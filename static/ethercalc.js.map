{"version":3,"sources":["socialcalcconstants.js","socialcalc-3.js","socialcalctableeditor.js","formatnumber2.js","formula1.js","socialcalcpopup.js","socialcalcspreadsheetcontrol.js","socialcalcviewer.js","third-party/class-js/lib/Class.js","third-party/wikiwyg/lib/Document/Emitter.js","third-party/wikiwyg/lib/Document/Emitter/HTML.js","third-party/wikiwyg/lib/Document/Parser.js","third-party/wikiwyg/lib/Document/Parser/Wikitext.js","static/jquery.js","static/vex.combined.min.js"],"names":["SocialCalc","Constants","cellDataType","v","n","t","f","c","textdatadefaulttype","s_BrowserNotSupported","s_InternalError","s_pssUnknownColType","s_pssUnknownRowType","s_pssUnknownLineType","s_cfspUnknownCellType","doCanonicalizeSheet","s_escUnknownSheetCmd","s_escUnknownSetCoordCmd","s_escUnknownCmd","s_caccCircRef","defaultRowNameWidth","defaultAssumedRowHeight","defaultCellIDPrefix","defaultCellLayout","defaultCellFontStyle","defaultCellFontSize","defaultCellFontFamily","defaultPaneDividerWidth","defaultPaneDividerHeight","defaultGridCSS","defaultCommentClass","defaultCommentStyle","defaultCommentNoGridClass","defaultCommentNoGridStyle","defaultReadonlyClass","defaultReadonlyStyle","defaultReadonlyNoGridClass","defaultReadonlyNoGridStyle","defaultReadonlyComment","defaultColWidth","defaultMinimumColWidth","defaultHighlightTypeCursorClass","defaultHighlightTypeCursorStyle","defaultHighlightTypeRangeClass","defaultHighlightTypeRangeStyle","defaultColnameClass","defaultColnameStyle","defaultSelectedColnameClass","defaultSelectedColnameStyle","defaultRownameClass","defaultRownameStyle","defaultSelectedRownameClass","defaultSelectedRownameStyle","defaultUpperLeftClass","defaultUpperLeftStyle","defaultSkippedCellClass","defaultSkippedCellStyle","defaultPaneDividerClass","defaultPaneDividerStyle","defaultUnhideLeftClass","defaultUnhideLeftStyle","defaultUnhideRightClass","defaultUnhideRightStyle","defaultUnhideTopClass","defaultUnhideTopStyle","defaultUnhideBottomClass","defaultUnhideBottomStyle","defaultColResizeBarClass","defaultRowResizeBarClass","s_rcMissingSheet","defaultLinkFormatString","defaultPageLinkFormatString","defaultFormatp","defaultFormatc","defaultFormatdt","defaultFormatd","defaultFormatt","defaultDisplayTRUE","defaultDisplayFALSE","defaultImagePrefix","defaultTableEditorIDPrefix","defaultPageUpDnAmount","AllowCtrlS","defaultTableControlThickness","cteGriddivClass","s_statusline_executing","s_statusline_displaying","s_statusline_ordering","s_statusline_calculating","s_statusline_calculatingls","s_statusline_doingserverfunc","s_statusline_incell","s_statusline_calcstart","s_statusline_sum","s_statusline_recalcneeded","s_statusline_circref","s_statusline_sendemail","s_inputboxdisplaymultilinetext","defaultInputEchoClass","defaultInputEchoStyle","defaultInputEchoPromptClass","defaultInputEchoPromptStyle","defaultInputEchoHintClass","defaultInputEchoHintStyle","ietUnknownFunction","CH_radius1","CH_radius2","s_CHfillAllTooltip","s_CHfillContentsTooltip","s_CHmovePasteAllTooltip","s_CHmovePasteContentsTooltip","s_CHmoveInsertAllTooltip","s_CHmoveInsertContentsTooltip","s_CHindicatorOperationLookup","Fill","FillC","Move","MoveI","MoveC","MoveIC","s_CHindicatorDirectionLookup","Down","Right","Horizontal","Vertical","defaultTCSliderThickness","defaultTCButtonThickness","defaultTCThumbThickness","TCmainStyle","TCmainClass","TCendcapStyle","TCendcapClass","TCpanesliderClass","s_panesliderTooltiph","s_panesliderTooltipv","TClessbuttonStyle","TClessbuttonClass","TClessbuttonRepeatWait","TClessbuttonRepeatInterval","TCmorebuttonStyle","TCmorebuttonClass","TCmorebuttonRepeatWait","TCmorebuttonRepeatInterval","TCscrollareaStyle","TCscrollareaClass","TCscrollareaRepeatWait","TCscrollareaRepeatInterval","TCthumbClass","TCthumbStyle","TCPStrackinglineClass","TCPStrackinglineStyle","TCPStrackinglineThickness","TCTDFSthumbstatusvClass","TCTDFSthumbstatusvStyle","TCTDFSthumbstatushClass","TCTDFSthumbstatushStyle","TCTDFSthumbstatusrownumClass","TCTDFSthumbstatusrownumStyle","TCTDFStopOffsetv","TCTDFSleftOffsetv","s_TCTDFthumbstatusPrefixv","TCTDFStopOffseth","TCTDFSleftOffseth","s_TCTDFthumbstatusPrefixh","TooltipOffsetX","TooltipOffsetY","TDpopupElementClass","TDpopupElementStyle","SCToolbarbackground","SCTabbackground","SCTabselectedCSS","SCTabplainCSS","SCToolbartext","SCFormulabarheight","SCStatuslineheight","SCStatuslineCSS","SCFormatNumberFormats","SCFormatTextFormats","SCFormatPadsizes","SCFormatFontsizes","SCFormatFontfamilies","SCFormatFontlook","SCFormatTextAlignhoriz","SCFormatNumberAlignhoriz","SCFormatAlignVertical","SCFormatColwidth","SCFormatRecalc","SCFormatUserMaxCol","SCFormatUserMaxRow","ISCButtonBorderNormal","ISCButtonBorderHover","ISCButtonBorderDown","ISCButtonDownBackground","s_PopupListCancel","s_PopupListCustom","s_loc_align_center","s_loc_align_left","s_loc_align_right","s_loc_alignment","s_loc_audit","s_loc_audit_trail_this_session","s_loc_auto","s_loc_auto_sum","s_loc_auto_wX_commas","s_loc_automatic","s_loc_background","s_loc_bold","s_loc_bold_XampX_italics","s_loc_bold_italic","s_loc_borders","s_loc_borders_off","s_loc_borders_on","s_loc_bottom","s_loc_bottom_border","s_loc_cell_settings","s_loc_csv_format","s_loc_cancel","s_loc_category","s_loc_center","s_loc_clear","s_loc_clear_socialcalc_clipboard","s_loc_clipboard","s_loc_color","s_loc_column_","s_loc_comment","s_loc_copy","s_loc_custom","s_loc_cut","s_loc_default","s_loc_default_alignment","s_loc_default_column_width","s_loc_default_font","s_loc_default_format","s_loc_default_padding","s_loc_delete","s_loc_delete_column","s_loc_delete_contents","s_loc_delete_row","s_loc_description","s_loc_display_clipboard_in","s_loc_down","s_loc_edit","s_loc_existing_names","s_loc_family","s_loc_fill_down","s_loc_fill_right","s_loc_font","s_loc_format","s_loc_formula","s_loc_function_list","s_loc_functions","s_loc_grid","s_loc_hidden","s_loc_hide_column","s_loc_hide_row","s_loc_horizontal","s_loc_insert_column","s_loc_insert_row","s_loc_italic","s_loc_last_sort","s_loc_left","s_loc_left_border","s_loc_link","s_loc_link_input_box","s_loc_list","s_loc_load_socialcalc_clipboard_with_this","s_loc_lock_cell","s_loc_major_sort","s_loc_manual","s_loc_merge_cells","s_loc_middle","s_loc_minor_sort","s_loc_move_insert","s_loc_move_paste","s_loc_multiXline_input_box","s_loc_name","s_loc_names","s_loc_no_padding","s_loc_normal","s_loc_number","s_loc_number_horizontal","s_loc_ok","s_loc_padding","s_loc_page_name","s_loc_paste","s_loc_paste_formats","s_loc_plain_text","s_loc_recalc","s_loc_recalculation","s_loc_redo","s_loc_right","s_loc_right_border","s_loc_sheet_settings","s_loc_save","s_loc_save_to","s_loc_set_cell_contents","s_loc_set_cells_to_sort","s_loc_set_value_to","s_loc_set_to_link_format","s_loc_setXclear_move_from","s_loc_show_cell_settings","s_loc_show_sheet_settings","s_loc_show_in_new_browser_window","s_loc_size","s_loc_socialcalcXsave_format","s_loc_sort","s_loc_sort_","s_loc_sort_cells","s_loc_swap_colors","s_loc_tabXdelimited_format","s_loc_text","s_loc_text_horizontal","s_loc_this_is_aXbrXsample","s_loc_top","s_loc_top_border","s_loc_undone_steps","s_loc_url","s_loc_undo","s_loc_unlock_cell","s_loc_unmerge_cells","s_loc_up","s_loc_value","s_loc_vertical","s_loc_wikitext","s_loc_workspace","s_loc_XnewX","s_loc_XnoneX","s_loc_Xselect_rangeX","SVStatuslineheight","SVStatuslineCSS","FormatNumber_separatorchar","FormatNumber_decimalchar","FormatNumber_defaultCurrency","s_FormatNumber_daynames","s_FormatNumber_daynames3","s_FormatNumber_monthnames","s_FormatNumber_monthnames3","s_FormatNumber_am","s_FormatNumber_am1","s_FormatNumber_pm","s_FormatNumber_pm1","s_parseerrexponent","s_parseerrchar","s_parseerrstring","s_parseerrspecialvalue","s_parseerrtwoops","s_parseerrmissingopenparen","s_parseerrcloseparennoopen","s_parseerrmissingcloseparen","s_parseerrmissingoperand","s_parseerrerrorinformula","s_calcerrerrorvalueinformula","s_parseerrerrorinformulabadval","s_formularangeresult","s_calcerrnumericnan","s_calcerrnumericoverflow","s_sheetunavailable","s_calcerrcellrefmissing","s_calcerrsheetnamemissing","s_circularnameref","s_calcerrunknownname","s_calcerrincorrectargstofunction","s_sheetfuncunknownfunction","s_sheetfunclnarg","s_sheetfunclog10arg","s_sheetfunclogsecondarg","s_sheetfunclogfirstarg","s_sheetfuncroundsecondarg","s_sheetfuncddblife","s_sheetfuncslnlife","s_fdef_ABS","s_fdef_ACOS","s_fdef_AND","s_fdef_ASIN","s_fdef_ATAN","s_fdef_ATAN2","s_fdef_AVERAGE","s_fdef_CHOOSE","s_fdef_COLUMNS","s_fdef_COS","s_fdef_COUNT","s_fdef_COUNTA","s_fdef_COUNTBLANK","s_fdef_COUNTIF","s_fdef_DATE","s_fdef_DAVERAGE","s_fdef_DAY","s_fdef_DCOUNT","s_fdef_DCOUNTA","s_fdef_DDB","s_fdef_DEGREES","s_fdef_DGET","s_fdef_DMAX","s_fdef_DMIN","s_fdef_DPRODUCT","s_fdef_DSTDEV","s_fdef_DSTDEVP","s_fdef_DSUM","s_fdef_DVAR","s_fdef_DVARP","s_fdef_EVEN","s_fdef_EXACT","s_fdef_EXP","s_fdef_FACT","s_fdef_FALSE","s_fdef_FIND","s_fdef_FV","s_fdef_HLOOKUP","s_fdef_HOUR","s_fdef_IF","s_fdef_INDEX","s_fdef_INT","s_fdef_IRR","s_fdef_ISBLANK","s_fdef_ISERR","s_fdef_ISERROR","s_fdef_ISLOGICAL","s_fdef_ISNA","s_fdef_ISNONTEXT","s_fdef_ISNUMBER","s_fdef_ISTEXT","s_fdef_LEFT","s_fdef_LEN","s_fdef_LN","s_fdef_LOG","s_fdef_LOG10","s_fdef_LOWER","s_fdef_MATCH","s_fdef_MAX","s_fdef_MID","s_fdef_MIN","s_fdef_MINUTE","s_fdef_MOD","s_fdef_MONTH","s_fdef_N","s_fdef_NA","s_fdef_NOT","s_fdef_NOW","s_fdef_NPER","s_fdef_NPV","s_fdef_ODD","s_fdef_OR","s_fdef_PI","s_fdef_PMT","s_fdef_POWER","s_fdef_PRODUCT","s_fdef_PROPER","s_fdef_PV","s_fdef_RADIANS","s_fdef_RATE","s_fdef_REPLACE","s_fdef_REPT","s_fdef_RIGHT","s_fdef_ROUND","s_fdef_ROWS","s_fdef_SECOND","s_fdef_SIN","s_fdef_SLN","s_fdef_SQRT","s_fdef_STDEV","s_fdef_STDEVP","s_fdef_SUBSTITUTE","s_fdef_SUM","s_fdef_SUMIF","s_fdef_SYD","s_fdef_T","s_fdef_TAN","s_fdef_TIME","s_fdef_TODAY","s_fdef_TRIM","s_fdef_TRUE","s_fdef_TRUNC","s_fdef_UPPER","s_fdef_VALUE","s_fdef_VAR","s_fdef_VARP","s_fdef_VLOOKUP","s_fdef_WEEKDAY","s_fdef_YEAR","s_fdef_SUMPRODUCT","s_fdef_CEILING","s_fdef_FLOOR","s_farg_v","s_farg_vn","s_farg_xy","s_farg_choose","s_farg_range","s_farg_rangec","s_farg_date","s_farg_dfunc","s_farg_ddb","s_farg_find","s_farg_fv","s_farg_hlookup","s_farg_iffunc","s_farg_index","s_farg_irr","s_farg_tc","s_farg_log","s_farg_match","s_farg_mid","s_farg_nper","s_farg_npv","s_farg_pmt","s_farg_pv","s_farg_rate","s_farg_replace","s_farg_vp","s_farg_valpre","s_farg_csl","s_farg_cslp","s_farg_subs","s_farg_sumif","s_farg_hms","s_farg_txt","s_farg_vlookup","s_farg_weekday","s_farg_dt","s_farg_rangen","s_farg_vsig","function_classlist","s_fclass_all","s_fclass_stat","s_fclass_lookup","s_fclass_datetime","s_fclass_financial","s_fclass_test","s_fclass_math","s_fclass_text","s_fclass_action","s_fclass_gui","lastone","ConstantsDefaultClasses","defaultComment","defaultCommentNoGrid","defaultHighlightTypeCursor","defaultHighlightTypeRange","defaultColname","defaultSelectedColname","defaultRowname","defaultSelectedRowname","defaultUpperLeft","defaultSkippedCell","defaultPaneDivider","cteGriddiv","defaultInputEcho","classname","style","TCmain","TCendcap","TCpaneslider","TClessbutton","TCmorebutton","TCscrollarea","TCthumb","TCPStrackingline","TCTDFSthumbstatus","TDpopupElement","ConstantsSetClasses","prefix","item","defaults","scc","undefined","ConstantsSetImagePrefix","imagePrefix","replace","Callbacks","expand_wiki","expand_markup","displayvalue","sheetobj","linkstyle","default_expand_markup","MakePageLink","NormalizeSheetName","Cell","coord","this","datavalue","datatype","formula","valuetype","readonly","CellProperties","errors","comment","bt","br","bb","bl","layout","font","color","bgcolor","cellformat","nontextvalueformat","textvalueformat","colspan","rowspan","cssc","csss","mod","displaystring","parseinfo","hcolspan","hrowspan","CellPropertiesTable","Sheet","ResetSheet","statuscallback","statuscallbackparams","sheet","reload","cells","attribs","lastcol","lastrow","defaultlayout","usermaxcol","usermaxrow","rowattribs","hide","height","colattribs","width","names","layouts","layouthash","fonts","fonthash","colors","colorhash","borderstyles","borderstylehash","cellformats","cellformathash","valueformats","valueformathash","matched_cells","selected_search_cell","copiedfrom","changes","UndoStack","renderneeded","changedrendervalues","recalcchangedavalue","hiddencolrow","sci","SheetCommandInfo","ioEventTree","ioParameterList","prototype","AddCell","newcell","LastCol","last_col","cell_id","cr","coordToCr","col","LastRow","last_row","row","GetAssuredCell","ParseSheetSave","savedsheet","CellFromStringParts","cell","parts","j","CreateSheetSave","range","canonicalize","CellToString","CanonicalizeSheet","full","EncodeCellAttributes","EncodeSheetAttributes","DecodeCellAttributes","DecodeSheetAttributes","ScheduleSheetCommands","cmd","saveundo","SheetUndo","SheetRedo","CreateAuditString","GetStyleNum","atype","GetStyleString","num","RecalcSheet","line","i","name","lines","split","length","defaultcolwidth","defaultrowheight","defaulttextformat","defaultnontextformat","defaultfont","defaulttextvalueformat","defaultnontextvalueformat","defaultcolor","defaultbgcolor","circularreferencecell","recalc","needsrecalc","decodeFromSave","toUpperCase","desc","definition","match","alert","charAt","ro","toLowerCase","sheetfields","sheetfieldsshort","sheetfieldsxlat","sheetfieldsxlatshort","sheetfieldsxlatxlt","cr1","cr2","value","prange","result","xlt","ParseRange","maxrow","maxcol","push","crToCoord","rcColname","encodeForSave","newborderstyles","newcellformats","newcolors","newfonts","newlayouts","newvalueformats","namesorder","join","r","b","l","borderstylesxlat","layoutsxlat","fontsxlat","colorsxlat","cellformatsxlat","valueformatsxlat","filled","an","a","newa","newxlat","used","ahash","alist","sort","Array","colorsUsed","borderstylesUsed","fontsUsed","layoutsUsed","cellformatsUsed","valueformatsUsed","unshift","InitAttrib","def","val","InitAttribs","namelist","SetAttrib","SetAttribStar","rowheight","newattribs","changed","CheckChanges","attribname","oldval","cmdname","DoCmd","cmdstr","str","alignvert","padtop","padright","padbottom","padleft","fontlook","fontsize","fontfamily","timerobj","firsttimerdelay","timerdelay","maxtimeslice","CmdExtensionCallbacks","parseobj","Parse","PushChange","window","setTimeout","SheetCommandsTimerRoutine","errortext","starttime","Date","EOF","ExecuteSheetCommand","console","log","NextLine","increment_amount","down","valid_datatype","type","editor","GetSpreadsheetControlObject","range2","returnval","hasrange","startcell","endcell","bottom","top","left","right","Range2Remove","cmd1","rest","what","attrib","pos","pos2","undostart","fillright","rowstart","colstart","crbase","rowoffset","coloffset","basecell","clipsheet","cliprange","numcols","numrows","attribtable","colend","rowend","newcolstart","newrowstart","newcolend","newrowend","rownext","colnext","colthis","rowbefore","colbefore","oldformula","oldcr","cols","dirs","lastsortcol","sortlist","sortcells","sortvalues","sorttypes","sortfunction","valtype","originalrow","sortedcr","v1","v2","cmdextension","undoNum","trackLine","cellProperties","cellChanged","RestOfStringNoMove","AddDo","NextToken","RestOfString","AddUndo","test","indexOf","substring","celldisplayneeded","_app","prevvaluetype","Clipboard","clipboard","inc","OffsetFormulaCoords","Math","max","slast","a1","b1","ta","cresult","tb","widgetsClean","AdjustFormulaCoords","movingcells","dest","destcr","inserthoriz","insertvert","pushamount","movedto","ReplaceFormulaCoords","recalconce","parseInt","context","rowpanes","first","timeout","SetRowPaneFirstLast","griddiv","document","getElementById","removeChild","FitToEditTable","colpanes","SetColPaneFirstLast","func","data","tos","TOS","undo","Undo","didredo","Redo","command","stack","ttext","ttype","newcr","updatedformula","scf","Formula","tokentype","TokenType","token_op","op","token_string","string","token_coord","tokenOpExpansion","TokenOpExpansion","ParseFormulaIntoTokens","text","sheetref","RecalcInfo","currentState","state","idle","start_calc","order","calc","start_wait","done_wait","recalctimer","timeslicedelay","queue","LoadSheet","sheetname","RecalcData","inrecalc","celllist","celllistitem","calclist","calclistlength","firstcalc","lastcalc","nextcalc","count","checkinfo","RecalcCheckInfo","oldcoord","parsepos","inrange","inrangestart","c1","c2","r1","r2","scri","FreshnessInfoReset","RecalcClearTimeout","RecalcSetTimeout","RecalcTimerRoutine","clearTimeout","RecalcLoadedSheet","recalcneeded","live","AddSheetToCache","SheetCache","waitingForLoading","previousrecalcsheet","eresult","err","status","recalcdata","do_statuscallback","arg","RecalcCheckCell","total","evaluate_parsed_formula","firstRenderScheduled","ScheduleRender","RemoteFunctionInfo","waitingForServer","funcname","error","reRenderCellList","FreshnessInfo","recalc_completed","shift","startcoord","rangecoord","coordvals","token_name","mainloop","LookupName","delimiter","lineEnd","pos1","oldpos","maxRedo","maxUndo","pop","args","arguments","RenderContext","hideRowsCols","showGrid","showRCHeaders","rownamewidth","pixelsPerRow","cellskip","coordToCR","colwidth","totalwidth","totalheight","colunhideleft","colunhideright","rowunhidetop","rowunhidebottom","highlights","cursorsuffix","highlightTypes","cursor","className","cursorinsertup","cursorinsertleft","cellIDprefix","defaultlinkstyle","defaultHTMLlinkstyle","defaultfontstyle","defaultfontsize","defaultfontfamily","defaultpanedividerwidth","defaultpanedividerheight","gridCSS","commentClassName","commentCSS","commentNoGridClassName","commentNoGridCSS","readonlyClassName","readonlyCSS","readonlyNoGridClassName","readonlyNoGridCSS","readonlyComment","classnames","colname","rowname","selectedcolname","selectedrowname","upperleft","skippedcell","panedivider","unhideleft","unhideright","unhidetop","unhidebottom","colresizebar","rowresizebar","explicitStyles","needcellskip","needprecompute","last","PrecomputeSheetFontsAndLayouts","CalculateCellSkipData","CalculateColWidthData","CalculateRowHeightData","panenum","CoordInPane","rowpane","colpane","CellInPane","InitializeTable","tableobj","RenderSheet","oldtable","RenderColGroup","RenderColHeaders","RenderSizingRow","RenderRow","rownum","RenderSpacingRow","RenderCell","colnum","noElement","layoutre","dparts","sparts","s","weight","size","family","skiprow","skipcol","skipcoord","borderCollapse","cellSpacing","cellPadding","newrow","colgroupobj","tbodyobj","parentnode","createElement","appendChild","parentNode","replaceChild","newcol","newdiv","cssText","verticalAlign","innerHTML","container","position","unhide","fixPosition","resizeBar","overflow","w","span","sheetattribs","stylestr","CreatePseudoElement","id","colSpan","rowSpan","FormatValueForDisplay","title","classList","add","setStyles","panerowlimits","panecollimits","collow","colhigh","floor","String","fromCharCode","letters","coordToCol","coordToRow","ch","charCodeAt","decodeFromAjax","special_chars","Lookup","list","element","part","GetViewportInfo","innerWidth","innerHeight","horizontalScroll","pageXOffset","verticalScroll","pageYOffset","documentElement","clientWidth","clientHeight","scrollLeft","scrollTop","body","GetElementPosition","offsetLeft","offsetTop","GetComputedStyle","offsetParent","GetElementPositionWithScroll","rect","getBoundingClientRect","GetElementFixedParent","tagName","computedStyle","currentStyle","defaultView","getComputedStyle","LookupElement","array","AssignID","obj","idPrefix","GetCellContents","cellobj","valueformat","valuesubtype","valueinputwidget","formula_name","html_display_value","html_formated_value","format_text_for_display","format_number_for_display","parameters","formula_details","FunctionList","cell_html","checkedValue","parameterValue","index","paramRegExp","RegExp","html","htmlIndex","css","rawvalue","dvsc","dvue","textval","encodeURI","expand_text_link","u","FormatNumber","formatNumberWithFormat","DetermineValueType","tvalue","matches","year","hour","minute","second","denom","intgr","constr","isNaN","slice","navigator","convert_date_gregorian_to_julian","InputConstants","TRUE","FALSE","#N/A","#NULL!","#NUM!","#DIV/0!","#VALUE!","#REF!","#NAME?","url","ParseCellLinkText","pagename","newwin","workspacename","workspace","pageform","urlend","descstart","lastlt","lastIndexOf","lastbrkt","lastbrace","descend","wsend","ConvertSaveToOtherFormat","savestr","outputformat","dorecalc","clipextents","div","ele","ConvertOtherFormatToSave","inputstr","inputformat","inquote","maxc","SetConvertedCell","TableEditor","toplevel","fullgrid","noEdit","tablewidth","tableheight","inputBox","inputEcho","verticaltablecontrol","horizontaltablecontrol","logo","cellhandles","busy","ensureecell","deferredCommands","deferredEmailCommands","gridposition","headposition","firstscrollingrow","firstscrollingrowtop","lastnonscrollingrow","lastvisiblerow","firstscrollingcol","firstscrollingcolleft","lastnonscrollingcol","lastvisiblecol","rowpositions","colpositions","ecell","workingvalues","imageprefix","pageUpDnAmount","recalcFunction","EditorSheetStatusCallback","ctrlkeyFunction","charname","sel","cliptext","pasteTextarea","GetEditorCellElement","ECellReadonly","EditorScheduleSheetCommands","display","focus","select","blur","KeyboardFocus","pastescclipboard","clipstr","ntvf","newntvf","prompt","CtrlSEditor","StatusCallback","MoveECellCallback","RangeChangeCallback","SettingsCallbacks","CreateTableEditor","ResizeTableEditor","SaveEditorSettings","LoadEditorSettings","flags","EditorRenderSheet","ignorebusy","EditorStepSet","GetStatuslineString","params","EditorGetStatuslineString","EditorMouseRegister","EditorMouseUnregister","EditorMouseRange","EditorProcessKey","e","EditorAddToInput","DisplayCellContents","EditorDisplayCellContents","EditorSaveEdit","EditorApplySetCommandsToRange","cmdline","MoveECellWithKey","MoveECell","ReplaceCell","UpdateCellCSS","SetECellHeaders","selected","EnsureECellVisible","RangeAnchor","RangeExtend","RangeRemove","CalculateEditorPositions","renderwidgets","DoRenderStep","SchedulePositionCalculations","DoPositionCalculations","CalculateRowPositions","positions","sizes","CalculateColPositions","ScrollRelative","vertical","amount","ScrollRelativeBoth","vamount","hamount","PageRelative","direction","LimitLastPanes","ScrollTableUpOneRow","ScrollTableDownOneRow","ScrollTableLeftOneCol","ScrollTableRightOneCol","StopPropagation","SetMouseMoveUp","RemoveMouseMoveUp","TableControl","CreateTableControl","main","table","tbody","tr","td","layouttable","background","TooltipRegister","firstChild","InputEcho","CellHandles","userAgent","removeEventListener","SafariPasteFunction","addEventListener","MouseWheelRegister","WheelMove","EditorProcessMouseWheel","KeyboardSetFocus","preventDefault","setting","anchorcoord","save","anchorrow","anchorcol","load","cmdTokens","TriggerIoAction","Email","dcmd","signalstatus","emailcmd","sstr","progress","circ","sum","emailing","emailreponse","updatingopsettings","updatingopresponse","calculating","EditorMouseInfo","registeredElements","ignore","mousedowncoord","mouselastcoord","mouseresizecol","mouseresizeclientx","mouseresizedisplay","mouseinfo","ProcessEditorMouseDown","ProcessEditorDblClick","attachEvent","oldelement","detachEvent","splice","event","stopPropagation","cancelBubble","returnValue","move","up","setCapture","releaseCapture","target","srcElement","nodeType","mobj","clientX","clientY","GridMousePosition","rowheader","rowselect","ProcessEditorRowselectMouseDown","ProcessEditorRowsizeMouseDown","colheader","colselect","ProcessEditorColselectMouseDown","ProcessEditorColsizeMouseDown","shiftKey","CmdGotFocus","clickedCell","widget_id","cell_widget","ProcessEditorMouseMove","ProcessEditorMouseUp","inputtext","wval","GetText","partialexpr","SetText","Blur","ShowInputBox","ShowCellHandles","SetDragAutoRepeat","mouseresizecolnum","coltoresize","mousedownclientx","mousecoltounhide","coltounhide","sizedisplay","zIndex","lastChild","childNodes","ProcessEditorColsizeMouseMove","ProcessEditorColsizeMouseUp","newsize","FinishColRowSize","coord1","coord2","coord3","ProcessEditorRowselectMouseMove","ProcessEditorRowselectMouseUp","ProcessEditorColselectMouseMove","ProcessEditorColselectMouseUp","spreadsheetDiv","offsetHeight","mouseresizerownum","rowtoresize","mouseresizerow","mousedownclienty","mouserowtounhide","rowtounhide","ProcessEditorRowsizeMouseMove","ProcessEditorRowsizeMouseUp","AutoRepeatInfo","timer","repeatinterval","repeatcallback","callback","repeatinfo","rowfooter","colfooter","distance","DragAutoRepeat","EditorOpenCellEdit","disabled","Focus","Select","ecoord","erow","ecol","substr","skipOne","valueinfo","fch","oldvalue","EditedTriggerCell","actionFormulaCells","editedCellRef","actionCellId","function_name","delta","mousewheelinfo","wobj","functionobj","ceil","offsetWidth","controlborder","headerColOffset","headerRowOffset","rowindex","colindex","shifted","min","newelement","headercell","totalrows","needed","firstRow","lastRow","ComputeTableControlPositions","ignoreRender","PositionTableControlElements","toprow","offset","trowobj","leftcol","cellposition","dv","dh","vplen","vlimit","hplen","hlimit","newfirst","totalsize","current","panes","lastpane","lastvisible","sizearray","defaultsize","plen","oldrownum","newbottomrow","oldchild","bottomrownum","rowneedsrefresh","maxrowspan","newrownum","insertBefore","InputBox","onmousedown","InputBoxOnMouseDown","formulabar","InputBoxDisplayCellContents","show","ShowInputEcho","newtext","InputBoxFocus","selection","createRange","duplicate","moveToElementText","collapse","selectionStart","selectionEnd","inputbox","Keyboard","focusTable","interval","hint","functionbox","DragRegister","MouseDown","DragFunctionStart","MouseMove","DragFunctionPosition","MouseUp","Disabled","positionobj","SetInputEchoText","inputecho","clearInterval","setInterval","InputEchoHeartbeat","fname","fstr","newstr","FillFunctionInfo","FunctionArgString","InputEchoMouseDown","noCursorSuffix","movedmouse","draghandle","imagetype","dragpalette","dragtooltip","fillinghandle","CellHandlesMouseMoveOnHandle","CellHandlesMouseDown","moveshow","doshow","colinc","rowinc","mouseDown","whichhandle","SegmentDivHit","CellHandlesHoverTimeout","tooltipstimer","tooltipswhichhandle","CellHandlesTooltipsTimeout","segtable","divWithMouseHit","x","y","len","sqrt","pow","quadrant","dragtype","filltype","startingcoord","startingX","startingY","CellHandlesMouseMove","CellHandlesMouseUp","crstart","crend","CellHandlesDragAutoRepeat","abs","newcoord","vscroll","hscroll","cstr","cmdtype","cmdtype2","sizec","sizer","deltac","deltar","endcap","paneslider","lessbutton","morebutton","scrollarea","thumb","endcapstart","panesliderstart","lessbuttonstart","morebuttonstart","scrollareastart","scrollareaend","scrollareasize","thumbpos","controlthickness","sliderthickness","buttonthickness","thumbthickness","minscrollingpanesize","control","functions","etype","vh","backgroundImage","TCPSDragFunctionStart","TCPSDragFunctionMove","TCPSDragFunctionStop","repeatwait","normalstyle","downstyle","hoverstyle","Repeat","ButtonRegister","ScrollAreaClick","TCTDragFunctionStart","TCTDragFunctionMove","TCTDragFunctionStop","buttoninfo","bobj","clickpos","border","realend","draginfo","dobj","trackingline","offsetY","offsetX","thumbstatus","rowmsgele","rowpreviewele","thumbcontext","pane","TCTDragFunctionRowSetStatus","msg","thumbrowshown","DragInfo","draggingElement","startX","startY","startZ","relativeOffset","horizontal","parent","DragMouseDown","DragUnregister","DragMouseMove","DragMouseUp","TooltipInfo","registered","tooltipElement","popupElement","tiptext","tooltipinfo","TooltipMouseMove","tobj","TooltipHide","ButtonInfo","buttonDown","TooltipWaitDone","TooltipMouseDown","TooltipDisplay","offsetx","offsety","viewport","buttonElement","doingHover","paramobj","ButtonMouseDown","ButtonMouseOver","ButtonMouseOut","MouseOver","MouseOut","ButtonMouseUp","ButtonRepeat","MouseWheelInfo","ProcessMouseWheel","passThru","wheelDelta","detail","keyboardTables","specialKeysCommon","8","9","13","25","27","33","34","35","36","37","38","39","40","45","46","113","specialKeysIE","controlKeysIE","67","83","86","88","90","specialKeysOpera","controlKeysOpera","specialKeysSafari","63232","63233","63234","63235","63272","63273","63275","63276","63277","63237","controlKeysSafari","99","115","118","120","122","ignoreKeysSafari","63236","63238","63239","63240","63241","63242","63243","63244","63245","63246","63247","63289","specialKeysFirefox","controlKeysFirefox","ignoreKeysFirefox","16","17","18","20","19","44","91","92","112","114","116","117","119","121","123","144","145","224","areListener","didProcessKey","statusFromProcessKey","repeatingKeyPress","chForProcessKey","onkeydown","ProcessKeyDown","onkeypress","ProcessKeyPress","kt","which","keyCode","ctrlKey","ProcessKey","metaKey","charCode","ft","format_definitions","separatorchar","decimalchar","daynames","daynames3","monthnames3","monthnames","allowedcolors","BLACK","BLUE","CYAN","GREEN","MAGENTA","RED","WHITE","YELLOW","alloweddates","H","M","MM","S","SS","commands","copy","integer_placeholder","fraction_placeholder","decimal","currency","general","separator","date","comparison","section","datevalues","julian_offset","seconds_in_a_day","seconds_in_an_hour","format_string","currency_char","operandstr","fromend","cval","operandstrlc","startval","estartval","hrs","mins","secs","ehrs","emins","esecs","ampmstr","ymd","minOK","thisformat","gotcomparison","compop","compval","cpos","oppos","sectioninfo","decimalscale","scaledvalue","strvalue","strparts","integervalue","fractionvalue","integerdigits2","integerpos","fractionpos","textcolor","textstyle","scfn","isFinite","formatTextWithFormat","negativevalue","zerovalue","FormatNumber_DefaultCurrency","parse_format_string","hascomparison","operators","operands","commas","percent","fractiondigits","integerdigits","hasdate","convert_date_julian_to_gregorian","mspos","sectionstart","thousandssep","factor","LOG10E","day","month","format_defs","lastwasinteger","lastwasslash","lastwasasterisk","lastwasunderscore","quotestr","inbracket","bracketstr","bracketdata","ingeneral","indate","chpos","integerpart","parse_format_bracket","operator","operand","ampstr","juliandate","intFunc","L","N","I","J","K","ParseState","alpha","stringquote","numexp1","numexp2","alphanumeric","specialvalue","space","CharClass","numstart","eof","incoord","quote","specialstart","CharClassTable"," ","!","\"","'","#","$","%","&","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7",":","<","=",">","A","B","C","D","E","F","G","O","P","Q","R","T","U","V","W","X","Y","Z","^","_","d","g","h","k","m","o","p","q","z","UpperCaseTable","SpecialConstants","TokenPrecedence","TypeLookupTable","unaryminus","n*","e*","t*","unaryplus","unarypercent","plus","n%","nd","nt","ndt","n$","nl","concat","th","tw","tl","oneargnumeric","twoargnumeric","propagateerror","cclass","haddecimal","last_token","last_token_type","last_token_text","parsestate","charclass","charclasstable","uppercasetable","pushtoken","ParsePushToken","coordregex","topcode","opcode","allowrangereturn","revpolish","ConvertInfixToPolish","EvaluatePolish","pii","tprecedence","tstackprecedence","token_precedence","parsestack","function_start","debug_log","DebugLog","logObject","rii","prii","value1","value2","tostype","tostype2","resulttype","cond","vmatch","smatch","lookup_result_type","LookupResultType","typelookup","operand_as_number","OperandAsNumber","operand_as_text","OperandAsText","operand_value_and_type","OperandValueAndType","operands_as_coord_on_sheet","OperandsAsCoordOnSheet","missingOperandError","PushOperand","parameterInfo","OperandsAsRangeOnSheet","CalculateFunction","type1","type2","table1","TopOfStackValueAndType","stacklen","operandinfo","cellvtype","coordsheet","StepThroughRangeDown","FindInSheetCache","PlainCoord","OperandAsCoord","OperandAsType","OperandAsRange","operandtype","othersheet","OperandAsSheetName","nvalue","isEnd","specialc","startedwalk","checknamecirc","rangevalue","sequence","sheet1","rp","OrderRangeParts","DecodeRangeParts","sheetdata","coordsheetdata","col1num","ncols","row1num","nrows","FunctionClasses","FunctionArgDefs","StoreIoEventFormula","operand_reverse","io_parameters","Clone","reverse","ioTimeTriggerList","radioGroupList","PushTriggerTime","coordA1","sheetData","triggerTimeCellId","currentTriggerTimeList","rangeinfo","cellCoord","ArrayValuesEqual","timeZoneOffsetMins","getTimezoneOffset","start_1_1_1970","triggerUTCTimeList","toString","triggerCellId","PushTriggerCord","cellcr","formDataViewer","CurrentSpreadsheetControlObject","CurrentSpreadsheetViewerObject","loaded","formFields","LoadFormFields","formFieldName","sheetCmd","formFieldsLength","headerCoord","valueCoord","sheetCmdTwo","destination","source","property","A1","A2","fobj","foperand","ffunc","argnum","CopyFunctionArgs","FunctionArgsError","FunctionSpecificError","errortype","CheckForErrorValue","classes","cname","items","nargs","fdata","adef","SeriesFunctions","maxval","minval","mk","sk","mk1","sk1","typelookupplus","resulttypesum","counta","countblank","product","SumProductFunction","products","DSeriesFunctions","dbrange","fieldname","criteriarange","dbinfo","criteriainfo","fieldasnum","targetcol","criteriafieldnums","testok","criteriacr","criteria","testcol","testcr","countmatches","FieldToColnum","criterianum","CRITERIAROW","TestCriteria","fieldtype","LookupFunctions","lookupvalue","rangelookup","offsetvalue","cincr","rincr","previousOK","csave","rsave","IndexFunction","indexinfo","CountifSumifFunctions","sumrange","f2operand","IfFunction","op1","op2","DateFunction","TimeFunction","hours","minutes","seconds","DMYFunctions","dtype","doffset","datevalue","HMSFunctions","fraction","datetime","ExactFunction","v1type","v2type","ArgList","FIND","LEFT","LEN","LOWER","MID","PROPER","REPLACE","REPT","RIGHT","SUBSTITUTE","TRIM","HEXCODE","UPPER","StringFunctions","start","numargs","argdef","operand_value","operand_type","word","fulltext","oldtext","code","next","IsFunctions","NTVFunctions","Math1Functions","acos","asin","atan","cos","PI","exp","sin","tan","Math2Functions","xval","yval","quotient","atan2","LogFunction","RoundFunction","round","CeilingFloorFunctions","sig","AndOrFunctions","NotFunction","ChooseFunction","cindex","ColumnsRowsFunctions","ZeroArgFunctions","tzoffset","nowdays","getTime","volatile","NOW","TODAY","DDBFunction","method","depreciation","accumulateddepreciation","cost","salvage","lifetime","period","SLNFunction","SYDFunction","sumperiods","InterestFunctions","dval","eval","fval","pv","fv","rate","payment","paytype","guess","part1","part2","part3","part4","part5","olddelta","maxloop","tries","oldrate","aval","bval","epsilon","NPVFunction","resulttypenpv","IRRFunction","oldsum","rangeoperand","cashflows","IoFunctions","parameter","repeatIndex","wantedType","argList","BUTTON","ONEDITDO","IMAGEBUTTON","EMAIL","EMAILIF","EMAILONEDIT","EMAILAT","EMAILONEDITIF","EMAILATIF","SUBMIT","TEXTBOX","AUTOCOMPLETE","SELECT","CHECKBOX","RADIOBUTTON","COPYVALUE","COPYFORMULA","INSERT","DELETEIF","COMMAND","COMMANDIF","PANEL","SPLASH","STYLE","repeatCount","parameterType","validParameterType","getStandardizedList","cssParameter","optionSource","options","optionRegExp","showindices","firstPanelIndex","splashdone","showrows","showcols","parameterIndex","showPanelFound","showIndex","panelCoordData","getStandardizedCoords","spreadsheet","ss","forceRender","lastShowDimension","showGridDimension","lastIndex","sheetHideList","showList","getIndexOf","arrayIndex","sheetHideIndex","getRowIndex","AddAutocomplete","autocompleteSource","ui","autocomplete","filter","term","matcher","escapeRegex","grep","label","minLength","autoFocus","AutoComplete","change","Button","conditionsParameter","parameterdata","getStandardizedValues","sheetCommandList","CopyValueToRange","CopyFormulaToRange","insertCommand","colOffset","rowOffset","insertcellCoord","cellcoord","sourceDataIndex","copyCellRange","deleteCommand","criteriaParameter","testRangeParameter","criteriaValue","celldata","commandsParameter","conditionCell","cellCommand","trim","formulaData","sheetCommand","destCellCoord","cellValueType","cellDataValue","cellFormula","sourceData","emailFormulaCellId","optionalTriggerCellId","parameterValues","parameterCellRefs","maxRangeSize","rangeSizeCounter","conditionIndex","toAddressParamOffset","setStatusBarMessage","emailContentsList","rangeIndex","valueRangeIndex","nameRangeIndex","conditionRangeIndex","toaddressRangeIndex","subjectsRangeIndex","bodyRangeIndex","emailContents","Submit","formDataValues","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","colIndex","SelectList","selectListCellId","getHTMLselectListCellValue","selectListWidget","updateInputWidgetFormula","autoCompleteCellId","getHTMLAutoCompleteCellValue","autoCompleteWidget","TextBox","textBoxCellId","getHTMLTextBoxCellValue","textBoxWidget","CheckBox","checkBoxCellId","getHTMLCheckBoxCellValue","checkBoxWidget","checked","RadioButton","radioButtonGroupName","getHTMLRadioButtonValue","radioButtonWidget","each","attr","widgetCellId","getHTMLWidgetCellValue","inputValue","paramIndex","UpdateFormDataSheet","formCellId","parameterData","getStandardizedParameter","listParameter","listValues","includeCellCoord","includeCellData","constantDatatype","sourcerangeinfo","sourceCoord","sheets","constants","asloaded","recalcing","recalcdone","loadsheet","sfsc","nsheetname","newsheet","sfscc","newsheetname","recalcstate","scffi","scfsc","comparitor","basestring","basevalue","testvalue","search","Popup","Types","Controls","Current","LocalizeString","Create","pt","SetValue","sp","spt","spc","spcdata","changedcallback","SetDisabled","Hide","GetValue","Initialize","Reset","CClick","Show","Close","Cancel","CreatePopupDiv","mainele","backgroundColor","moveable","dragregistered","EnsurePosition","GetLayoutValues","popup","popupele","DestroyPopupDiv","RGBToHex","rgbvals","ToHex","HexDigits","FromHex","HexToRGB","makeRGB","splitRGB","rgb","List","spcid","custom","skip","cancel","MakeCustom","customele","listdiv","contentele","MakeList","ensureWithin","bg","SPLoc","ItemClicked","oele","nele","CustomToList","CustomOK","rowele","ColorChooser","spca","sampleWidth","sampleHeight","img","backgroundImageDefault","backgroundPosition","backgroundImageDisabled","CreateGrid","padding","grid","fontSize","borderRight","backgroundRepeat","marginTop","defaultbox","onclick","DefaultClicked","CustomClicked","CloseOK","GridMouseDown","DetermineColors","SetColors","gridToG","sptc","steps","commonrgb","mousedown","gpos","newrgb","oldrgb","ControlClicked","cid","CustomToGrid","SpreadsheetControl","requestedHeight","requestedWidth","requestedSpaceBelow","viewheight","tabs","tabnums","tabreplacements","currentTab","views","editorDiv","sortrange","moverange","multipartBoundary","toolbarbackground","tabbackground","tabselectedCSS","tabplainCSS","toolbartext","formulabarheight","statuslineheight","statuslineCSS","ExportCallback","statusline","SpreadsheetControlStatuslineCallback","statuslineid","recalcid1","recalcid2","movefrom","formulabuttons","formulafunctions","image","tooltip","DoFunctionList","multilineinput","DoMultiline","link","DoLink","DoSum","findbuttons","SearchUp","SearchDown","edit","oncreate","settings","view","SettingsControls","SettingControlReset","cellattribs","SettingsControlLoadPanel","values","sheetspanel","cellspanel","SpreadsheetControlSettingsSwitch","onclickFocus","viewobj","colorchooser","formatnumber","initialdata","formattext","textalignhoriz","numberalignhoriz","cformatnumber","cformattext","cfontfamily","cfontlook","cfontsize","calignhoriz","calignvert","ctextcolor","cbgcolor","cbt","cbr","cbb","cbl","cpadtop","cpadright","cpadbottom","cpadleft","SettingsControlInitializePanel","replacements","itemtitle","regex","replacement","sectiontitle","parttitle","itembody","bodypart","divStyle","SpreadsheetControlSortOnclick","SpreadsheetControlSortSave","SpreadsheetControlSortLoad","audit","SCLoc","ObjToSource","check","na","SpreadsheetControlCommentOnclick","onunclick","SpreadsheetControlCommentOnunclick","SpreadsheetControlNamesOnclick","SpreadsheetControlNamesOnunclick","SpreadsheetControlClipboardOnclick","InitializeSpreadsheetControl","node","spacebelow","DoOnResize","SizeSSDiv","ExecuteCommand","combostr","SpreadsheetControlExecuteCommand","CreateSheetHTML","SpreadsheetControlCreateSheetHTML","CreateSpreadsheetSave","otherparts","SpreadsheetControlCreateSpreadsheetSave","DecodeSpreadsheetSave","SpreadsheetControlDecodeSpreadsheetSave","CreateCellHTML","SpreadsheetControlCreateCellHTML","CreateCellHTMLSave","SpreadsheetControlCreateCellHTMLSave","child","vname","button","bele","SCLocSS","LocalizeSubstrings","Buttons","button_undo","button_redo","button_copy","button_cut","button_paste","button_pasteformats","button_lock","button_unlock","button_delete","button_filldown","button_fillright","button_movefrom","button_movepaste","button_moveinsert","button_alignleft","button_aligncenter","button_alignright","button_borderon","button_borderoff","button_swapcolors","button_merge","button_insertrow","button_insertcol","button_deleterow","button_deletecol","button_hiderow","button_hidecol","button_recalc","DoButtonCmd","formulabarDiv","src","skipImagePrefix","marginLeft","input","searchBar","append","formulabardiv","on","FindInSheet","keyup","CalculateSheetNonViewHeight","nonviewheight","appViewDiv","formDataDiv","SpreadsheetViewer","InitializeSpreadsheetViewer","statuslineDiv","paddingTop","paddingBottom","SetSpreadsheetControlObject","nodeIndex","LocalizeStringList","csco","needresize","resized","nodestyle","newval","fudgefactorX","fudgefactorY","marginBottom","marginRight","SetTab","newtab","tname","newtabnum","newview","menutabs","tools","needsresize","onresize","rele1","rele2","UpdateSortRangeProposal","LoadColumnChoosers","nrange","rparts","sele","oldindex","selectedIndex","Option","cl","clele","slist","slistele","rele","lele","SpreadsheetCmdTable","slists","min_col","max_col","min_row","max_row","visibility","SpreadsheetCmdLookup","SpreadsheetCmdSLookup","cut","paste","pasteformats","lock","unlock","delete","filldown","erase","borderon","borderoff","merge","unmerge","align-left","align-center","align-right","align-default","insertrow","insertcol","deleterow","deletecol","hiderow","hidecol","redo","eobj","cellHTML","fcl","idp","GetFunctionNamesStr","GetFunctionInfoStr","vp","FillFunctionNames","scsc","FunctionClassChosen","FunctionChosen","HideFunctions","DoFunctionPaste","mele","HideMultiline","DoMultilineClear","DoMultilinePaste","setformat","HideLink","DoLinkClear","DoLinkPaste","ltsym","gtsym","obsym","cbsym","descele","urlele","pagenameele","workspaceele","formatele","foundvalue","searchstatus","search_cells","cellvalue","SearchSheet","selected_cell","new_cell","textContent","n_options","SpreadsheetControlCommentMoveECell","SpreadsheetControlCommentDisplay","SpreadsheetControlCommentSet","SpreadsheetControlNamesRangeChange","SpreadsheetControlNamesFillNameList","SpreadsheetControlNamesChangedName","currentname","SpreadsheetControlNamesSetValue","SpreadsheetControlNamesSave","SpreadsheetControlNamesDelete","clipele","SpreadsheetControlClipboardFormat","SpreadsheetControlClipboardLoad","savetype","SpreadsheetControlClipboardClear","SpreadsheetControlClipboardExport","sheettable","celltable","sheettoolbar","celltoolbar","SettingsControlSetCurrentPanel","SettingsControlSave","sc","panelobj","CurrentPanel","SettingsControlUnloadPanel","partname","extranl","otherpartsstr","otherpartsnames","mpregex","searchinfo","boundary","boundaryregex","blanklineregex","ending","partlist","exec","pnum","end","PopupChangeCallback","ctrlname","ctrl","str1","str2","cv","fontFamily","paddingRight","paddingLeft","borderTop","borderBottom","borderLeft","BorderSideGetValue","textAlign","fontStyle","fontWeight","PopupListSetValue","PopupListGetValue","ctl","PopupListInitialize","otext","InitialData","optionvals","PopupListReset","PopupList","OnReset","ChangedCallback","ColorChooserSetValue","ColorChooserGetValue","ColorChooserInitialize","ColorChooserReset","BorderSideSetValue","idname","idstart","BorderSideInitialize","SettingsControlOnchangeBorder","nameparts","ctrlidsuffix","ctrltype","BorderSide","OnClick","ColorComboOnClick","thickness","OtherSaveParts","whichpart","strtoedit","editbox","ebta","CtrlSEditorDone","idprefix","edittextarea","_view","SpreadsheetViewerStatuslineCallback","hasStatusLine","statuslineHTML","statuslineFull","noRecalc","repeatingMacroTimer","repeatingMacroInterval","repeatingMacroCommands","LoadSave","SpreadsheetViewerLoadSave","SpreadsheetViewerDecodeSpreadsheetSave","spreadsheetobj","rmstr","t2","startupmacro","repeatingmacro","SpreadsheetViewerDoRepeatingMacro","GetSpreadsheetViewerObject","repeatmacro","SpreadsheetViewerRepeatMacroCommand","SpreadsheetViewerStopRepeatingMacro","SpreadsheetViewerDoButtonCmd","csvo","slstr","SpreadsheetViewerCreateSheetHTML","hasreturnonly","Class","classDefinition","classWrapper","$1","baseClassName","$2","$3","incValues","strict","option","klass","global","init","isa","baseName","superFunc","addGlobal","newGlobals","extend","pairs","ii","ll","eval_strict","apply","last_key","globals","globals_after","proto","instantiate","output","content","insert","receiver","begin_node","tag","_wafl","onload","_label","imageName","_href","end_node","text_node","parse","grammar","create_grammar","parse_blocks","container_type","types","blocks","matched","find_match","handle_match","JSON","stringify","subparse","matched_func","re","capture","call","lookbehind","parse_phrases","phrases","begin","filtered_text","parser","matched_block","matched_phrase","$4","all_blocks","all_phrases","re_huggy","brace1","brace2","im_types","yahoo","ymsgr","callto","callme","skype","aim","im_label","im_re","key","re_list","bullet","filter_out","exclusion","_all_blocks","_all_phrases","ol","ul","blockquote","subl","li","li2","_html","pre","hr","hx","empty","else","waflparagraph","waflphrase","asis","wikilink","wikilink2","file","href","im","mail","tt","del","module","exports","Error","isWindow","isFunction","inArray","readyState","ready","getAttribute","parseJSON","isEmptyObject","acceptData","expando","cache","guid","toJSON","noop","camelCase","isArray","map","cleanData","deleteExpando","cb","db","activeElement","eb","fb","createDocumentFragment","vb","getElementsByTagName","querySelectorAll","nodeName","wb","defaultChecked","xb","ownerDocument","yb","find","zb","qb","removeAttribute","Ab","_data","Bb","hasData","events","handle","Cb","noCloneEvent","removeEvent","outerHTML","html5Clone","defaultSelected","defaultValue","Fb","appendTo","getDefaultComputedStyle","detach","Gb","Eb","Db","contentWindow","contentDocument","write","close","Mb","get","Vb","Ub","Wb","Xb","Qb","Yb","Zb","Jb","boxSizing","Kb","Ib","boxSizingReliable","parseFloat","$b","gc","_b","now","hc","opacity","ic","fc","jc","_queueHooks","unqueued","fire","always","overflowX","overflowY","inlineBlockNeedsLayout","zoom","shrinkWrapBlocks","bc","hidden","done","_removeData","kc","cssHooks","expand","lc","ec","Deferred","elem","startTime","duration","tweens","run","notifyWith","resolveWith","promise","props","opts","specialEasing","originalProperties","originalOptions","createTween","Tween","easing","stop","rejectWith","fx","anim","complete","fail","Mc","Nc","dataTypes","Jc","Oc","ajaxSettings","flatOptions","Pc","contents","mimeType","getResponseHeader","converters","Qc","responseFields","dataFilter","dataType","Wc","Sc","$c","XMLHttpRequest","_c","ActiveXObject","ed","parentWindow","hasOwnProperty","fn","jquery","constructor","selector","toArray","pushStack","prevObject","eq","isPlainObject","random","isReady","isNumeric","ownLast","globalEval","execScript","makeArray","Object","proxy","support","getElementsByClassName","qsa","ob","setAttribute","pb","mb","cacheLength","gb","hb","attrHandle","ib","sourceIndex","nextSibling","jb","kb","lb","nb","preFilter","dir","rb","sb","ub","relative","TAG","uniqueSort","getById","ID","ab","needsContext","CLASS","ATTR","PSEUDO","CHILD","bool","isXML","setDocument","attributes","createComment","getElementsByName","getAttributeNode","matchesSelector","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","msMatchesSelector","disconnectedMatch","compareDocumentPosition","contains","sortDetached","specified","detectDuplicates","sortStable","getText","nodeValue","selectors","createPseudo","~","pseudos","setFilters","not","has","innerText","lang","location","hash","root","hasFocus","tabIndex","enabled","header","even","odd","lt","gt","nth","radio","checkbox","password","submit","reset","filters","compile","expr","unique","isXMLDoc","is","parseHTML","children","prev","sibling","closest","prevAll","addBack","parents","parentsUntil","nextAll","nextUntil","prevUntil","siblings","once","memory","stopOnFalse","disable","remove","locked","fireWith","fired","then","resolve","reject","notify","pipe","when","readyWait","holdReady","trigger","off","frameElement","doScroll","noData","applet ","embed ","object ","removeData","dequeue","clearQueue","access","leadingWhitespace","htmlSerialize","cloneNode","appendChecked","noCloneChecked","checkClone","click","focusin","handler","triggered","dispatch","special","delegateType","bindType","origType","namespace","delegateCount","setup","teardown","Event","isTrigger","namespace_re","noBubble","isPropagationStopped","isDefaultPrevented","_default","fix","delegateTarget","preDispatch","handlers","currentTarget","isImmediatePropagationStopped","handleObj","postDispatch","fixHooks","mouseHooks","keyHooks","fromElement","pageX","clientLeft","pageY","clientTop","relatedTarget","toElement","beforeunload","originalEvent","simulate","isSimulated","defaultPrevented","getPreventDefault","timeStamp","stopImmediatePropagation","mouseenter","mouseleave","submitBubbles","form","_submit_bubble","changeBubbles","propertyName","_just_changed","focusinBubbles","one","triggerHandler","legend","area","param","thead","optgroup","tfoot","colgroup","caption","clone","buildFragment","createTextNode","domManip","prepend","before","after","replaceWith","_evalUrl","prependTo","insertAfter","replaceAll","cssFloat","backgroundClip","clearCloneStyle","Hb","Lb","getPropertyValue","minWidth","maxWidth","runtimeStyle","pixelLeft","swap","reliableHiddenOffsets","pixelPosition","reliableMarginRight","Nb","Ob","Pb","Rb","Sb","Tb","letterSpacing","cssNumber","columnCount","fillOpacity","lineHeight","orphans","widows","cssProps","float","set","margin","toggle","prop","cur","unit","propHooks","step","linear","swing","ac","cc","dc","Animation","tweener","prefilter","speed","speeds","old","fadeTo","animate","finish","timers","slideDown","slideUp","slideToggle","fadeIn","fadeOut","fadeToggle","tick","slow","fast","delay","getSetAttribute","hrefNormalized","checkOn","optSelected","enctype","optDisabled","radioValue","mc","valHooks","scrollHeight","nc","oc","pc","qc","rc","removeAttr","attrHooks","propFix","setAttributeNode","createAttribute","coords","contenteditable","tc","uc","removeProp","for","class","vc","addClass","removeClass","toggleClass","hasClass","hover","bind","unbind","delegate","undelegate","wc","xc","yc","Function","parseXML","DOMParser","parseFromString","async","loadXML","zc","Ac","Bc","Cc","Dc","Ec","Fc","Gc","Hc","Ic","Kc","Lc","active","lastModified","etag","isLocal","processData","contentType","accepts","xml","json","* text","text html","text json","text xml","ajaxSetup","ajaxPrefilter","ajaxTransport","ajax","ifModified","statusText","statusCode","getAllResponseHeaders","setRequestHeader","overrideMimeType","abort","success","crossDomain","traditional","hasContent","headers","beforeSend","send","getJSON","getScript","throws","wrapAll","wrapInner","wrap","unwrap","visible","Rc","Tc","Uc","Vc","encodeURIComponent","serialize","serializeArray","xhr","Xc","Yc","Zc","cors","open","username","xhrFields","onreadystatechange","responseText","script","text script","head","scriptCharset","charset","ad","bd","jsonp","jsonpCallback","cd","animated","dd","setOffset","using","scrollTo","Height","Width","","andSelf","define","amd","fd","jQuery","gd","noConflict","animation","WebkitAnimation","MozAnimation","MsAnimation","OAnimation","closeByEscape","globalID","animationEndEvent","baseClassNames","vex","overlay","closing","defaultOptions","showCloseButton","escapeButtonCloses","overlayClosesOnClick","appendLocation","overlayClassName","overlayCSS","contentClassName","contentCSS","closeClassName","closeCSS","$vex","$vexOverlay","$vexContent","$closeButton","setupBodyClassName","afterOpen","getAllVexes","getVexByID","closeByID","closeAll","beforeClose","afterClose","hideLoading","showLoading","require","buttons","YES","NO","message","onSubmit","getFormValueOnSubmit","focusFirstInput","defaultAlertOptions","defaultConfirmOptions","buildDialogForm","confirm","placeholder","buttonsToDOM","dialog"],"mappings":"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","sourcesContent":["//\r\n/*\r\n// The module of the SocialCalc package with customizable constants, strings, etc.\r\n// This is where most of the common localizations are done.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n\r\nvar SocialCalc;\r\nif (!SocialCalc) SocialCalc = {};\r\n\r\n// *************************************\r\n//\r\n// TO LEARN HOW TO LOCALIZE OR CUSTOMIZE SOCIALCALC, PLEASE READ THIS:\r\n//\r\n// The constants are all properties of the SocialCalc.Constants object.\r\n// They are grouped here by what they are for, which module uses them, etc.\r\n//\r\n// Properties whose names start with \"s_\" are strings, or arrays of strings,\r\n// that are good candidates for translation from the English.\r\n//\r\n// Other properties relate to visual settings, localization parameters, etc.\r\n//\r\n// These values are not used when SocialCalc modules are first loaded.\r\n// They may be modified before the first use of the routines that use them,\r\n// e.g., before creating SocialCalc objects.\r\n//\r\n// The exceptions are:\r\n//    TooltipOffsetX and TooltipOffsetY, as described with their definitions.\r\n//\r\n// SocialCalc IS NOT DESIGNED FOR USE WITH A TRANSLATION FUNCTION each time a string\r\n// is used. Instead, language translations may be done by modifying this object.\r\n//\r\n// To customize SocialCalc, you may either replace this file with a modified version\r\n// or you can overwrite the values before use. An example would be to\r\n// iterate over all the properties looking for names that start with \"s_\" and\r\n// use some other mechanism to obtain a localized string and replace the values\r\n// here with those translated values.\r\n//\r\n// There is also a function, SocialCalc.ConstantsSetClasses, that may be used\r\n// to easily switch SocialCalc from using explicit CSS styles for many things\r\n// to using CSS classes. See the function, below, for more information.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.Constants = {\r\n\r\n//\r\n// Main SocialCalc module, socialcalc-3.js:\r\n//\r\n\r\n// eddy cellDataType {\r\n//    datatype: if present, v=numeric value, t=text value, f=formula,\r\n//              or c=constant that is not a simple number (like \"$1.20\")\r\n   cellDataType: { \r\n\tv:\"value\",\r\n\tn:\"value\",\r\n\tt:\"text\",\r\n\tf:\"formula\",\r\n\tc:\"constant\"\t\r\n   },\r\n// }   \r\n   \r\n   //*** Common Constants\r\n\r\n   textdatadefaulttype: \"t\", // This sets the default type for text on reading source file\r\n                             // It should normally be \"t\"\r\n\r\n   //*** Common error messages\r\n\r\n   s_BrowserNotSupported: \"Browser not supported.\", // error thrown if browser can't handle events like IE or Firefox.\r\n   s_InternalError: \"Internal SocialCalc error (probably an internal bug): \", // hopefully unlikely, but a test failed\r\n\r\n   //*** SocialCalc.ParseSheetSave\r\n\r\n   // Errors thrown on unexpected value in save file:\r\n\r\n   s_pssUnknownColType: \"Unknown col type item\",\r\n   s_pssUnknownRowType: \"Unknown row type item\",\r\n   s_pssUnknownLineType: \"Unknown line type\",\r\n\r\n   //*** SocialCalc.CellFromStringParts\r\n\r\n   // Error thrown on unexpected value in save file:\r\n\r\n   s_cfspUnknownCellType: \"Unknown cell type item\",\r\n\r\n   //*** SocialCalc.CanonicalizeSheet\r\n\r\n   doCanonicalizeSheet: true, // if true, do the canonicalization calculations\r\n\r\n   //*** ExecuteSheetCommand\r\n\r\n   s_escUnknownSheetCmd: \"Unknown sheet command: \",\r\n   s_escUnknownSetCoordCmd: \"Unknown set coord command: \",\r\n   s_escUnknownCmd: \"Unknown command: \",\r\n\r\n   //*** SocialCalc.CheckAndCalcCell\r\n\r\n   s_caccCircRef: \"Circular reference to \", // circular reference found during recalc\r\n\r\n   //*** SocialCalc.RenderContext\r\n\r\n   defaultRowNameWidth: \"30\", // used to set minimum width of the row header column - a string in pixels\r\n   defaultAssumedRowHeight: 15, // used when guessing row heights - number\r\n   defaultCellIDPrefix: \"cell_\", // if non-null, each cell will render with an ID starting with this\r\n\r\n   // Default sheet display values\r\n\r\n   defaultCellLayout: \"padding:2px 2px 1px 2px;vertical-align:top;\",\r\n   defaultCellFontStyle: \"normal normal\",\r\n   defaultCellFontSize: \"small\",\r\n   defaultCellFontFamily: \"Verdana,Arial,Helvetica,sans-serif\",\r\n\r\n   defaultPaneDividerWidth: \"3\", // a string\r\n   defaultPaneDividerHeight: \"3\", // a string\r\n\r\n   defaultGridCSS: \"1px solid #C0C0C0;\", // used as style to set each border when grid enabled (was #ECECEC)\r\n\r\n   defaultCommentClass: \"\", // class added to cells with non-null comments when grid enabled\r\n   defaultCommentStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-commentbg.gif);\", // style added to cells with non-null comments when grid enabled\r\n   defaultCommentNoGridClass: \"\", // class added to cells with non-null comments when grid not enabled\r\n   defaultCommentNoGridStyle: \"\", // style added to cells with non-null comments when grid not enabled\r\n\r\n   defaultReadonlyClass: \"\", // class added to readonly cells when grid enabled\r\n   defaultReadonlyStyle: \"background-repeat:no-repeat;background-position:top right;background-image:url(images/sc-lockbg.gif);\", // style added to readonly cells when grid enabled\r\n   defaultReadonlyNoGridClass: \"\", // class added to readonly cells when grid not enabled\r\n   defaultReadonlyNoGridStyle: \"\", // style added to readonly cells when grid not enabled\r\n   defaultReadonlyComment: \"Locked cell\",\r\n\r\n   defaultColWidth: \"80\", // text\r\n   defaultMinimumColWidth: 10, // numeric\r\n\r\n   // For each of the following default sheet display values at least one of class and/or style are needed\r\n\r\n   defaultHighlightTypeCursorClass: \"\",\r\n   defaultHighlightTypeCursorStyle: \"color:#FFF;backgroundColor:#A6A6A6;\",\r\n   defaultHighlightTypeRangeClass: \"\",\r\n   defaultHighlightTypeRangeStyle: \"color:#000;backgroundColor:#E5E5E5;\",\r\n\r\n   defaultColnameClass: \"\", // regular column heading letters, needs a cursor property \r\n   defaultColnameStyle: \"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#808080;\",\r\n   defaultSelectedColnameClass: \"\", // column with selected cell, needs a cursor property \r\n   defaultSelectedColnameStyle: \"overflow:visible;font-size:small;text-align:center;color:#FFFFFF;background-color:#404040;\",\r\n   defaultRownameClass: \"\", // regular row heading numbers\r\n   defaultRownameStyle: \"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#808080;\",\r\n   defaultSelectedRownameClass: \"\", // column with selected cell, needs a cursor property \r\n   defaultSelectedRownameStyle: \"position:relative;overflow:visible;font-size:small;text-align:right;color:#FFFFFF;background-color:#404040;\",\r\n   defaultUpperLeftClass: \"\", // Corner cell in upper left\r\n   defaultUpperLeftStyle: \"font-size:small;\",\r\n   defaultSkippedCellClass: \"\", // used if present for spanned cells peeking into a pane (at least one of class/style needed)\r\n   defaultSkippedCellStyle: \"font-size:small;background-color:#CCC\", // used if present\r\n   defaultPaneDividerClass: \"\", // used if present for the look of the space between panes (at least one of class/style needed)\r\n   defaultPaneDividerStyle: \"font-size:small;background-color:#C0C0C0;padding:0px;\", // used if present\r\n   defaultUnhideLeftClass: \"\",\r\n   defaultUnhideLeftStyle: \"float:right;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideleft.gif);padding:0;\", // used if present\r\n   defaultUnhideRightClass: \"\",\r\n   defaultUnhideRightStyle: \"float:left;width:9px;height:12px;cursor:pointer;background-image:url(images/sc-unhideright.gif);padding:0;\", // used if present\r\n   defaultUnhideTopClass: \"\",\r\n   defaultUnhideTopStyle: \"float:left;left:1px;position:absolute;bottom:-4px;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidetop.gif);padding:0;\",\r\n   defaultUnhideBottomClass: \"\",\r\n   defaultUnhideBottomStyle: \"float:left;width:12px;height:9px;cursor:pointer;background-image:url(images/sc-unhidebottom.gif);padding:0;\",\r\n\r\n   defaultColResizeBarClass: \"col-resize-bar\",\r\n   defaultRowResizeBarClass: \"row-resize-bar\",\r\n\r\n   s_rcMissingSheet: \"Render Context must have a sheet object\", // unlikely thrown error\r\n\r\n   //*** SocialCalc.format_text_for_display\r\n\r\n   defaultLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Link</span>', // used for format \"text-link\"; you could make this an img tag if desired\r\n//   defaultLinkFormatString: '<img src=\"images/sc-linkout.gif\" border=\"0\" alt=\"Link out\" title=\"Link out\">',\r\n   defaultPageLinkFormatString: '<span style=\"font-size:smaller;text-decoration:none !important;background-color:#66B;color:#FFF;\">Page</span>', // used for format \"text-link\"; you could make this an img tag if desired\r\n\r\n   //*** SocialCalc.format_number_for_display\r\n\r\n   defaultFormatp: '#,##0.0%',\r\n   defaultFormatc: '[$$]#,##0.00',\r\n   defaultFormatdt: 'd-mmm-yyyy h:mm:ss',\r\n   defaultFormatd: 'd-mmm-yyyy',\r\n   defaultFormatt: '[h]:mm:ss',\r\n   defaultDisplayTRUE: 'TRUE', // how TRUE shows when rendered\r\n   defaultDisplayFALSE: 'FALSE',\r\n\r\n//\r\n// SocialCalc Table Editor module, socialcalctableeditor.js:\r\n//\r\n\r\n   //*** SocialCalc.TableEditor\r\n\r\n   defaultImagePrefix: \"images/sc_\", // URL prefix for images (e.g., \"/images/sc\")\r\n   defaultTableEditorIDPrefix: \"te_\", // if present, many TableEditor elements are assigned IDs with this prefix\r\n   defaultPageUpDnAmount: 15, // number of rows to move cursor on PgUp/PgDn keys (numeric)\r\n\r\n   AllowCtrlS: true, // turns on Ctrl-S trapdoor for setting custom numeric formats and commands if true\r\n\r\n   //*** SocialCalc.CreateTableEditor\r\n\r\n   defaultTableControlThickness: 20, // the short size for the scrollbars, etc. (numeric in pixels)\r\n   cteGriddivClass: \"\", // if present, the class for the TableEditor griddiv element\r\n\r\n   //** SocialCalc.EditorGetStatuslineString -- strings shown on status line\r\n\r\n   s_statusline_executing: \"Executing...\",\r\n   s_statusline_displaying: \"Displaying...\",\r\n   s_statusline_ordering: \"Ordering...\",\r\n   s_statusline_calculating: \"Calculating...\",\r\n   s_statusline_calculatingls: \"Calculating... Loading Sheet...\",\r\n   s_statusline_doingserverfunc: \"doing server function \",\r\n   s_statusline_incell: \" in cell \",\r\n   s_statusline_calcstart: \"Calculation start...\",\r\n   s_statusline_sum: \"SUM\",\r\n   s_statusline_recalcneeded: '<span style=\"color:#999;\">(Recalc needed)</span>',\r\n   s_statusline_circref: '<span style=\"color:red;\">Circular reference: ',\r\n   s_statusline_sendemail: \"Sending Email \",  // eddy\r\n   //** SocialCalc.InputBoxDisplayCellContents\r\n\r\n   s_inputboxdisplaymultilinetext: \"[Multi-line text: Click icon on right to edit]\",\r\n\r\n   //** SocialCalc.InputEcho\r\n\r\n   defaultInputEchoClass: \"\", // if present, the class of the popup inputEcho div\r\n   defaultInputEchoStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;border:1px solid #884;\"+\r\n      \"fontSize:small;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\r\n   defaultInputEchoPromptClass: \"\", // if present, the class of the popup inputEcho div\r\n   defaultInputEchoPromptStyle: \"filter:alpha(opacity=90);opacity:.9;backgroundColor:#FFD;\"+\r\n      \"borderLeft:1px solid #884;borderRight:1px solid #884;borderBottom:1px solid #884;\"+\r\n      \"fontSize:small;fontStyle:italic;padding:2px 10px 1px 2px;cursor:default;\", // if present, pseudo style\r\n   defaultInputEchoHintClass: \"\", // if present, the class of the popup inputEcho div\r\n   defaultInputEchoHintStyle: \"filter:alpha(opacity=80);opacity:.8;backgroundColor:#884;border:1px solid #884;\"+\r\n      \"fontSize:small;fontWeight:bold;padding:2px 2px 2px 2px;color:#FFF;position:absolute;top:-20px;cursor:default;\", // if present, pseudo style\r\n\r\n   //** SocialCalc.InputEchoText\r\n\r\n   ietUnknownFunction: \"Unknown function \", // displayed when typing \"=unknown(\"\r\n\r\n   //** SocialCalc.CellHandles\r\n\r\n   CH_radius1: 29.0, // extent of inner circle within 90px image\r\n   CH_radius2: 41.0, // extent of outer circle within 90px image\r\n   s_CHfillAllTooltip: \"Fill Contents and Formats Down/Right\", // tooltip for fill all handle\r\n   s_CHfillContentsTooltip: \"Fill Contents Only Down/Right\", // tooltip for fill formulas handle\r\n   s_CHmovePasteAllTooltip: \"Move Contents and Formats\", // etc.\r\n   s_CHmovePasteContentsTooltip: \"Move Contents Only\",\r\n   s_CHmoveInsertAllTooltip: \"Slide Contents and Formats within Row/Col\",\r\n   s_CHmoveInsertContentsTooltip: \"Slide Contents within Row/Col\",\r\n   s_CHindicatorOperationLookup: {\"Fill\": \"Fill\", \"FillC\": \"Fill Contents\",\r\n                                  \"Move\": \"Move\", \"MoveI\": \"Slide\", \r\n                                  \"MoveC\": \"Move Contents\", \"MoveIC\": \"Slide Contents\"}, // short form of operation to follow drag\r\n   s_CHindicatorDirectionLookup: {\"Down\": \" Down\", \"Right\": \" Right\",\r\n                                  \"Horizontal\": \" Horizontal\", \"Vertical\": \" Vertical\"}, // direction that modifies operation during drag\r\n\r\n   //*** SocialCalc.TableControl\r\n\r\n   defaultTCSliderThickness: 9, // length of pane slider (numeric in pixels)\r\n   defaultTCButtonThickness: 20, // length of scroll +/- buttons (numeric in pixels)\r\n   defaultTCThumbThickness: 15, // length of thumb (numeric in pixels)\r\n\r\n   //*** SocialCalc.CreateTableControl\r\n\r\n   TCmainStyle: \"backgroundColor:#EEE;\", // if present, pseudo style (text-align is textAlign) for main div of a table control\r\n   TCmainClass: \"\", // if present, the CSS class of the main div for a table control\r\n   TCendcapStyle: \"backgroundColor:#FFF;\", // backgroundColor may be used while waiting for image that may not come\r\n   TCendcapClass: \"\",\r\n   TCpanesliderClass: \"tc-paneslider\",\r\n   s_panesliderTooltiph: \"Drag to lock pane vertically\", // tooltip for horizontal table control pane slider\r\n   s_panesliderTooltipv: \"Drag to lock pane horizontally\",\r\n   TClessbuttonStyle: \"backgroundColor:#AAA;\",\r\n   TClessbuttonClass: \"\",\r\n   TClessbuttonRepeatWait: 300, // in milliseconds\r\n   TClessbuttonRepeatInterval: 20,//100, // in milliseconds\r\n   TCmorebuttonStyle: \"backgroundColor:#AAA;\",\r\n   TCmorebuttonClass: \"\",\r\n   TCmorebuttonRepeatWait: 300, // in milliseconds\r\n   TCmorebuttonRepeatInterval: 20,//100, // in milliseconds\r\n   TCscrollareaStyle: \"backgroundColor:#DDD;\",\r\n   TCscrollareaClass: \"\",\r\n   TCscrollareaRepeatWait: 500, // in milliseconds\r\n   TCscrollareaRepeatInterval: 100, // in milliseconds\r\n   TCthumbClass: \"\",\r\n   TCthumbStyle: \"backgroundColor:#CCC;\",\r\n\r\n   //*** SocialCalc.TCPSDragFunctionStart\r\n\r\n   TCPStrackinglineClass: \"tracklingine\", // at least one of class/style for pane slider tracking line display in table control\r\n   TCPStrackinglineStyle: \"overflow:hidden;position:absolute;zIndex:100;\",\r\n                           // if present, pseudo style (text-align is textAlign)\r\n   TCPStrackinglineThickness: \"2px\", // narrow dimension of trackling line (string with units)\r\n\r\n\r\n   //*** SocialCalc.TCTDragFunctionStart\r\n\r\n   TCTDFSthumbstatusvClass: \"\", // at least one of class/style for vertical thumb dragging status display in table control\r\n   TCTDFSthumbstatusvStyle: \"height:20px;width:auto;border:3px solid #808080;overflow:hidden;\"+\r\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\r\n                           // if present, pseudo style (text-align is textAlign)\r\n   TCTDFSthumbstatushClass: \"\", // at least one of class/style for horizontal thumb dragging status display in table control\r\n   TCTDFSthumbstatushStyle: \"height:20px;width:auto;border:1px solid black;padding:2px;\"+\r\n                           \"backgroundColor:#FFF;fontSize:small;position:absolute;zIndex:100;\",\r\n                           // if present, pseudo style (text-align is textAlign)\r\n   TCTDFSthumbstatusrownumClass: \"\", // at least one of class/style for thumb dragging status display in table control\r\n   TCTDFSthumbstatusrownumStyle: \"color:#FFF;background-color:#808080;font-size:small;white-space:nowrap;padding:3px;\", // if present, real style\r\n   TCTDFStopOffsetv: 0, // offsets for thumbstatus display while dragging\r\n   TCTDFSleftOffsetv: -80,\r\n   s_TCTDFthumbstatusPrefixv: \"Row \", // Text Control Drag Function text before row number\r\n   TCTDFStopOffseth: -30,\r\n   TCTDFSleftOffseth: 0,\r\n   s_TCTDFthumbstatusPrefixh: \"Col \", // Text Control Drag Function text before col number\r\n\r\n   //*** SocialCalc.TooltipInfo\r\n\r\n   // Note: These two values are used to set the TooltipInfo initial values when the code is first read in.\r\n   // Modifying them here after loading has no effect -- you need to modify SocialCalc.TooltipInfo directly\r\n   // to dynamically set them. This is different than most other constants which may be modified until use.\r\n\r\n   TooltipOffsetX: 2, // offset in pixels from mouse position (to right on left side of screen, to left on right)\r\n   TooltipOffsetY: 10, // offset in pixels above mouse position for lower edge\r\n\r\n   //*** SocialCalc.TooltipDisplay\r\n\r\n   TDpopupElementClass: \"\", // at least one of class/style for tooltip display\r\n   TDpopupElementStyle: \"border:1px solid black;padding:1px 2px 2px 2px;textAlign:center;backgroundColor:#FFF;\"+\r\n                        \"fontSize:7pt;fontFamily:Verdana,Arial,Helvetica,sans-serif;\"+\r\n                        \"position:absolute;width:auto;zIndex:110;\",\r\n                        // if present, pseudo style (text-align is textAlign)\r\n\r\n\r\n//\r\n// SocialCalc Spreadsheet Control module, socialcalcspreadsheetcontrol.js:\r\n//\r\n\r\n   //*** SocialCalc.SpreadsheetControl\r\n\r\n   SCToolbarbackground: \"background-color:#404040;\",\r\n   SCTabbackground: \"background-color:#CCC;\",\r\n   SCTabselectedCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#404040;cursor:default;border-right:1px solid #CCC;\",\r\n   SCTabplainCSS: \"font-size:small;padding:6px 30px 6px 8px;color:#FFF;background-color:#808080;cursor:default;border-right:1px solid #CCC;\",\r\n   SCToolbartext: \"font-size:x-small;font-weight:bold;color:#FFF\",\r\n\r\n   SCFormulabarheight: 30, // in pixels, will contain a text input box\r\n\r\n   SCStatuslineheight: 20, // in pixels\r\n   SCStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\r\n\r\n   // Constants for default Format tab (settings)\r\n   //\r\n   // *** EVEN THOUGH THESE DON'T START WITH s_: ***\r\n   //\r\n   // These should be carefully checked for localization. Make sure you understand what they do and how they work!\r\n   // The first part of \"first:second|first:second|...\" is what is displayed and the second is the value to be used.\r\n   // The value is normally not translated -- only the displayed part. The [cancel], [break], etc., are not translated --\r\n   // they are commands to SocialCalc.SettingsControls.PopupListInitialize \r\n\r\n   SCFormatNumberFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Auto w/ commas!:[,]General|[break]:|\"+\r\n            \"00:00|000:000|0000:0000|00000:00000|[break]:|%loc!Formula!:formula|%loc!Hidden!:hidden|[newcol]:\"+\r\n            \"1234:0|1,234:#,##0|1,234.5:#,##0.0|1,234.56:#,##0.00|1,234.567:#,##0.000|1,234.5678:#,##0.0000|\"+\r\n            \"[break]:|1,234%:#,##0%|1,234.5%:#,##0.0%|1,234.56%:#,##0.00%|\"+\r\n            \"[newcol]:|$1,234:$#,##0|$1,234.5:$#,##0.0|$1,234.56:$#,##0.00|[break]:|\"+\r\n            \"(1,234):#,##0_);(#,##0)|(1,234.5):#,##0.0_);(#,##0.0)|(1,234.56):#,##0.00_);(#,##0.00)|[break]:|\"+\r\n            \"($1,234):$#,##0_);($#,##0)|($1,234.5):$#,##0.0_);($#,##0.0)|($1,234.56):$#,##0.00_);($#,##0.00)|\"+\r\n            \"[newcol]:|1/4/06:m/d/yy|01/04/2006:mm/dd/yyyy|2006-01-04:yyyy-mm-dd|4-Jan-06:d-mmm-yy|04-Jan-2006:dd-mmm-yyyy|January 4, 2006:mmmm d, yyyy|\"+\r\n            \"[break]:|1\\\\c23:h:mm|1\\\\c23 PM:h:mm AM/PM|1\\\\c23\\\\c45:h:mm:ss|01\\\\c23\\\\c45:hh:mm:ss|26\\\\c23 (h\\\\cm):[hh]:mm|69\\\\c45 (m\\\\cs):[mm]:ss|69 (s):[ss]|\"+\r\n            \"[newcol]:|2006-01-04 01\\\\c23\\\\c45:yyyy-mm-dd hh:mm:ss|January 4, 2006:mmmm d, yyyy hh:mm:ss|Wed:ddd|Wednesday:dddd|\",\r\n   SCFormatTextFormats: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!Automatic!:general|%loc!Plain Text!:text-plain|\"+\r\n            \"HTML:text-html|%loc!Wikitext!:text-wiki|%loc!Link!:text-link|%loc!Formula!:formula|%loc!Hidden!:hidden|\",\r\n   SCFormatPadsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|%loc!No padding!:0px|\"+\r\n            \"[newcol]:|1 pixel:1px|2 pixels:2px|3 pixels:3px|4 pixels:4px|5 pixels:5px|\"+\r\n            \"6 pixels:6px|7 pixels:7px|8 pixels:8px|[newcol]:|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\r\n            \"12 pixels:12px|13 pixels:13px|14 pixels:14px|16 pixels:16px|\"+\r\n            \"18 pixels:18px|[newcol]:|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\r\n   SCFormatFontsizes: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|X-Small:x-small|Small:small|Medium:medium|Large:large|X-Large:x-large|\"+\r\n                  \"[newcol]:|6pt:6pt|7pt:7pt|8pt:8pt|9pt:9pt|10pt:10pt|11pt:11pt|12pt:12pt|14pt:14pt|16pt:16pt|\"+\r\n                  \"[newcol]:|18pt:18pt|20pt:20pt|22pt:22pt|24pt:24pt|28pt:28pt|36pt:36pt|48pt:48pt|72pt:72pt|\"+\r\n                  \"[newcol]:|8 pixels:8px|9 pixels:9px|10 pixels:10px|11 pixels:11px|\"+\r\n                  \"12 pixels:12px|13 pixels:13px|14 pixels:14px|[newcol]:|16 pixels:16px|\"+\r\n                  \"18 pixels:18px|20 pixels:20px|22 pixels:22px|24 pixels:24px|28 pixels:28px|36 pixels:36px|\",\r\n   SCFormatFontfamilies: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|Verdana:Verdana,Arial,Helvetica,sans-serif|\"+\r\n                  \"Arial:arial,helvetica,sans-serif|Courier:'Courier New',Courier,monospace|\",\r\n   SCFormatFontlook: \"[cancel]:|[break]:|%loc!Default!:|%loc!Normal!:normal normal|%loc!Bold!:normal bold|%loc!Italic!:italic normal|\"+\r\n                  \"%loc!Bold Italic!:italic bold\",\r\n   SCFormatTextAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\r\n   SCFormatNumberAlignhoriz:  \"[cancel]:|[break]:|%loc!Default!:|%loc!Left!:left|%loc!Center!:center|%loc!Right!:right|\",\r\n   SCFormatAlignVertical: \"[cancel]:|[break]:|%loc!Default!:|%loc!Top!:top|%loc!Middle!:middle|%loc!Bottom!:bottom|\",\r\n   SCFormatColwidth: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\r\n                  \"20 pixels:20|40:40|60:60|80:80|100:100|120:120|140:140|160:160|\"+\r\n                  \"[newcol]:|180 pixels:180|200:200|220:220|240:240|260:260|280:280|300:300|\",\r\n   SCFormatRecalc: \"[cancel]:|[break]:|%loc!Auto!:|%loc!Manual!:off|\",\r\n   SCFormatUserMaxCol: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\r\n                  \"Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\",\r\n   SCFormatUserMaxRow: \"[cancel]:|[break]:|%loc!Default!:|[custom]:|[newcol]:|\"+\r\n                  \"Unlimited:0|10:10|20:20|30:30|40:40|50:50|60:60|80:80|100:100|\",\r\n\r\n   //*** SocialCalc.InitializeSpreadsheetControl\r\n\r\n   ISCButtonBorderNormal: \"#404040\",\r\n   ISCButtonBorderHover: \"#999\",\r\n   ISCButtonBorderDown: \"#FFF\",\r\n   ISCButtonDownBackground: \"#888\",\r\n\r\n   //*** SocialCalc.SettingsControls.PopupListInitialize\r\n\r\n   s_PopupListCancel: \"[Cancel]\",\r\n   s_PopupListCustom: \"Custom\",\r\n\r\n   // ***\r\n   //\r\n   // s_loc_ constants accessed by SocialCalc.LocalizeString and SocialCalc.LocalizeSubstrings\r\n   //\r\n   // Used extensively by socialcalcspreadsheetcontrol.js\r\n   //\r\n   // ***\r\n\r\n   s_loc_align_center: \"Align Center\",\r\n   s_loc_align_left: \"Align Left\",\r\n   s_loc_align_right: \"Align Right\",\r\n   s_loc_alignment: \"Alignment\",\r\n   s_loc_audit: \"Audit\",\r\n   s_loc_audit_trail_this_session: \"Audit Trail This Session\",\r\n   s_loc_auto: \"Auto\",\r\n   s_loc_auto_sum: \"Auto Sum\",\r\n   s_loc_auto_wX_commas: \"Auto w/ commas\",\r\n   s_loc_automatic: \"Automatic\",\r\n   s_loc_background: \"Background\",\r\n   s_loc_bold: \"Bold\",\r\n   s_loc_bold_XampX_italics: \"Bold &amp; Italics\",\r\n   s_loc_bold_italic: \"Bold Italic\",\r\n   s_loc_borders: \"Borders\",\r\n   s_loc_borders_off: \"Borders Off\",\r\n   s_loc_borders_on: \"Borders On\",\r\n   s_loc_bottom: \"Bottom\",\r\n   s_loc_bottom_border: \"Bottom Border\",\r\n   s_loc_cell_settings: \"CELL SETTINGS\",\r\n   s_loc_csv_format: \"CSV format\",\r\n   s_loc_cancel: \"Cancel\",\r\n   s_loc_category: \"Category\",\r\n   s_loc_center: \"Center\",\r\n   s_loc_clear: \"Clear\",\r\n   s_loc_clear_socialcalc_clipboard: \"Clear SocialCalc Clipboard\",\r\n   s_loc_clipboard: \"Clipboard\",\r\n   s_loc_color: \"Color\",\r\n   s_loc_column_: \"Column \",\r\n   s_loc_comment: \"Comment\",\r\n   s_loc_copy: \"Copy\",\r\n   s_loc_custom: \"Custom\",\r\n   s_loc_cut: \"Cut\",\r\n   s_loc_default: \"Default\",\r\n   s_loc_default_alignment: \"Default Alignment\",\r\n   s_loc_default_column_width: \"Default Column Width\",\r\n   s_loc_default_font: \"Default Font\",\r\n   s_loc_default_format: \"Default Format\",\r\n   s_loc_default_padding: \"Default Padding\",\r\n   s_loc_delete: \"Delete\",\r\n   s_loc_delete_column: \"Delete Column\",\r\n   s_loc_delete_contents: \"Delete Cell Contents\",\r\n   s_loc_delete_row: \"Delete Row\",\r\n   s_loc_description: \"Description\",\r\n   s_loc_display_clipboard_in: \"Display Clipboard in\",\r\n   s_loc_down: \"Down\",\r\n   s_loc_edit: \"Edit\",\r\n   s_loc_existing_names: \"Existing Names\",\r\n   s_loc_family: \"Family\",\r\n   s_loc_fill_down: \"Fill Down\",\r\n   s_loc_fill_right: \"Fill Right\",\r\n   s_loc_font: \"Font\",\r\n   s_loc_format: \"Format\",\r\n   s_loc_formula: \"Formula\",\r\n   s_loc_function_list: \"Function List\",\r\n   s_loc_functions: \"Functions\",\r\n   s_loc_grid: \"Grid\",\r\n   s_loc_hidden: \"Hidden\",\r\n   s_loc_hide_column: \"Hide Column\",\r\n   s_loc_hide_row: \"Hide Row\",\r\n   s_loc_horizontal: \"Horizontal\",\r\n   s_loc_insert_column: \"Insert Column Before\",\r\n   s_loc_insert_row: \"Insert Row Before\",\r\n   s_loc_italic: \"Italic\",\r\n   s_loc_last_sort: \"Last Sort\",\r\n   s_loc_left: \"Left\",\r\n   s_loc_left_border: \"Left Border\",\r\n   s_loc_link: \"Link\",\r\n   s_loc_link_input_box: \"Link Input Box\",\r\n   s_loc_list: \"List\",\r\n   s_loc_load_socialcalc_clipboard_with_this: \"Load SocialCalc Clipboard With This\",\r\n   s_loc_lock_cell: \"Lock Cell\",\r\n   s_loc_major_sort: \"Major Sort\",\r\n   s_loc_manual: \"Manual\",\r\n   s_loc_merge_cells: \"Merge/Unmerge Cells\",\r\n   s_loc_middle: \"Middle\",\r\n   s_loc_minor_sort: \"Minor Sort\",\r\n   s_loc_move_insert: \"Move Insert\",\r\n   s_loc_move_paste: \"Move Paste\",\r\n   s_loc_multiXline_input_box: \"Multi-line Input Box\",\r\n   s_loc_name: \"Name\",\r\n   s_loc_names: \"Names\",\r\n   s_loc_no_padding: \"No padding\",\r\n   s_loc_normal: \"Normal\",\r\n   s_loc_number: \"Number\",\r\n   s_loc_number_horizontal: \"Number Horizontal\",\r\n   s_loc_ok: \"OK\",\r\n   s_loc_padding: \"Padding\",\r\n   s_loc_page_name: \"Page Name\",\r\n   s_loc_paste: \"Paste\",\r\n   s_loc_paste_formats: \"Paste Formats\",\r\n   s_loc_plain_text: \"Plain Text\",\r\n   s_loc_recalc: \"Recalc\",\r\n   s_loc_recalculation: \"Recalculation\",\r\n   s_loc_redo: \"Redo\",\r\n   s_loc_right: \"Right\",\r\n   s_loc_right_border: \"Right Border\",\r\n   s_loc_sheet_settings: \"SHEET SETTINGS\",\r\n   s_loc_save: \"Save\",\r\n   s_loc_save_to: \"Save to\",\r\n   s_loc_set_cell_contents: \"Set Cell Contents\",\r\n   s_loc_set_cells_to_sort: \"Set Cells To Sort\",\r\n   s_loc_set_value_to: \"Set Value To\",\r\n   s_loc_set_to_link_format: \"Set to Link format\",\r\n   s_loc_setXclear_move_from: \"Set/Clear Move From\",\r\n   s_loc_show_cell_settings: \"Show Cell Settings\",\r\n   s_loc_show_sheet_settings: \"Show Sheet Settings\",\r\n   s_loc_show_in_new_browser_window: \"Show in new browser window\",\r\n   s_loc_size: \"Size\",\r\n   s_loc_socialcalcXsave_format: \"SocialCalc-save format\",\r\n   s_loc_sort: \"Sort\",\r\n   s_loc_sort_: \"Sort \",\r\n   s_loc_sort_cells: \"Sort Cells\",\r\n   s_loc_swap_colors: \"Swap Colors\",\r\n   s_loc_tabXdelimited_format: \"Tab-delimited format\",\r\n   s_loc_text: \"Text\",\r\n   s_loc_text_horizontal: \"Text Horizontal\",\r\n   s_loc_this_is_aXbrXsample: \"This is a<br>sample\",\r\n   s_loc_top: \"Top\",\r\n   s_loc_top_border: \"Top Border\",\r\n   s_loc_undone_steps: \"UNDONE STEPS\",\r\n   s_loc_url: \"URL\",\r\n   s_loc_undo: \"Undo\",\r\n   s_loc_unlock_cell: \"Unlock Cell\",\r\n   s_loc_unmerge_cells: \"Unmerge Cells\",\r\n   s_loc_up: \"Up\",\r\n   s_loc_value: \"Value\",\r\n   s_loc_vertical: \"Vertical\",\r\n   s_loc_wikitext: \"Wikitext\",\r\n   s_loc_workspace: \"Workspace\",\r\n   s_loc_XnewX: \"[New]\",\r\n   s_loc_XnoneX: \"[None]\",\r\n   s_loc_Xselect_rangeX: \"[select range]\",\r\n\r\n//\r\n// SocialCalc Spreadsheet Viewer module, socialcalcviewer.js:\r\n//\r\n\r\n   //*** SocialCalc.SpreadsheetViewer\r\n\r\n   SVStatuslineheight: 20, // in pixels\r\n   SVStatuslineCSS: \"font-size:10px;padding:3px 0px;\",\r\n\r\n//\r\n// SocialCalc Format Number module, formatnumber2.js:\r\n//\r\n\r\n   FormatNumber_separatorchar: \",\", // the thousands separator character when formatting numbers for display\r\n   FormatNumber_decimalchar: \".\", // the decimal separator character when formatting numbers for display\r\n   FormatNumber_defaultCurrency: \"$\", // the currency string used if none specified\r\n\r\n   // The following constants are arrays of strings with the short (3 character) and full names of days and months\r\n\r\n   s_FormatNumber_daynames: [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"],\r\n   s_FormatNumber_daynames3: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\r\n   s_FormatNumber_monthnames: [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\r\n                                      \"October\", \"November\", \"December\"],\r\n   s_FormatNumber_monthnames3: [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"],\r\n   s_FormatNumber_am: \"AM\",\r\n   s_FormatNumber_am1: \"A\",\r\n   s_FormatNumber_pm: \"PM\",\r\n   s_FormatNumber_pm1: \"P\",\r\n\r\n//\r\n// SocialCalc Spreadsheet Formula module, formula1.js:\r\n//\r\n\r\n   s_parseerrexponent: \"Improperly formed number exponent\",\r\n   s_parseerrchar: \"Unexpected character in formula\",\r\n   s_parseerrstring: \"Improperly formed string\",\r\n   s_parseerrspecialvalue: \"Improperly formed special value\",\r\n   s_parseerrtwoops: \"Error in formula (two operators inappropriately in a row)\",\r\n   s_parseerrmissingopenparen: \"Missing open parenthesis in list with comma(s). \",\r\n   s_parseerrcloseparennoopen: \"Closing parenthesis without open parenthesis. \",\r\n   s_parseerrmissingcloseparen: \"Missing close parenthesis. \",\r\n   s_parseerrmissingoperand: \"Missing operand. \",\r\n   s_parseerrerrorinformula: \"Error in formula.\",\r\n   s_calcerrerrorvalueinformula: \"Error value in formula\",\r\n   s_parseerrerrorinformulabadval: \"Error in formula resulting in bad value\",\r\n   s_formularangeresult: \"Formula results in range value:\",\r\n   s_calcerrnumericnan: \"Formula results in an bad numeric value\",\r\n   s_calcerrnumericoverflow: \"Numeric overflow\",\r\n   s_sheetunavailable: \"Sheet unavailable:\", // when FindSheetInCache returns null\r\n   s_calcerrcellrefmissing: \"Cell reference missing when expected.\",\r\n   s_calcerrsheetnamemissing: \"Sheet name missing when expected.\",\r\n   s_circularnameref: \"Circular name reference to name\",\r\n   s_calcerrunknownname: \"Unknown name\",\r\n   s_calcerrincorrectargstofunction: \"Incorrect arguments to function\",\r\n   s_sheetfuncunknownfunction: \"Unknown function\",\r\n   s_sheetfunclnarg: \"LN argument must be greater than 0\",\r\n   s_sheetfunclog10arg: \"LOG10 argument must be greater than 0\",\r\n   s_sheetfunclogsecondarg: \"LOG second argument must be numeric greater than 0\",\r\n   s_sheetfunclogfirstarg: \"LOG first argument must be greater than 0\",\r\n   s_sheetfuncroundsecondarg: \"ROUND second argument must be numeric\",\r\n   s_sheetfuncddblife: \"DDB life must be greater than 1\",\r\n   s_sheetfuncslnlife: \"SLN life must be greater than 1\",\r\n\r\n   // Function definition text\r\n\r\n   s_fdef_ABS: 'Absolute value function. ',\r\n   s_fdef_ACOS: 'Trigonometric arccosine function. ',\r\n   s_fdef_AND: 'True if all arguments are true. ',\r\n   s_fdef_ASIN: 'Trigonometric arcsine function. ',\r\n   s_fdef_ATAN: 'Trigonometric arctan function. ',\r\n   s_fdef_ATAN2: 'Trigonometric arc tangent function (result is in radians). ',\r\n   s_fdef_AVERAGE: 'Averages the values. ',\r\n   s_fdef_CHOOSE: 'Returns the value specified by the index. The values may be ranges of cells. ',\r\n   s_fdef_COLUMNS: 'Returns the number of columns in the range. ',\r\n   s_fdef_COS: 'Trigonometric cosine function (value is in radians). ',\r\n   s_fdef_COUNT: 'Counts the number of numeric values, not blank, text, or error. ',\r\n   s_fdef_COUNTA: 'Counts the number of non-blank values. ',\r\n   s_fdef_COUNTBLANK: 'Counts the number of blank values. (Note: \"\" is not blank.) ',\r\n   s_fdef_COUNTIF: 'Counts the number of number of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). ',\r\n   s_fdef_DATE: 'Returns the appropriate date value given numbers for year, month, and day. For example: DATE(2006,2,1) for February 1, 2006. Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\r\n   s_fdef_DAVERAGE: 'Averages the values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DAY: 'Returns the day of month for a date value. ',\r\n   s_fdef_DCOUNT: 'Counts the number of numeric values, not blank, text, or error, in the specified field in records that meet the criteria. ',\r\n   s_fdef_DCOUNTA: 'Counts the number of non-blank values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DDB: 'Returns the amount of depreciation at the given period of time (the default factor is 2 for double-declining balance).   ',\r\n   s_fdef_DEGREES: 'Converts value in radians into degrees. ',\r\n   s_fdef_DGET: 'Returns the value of the specified field in the single record that meets the criteria. ',\r\n   s_fdef_DMAX: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DMIN: 'Returns the maximum of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DPRODUCT: 'Returns the result of multiplying the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DSTDEV: 'Returns the sample standard deviation of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DSTDEVP: 'Returns the standard deviation of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DSUM: 'Returns the sum of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DVAR: 'Returns the sample variance of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_DVARP: 'Returns the variance of the numeric values in the specified field in records that meet the criteria. ',\r\n   s_fdef_EVEN: 'Rounds the value up in magnitude to the nearest even integer. ',\r\n   s_fdef_EXACT: 'Returns \"true\" if the values are exactly the same, including case, type, etc. ',\r\n   s_fdef_EXP: 'Returns e raised to the value power. ',\r\n   s_fdef_FACT: 'Returns factorial of the value. ',\r\n   s_fdef_FALSE: 'Returns the logical value \"false\". ',\r\n   s_fdef_FIND: 'Returns the starting position within string2 of the first occurrence of string1 at or after \"start\". If start is omitted, 1 is assumed. ',\r\n   s_fdef_FV: 'Returns the future value of repeated payments of money invested at the given rate for the specified number of periods, with optional present value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\r\n   s_fdef_HLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the row offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. ',\r\n   s_fdef_HOUR: 'Returns the hour portion of a time or date/time value. ',\r\n   s_fdef_IF: 'Results in true-value if logical-expression is TRUE or non-zero, otherwise results in false-value. ',\r\n   s_fdef_INDEX: 'Returns a cell or range reference for the specified row and column in the range. If range is 1-dimensional, then only one of rownum or colnum are needed. If range is 2-dimensional and rownum or colnum are zero, a reference to the range of just the specified column or row is returned. You can use the returned reference value in a range, e.g., sum(A1:INDEX(A2:A10,4)). ',\r\n   s_fdef_INT: 'Returns the value rounded down to the nearest integer (towards -infinity). ',\r\n   s_fdef_IRR: 'Returns the interest rate at which the cash flows in the range have a net present value of zero. Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\r\n   s_fdef_ISBLANK: 'Returns \"true\" if the value is a reference to a blank cell. ',\r\n   s_fdef_ISERR: 'Returns \"true\" if the value is of type \"Error\" but not \"NA\". ',\r\n   s_fdef_ISERROR: 'Returns \"true\" if the value is of type \"Error\". ',\r\n   s_fdef_ISLOGICAL: 'Returns \"true\" if the value is of type \"Logical\" (true/false). ',\r\n   s_fdef_ISNA: 'Returns \"true\" if the value is the error type \"NA\". ',\r\n   s_fdef_ISNONTEXT: 'Returns \"true\" if the value is not of type \"Text\". ',\r\n   s_fdef_ISNUMBER: 'Returns \"true\" if the value is of type \"Number\" (including logical values). ',\r\n   s_fdef_ISTEXT: 'Returns \"true\" if the value is of type \"Text\". ',\r\n   s_fdef_LEFT: 'Returns the specified number of characters from the text value. If count is omitted, 1 is assumed. ',\r\n   s_fdef_LEN: 'Returns the number of characters in the text value. ',\r\n   s_fdef_LN: 'Returns the natural logarithm of the value. ',\r\n   s_fdef_LOG: 'Returns the logarithm of the value using the specified base. ',\r\n   s_fdef_LOG10: 'Returns the base 10 logarithm of the value. ',\r\n   s_fdef_LOWER: 'Returns the text value with all uppercase characters converted to lowercase. ',\r\n   s_fdef_MATCH: 'Look for the matching value for the given value in the range and return position (the first is 1) in that range. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match<=value) instead of exact match. If rangelookup is -1, act like 1 but the bracket is match>=value. ',\r\n   s_fdef_MAX: 'Returns the maximum of the numeric values. ',\r\n   s_fdef_MID: 'Returns the specified number of characters from the text value starting from the specified position. ',\r\n   s_fdef_MIN: 'Returns the minimum of the numeric values. ',\r\n   s_fdef_MINUTE: 'Returns the minute portion of a time or date/time value. ',\r\n   s_fdef_MOD: 'Returns the remainder of the first value divided by the second. ',\r\n   s_fdef_MONTH: 'Returns the month part of a date value. ',\r\n   s_fdef_N: 'Returns the value if it is a numeric value otherwise an error. ',\r\n   s_fdef_NA: 'Returns the #N/A error value which propagates through most operations. ',\r\n   s_fdef_NOT: 'Returns FALSE if value is true, and TRUE if it is false. ',\r\n   s_fdef_NOW: 'Returns the current date/time. ',\r\n   s_fdef_NPER: 'Returns the number of periods at which payments invested each period at the given rate with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period) has the given present value. ',\r\n   s_fdef_NPV: 'Returns the net present value of cash flows (which may be individual values and/or ranges) at the given rate. The flows are positive if income, negative if paid out, and are assumed at the end of each period. ',\r\n   s_fdef_ODD: 'Rounds the value up in magnitude to the nearest odd integer. ',\r\n   s_fdef_OR: 'True if any argument is true ',\r\n   s_fdef_PI: 'The value 3.1415926... ',\r\n   s_fdef_PMT: 'Returns the amount of each payment that must be invested at the given rate for the specified number of periods to have the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\r\n   s_fdef_POWER: 'Returns the first value raised to the second value power. ',\r\n   s_fdef_PRODUCT: 'Returns the result of multiplying the numeric values. ',\r\n   s_fdef_PROPER: 'Returns the text value with the first letter of each word converted to uppercase and the others to lowercase. ',\r\n   s_fdef_PV: 'Returns the present value of the given number of payments each invested at the given rate, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). ',\r\n   s_fdef_RADIANS: 'Converts value in degrees into radians. ',\r\n   s_fdef_RATE: 'Returns the rate at which the given number of payments each invested at the given rate has the specified present value, with optional future value (default 0) and payment type (default 0 = at end of period, 1 = beginning of period). Uses an iterative process that will return #NUM! error if it does not converge. There may be more than one possible solution. Providing the optional guess value may help in certain situations where it does not converge or finds an inappropriate solution (the default guess is 10%). ',\r\n   s_fdef_REPLACE: 'Returns text1 with the specified number of characters starting from the specified position replaced by text2. ',\r\n   s_fdef_REPT: 'Returns the text repeated the specified number of times. ',\r\n   s_fdef_RIGHT: 'Returns the specified number of characters from the text value starting from the end. If count is omitted, 1 is assumed. ',\r\n   s_fdef_ROUND: 'Rounds the value to the specified number of decimal places. If precision is negative, then round to powers of 10. The default precision is 0 (round to integer). ',\r\n   s_fdef_ROWS: 'Returns the number of rows in the range. ',\r\n   s_fdef_SECOND: 'Returns the second portion of a time or date/time value (truncated to an integer). ',\r\n   s_fdef_SIN: 'Trigonometric sine function (value is in radians) ',\r\n   s_fdef_SLN: 'Returns the amount of depreciation at each period of time using the straight-line method. ',\r\n   s_fdef_SQRT: 'Square root of the value ',\r\n   s_fdef_STDEV: 'Returns the sample standard deviation of the numeric values. ',\r\n   s_fdef_STDEVP: 'Returns the standard deviation of the numeric values. ',\r\n   s_fdef_SUBSTITUTE: 'Returns text1 with the all occurrences of oldtext replaced by newtext. If \"occurrence\" is present, then only that occurrence is replaced. ',\r\n   s_fdef_SUM: 'Adds the numeric values. The values to the sum function may be ranges in the form similar to A1:B5. ',\r\n   s_fdef_SUMIF: 'Sums the numeric values of cells in the range that meet the criteria. The criteria may be a value (\"x\", 15, 1+3) or a test (>25). If range2 is present, then range1 is tested and the corresponding range2 value is summed. ',\r\n   s_fdef_SYD: 'Depreciation by Sum of Year\\'s Digits method. ',\r\n   s_fdef_T: 'Returns the text value or else a null string. ',\r\n   s_fdef_TAN: 'Trigonometric tangent function (value is in radians) ',\r\n   s_fdef_TIME: 'Returns the time value given the specified hour, minute, and second. ',\r\n   s_fdef_TODAY: 'Returns the current date (an integer). Note: In this program, day \"1\" is December 31, 1899 and the year 1900 is not a leap year. Some programs use January 1, 1900, as day \"1\" and treat 1900 as a leap year. In both cases, though, dates on or after March 1, 1900, are the same. ',\r\n   s_fdef_TRIM: 'Returns the text value with leading, trailing, and repeated spaces removed. ',\r\n   s_fdef_TRUE: 'Returns the logical value \"true\". ',\r\n   s_fdef_TRUNC: 'Truncates the value to the specified number of decimal places. If precision is negative, truncate to powers of 10. ',\r\n   s_fdef_UPPER: 'Returns the text value with all lowercase characters converted to uppercase. ',\r\n   s_fdef_VALUE: 'Converts the specified text value into a numeric value. Various forms that look like numbers (including digits followed by %, forms that look like dates, etc.) are handled. This may not handle all of the forms accepted by other spreadsheets and may be locale dependent. ',\r\n   s_fdef_VAR: 'Returns the sample variance of the numeric values. ',\r\n   s_fdef_VARP: 'Returns the variance of the numeric values. ',\r\n   s_fdef_VLOOKUP: 'Look for the matching value for the given value in the range and return the corresponding value in the cell specified by the column offset. If rangelookup is 1 (the default) and not 0, match if within numeric brackets (match>=value) instead of exact match. ',\r\n   s_fdef_WEEKDAY: 'Returns the day of week specified by the date value. If type is 1 (the default), Sunday is day and Saturday is day 7. If type is 2, Monday is day 1 and Sunday is day 7. If type is 3, Monday is day 0 and Sunday is day 6. ',\r\n   s_fdef_YEAR: 'Returns the year part of a date value. ',\r\n   s_fdef_SUMPRODUCT: 'Sums the pairwise products of 2 or more ranges. The ranges must be of equal length.',\r\n   s_fdef_CEILING: 'Rounds the given number up to the nearest integer or multiple of significance. Significance is the value to whose multiple of ten the value is to be rounded up (.01, .1, 1, 10, etc.)',\r\n   s_fdef_FLOOR: 'Rounds the given number down to the nearest multiple of significance. Significance is the value to whose multiple of ten the number is to be rounded down (.01, .1, 1, 10, etc.)',\r\n\r\n   s_farg_v: \"value\",\r\n   s_farg_vn: \"value1, value2, ...\",\r\n   s_farg_xy: \"valueX, valueY\",\r\n   s_farg_choose: \"index, value1, value2, ...\",\r\n   s_farg_range: \"range\",\r\n   s_farg_rangec: \"range, criteria\",\r\n   s_farg_date: \"year, month, day\",\r\n   s_farg_dfunc: \"databaserange, fieldname, criteriarange\",\r\n   s_farg_ddb: \"cost, salvage, lifetime, period, [factor]\",\r\n   s_farg_find: \"string1, string2, [start]\",\r\n   s_farg_fv: \"rate, n, payment, [pv, [paytype]]\",\r\n   s_farg_hlookup: \"value, range, row, [rangelookup]\",\r\n   s_farg_iffunc: \"logical-expression, true-value, [false-value]\",\r\n   s_farg_index: \"range, rownum, colnum\",\r\n   s_farg_irr: \"range, [guess]\",\r\n   s_farg_tc: \"text, count\",\r\n   s_farg_log: \"value, base\",\r\n   s_farg_match: \"value, range, [rangelookup]\",\r\n   s_farg_mid: \"text, start, length\",\r\n   s_farg_nper: \"rate, payment, pv, [fv, [paytype]]\",\r\n   s_farg_npv: \"rate, value1, value2, ...\",\r\n   s_farg_pmt: \"rate, n, pv, [fv, [paytype]]\",\r\n   s_farg_pv: \"rate, n, payment, [fv, [paytype]]\",\r\n   s_farg_rate: \"n, payment, pv, [fv, [paytype, [guess]]]\",\r\n   s_farg_replace: \"text1, start, length, text2\",\r\n   s_farg_vp: \"value, [precision]\",\r\n   s_farg_valpre: \"value, precision\",\r\n   s_farg_csl: \"cost, salvage, lifetime\",\r\n   s_farg_cslp: \"cost, salvage, lifetime, period\",\r\n   s_farg_subs: \"text1, oldtext, newtext, [occurrence]\",\r\n   s_farg_sumif: \"range1, criteria, [range2]\",\r\n   s_farg_hms: \"hour, minute, second\",\r\n   s_farg_txt: \"text\",\r\n   s_farg_vlookup: \"value, range, col, [rangelookup]\",\r\n   s_farg_weekday: \"date, [type]\",\r\n   s_farg_dt: \"date\",\r\n   s_farg_rangen: \"range1, range2, ...\",\r\n   s_farg_vsig: 'value, [significance]',\r\n\r\n   function_classlist: [\"all\", \"stat\", \"lookup\", \"datetime\", \"financial\", \"test\", \"math\", \"text\", \"gui\", \"action\"], // order of function classes\r\n\r\n   s_fclass_all: \"All\",\r\n   s_fclass_stat: \"Statistics\",\r\n   s_fclass_lookup: \"Lookup\",\r\n   s_fclass_datetime: \"Date & Time\",\r\n   s_fclass_financial: \"Financial\",\r\n   s_fclass_test: \"Test\",\r\n   s_fclass_math: \"Math\",\r\n   s_fclass_text: \"Text\",\r\n   s_fclass_action: \"Email & Copy\",\r\n   s_fclass_gui: \"Button & Input\",\r\n\r\n   lastone: null\r\n\r\n   };\r\n\r\n// Default classnames for use with SocialCalc.ConstantsSetClasses:\r\n\r\nSocialCalc.ConstantsDefaultClasses = {\r\n   defaultComment: \"\",\r\n   defaultCommentNoGrid: \"\",\r\n   defaultHighlightTypeCursor: \"\",\r\n   defaultHighlightTypeRange: \"\",\r\n   defaultColname: \"\",\r\n   defaultSelectedColname: \"\",\r\n   defaultRowname: \"\",\r\n   defaultSelectedRowname: \"\", \r\n   defaultUpperLeft: \"\",\r\n   defaultSkippedCell: \"\",\r\n   defaultPaneDivider: \"\",\r\n   cteGriddiv: \"\", // this one has no Style version with it\r\n   defaultInputEcho: {classname: \"\", style: \"filter:alpha(opacity=90);opacity:.9;\"}, // so FireFox won't show warning\r\n   TCmain: \"\",\r\n   TCendcap: \"\",\r\n   TCpaneslider: \"\",\r\n   TClessbutton: \"\",\r\n   TCmorebutton: \"\",\r\n   TCscrollarea: \"\",\r\n   TCthumb: \"\",\r\n   TCPStrackingline: \"\",\r\n   TCTDFSthumbstatus: \"\",\r\n   TDpopupElement: \"\"\r\n   };\r\n\r\n//\r\n// SocialCalc.ConstantsSetClasses(prefix)\r\n//\r\n// This routine goes through all of the xyzClass/xyzStyle pairs and sets the Class to a default and\r\n// turns off the Style, if present. The prefix is put before each default.\r\n// The list of items to set is in SocialCalc.ConstantsDefaultClasses. The names there\r\n// correspond to the \"xyz\" parts. If there is a value, it is the default to set. If the\r\n// default is a null, no change is made. If the default is the null string (\"\"), the\r\n// name of the item is used (e.g., \"defaultComment\" would use the classname \"defaultComment\").\r\n// If the default is an object, then it expects {classname: classname, style: stylestring} - this\r\n// lets you combine both.\r\n//\r\n\r\nSocialCalc.ConstantsSetClasses = function(prefix) {\r\n\r\n   var defaults = SocialCalc.ConstantsDefaultClasses;\r\n   var scc = SocialCalc.Constants;\r\n   var item;\r\n\r\n   prefix = prefix || \"\";\r\n\r\n   for (item in defaults) {\r\n      if (typeof defaults[item] == \"string\") {\r\n         scc[item+\"Class\"] = prefix + (defaults[item] || item);\r\n         if (scc[item+\"Style\"] !== undefined) {\r\n            scc[item+\"Style\"] = \"\";\r\n            }\r\n         }\r\n      else if (typeof defaults[item] == \"object\") {\r\n         scc[item+\"Class\"] = prefix + (defaults[item].classname || item);\r\n         scc[item+\"Style\"] = defaults[item].style;\r\n         }\r\n      }\r\n   }\r\n\r\n// Set the image prefix on all images.\r\n\r\nSocialCalc.ConstantsSetImagePrefix = function(imagePrefix) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   for (var item in scc) {\r\n      if (typeof scc[item] == \"string\") {\r\n         scc[item] = scc[item].replace(scc.defaultImagePrefix, imagePrefix);\r\n         }\r\n      }\r\n   scc.defaultImagePrefix = imagePrefix;\r\n\r\n   }\r\n\r\n","//\r\n// The main SocialCalc code module of the SocialCalc package\r\n//\r\n/*\r\n// (c) Copyright 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of\r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n \r\n/*\r\n\r\n**** Overview ****\r\n\r\nThis is the beginning of a library of routines for displaying and editing spreadsheet\r\ndata in a browser. The HTML that includes this does not need to have anything\r\nspecific to the spreadsheet or editor already present -- everything is dynamically\r\nadded to the DOM by this code, including the rendered sheet and any editing controls.\r\n\r\nThe library has a few parts. This is the main SocialCalc code module.\r\nOther parts are the Table Editor module, the Formula module, and the Format Number module.\r\nNote: The Table Editor module is licensed under a different license than this module.\r\n\r\nThe class/object style is derived from O'Reilly's JavaScript by Flanagan, 5th Edition,\r\nsection 9.3, page 157.\r\n\r\nAll of the data, object definitions, functions, etc., are stored as properties of the SocialCalc\r\nobject so as not to clutter up the global variables nor conflict with other names.\r\n\r\nA design goal (not tested yet for success) is to make it possible to have more than one\r\nspreadsheet active on a page, perhaps even open for editing. It is assumed, though, that\r\nthere is only one mouse and one keyboard (a good assumption on most PCs today but not in the\r\nnew \"touch and surface world\" Apple and Microsoft are working towards).\r\n\r\nThe testing has been on Windows Firefox (2 and 3),\r\nInternet Explorer (6 and 7), Opera (9.23 and mainly later), Mac Safari (3.1), and Mac Firefox (2.0.0.6).\r\nThere are small issues with Firefox before 2.0 (cosmetic with drag handles) and larger ones\r\nwith Opera before 9.5 (the Delete key isn't recognized in some cases -- the 9.5 version was still\r\nin beta and this bug affects other products like GMail, I believe).\r\n\r\nThe data is stored in a SocialCalc.Sheet object. The data is organized in a form similar to that\r\nused by SocialCalc 1.1.0. There is a function for converting a normal SocialCalc spreadsheet\r\nsave data string (the spreadsheet part of a SocialCalc data file) into this internal form.\r\n\r\nThe SocialCalc.RenderContext class provides methods for rendering a table into the DOM representing\r\npart of the spreadsheet. It is assumed that the spreadsheet could possibly be very large\r\nand that rendering the whole thing at once could be too time consuming. It is also set up so\r\nthat it might be possible to have some of the sheet data only be loaded on demand (such as by Ajax).\r\nThe rendering can render cells to the right and below the already active area of the spreadsheet\r\nso that you can scroll to that \"clean\" area without explicitly doing \"add row/column\". The class also\r\ndoes simple operations such as \"scrolling\" within that table. The table may optionally include\r\nrow and column headers and may be split into panes. Most of the code assumes any number of panes,\r\nbut only the rightmost pane has scrolling code. In normal operation there would be one or two\r\npanes horizontally and vertically. The panes may start on any row/column, though a given row/column\r\nshould only appear in one pane at a time (not all code enforces this, yet).\r\n\r\nThe RenderContext is designed to be rendered as part of a SocialCalc.TableEditor. The TableEditor\r\nincludes the spreadsheet grid as well as scrollbars, pane sliders, and (eventually) editing controls.\r\nThe layout is dynamic and may be recomputed on the fly, such as in response to resizing the browser\r\nwindow.\r\n\r\nThe scrollbars and pane sliders are created using SocialCalc.TableControl objects. These in turn\r\nmake use of Dragging, ToolTip, Button, and MouseWheel functions.\r\n\r\nThe keyboard input is handled by keyboard code.\r\n\r\nThere are also some helper routines.\r\n\r\nMore comments yet to come...\r\n\r\n*/\r\n\r\n\r\nvar SocialCalc;\r\nif (!SocialCalc) SocialCalc = {};\r\n\r\n// *************************************\r\n//\r\n// Shared values\r\n//\r\n// These are \"global\" values shared by the classes, including default settings\r\n//\r\n// *************************************\r\n\r\n// Callbacks\r\n\r\nSocialCalc.Callbacks = {\r\n\r\n   // The next two are used by SocialCalc.format_text_for_display\r\n\r\n   // The function to expand wiki text - should be set if you want wikitext expansion\r\n   // The form is: expand_wiki(displayvalue, sheetobj, linkstyle, valueformat)\r\n   //    valueformat is text-wiki followed by optional sub-formats, e.g., text-wikipagelink\r\n\r\n   expand_wiki: null,\r\n\r\n   expand_markup: function(displayvalue, sheetobj, linkstyle) // the old function to expand wiki text - may be replaced\r\n                   {return SocialCalc.default_expand_markup(displayvalue, sheetobj, linkstyle);},\r\n\r\n   // MakePageLink is used to create the href for a link to another \"page\"\r\n   // The form is: MakePageLink(pagename, workspacename, linktyle, valueformat), returns string\r\n\r\n   MakePageLink: null,\r\n\r\n   // NormalizeSheetName is used to make different variations of sheetnames use the same cache slot\r\n\r\n   NormalizeSheetName: null // use default - lowercase\r\n\r\n   };\r\n\r\n// Shared flags\r\n\r\n   // none at present\r\n\r\n\r\n// *************************************\r\n//\r\n// Cell class:\r\n//\r\n// *************************************\r\n\r\n//\r\n// Class SocialCalc.Cell\r\n//\r\n// Usage: var s = new SocialCalc.Cell(coord);\r\n//\r\n// Cell attributes include:\r\n//\r\n//    coord: the column/row as a string, e.g., \"A1\"\r\n//    datavalue: the value to be used for computation and formatting for display,\r\n//               string or numeric (tolerant of numbers stored as strings)\r\n//    datatype: if present, v=numeric value, t=text value, f=formula,\r\n//              or c=constant that is not a simple number (like \"$1.20\")\r\n//    formula: if present, the formula (without leading \"=\") for computation or the constant\r\n//    valuetype: first char is main type, the following are sub-types.\r\n//               Main types are b=blank cell, n=numeric, t=text, e=error\r\n//               Examples of using sub-types would be \"nt\" for a numeric time value, \"n$\" for currency, \"nl\" for logical\r\n//    readonly: if present, whether the current cell is read-only of writable\r\n//    displayvalue: if present, rendered version of datavalue with formatting attributes applied\r\n//    parseinfo: if present, cached parsed version of formula\r\n//\r\n//    The following optional values, if present, are mainly used in rendering, overriding defaults:\r\n//\r\n//    bt, br, bb, bl: number of border's definition\r\n//    layout: layout (vertical alignment, padding) definition number\r\n//    font: font definition number\r\n//    color: text color definition number\r\n//    bgcolor: background color definition number\r\n//    cellformat: cell format (horizontal alignment) definition number\r\n//    nontextvalueformat: custom format definition number for non-text values, e.g., numbers\r\n//    textvalueformat: custom format definition number for text values\r\n//    colspan, rowspan: number of cells to span for merged cells (only on main cell)\r\n//    cssc: custom css classname for cell, as text (no special chars)\r\n//    csss: custom css style definition\r\n//    mod: modification allowed flag \"y\" if present\r\n//    comment: cell comment string\r\n//\r\n\r\n// Eddy - SocialCalc.Cell\r\n\r\nSocialCalc.Cell = function(coord) {\r\n\r\n   this.coord = coord;\r\n   this.datavalue = \"\";\r\n   this.datatype = null;\r\n   this.formula = \"\";\r\n   this.valuetype = \"b\";\r\n   this.readonly = false;\r\n\r\n   }\r\n\r\n// The types of cell properties\r\n//\r\n// Type 1: Base, Type 2: Attribute, Type 3: Special (e.g., displaystring, parseinfo)\r\n\r\nSocialCalc.CellProperties = {\r\n   coord: 1, datavalue: 1, datatype: 1, formula: 1, valuetype: 1, errors: 1, comment: 1, readonly: 1,\r\n   bt: 2, br: 2, bb: 2, bl: 2, layout: 2, font: 2, color: 2, bgcolor: 2,\r\n   cellformat: 2, nontextvalueformat: 2, textvalueformat: 2, colspan: 2, rowspan: 2,\r\n   cssc: 2, csss: 2, mod: 2,\r\n   displaystring: 3, // used to cache rendered HTML of cell contents\r\n   parseinfo: 3, // used to cache parsed formulas\r\n   hcolspan: 3, hrowspan: 3 // spans taking hidden cols/rows into account (!!! NOT YET !!!)\r\n   };\r\n\r\nSocialCalc.CellPropertiesTable = {\r\n   bt: \"borderstyle\", br: \"borderstyle\", bb: \"borderstyle\", bl: \"borderstyle\",\r\n   layout: \"layout\", font: \"font\", color: \"color\", bgcolor: \"color\",\r\n   cellformat: \"cellformat\", nontextvalueformat: \"valueformat\", textvalueformat: \"valueformat\"\r\n   };\r\n\r\n// *************************************\r\n//\r\n// Sheet class:\r\n//\r\n// *************************************\r\n\r\n//\r\n// Class SocialCalc.Sheet\r\n//\r\n// Usage: var s = new SocialCalc.Sheet();\r\n//\r\n\r\nSocialCalc.Sheet = function() {\r\n\r\n   SocialCalc.ResetSheet(this);\r\n\r\n   // Set other values:\r\n   //\r\n   // sheet.statuscallback(data, status, arg, this.statuscallbackparams) is called\r\n   // during recalc and commands.\r\n   //\r\n   // During recalc, data is the current recalcdata.\r\n   // The values for status and the corresponding arg are:\r\n   //\r\n   //    calcorder, {coord: coord, total: celllist length, count: count} [0 or more times per recalc]\r\n   //    calccheckdone, calclist length [once per recalc]\r\n   //    calcstep, {coord: coord, total: calclist length, count: count} [0 or more times per recalc]\r\n   //    calcloading, {sheetname: name-of-sheet}\r\n   //    calcserverfunc, {funcname: name-of-function, coord: coord, total: calclist length, count: count}\r\n   //    calcfinished, time in milliseconds [once per recalc]\r\n   //\r\n   // During commands, data is SocialCalc.SheetCommandInfo.\r\n   // These values for status and arg are:\r\n   //\r\n   //    cmdstart, cmdstr\r\n   //    cmdend\r\n   //\r\n\r\n   this.statuscallback = null; // routine called with cmdstart, calcstart, etc., status and args:\r\n                                // sheet.statuscallback(data, status, arg, params)\r\n   this.statuscallbackparams = null; // parameters passed to that routine\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.ResetSheet(sheet)\r\n//\r\n// Resets (and/or initializes) sheet data values.\r\n// \r\n\r\nSocialCalc.ResetSheet = function(sheet, reload) {\r\n\r\n   // properties:\r\n\r\n   sheet.cells = {}; // at least one for each non-blank cell: coord: cell-object\r\n   sheet.attribs = // sheet attributes\r\n      {\r\n         lastcol: 1,\r\n         lastrow: 1,\r\n         defaultlayout: 0,\r\n         usermaxcol: 0,\r\n         usermaxrow: 0\r\n\r\n      };\r\n   sheet.rowattribs =\r\n      {\r\n         hide: {}, // access by row number\r\n         height: {}\r\n      };\r\n   sheet.colattribs =\r\n      {\r\n         width: {}, // access by col name\r\n         hide: {}\r\n      };\r\n   sheet.names={}; // Each is: {desc: \"optional description\", definition: \"B5, A1:B7, or =formula\"}\r\n   sheet.layouts=[];\r\n   sheet.layouthash={};\r\n   sheet.fonts=[];\r\n   sheet.fonthash={};\r\n   sheet.colors=[];\r\n   sheet.colorhash={};\r\n   sheet.borderstyles=[];\r\n   sheet.borderstylehash={};\r\n   sheet.cellformats=[];\r\n   sheet.cellformathash={};\r\n   sheet.valueformats=[];\r\n   sheet.valueformathash={};\r\n   sheet.matched_cells=[];\r\n   sheet.selected_search_cell=undefined;\r\n\r\n   sheet.copiedfrom = \"\"; // if a range, then this was loaded from a saved range as clipboard content\r\n\r\n   sheet.changes = new SocialCalc.UndoStack();\r\n\r\n   sheet.renderneeded = false;\r\n\r\n   sheet.changedrendervalues = true; // if true, spans and/or fonts have changed (set by ExecuteSheetCommand & GetStyle)\r\n\r\n   sheet.recalcchangedavalue = false; // true if a recalc resulted in a change to a cell's calculated value\r\n\r\n   sheet.hiddencolrow = \"\"; // \"col\" or \"row\" if it was hidden\r\n\r\n   sheet.sci = new SocialCalc.SheetCommandInfo(sheet);\r\n\r\n   sheet.ioEventTree ={};\r\n   sheet.ioParameterList = {}; \r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.Sheet.prototype.ResetSheet = function() {SocialCalc.ResetSheet(this);};\r\nSocialCalc.Sheet.prototype.AddCell = function(newcell) {return this.cells[newcell.coord]=newcell;};\r\nSocialCalc.Sheet.prototype.LastCol = function() { \r\n    var last_col = 1;\r\n    for (var cell_id  in this.cells) {\r\n        var cr = SocialCalc.coordToCr(cell_id);\r\n        if (cr.col > last_col) {\r\n            last_col = cr.col;\r\n        }\r\n    }\r\n    return last_col;\r\n}\r\nSocialCalc.Sheet.prototype.LastRow = function() { \r\n    var last_row = 1;\r\n    for (var cell_id  in this.cells) {\r\n        var cr = SocialCalc.coordToCr(cell_id);\r\n        if (cr.row > last_row) {\r\n            last_row = cr.row;\r\n        }\r\n    }\r\n    return last_row;\r\n} \r\nSocialCalc.Sheet.prototype.GetAssuredCell = function(coord) {\r\n   return this.cells[coord] || this.AddCell(new SocialCalc.Cell(coord));\r\n   };\r\nSocialCalc.Sheet.prototype.ParseSheetSave = function(savedsheet) {SocialCalc.ParseSheetSave(savedsheet,this);};\r\nSocialCalc.Sheet.prototype.CellFromStringParts = function(cell, parts, j) {return SocialCalc.CellFromStringParts(this, cell, parts, j);};\r\nSocialCalc.Sheet.prototype.CreateSheetSave = function(range, canonicalize) {return SocialCalc.CreateSheetSave(this, range, canonicalize);};\r\nSocialCalc.Sheet.prototype.CellToString = function(cell) {return SocialCalc.CellToString(this, cell);};\r\nSocialCalc.Sheet.prototype.CanonicalizeSheet = function(full) {return SocialCalc.CanonicalizeSheet(this, full);};\r\nSocialCalc.Sheet.prototype.EncodeCellAttributes = function(coord) {return SocialCalc.EncodeCellAttributes(this, coord);};\r\nSocialCalc.Sheet.prototype.EncodeSheetAttributes = function() {return SocialCalc.EncodeSheetAttributes(this);};\r\nSocialCalc.Sheet.prototype.DecodeCellAttributes = function(coord, attribs, range) {return SocialCalc.DecodeCellAttributes(this, coord, attribs, range);};\r\nSocialCalc.Sheet.prototype.DecodeSheetAttributes = function(attribs) {return SocialCalc.DecodeSheetAttributes(this, attribs);};\r\n\r\nSocialCalc.Sheet.prototype.ScheduleSheetCommands = function(cmd, saveundo) {return SocialCalc.ScheduleSheetCommands(this, cmd, saveundo);};\r\nSocialCalc.Sheet.prototype.SheetUndo = function() {return SocialCalc.SheetUndo(this);};\r\nSocialCalc.Sheet.prototype.SheetRedo = function() {return SocialCalc.SheetRedo(this);};\r\nSocialCalc.Sheet.prototype.CreateAuditString = function() {return SocialCalc.CreateAuditString(this);};\r\nSocialCalc.Sheet.prototype.GetStyleNum = function(atype, style) {return SocialCalc.GetStyleNum(this, atype, style);};\r\nSocialCalc.Sheet.prototype.GetStyleString = function(atype, num) {return SocialCalc.GetStyleString(this, atype, num);};\r\nSocialCalc.Sheet.prototype.RecalcSheet = function() {return SocialCalc.RecalcSheet(this);};\r\n\r\n//\r\n// Sheet save format:\r\n//\r\n// linetype:param1:param2:...\r\n//\r\n// Linetypes are:\r\n//\r\n//    version:versionname - version of this format. Currently 1.4.\r\n//\r\n//    cell:coord:type:value...:type:value... - Types are as follows:\r\n//\r\n//       v:value - straight numeric value\r\n//       t:value - straight text/wiki-text in cell, encoded to handle \\, :, newlines\r\n//       vt:fulltype:value - value with value type/subtype\r\n//       vtf:fulltype:value:formulatext - formula resulting in value with value type/subtype, value and text encoded\r\n//       vtc:fulltype:value:valuetext - formatted text constant resulting in value with value type/subtype, value and text encoded\r\n//       vf:fvalue:formulatext - formula resulting in value, value and text encoded (obsolete: only pre format version 1.1)\r\n//          fvalue - first char is \"N\" for numeric value, \"T\" for text value, \"H\" for HTML value, rest is the value\r\n//       e:errortext - Error text. Non-blank means formula parsing/calculation results in error.\r\n//       b:topborder#:rightborder#:bottomborder#:leftborder# - border# in sheet border list or blank if none\r\n//       l:layout# - number in cell layout list\r\n//       f:font# - number in sheet fonts list\r\n//       c:color# - sheet color list index for text\r\n//       bg:color# - sheet color list index for background color\r\n//       cf:format# - sheet cell format number for explicit format (align:left, etc.)\r\n//       cvf:valueformat# - sheet cell value format number (obsolete: only pre format v1.2)\r\n//       tvf:valueformat# - sheet cell text value format number\r\n//       ntvf:valueformat# - sheet cell non-text value format number\r\n//       colspan:numcols - number of columns spanned in merged cell\r\n//       rowspan:numrows - number of rows spanned in merged cell\r\n//       cssc:classname - name of CSS class to be used for cell when published instead of one calculated here\r\n//       csss:styletext - explicit CSS style information, encoded to handle :, etc.\r\n//       mod:allow - if \"y\" allow modification of cell for live \"view\" recalc\r\n//       comment:value - encoded text of comment for this cell (added in v1.5)\r\n//\r\n//    col:\r\n//       w:widthval - number, \"auto\" (no width in <col> tag), number%, or blank (use default)\r\n//       hide: - yes/no, no is assumed if missing\r\n//    row:\r\n//       hide - yes/no, no is assumed if missing\r\n//\r\n//    sheet:\r\n//       c:lastcol - number\r\n//       r:lastrow - number\r\n//       w:defaultcolwidth - number, \"auto\", number%, or blank (default->80)\r\n//       h:defaultrowheight - not used\r\n//       tf:format# - cell format number for sheet default for text values\r\n//       ntf:format# - cell format number for sheet default for non-text values (i.e., numbers)\r\n//       layout:layout# - default cell layout number in cell layout list\r\n//       font:font# - default font number in sheet font list\r\n//       vf:valueformat# - default number value format number in sheet valueformat list (obsolete: only pre format version 1.2)\r\n//       ntvf:valueformat# - default non-text (number) value format number in sheet valueformat list\r\n//       tvf:valueformat# - default text value format number in sheet valueformat list\r\n//       color:color# - default number for text color in sheet color list\r\n//       bgcolor:color# - default number for background color in sheet color list\r\n//       circularreferencecell:coord - cell coord with a circular reference\r\n//       recalc:value - on/off (on is default). If not \"off\", appropriate changes to the sheet cause a recalc\r\n//       needsrecalc:value - yes/no (no is default). If \"yes\", formula values are not up to date\r\n//       usermaxcol:value - maximum column to display, 0 for unlimited (default=0)\r\n//       usermaxrow:value - maximum row to display, 0 for unlimited (default=0)\r\n//\r\n//    name:name:description:value - name definition, name in uppercase, with value being \"B5\", \"A1:B7\", or \"=formula\";\r\n//                                  description and value are encoded.\r\n//    font:fontnum:value - text of font definition (style weight size family) for font fontnum\r\n//                         \"*\" for \"style weight\", size, or family, means use default (first look to sheet, then builtin)\r\n//    color:colornum:rgbvalue - text of color definition (e.g., rgb(255,255,255)) for color colornum\r\n//    border:bordernum:value - text of border definition (thickness style color) for border bordernum\r\n//    layout:layoutnum:value - text of vertical alignment and padding style for cell layout layoutnum (* for default):\r\n//                             vertical-alignment:vavalue;padding:topval rightval bottomval leftval;\r\n//    cellformat:cformatnum:value - text of cell alignment (left/center/right) for cellformat cformatnum\r\n//    valueformat:vformatnum:value - text of number format (see FormatValueForDisplay) for valueformat vformatnum (changed in v1.2)\r\n//    clipboardrange:upperleftcoord:bottomrightcoord - ignored -- from wikiCalc\r\n//    clipboard:coord:type:value:... - ignored -- from wikiCalc\r\n//\r\n// If this is clipboard contents, then there is also information to facilitate pasting:\r\n//\r\n//    copiedfrom:upperleftcoord:bottomrightcoord - range from which this was copied\r\n//\r\n\r\n// Functions:\r\n\r\nSocialCalc.ParseSheetSave = function(savedsheet,sheetobj) {\r\n\r\n   var lines=savedsheet.split(/\\r\\n|\\n/);\r\n   var parts=[];\r\n   var line;\r\n   var i, j, t, v, coord, cell, attribs, name;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   for (i=0;i<lines.length;i++) {\r\n      line=lines[i];\r\n      parts = line.split(\":\");\r\n      switch (parts[0]) {\r\n         case \"cell\":\r\n            cell=sheetobj.GetAssuredCell(parts[1]);\r\n            j=2;\r\n            sheetobj.CellFromStringParts(cell, parts, j);\r\n            break;\r\n\r\n         case \"col\":\r\n            coord=parts[1];\r\n            j=2;\r\n            while (t=parts[j++]) {\r\n               switch (t) {\r\n                  case \"w\":\r\n                     sheetobj.colattribs.width[coord]=parts[j++]; // must be text - could be auto or %, etc.\r\n                     break;\r\n                  case \"hide\":\r\n                     sheetobj.colattribs.hide[coord]=parts[j++];\r\n                     break;\r\n                  default:\r\n                     throw scc.s_pssUnknownColType+\" '\"+t+\"'\";\r\n                     break;\r\n                  }\r\n               }\r\n            break;\r\n\r\n         case \"row\":\r\n            coord=parts[1]-0;\r\n            j=2;\r\n            while (t=parts[j++]) {\r\n               switch (t) {\r\n                  case \"h\":\r\n                     sheetobj.rowattribs.height[coord]=parts[j++]-0;\r\n                     break;\r\n                  case \"hide\":\r\n                     sheetobj.rowattribs.hide[coord]=parts[j++];\r\n                     break;\r\n                  default:\r\n                     throw scc.s_pssUnknownRowType+\" '\"+t+\"'\";\r\n                     break;\r\n                  }\r\n               }\r\n            break;\r\n\r\n         case \"sheet\":\r\n            attribs=sheetobj.attribs;\r\n            j=1;\r\n            while (t=parts[j++]) {\r\n               switch (t) {\r\n                  case \"c\":\r\n                     attribs.lastcol=parts[j++]-0;\r\n                     break;\r\n                  case \"r\":\r\n                     attribs.lastrow=parts[j++]-0;\r\n                     break;\r\n                  case \"w\":\r\n                     attribs.defaultcolwidth=parts[j++]+\"\";\r\n                     break;\r\n                  case \"h\":\r\n                     attribs.defaultrowheight=parts[j++]-0;\r\n                     break;\r\n                  case \"tf\":\r\n                     attribs.defaulttextformat=parts[j++]-0;\r\n                     break;\r\n                  case \"ntf\":\r\n                     attribs.defaultnontextformat=parts[j++]-0;\r\n                     break;\r\n                  case \"layout\":\r\n                     attribs.defaultlayout=parts[j++]-0;\r\n                     break;\r\n                  case \"font\":\r\n                     attribs.defaultfont=parts[j++]-0;\r\n                     break;\r\n                  case \"tvf\":\r\n                     attribs.defaulttextvalueformat=parts[j++]-0;\r\n                     break;\r\n                  case \"ntvf\":\r\n                     attribs.defaultnontextvalueformat=parts[j++]-0;\r\n                     break;\r\n                  case \"color\":\r\n                     attribs.defaultcolor=parts[j++]-0;\r\n                     break;\r\n                  case \"bgcolor\":\r\n                     attribs.defaultbgcolor=parts[j++]-0;\r\n                     break;\r\n                  case \"circularreferencecell\":\r\n                     attribs.circularreferencecell=parts[j++];\r\n                     break;\r\n                  case \"recalc\":\r\n                     attribs.recalc=parts[j++];\r\n                     break;\r\n                  case \"needsrecalc\":\r\n                     attribs.needsrecalc=parts[j++];\r\n                     break;\r\n                  case \"usermaxcol\":\r\n                     attribs.usermaxcol=parts[j++]-0;\r\n                     break;\r\n                  case \"usermaxrow\":\r\n                     attribs.usermaxrow=parts[j++]-0;\r\n                     break;\r\n                  default:\r\n                     j+=1;\r\n                     break;\r\n                  }\r\n               }\r\n            break;\r\n\r\n         case \"name\":\r\n            name = SocialCalc.decodeFromSave(parts[1]).toUpperCase();\r\n            sheetobj.names[name] = {desc: SocialCalc.decodeFromSave(parts[2])};\r\n            sheetobj.names[name].definition = SocialCalc.decodeFromSave(parts[3]);\r\n            break;\r\n\r\n         case \"layout\":\r\n            parts=lines[i].match(/^layout\\:(\\d+)\\:(.+)$/); // layouts can have \":\" in them\r\n            sheetobj.layouts[parts[1]-0]=parts[2];\r\n            sheetobj.layouthash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"font\":\r\n            sheetobj.fonts[parts[1]-0]=parts[2];\r\n            sheetobj.fonthash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"color\":\r\n            sheetobj.colors[parts[1]-0]=parts[2];\r\n            sheetobj.colorhash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"border\":\r\n            sheetobj.borderstyles[parts[1]-0]=parts[2];\r\n            sheetobj.borderstylehash[parts[2]]=parts[1]-0;\r\n            break;\r\n\r\n         case \"cellformat\":\r\n            v=SocialCalc.decodeFromSave(parts[2]);\r\n            sheetobj.cellformats[parts[1]-0]=v;\r\n            sheetobj.cellformathash[v]=parts[1]-0;\r\n            break;\r\n\r\n         case \"valueformat\":\r\n            v=SocialCalc.decodeFromSave(parts[2]);\r\n            sheetobj.valueformats[parts[1]-0]=v;\r\n            sheetobj.valueformathash[v]=parts[1]-0;\r\n            break;\r\n\r\n         case \"version\":\r\n            break;\r\n\r\n         case \"copiedfrom\":\r\n            sheetobj.copiedfrom = parts[1]+\":\"+parts[2];\r\n            break;\r\n\r\n         case \"clipboardrange\": // in save versions up to 1.3. Ignored.\r\n         case \"clipboard\":\r\n            break;\r\n\r\n         case \"\":\r\n            break;\r\n\r\n         default:\r\nalert(scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\");\r\n            throw scc.s_pssUnknownLineType+\" '\"+parts[0]+\"'\";\r\n            break;\r\n         }\r\n      parts = null;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.CellFromStringParts(sheet, cell, parts, j)\r\n//\r\n// Takes string that has been split by \":\" in parts, starting at item j,\r\n// and fills in cell assuming save format.\r\n//\r\n\r\nSocialCalc.CellFromStringParts = function(sheet, cell, parts, j) {\r\n\r\n   var cell, t, v;\r\n\r\n   while (t=parts[j++]) {\r\n      switch (t) {\r\n         case \"v\":\r\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n            cell.datatype=\"v\";\r\n            cell.valuetype=\"n\";\r\n            break;\r\n         case \"t\":\r\n            cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.datatype=\"t\";\r\n            cell.valuetype=SocialCalc.Constants.textdatadefaulttype; \r\n            break;\r\n         case \"vt\":\r\n            v=parts[j++];\r\n            cell.valuetype=v;\r\n            if (v.charAt(0)==\"n\") {\r\n               cell.datatype=\"v\";\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n               }\r\n            else {\r\n               cell.datatype=\"t\";\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n               }\r\n            break;\r\n         case \"vtf\":\r\n            v=parts[j++];\r\n            cell.valuetype=v;\r\n            if (v.charAt(0)==\"n\") {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n               }\r\n            else {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n               }\r\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.datatype=\"f\";\r\n            break;\r\n         case \"vtc\":\r\n            v=parts[j++];\r\n            cell.valuetype=v;\r\n            if (v.charAt(0)==\"n\") {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++])-0;\r\n               }\r\n            else {\r\n               cell.datavalue=SocialCalc.decodeFromSave(parts[j++]);\r\n               }\r\n            cell.formula=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.datatype=\"c\";\r\n            break;\r\n         case \"ro\":\r\n            ro=SocialCalc.decodeFromSave(parts[j++]);\r\n            cell.readonly=ro.toLowerCase()==\"yes\";\r\n            break;\r\n         case \"e\":\r\n            cell.errors=SocialCalc.decodeFromSave(parts[j++]);\r\n            break;\r\n         case \"b\":\r\n            cell.bt=parts[j++]-0;\r\n            cell.br=parts[j++]-0;\r\n            cell.bb=parts[j++]-0;\r\n            cell.bl=parts[j++]-0;\r\n            break;\r\n         case \"l\":\r\n            cell.layout=parts[j++]-0;\r\n            break;\r\n         case \"f\":\r\n            cell.font=parts[j++]-0;\r\n            break;\r\n         case \"c\":\r\n            cell.color=parts[j++]-0;\r\n            break;\r\n         case \"bg\":\r\n            cell.bgcolor=parts[j++]-0;\r\n            break;\r\n         case \"cf\":\r\n            cell.cellformat=parts[j++]-0;\r\n            break;\r\n         case \"ntvf\":\r\n            cell.nontextvalueformat=parts[j++]-0;\r\n            break;\r\n         case \"tvf\":\r\n            cell.textvalueformat=parts[j++]-0;\r\n            break;\r\n         case \"colspan\":\r\n            cell.colspan=parts[j++]-0;\r\n            break;\r\n         case \"rowspan\":\r\n            cell.rowspan=parts[j++]-0;\r\n            break;\r\n         case \"cssc\":\r\n            cell.cssc=parts[j++];\r\n            break;\r\n         case \"csss\":\r\n            cell.csss=SocialCalc.decodeFromSave(parts[j++]);\r\n            break;\r\n         case \"mod\":\r\n            j+=1;\r\n            break;\r\n         case \"comment\":\r\n            cell.comment=SocialCalc.decodeFromSave(parts[j++]);\r\n            break;\r\n         default:\r\n            throw SocialCalc.Constants.s_cfspUnknownCellType+\" '\"+t+\"'\";\r\n            break;\r\n         }\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.sheetfields = [\"defaultrowheight\", \"defaultcolwidth\", \"circularreferencecell\", \"recalc\", \"needsrecalc\", \"usermaxcol\", \"usermaxrow\"];\r\nSocialCalc.sheetfieldsshort = [\"h\", \"w\", \"circularreferencecell\", \"recalc\", \"needsrecalc\", \"usermaxcol\", \"usermaxrow\"];\r\n\r\nSocialCalc.sheetfieldsxlat = [\"defaulttextformat\", \"defaultnontextformat\",\r\n                              \"defaulttextvalueformat\", \"defaultnontextvalueformat\",\r\n                              \"defaultcolor\", \"defaultbgcolor\", \"defaultfont\", \"defaultlayout\"];\r\nSocialCalc.sheetfieldsxlatshort = [\"tf\", \"ntf\", \"tvf\", \"ntvf\", \"color\", \"bgcolor\", \"font\", \"layout\"];\r\nSocialCalc.sheetfieldsxlatxlt = [\"cellformat\", \"cellformat\", \"valueformat\", \"valueformat\",\r\n                                  \"color\", \"color\", \"font\", \"layout\"];\r\n\r\n//\r\n// sheetstr = SocialCalc.CreateSheetSave(sheetobj, range, canonicalize)\r\n//\r\n// Creates a text representation of the sheetobj data.\r\n// If the range is present then only those cells are saved\r\n// (as clipboard data with \"copiedfrom\" set).\r\n//\r\n\r\nSocialCalc.CreateSheetSave = function(sheetobj, range, canonicalize) {\r\n\r\n   var cell, cr1, cr2, row, col, coord, attrib, line, value, formula, i, t, r, b, l, name, blanklen;\r\n   var result=[];\r\n\r\n   var prange;\r\n\r\n   sheetobj.CanonicalizeSheet(canonicalize || SocialCalc.Constants.doCanonicalizeSheet);\r\n   var xlt = sheetobj.xlt;\r\n\r\n   if (range) {\r\n      prange = SocialCalc.ParseRange(range);\r\n      }\r\n   else {\r\n      prange = {cr1: {row: 1, col:1},\r\n                cr2: {row: xlt.maxrow, col: xlt.maxcol}};\r\n      }\r\n   cr1 = prange.cr1;\r\n   cr2 = prange.cr2;\r\n\r\n   result.push(\"version:1.5\");\r\n\r\n   for (row=cr1.row; row <= cr2.row; row++) {\r\n      for (col=cr1.col; col <= cr2.col; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         cell=sheetobj.cells[coord];\r\n         if (!cell) continue;\r\n         line=sheetobj.CellToString(cell);\r\n         if (line.length==0) continue; // ignore completely empty cells\r\n         line=\"cell:\"+coord+line;\r\n         result.push(line);\r\n         }\r\n      }\r\n\r\n   for (col=1; col <= xlt.maxcol; col++) {\r\n      coord = SocialCalc.rcColname(col);\r\n      if (sheetobj.colattribs.width[coord])\r\n         result.push(\"col:\"+coord+\":w:\"+sheetobj.colattribs.width[coord]);\r\n      if (sheetobj.colattribs.hide[coord])\r\n         result.push(\"col:\"+coord+\":hide:\"+sheetobj.colattribs.hide[coord]);\r\n      }\r\n\r\n   for (row=1; row <= xlt.maxrow; row++) {\r\n      if (sheetobj.rowattribs.height[row])\r\n         result.push(\"row:\"+row+\":h:\"+sheetobj.rowattribs.height[row]);\r\n      if (sheetobj.rowattribs.hide[row])\r\n         result.push(\"row:\"+row+\":hide:\"+sheetobj.rowattribs.hide[row]);\r\n      }\r\n\r\n   line=\"sheet:c:\"+xlt.maxcol+\":r:\"+xlt.maxrow;\r\n\r\n   for (i=0; i<SocialCalc.sheetfields.length; i++) { // non-xlated values\r\n      value = SocialCalc.encodeForSave(sheetobj.attribs[SocialCalc.sheetfields[i]]);\r\n      if (value) line+=\":\"+SocialCalc.sheetfieldsshort[i]+\":\"+value;\r\n      }\r\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // xlated values\r\n      value = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\r\n      if (value) line+=\":\"+SocialCalc.sheetfieldsxlatshort[i]+\":\"+xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sxlat\"][value];\r\n      }\r\n\r\n   result.push(line);\r\n\r\n   for (i=1;i<xlt.newborderstyles.length;i++) {\r\n      result.push(\"border:\"+i+\":\"+xlt.newborderstyles[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newcellformats.length;i++) {\r\n      result.push(\"cellformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newcellformats[i]));\r\n      }\r\n\r\n   for (i=1;i<xlt.newcolors.length;i++) {\r\n      result.push(\"color:\"+i+\":\"+xlt.newcolors[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newfonts.length;i++) {\r\n      result.push(\"font:\"+i+\":\"+xlt.newfonts[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newlayouts.length;i++) {\r\n      result.push(\"layout:\"+i+\":\"+xlt.newlayouts[i]);\r\n      }\r\n\r\n   for (i=1;i<xlt.newvalueformats.length;i++) {\r\n      result.push(\"valueformat:\"+i+\":\"+SocialCalc.encodeForSave(xlt.newvalueformats[i]));\r\n      }\r\n\r\n   for (i=0; i<xlt.namesorder.length; i++) {\r\n      name = xlt.namesorder[i];\r\n      result.push(\"name:\"+SocialCalc.encodeForSave(name).toUpperCase()+\":\"+\r\n                   SocialCalc.encodeForSave(sheetobj.names[name].desc)+\":\"+\r\n                   SocialCalc.encodeForSave(sheetobj.names[name].definition));\r\n      }\r\n\r\n   if (range) {\r\n      result.push(\"copiedfrom:\"+SocialCalc.crToCoord(cr1.col, cr1.row)+\":\"+\r\n                  SocialCalc.crToCoord(cr2.col, cr2.row));\r\n      }\r\n\r\n   result.push(\"\"); // one extra to get extra \\n\r\n\r\n   delete sheetobj.xlt; // clean up\r\n\r\n   return result.join(\"\\n\");\r\n   }\r\n\r\n//\r\n// line = SocialCalc.CellToString(sheet, cell)\r\n//\r\n\r\nSocialCalc.CellToString = function(sheet, cell) {\r\n\r\n   var cell, line, value, formula, t, r, b, l, xlt;\r\n\r\n   line = \"\";\r\n\r\n   if (!cell) return line;\r\n\r\n   value = SocialCalc.encodeForSave(cell.datavalue);\r\n   if (cell.datatype==\"v\") {\r\n      if (cell.valuetype==\"n\") line += \":v:\"+value;\r\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\r\n      }\r\n   else if (cell.datatype==\"t\") {\r\n      if (cell.valuetype==SocialCalc.Constants.textdatadefaulttype)\r\n         line += \":t:\"+value;\r\n      else line += \":vt:\"+cell.valuetype+\":\"+value;\r\n      }\r\n   else {\r\n      formula = SocialCalc.encodeForSave(cell.formula);\r\n      if (cell.datatype==\"f\") {\r\n         line += \":vtf:\"+cell.valuetype+\":\"+value+\":\"+formula;\r\n         }\r\n      else if (cell.datatype==\"c\") {\r\n         line += \":vtc:\"+cell.valuetype+\":\"+value+\":\"+formula;\r\n         }\r\n      }\r\n   if (cell.readonly) {\r\n      line += \":ro:yes\";\r\n      }\r\n   if (cell.errors) {\r\n      line += \":e:\"+SocialCalc.encodeForSave(cell.errors);\r\n      }\r\n   t = cell.bt || \"\";\r\n   r = cell.br || \"\";\r\n   b = cell.bb || \"\";\r\n   l = cell.bl || \"\";\r\n\r\n   if (sheet.xlt) { // if have canonical save info\r\n      xlt = sheet.xlt;\r\n      if (t || r || b || l)\r\n      line += \":b:\"+xlt.borderstylesxlat[t||0]+\":\"+xlt.borderstylesxlat[r||0]+\":\"+xlt.borderstylesxlat[b||0]+\":\"+xlt.borderstylesxlat[l||0];\r\n      if (cell.layout) line += \":l:\"+xlt.layoutsxlat[cell.layout];\r\n      if (cell.font) line += \":f:\"+xlt.fontsxlat[cell.font];\r\n      if (cell.color) line += \":c:\"+xlt.colorsxlat[cell.color];\r\n      if (cell.bgcolor) line += \":bg:\"+xlt.colorsxlat[cell.bgcolor];\r\n      if (cell.cellformat) line += \":cf:\"+xlt.cellformatsxlat[cell.cellformat];\r\n      if (cell.textvalueformat) line += \":tvf:\"+xlt.valueformatsxlat[cell.textvalueformat];\r\n      if (cell.nontextvalueformat) line += \":ntvf:\"+xlt.valueformatsxlat[cell.nontextvalueformat];\r\n      }\r\n   else {\r\n      if (t || r || b || l)\r\n      line += \":b:\"+t+\":\"+r+\":\"+b+\":\"+l;\r\n      if (cell.layout) line += \":l:\"+cell.layout;\r\n      if (cell.font) line += \":f:\"+cell.font;\r\n      if (cell.color) line += \":c:\"+cell.color;\r\n      if (cell.bgcolor) line += \":bg:\"+cell.bgcolor;\r\n      if (cell.cellformat) line += \":cf:\"+cell.cellformat;\r\n      if (cell.textvalueformat) line += \":tvf:\"+cell.textvalueformat;\r\n      if (cell.nontextvalueformat) line += \":ntvf:\"+cell.nontextvalueformat;\r\n      }\r\n   if (cell.colspan) line += \":colspan:\"+cell.colspan;\r\n   if (cell.rowspan) line += \":rowspan:\"+cell.rowspan;\r\n   if (cell.cssc) line += \":cssc:\"+cell.cssc;\r\n   if (cell.csss) line += \":csss:\"+SocialCalc.encodeForSave(cell.csss);\r\n   if (cell.mod) line += \":mod:\"+cell.mod;\r\n   if (cell.comment) line += \":comment:\"+SocialCalc.encodeForSave(cell.comment);\r\n\r\n   return line;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.CanonicalizeSheet(sheetobj, full)\r\n//\r\n// Goes through the sheet and fills in sheetobj.xlt with the following:\r\n//\r\n//   .maxrow, .maxcol - lastrow and lastcol are as small as possible\r\n//   .newlayouts - new version of sheetobj.layouts without unused ones and all in ascending order\r\n//   .layoutsxlat - maps old layouts index to new one\r\n//   same \".new\" and \".xlat\" for fonts, colors, borderstyles, cell and value formats\r\n//   .namesorder - array with names sorted\r\n//\r\n// If full or SocialCalc.Constants.doCanonicalizeSheet are not true, then the values will leave things unchanged (to save time, etc.)\r\n//\r\n// sheetobj.xlt should be deleted when you are finished using it\r\n//\r\n\r\nSocialCalc.CanonicalizeSheet = function(sheetobj, full) {\r\n\r\n   var l, coord, cr, cell, filled, an, a, newa, newxlat, used, ahash, i, v;\r\n   var maxrow = 0;\r\n   var maxcol = 0;\r\n   var alist = [\"borderstyle\", \"cellformat\", \"color\", \"font\", \"layout\", \"valueformat\"];\r\n\r\n   var xlt = {};\r\n\r\n   xlt.namesorder = []; // always return a sorted list\r\n   for (a in sheetobj.names) {\r\n      xlt.namesorder.push(a);\r\n      }\r\n   xlt.namesorder.sort();\r\n\r\n   if (!SocialCalc.Constants.doCanonicalizeSheet || !full) { // return make-no-changes values if not wanted\r\n      for (an=0; an<alist.length; an++) {\r\n         a = alist[an];\r\n         xlt[\"new\"+a+\"s\"] = sheetobj[a+\"s\"];\r\n         l = sheetobj[a+\"s\"].length;\r\n         newxlat = new Array(l);\r\n         newxlat[0] = \"\";\r\n         for (i=1; i<l; i++) {\r\n            newxlat[i] = i;\r\n            }\r\n         xlt[a+\"sxlat\"] = newxlat;\r\n         }\r\n\r\n      xlt.maxrow = sheetobj.attribs.lastrow;\r\n      xlt.maxcol = sheetobj.attribs.lastcol;\r\n\r\n      sheetobj.xlt = xlt;\r\n\r\n      return;\r\n      }\r\n\r\n   for (an=0; an<alist.length; an++) {\r\n      a = alist[an];\r\n      xlt[a+\"sUsed\"] = {};\r\n      }\r\n\r\n   var colorsUsed = xlt.colorsUsed;\r\n   var borderstylesUsed = xlt.borderstylesUsed;\r\n   var fontsUsed = xlt.fontsUsed;\r\n   var layoutsUsed = xlt.layoutsUsed;\r\n   var cellformatsUsed = xlt.cellformatsUsed;\r\n   var valueformatsUsed = xlt.valueformatsUsed;\r\n\r\n   for (coord in sheetobj.cells) { // check all cells to see which values are used\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell = sheetobj.cells[coord];\r\n      filled = false;\r\n\r\n      if (cell.valuetype && cell.valuetype!=\"b\") filled = true;\r\n\r\n      if (cell.color) {\r\n         colorsUsed[cell.color] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.bgcolor) {\r\n         colorsUsed[cell.bgcolor] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.bt) {\r\n         borderstylesUsed[cell.bt] = 1;\r\n         filled = true;\r\n         }\r\n      if (cell.br) {\r\n         borderstylesUsed[cell.br] = 1;\r\n         filled = true;\r\n         }\r\n      if (cell.bb) {\r\n         borderstylesUsed[cell.bb] = 1;\r\n         filled = true;\r\n         }\r\n      if (cell.bl) {\r\n         borderstylesUsed[cell.bl] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.layout) {\r\n         layoutsUsed[cell.layout] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.font) {\r\n         fontsUsed[cell.font] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.cellformat) {\r\n         cellformatsUsed[cell.cellformat] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.textvalueformat) {\r\n         valueformatsUsed[cell.textvalueformat] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (cell.nontextvalueformat) {\r\n         valueformatsUsed[cell.nontextvalueformat] = 1;\r\n         filled = true;\r\n         }\r\n\r\n      if (filled) {\r\n         if (cr.row > maxrow) maxrow = cr.row;\r\n         if (cr.col > maxcol) maxcol = cr.col;\r\n         }\r\n      }\r\n\r\n   for (i=0; i<SocialCalc.sheetfieldsxlat.length; i++) { // do sheet values, too\r\n      v = sheetobj.attribs[SocialCalc.sheetfieldsxlat[i]];\r\n      if (v) {\r\n         xlt[SocialCalc.sheetfieldsxlatxlt[i]+\"sUsed\"][v] = 1;\r\n         }\r\n      }\r\n\r\n   a = {\"height\": 1, \"hide\": 1}; // look at explicit row settings\r\n   for (v in a) {\r\n      for (cr in sheetobj.rowattribs[v]) {\r\n         if (cr > maxrow) maxrow = cr;\r\n         }\r\n      }\r\n   a = {\"hide\": 1, \"width\": 1}; // look at explicit col settings\r\n   for (v in a) {\r\n      for (coord in sheetobj.colattribs[v]) {\r\n         cr = SocialCalc.coordToCr(coord+\"1\");\r\n         if (cr.col > maxcol) maxcol = cr.col;\r\n         }\r\n      }\r\n\r\n   for (an=0; an<alist.length; an++) { // go through the attribs we want\r\n      a = alist[an];\r\n\r\n      newa = [];\r\n      used = xlt[a+\"sUsed\"];\r\n      for (v in used) {\r\n         newa.push(sheetobj[a+\"s\"][v]);\r\n         }\r\n      newa.sort();\r\n      newa.unshift(\"\");\r\n\r\n      newxlat = [\"\"];\r\n      ahash = sheetobj[a+\"hash\"];\r\n\r\n      for (i=1; i<newa.length; i++) {\r\n         newxlat[ahash[newa[i]]] = i;\r\n         }\r\n\r\n      xlt[a+\"sxlat\"] = newxlat;\r\n      xlt[\"new\"+a+\"s\"] = newa;\r\n\r\n      }\r\n\r\n   xlt.maxrow = maxrow || 1;\r\n   xlt.maxcol = maxcol || 1;\r\n\r\n   sheetobj.xlt = xlt; // leave for use by caller\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.EncodeCellAttributes(sheet, coord)\r\n//\r\n// Returns the cell's attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n\r\nSocialCalc.EncodeCellAttributes = function(sheet, coord) {\r\n\r\n   var value, i, b, bb;\r\n   var result = {};\r\n\r\n   var InitAttrib = function(name) {\r\n      result[name] = {def: true, val: \"\"};\r\n      }\r\n\r\n   var InitAttribs = function(namelist) {\r\n      for (var i=0; i<namelist.length; i++) {\r\n         InitAttrib(namelist[i]);\r\n         }\r\n      }\r\n\r\n   var SetAttrib = function(name, v) {\r\n      result[name].def = false;\r\n      result[name].val = v || \"\";\r\n      }\r\n\r\n   var SetAttribStar = function(name, v) {\r\n      if (v==\"*\") return;\r\n      result[name].def = false;\r\n      result[name].val = v;\r\n      }\r\n\r\n   var cell = sheet.GetAssuredCell(coord);\r\n\r\n   // cellformat: alignhoriz\r\n\r\n   InitAttrib(\"alignhoriz\");\r\n   if (cell.cellformat) {\r\n      SetAttrib(\"alignhoriz\", sheet.cellformats[cell.cellformat]);\r\n      }\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\r\n   if (cell.layout) {\r\n      parts = sheet.layouts[cell.layout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\r\n      SetAttribStar(\"padtop\", parts[1]);\r\n      SetAttribStar(\"padright\", parts[2]);\r\n      SetAttribStar(\"padbottom\", parts[3]);\r\n      SetAttribStar(\"padleft\", parts[4]);\r\n      SetAttribStar(\"alignvert\", parts[5]);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\r\n   if (cell.font) {\r\n      parts = sheet.fonts[cell.font].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\r\n      SetAttribStar(\"fontfamily\", parts[3]);\r\n      SetAttribStar(\"fontsize\", parts[2]);\r\n      SetAttribStar(\"fontlook\", parts[1]);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   InitAttrib(\"textcolor\");\r\n   if (cell.color) {\r\n      SetAttrib(\"textcolor\", sheet.colors[cell.color]);\r\n      }\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   InitAttrib(\"bgcolor\");\r\n   if (cell.bgcolor) {\r\n      SetAttrib(\"bgcolor\", sheet.colors[cell.bgcolor]);\r\n      }\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   InitAttribs([\"numberformat\", \"textformat\"]);\r\n   if (cell.nontextvalueformat) {\r\n      SetAttrib(\"numberformat\", sheet.valueformats[cell.nontextvalueformat]);\r\n      }\r\n   if (cell.textvalueformat) {\r\n      SetAttrib(\"textformat\", sheet.valueformats[cell.textvalueformat]);\r\n      }\r\n\r\n   // merges: colspan, rowspan\r\n\r\n   InitAttribs([\"colspan\", \"rowspan\"]);\r\n   SetAttrib(\"colspan\", cell.colspan || 1);\r\n   SetAttrib(\"rowspan\", cell.rowspan || 1);\r\n\r\n   // borders: bXthickness, bXstyle, bXcolor for X = t, r, b, and l\r\n\r\n   for (i=0; i<4; i++) {\r\n      b = \"trbl\".charAt(i);\r\n      bb = \"b\"+b;\r\n      InitAttrib(bb);\r\n      SetAttrib(bb, cell[bb] ? sheet.borderstyles[cell[bb]] : \"\");\r\n      InitAttrib(bb+\"thickness\");\r\n      InitAttrib(bb+\"style\");\r\n      InitAttrib(bb+\"color\");\r\n      if (cell[bb]) {\r\n         parts = sheet.borderstyles[cell[bb]].match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\r\n         SetAttrib(bb+\"thickness\", parts[1]);\r\n         SetAttrib(bb+\"style\", parts[2]);\r\n         SetAttrib(bb+\"color\", parts[3]);\r\n         }\r\n      }\r\n \r\n   // misc: cssc, csss, mod\r\n\r\n   InitAttribs([\"cssc\", \"csss\", \"mod\"]);\r\n   SetAttrib(\"cssc\", cell.cssc || \"\"); \r\n   SetAttrib(\"csss\", cell.csss || \"\");\r\n   SetAttrib(\"mod\", cell.mod || \"n\");\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.EncodeSheetAttributes(sheet)\r\n//\r\n// Returns the sheet's attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n\r\nSocialCalc.EncodeSheetAttributes = function(sheet) {\r\n\r\n   var value;\r\n   var attribs = sheet.attribs;\r\n   var result = {};\r\n\r\n   var InitAttrib = function(name) {\r\n      result[name] = {def: true, val: \"\"};\r\n      }\r\n\r\n   var InitAttribs = function(namelist) {\r\n      for (var i=0; i<namelist.length; i++) {\r\n         InitAttrib(namelist[i]);\r\n         }\r\n      }\r\n\r\n   var SetAttrib = function(name, v) {\r\n      result[name].def = false;\r\n      result[name].val = v || value;\r\n      }\r\n\r\n   var SetAttribStar = function(name, v) {\r\n      if (v==\"*\") return;\r\n      result[name].def = false;\r\n      result[name].val = v;\r\n      }\r\n\r\n   // sizes: colwidth, rowheight\r\n\r\n   InitAttrib(\"colwidth\");\r\n   if (attribs.defaultcolwidth) {\r\n      SetAttrib(\"colwidth\", attribs.defaultcolwidth);\r\n      }\r\n\r\n   InitAttrib(\"rowheight\");\r\n   if (attribs.rowheight) {\r\n      SetAttrib(\"rowheight\", attribs.defaultrowheight);\r\n      }\r\n\r\n   // cellformat: textalignhoriz, numberalignhoriz\r\n\r\n   InitAttrib(\"textalignhoriz\");\r\n   if (attribs.defaulttextformat) {\r\n      SetAttrib(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat]);\r\n      }\r\n\r\n   InitAttrib(\"numberalignhoriz\");\r\n   if (attribs.defaultnontextformat) {\r\n      SetAttrib(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat]);\r\n      }\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   InitAttribs([\"alignvert\", \"padtop\", \"padright\", \"padbottom\", \"padleft\"]);\r\n   if (attribs.defaultlayout) {\r\n      parts = sheet.layouts[attribs.defaultlayout].match(/^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/);\r\n      SetAttribStar(\"padtop\", parts[1]);\r\n      SetAttribStar(\"padright\", parts[2]);\r\n      SetAttribStar(\"padbottom\", parts[3]);\r\n      SetAttribStar(\"padleft\", parts[4]);\r\n      SetAttribStar(\"alignvert\", parts[5]);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   InitAttribs([\"fontfamily\", \"fontlook\", \"fontsize\"]);\r\n   if (attribs.defaultfont) {\r\n      parts = sheet.fonts[attribs.defaultfont].match(/^(\\*|\\S+? \\S+?) (\\S+?) (\\S.*)$/);\r\n      SetAttribStar(\"fontfamily\", parts[3]);\r\n      SetAttribStar(\"fontsize\", parts[2]);\r\n      SetAttribStar(\"fontlook\", parts[1]);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   InitAttrib(\"textcolor\");\r\n   if (attribs.defaultcolor) {\r\n      SetAttrib(\"textcolor\", sheet.colors[attribs.defaultcolor]);\r\n      }\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   InitAttrib(\"bgcolor\");\r\n   if (attribs.defaultbgcolor) {\r\n      SetAttrib(\"bgcolor\", sheet.colors[attribs.defaultbgcolor]);\r\n      }\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   InitAttribs([\"numberformat\", \"textformat\"]);\r\n   if (attribs.defaultnontextvalueformat) {\r\n      SetAttrib(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat]);\r\n      }\r\n   if (attribs.defaulttextvalueformat) {\r\n      SetAttrib(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat]);\r\n      }\r\n\r\n   // recalc: recalc\r\n\r\n   InitAttrib(\"recalc\");\r\n   if (attribs.recalc) {\r\n      SetAttrib(\"recalc\", attribs.recalc);\r\n      }\r\n\r\n   // usermaxcol, usermaxrow\r\n   InitAttrib(\"usermaxcol\");\r\n   if (attribs.usermaxcol) {\r\n      SetAttrib(\"usermaxcol\", attribs.usermaxcol);\r\n      }\r\n   InitAttrib(\"usermaxrow\");\r\n   if (attribs.usermaxrow) {\r\n      SetAttrib(\"usermaxrow\", attribs.usermaxrow);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// cmdstr = SocialCalc.DecodeCellAttributes(sheet, coord, attribs, range)\r\n//\r\n// Takes cell attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n// and returns the sheet commands to make the actual attributes correspond.\r\n// Returns a non-null string if any commands are to be executed, null otherwise.\r\n//\r\n// If range is provided, the commands are executed on the whole range.\r\n//\r\n\r\nSocialCalc.DecodeCellAttributes = function(sheet, coord, newattribs, range) {\r\n\r\n   var value, b, bb;\r\n\r\n   var cell = sheet.GetAssuredCell(coord);\r\n\r\n   var changed = false;\r\n\r\n   var CheckChanges = function(attribname, oldval, cmdname) {\r\n      var val;\r\n      if (newattribs[attribname]) {\r\n         if (newattribs[attribname].def) {\r\n            val = \"\";\r\n            }\r\n         else {\r\n            val = newattribs[attribname].val;\r\n            }\r\n         if (val != (oldval || \"\")) {\r\n            DoCmd(cmdname+\" \"+val);\r\n            }\r\n         }\r\n      }\r\n\r\n   var cmdstr = \"\";\r\n\r\n   var DoCmd = function(str) {\r\n      if (cmdstr) cmdstr += \"\\n\";\r\n      cmdstr += \"set \"+(range || coord)+\" \"+str;\r\n      changed = true;\r\n      }\r\n\r\n   // cellformat: alignhoriz\r\n\r\n   CheckChanges(\"alignhoriz\", sheet.cellformats[cell.cellformat], \"cellformat\");\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\r\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\r\n      value = \"padding:\" +\r\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\r\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\r\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\r\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\r\n         \";vertical-align:\" +\r\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.layouts[cell.layout] || \"\")) {\r\n      DoCmd(\"layout \"+value);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\r\n      value =\r\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\r\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\r\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.fonts[cell.font] || \"\")) {\r\n      DoCmd(\"font \"+value);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   CheckChanges(\"textcolor\", sheet.colors[cell.color], \"color\");\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   CheckChanges(\"bgcolor\", sheet.colors[cell.bgcolor], \"bgcolor\");\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   CheckChanges(\"numberformat\", sheet.valueformats[cell.nontextvalueformat], \"nontextvalueformat\");\r\n\r\n   CheckChanges(\"textformat\", sheet.valueformats[cell.textvalueformat], \"textvalueformat\");\r\n\r\n   // merges: colspan, rowspan - NOT HANDLED: IGNORED!\r\n\r\n   // borders: bX for X = t, r, b, and l; bXthickness, bXstyle, bXcolor ignored\r\n\r\n   for (i=0; i<4; i++) {\r\n      b = \"trbl\".charAt(i);\r\n      bb = \"b\"+b;\r\n      CheckChanges(bb, sheet.borderstyles[cell[bb]], bb);\r\n      }\r\n\r\n   // misc: cssc, csss, mod\r\n\r\n   CheckChanges(\"cssc\", cell.cssc, \"cssc\");\r\n\r\n   CheckChanges(\"csss\", cell.csss, \"csss\");\r\n\r\n   if (newattribs.mod) {\r\n      if (newattribs.mod.def) {\r\n         value = \"n\";\r\n         }\r\n      else {\r\n         value = newattribs.mod.val;\r\n         }\r\n      if (value != (cell.mod || \"n\")) {\r\n         if (value==\"n\") value = \"\"; // restrict to \"y\" and \"\" normally\r\n         DoCmd(\"mod \"+value);\r\n         }\r\n      }\r\n\r\n   // if any changes return command(s)\r\n\r\n   if (changed) {\r\n       return cmdstr;\r\n      }\r\n   else {\r\n      return null;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// changed = SocialCalc.DecodeSheetAttributes(sheet, newattribs)\r\n//\r\n// Takes sheet attributes in an object, each in the following form:\r\n//\r\n//    attribname: {def: true/false, val: full-value}\r\n//\r\n// and returns the sheet commands to make the actual attributes correspond.\r\n// Returns a non-null string if any commands were executed, null otherwise.\r\n//\r\n\r\nSocialCalc.DecodeSheetAttributes = function(sheet, newattribs) {\r\n\r\n   var value;\r\n   var attribs = sheet.attribs;\r\n   var changed = false;\r\n\r\n   var CheckChanges = function(attribname, oldval, cmdname) {\r\n      var val;\r\n      if (newattribs[attribname]) {\r\n         if (newattribs[attribname].def) {\r\n            val = \"\";\r\n            }\r\n         else {\r\n            val = newattribs[attribname].val;\r\n            }\r\n         if (val != (oldval || \"\")) {\r\n            DoCmd(cmdname+\" \"+val);\r\n            }\r\n         }\r\n      }\r\n\r\n   var cmdstr = \"\";\r\n\r\n   var DoCmd = function(str) {\r\n      if (cmdstr) cmdstr += \"\\n\";\r\n      cmdstr += \"set sheet \"+str;\r\n      changed = true;\r\n      }\r\n\r\n   // sizes: colwidth, rowheight\r\n\r\n   CheckChanges(\"colwidth\", attribs.defaultcolwidth, \"defaultcolwidth\");\r\n\r\n   CheckChanges(\"rowheight\", attribs.defaultrowheight, \"defaultrowheight\");\r\n\r\n   // cellformat: textalignhoriz, numberalignhoriz\r\n\r\n   CheckChanges(\"textalignhoriz\", sheet.cellformats[attribs.defaulttextformat], \"defaulttextformat\");\r\n\r\n   CheckChanges(\"numberalignhoriz\", sheet.cellformats[attribs.defaultnontextformat], \"defaultnontextformat\");\r\n\r\n   // layout: alignvert, padtop, padright, padbottom, padleft\r\n\r\n   if (!newattribs.alignvert.def || !newattribs.padtop.def || !newattribs.padright.def ||\r\n       !newattribs.padbottom.def || !newattribs.padleft.def) {\r\n      value = \"padding:\" +\r\n         (newattribs.padtop.def ? \"* \" : newattribs.padtop.val + \" \") +\r\n         (newattribs.padright.def ? \"* \" : newattribs.padright.val + \" \") +\r\n         (newattribs.padbottom.def ? \"* \" : newattribs.padbottom.val + \" \") +\r\n         (newattribs.padleft.def ? \"*\" : newattribs.padleft.val) +\r\n         \";vertical-align:\" +\r\n         (newattribs.alignvert.def ? \"*;\" : newattribs.alignvert.val+\";\");\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.layouts[attribs.defaultlayout] || \"\")) {\r\n      DoCmd(\"defaultlayout \"+value);\r\n      }\r\n\r\n   // font: fontfamily, fontlook, fontsize\r\n\r\n   if (!newattribs.fontlook.def || !newattribs.fontsize.def || !newattribs.fontfamily.def) {\r\n      value =\r\n         (newattribs.fontlook.def ? \"* \" : newattribs.fontlook.val + \" \") +\r\n         (newattribs.fontsize.def ? \"* \" : newattribs.fontsize.val + \" \") +\r\n         (newattribs.fontfamily.def ? \"*\" : newattribs.fontfamily.val);\r\n      }\r\n   else {\r\n      value = \"\";\r\n      }\r\n\r\n   if (value != (sheet.fonts[attribs.defaultfont] || \"\")) {\r\n      DoCmd(\"defaultfont \"+value);\r\n      }\r\n\r\n   // color: textcolor\r\n\r\n   CheckChanges(\"textcolor\", sheet.colors[attribs.defaultcolor], \"defaultcolor\");\r\n\r\n   // bgcolor: bgcolor\r\n\r\n   CheckChanges(\"bgcolor\", sheet.colors[attribs.defaultbgcolor], \"defaultbgcolor\");\r\n\r\n   // formatting: numberformat, textformat\r\n\r\n   CheckChanges(\"numberformat\", sheet.valueformats[attribs.defaultnontextvalueformat], \"defaultnontextvalueformat\");\r\n\r\n   CheckChanges(\"textformat\", sheet.valueformats[attribs.defaulttextvalueformat], \"defaulttextvalueformat\");\r\n\r\n   // recalc: recalc\r\n\r\n   CheckChanges(\"recalc\", sheet.attribs.recalc, \"recalc\");\r\n\r\n   // usermaxcol, usermaxrow\r\n\r\n   CheckChanges(\"usermaxcol\", sheet.attribs.usermaxcol, \"usermaxcol\");\r\n   CheckChanges(\"usermaxrow\", sheet.attribs.usermaxrow, \"usermaxrow\");\r\n\r\n   // if any changes return command(s)\r\n\r\n   if (changed) {\r\n       return cmdstr;\r\n      }\r\n   else {\r\n      return null;\r\n      }\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Sheet command routines\r\n//\r\n// *************************************\r\n\r\n//\r\n// SocialCalc.SheetCommandInfo - object with information used during command execution\r\n//\r\n\r\nSocialCalc.SheetCommandInfo = function(sheetobj) {\r\n\r\n   this.sheetobj = sheetobj; // sheet being operated on\r\n   this.timerobj = null; // used for timeslicing\r\n   this.firsttimerdelay = 50; // wait before starting cmds (for Chrome - to give time to update)\r\n   this.timerdelay = 1; // wait between slices\r\n   this.maxtimeslice = 100; // do another slice after this many milliseconds\r\n   this.saveundo = false; // arg for ExecuteSheetCommand\r\n\r\n   this.CmdExtensionCallbacks = {}; // for startcmdextension, in form: cmdname, {func:function(cmdname, data, sheet, SocialCalc.Parse object, saveundo), data:whatever}\r\n\r\n//   statuscallback: null, // called during execution - obsolete: use sheet obj's\r\n//   statuscallbackparams: null\r\n\r\n   };\r\n\r\n//\r\n// SocialCalc.ScheduleSheetCommands\r\n//\r\n// statuscallback is called at the beginning (cmdstart) and end (cmdend).\r\n//\r\n\r\nSocialCalc.ScheduleSheetCommands = function(sheet, cmdstr, saveundo) {\r\n\r\n   var sci = sheet.sci;\r\n\r\n   var parseobj = new SocialCalc.Parse(cmdstr);\r\n\r\n   if (sci.sheetobj.statuscallback) { // notify others if requested\r\n      sheet.statuscallback(sci, \"cmdstart\", \"\", sci.sheetobj.statuscallbackparams);\r\n      }\r\n\r\n   if (saveundo) {\r\n      sci.sheetobj.changes.PushChange(\"\"); // add a step to undo stack\r\n      }\r\n\r\n   sci.timerobj = window.setTimeout(function() {\r\n      SocialCalc.SheetCommandsTimerRoutine(sci, parseobj, saveundo);\r\n   }, sci.firsttimerdelay);\r\n\r\n   }\r\n\r\nSocialCalc.SheetCommandsTimerRoutine = function(sci, parseobj, saveundo) {\r\n\r\n   var errortext;\r\n   var starttime = new Date();\r\n   sci.timerobj = null;\r\n\r\n   while (!parseobj.EOF()) { // go through all commands (separated by newlines)\r\n\r\n      errortext = SocialCalc.ExecuteSheetCommand(sci.sheetobj, parseobj, saveundo);\r\n      // Error - Use  log on server   OR  alert on client \r\n      if (errortext) {\r\n        if (typeof(alert) == \"function\")  {\r\n          alert(errortext);\r\n        } else {\r\n          console.log(errortext)\r\n        }\r\n      }\r\n\r\n      parseobj.NextLine();\r\n\r\n      if (((new Date()) - starttime) >= sci.maxtimeslice) { // if taking too long, give up CPU for a while\r\n         sci.timerobj = window.setTimeout(function() {\r\n            SocialCalc.SheetCommandsTimerRoutine(sci, parseobj, saveundo);\r\n         }, sci.timerdelay);\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (sci.sheetobj.statuscallback) { // notify others if requested\r\n      sci.sheetobj.statuscallback(sci, \"cmdend\", \"\", sci.sheetobj.statuscallbackparams);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// errortext = SocialCalc.ExecuteSheetCommand(sheet, cmd, saveundo)\r\n//\r\n// cmd is a SocialCalc.Parse object.\r\n//\r\n// Executes commands that modify the sheet data.\r\n// Sets sheet \"needsrecalc\" as needed.\r\n// Sets sheet \"changedrendervalues\" as needed.\r\n//\r\n// The cmd string may be multiple commands, separated by newlines. In that case\r\n// only one \"step\" is put on the undo stack representing all the commands.\r\n// Note that because of this, in \"set A1 text ...\" and \"set A1 comment ...\" text is\r\n// treated as encoded (newline => \\n, \\ => \\b, : => \\c).\r\n//\r\n// The commands are in the forms:\r\n//\r\n//    set sheet attributename value (plus lastcol and lastrow)\r\n//    set 22 attributename value\r\n//    set B attributename value\r\n//    set A1 attributename value1 value2... (see each attribute in code for details)\r\n//    set A1:B5 attributename value1 value2...\r\n//    erase/copy/cut/paste/fillright/filldown A1:B5 all/formulas/format\r\n//    loadclipboard save-encoded-clipboard-data\r\n//    clearclipboard\r\n//    merge C3:F3\r\n//    unmerge C3\r\n//    insertcol/insertrow C5\r\n//    deletecol/deleterow C5:E7\r\n//    movepaste/moveinsert A1:B5 A8 all/formulas/format (if insert, destination must be in same rows or columns or else paste done)\r\n//    sort cr1:cr2 col1 up/down col2 up/down col3 up/down\r\n//    name define NAME definition\r\n//    name desc NAME description\r\n//    name delete NAME\r\n//    recalc\r\n//    redisplay\r\n//    changedrendervalues\r\n//    startcmdextension extension rest-of-command\r\n//    sendemail ??? eddy ???\r\n//\r\n// If saveundo is true, then undo information is saved in sheet.changes.\r\n//\r\n\r\nSocialCalc.ExecuteSheetCommand = function(sheet, cmd, saveundo) {\r\n\r\n   var cmdstr, cmd1, rest, what, attrib, num, pos, pos2, errortext, undostart, val;\r\n   var cr1, cr2, col, row, cr, cell, newcell;\r\n   var fillright, rowstart, colstart, crbase, rowoffset, coloffset, basecell;\r\n   var clipsheet, cliprange, numcols, numrows, attribtable;\r\n   var colend, rowend, newcolstart, newrowstart, newcolend, newrowend, rownext, colnext, colthis, cellnext;\r\n   var lastrow, lastcol, rowbefore, colbefore, oldformula, oldcr;\r\n   var cols, dirs, lastsortcol, i, sortlist, sortcells, sortvalues, sorttypes;\r\n   var sortfunction, slen, valtype, originalrow, sortedcr;\r\n   var name, v1, v2;\r\n   var cmdextension;\r\n   var col, row, editor, undoNum, trackLine;\r\n\r\n   var attribs = sheet.attribs;\r\n   var changes = sheet.changes;\r\n   var cellProperties = SocialCalc.CellProperties;\r\n   var scc = SocialCalc.Constants;\r\n   var cellChanged = false;\r\n\r\n   var ParseRange =\r\n      function() {\r\n         var prange = SocialCalc.ParseRange(what);\r\n         cr1 = prange.cr1;\r\n         cr2 = prange.cr2;\r\n         if (cr2.col > attribs.lastcol) attribs.lastcol = cr2.col;\r\n         if (cr2.row > attribs.lastrow) attribs.lastrow = cr2.row;\r\n         };\r\n\r\n   errortext = \"\";\r\n\r\n   cmdstr = cmd.RestOfStringNoMove();\r\n   if (saveundo) {\r\n      sheet.changes.AddDo(cmdstr);\r\n      }\r\n\r\n   cmd1 = cmd.NextToken();\r\n   switch (cmd1) {\r\n\r\n      case \"set\":\r\n         what = cmd.NextToken();\r\n         attrib = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         undostart = \"set \"+what+\" \"+attrib;\r\n\r\n         if (what==\"sheet\") {\r\n            sheet.renderneeded = true;\r\n            switch (attrib) {\r\n               case \"defaultcolwidth\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\r\n                  attribs[attrib] = rest;\r\n                  break;\r\n               case \"defaultcolor\":\r\n               case \"defaultbgcolor\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"color\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"color\", rest);\r\n                  break;\r\n               case \"defaultlayout\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"layout\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"layout\", rest);\r\n                  break;\r\n               case \"defaultfont\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"font\", attribs[attrib]));\r\n                  if (rest==\"* * *\") rest = \"\"; // all default\r\n                  attribs[attrib] = sheet.GetStyleNum(\"font\", rest);\r\n                  break;\r\n               case \"defaulttextformat\":\r\n               case \"defaultnontextformat\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"cellformat\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"cellformat\", rest);\r\n                  break;\r\n               case \"defaulttextvalueformat\":\r\n               case \"defaultnontextvalueformat\":\r\n                  if (saveundo) changes.AddUndo(undostart, sheet.GetStyleString(\"valueformat\", attribs[attrib]));\r\n                  attribs[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\r\n                  for (cr in sheet.cells) { // forget all cached display strings\r\n                     delete sheet.cells[cr].displaystring;\r\n                     }\r\n                  break;\r\n               case \"lastcol\":\r\n               case \"lastrow\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\r\n                  num = rest-0;\r\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 1;\r\n                  break;\r\n               case \"recalc\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]);\r\n                  if (rest == \"off\") {\r\n                     attribs.recalc = rest; // manual recalc, not auto\r\n                     }\r\n                  else { // all values other than \"off\" mean \"on\"\r\n                     delete attribs.recalc;\r\n                     }\r\n                  break;\r\n               case \"usermaxcol\":\r\n               case \"usermaxrow\":\r\n                  if (saveundo) changes.AddUndo(undostart, attribs[attrib]-0);\r\n                  num = rest-0;\r\n                  if (typeof num == \"number\") attribs[attrib] = num > 0 ? num : 0;\r\n                  break;\r\n               default:\r\n                  errortext = scc.s_escUnknownSheetCmd+cmdstr;\r\n                  break;\r\n               }\r\n            }\r\n\r\n         else if (/^[a-z]{1,2}(:[a-z]{1,2})?$/i.test(what)) { // col attributes\r\n            sheet.renderneeded = true;\r\n            \r\n            what = what.toUpperCase();\r\n            pos = what.indexOf(\":\");\r\n            if (pos>=0) {\r\n               cr1 = SocialCalc.coordToCr(what.substring(0,pos)+\"1\");\r\n               cr2 = SocialCalc.coordToCr(what.substring(pos+1)+\"1\");\r\n               }\r\n            else {\r\n               cr1 = SocialCalc.coordToCr(what+\"1\");\r\n               cr2 = cr1;\r\n               }\r\n            for (col=cr1.col; col <= cr2.col; col++) {\r\n               if (attrib==\"width\") {\r\n                  cr = SocialCalc.rcColname(col);\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" width\", sheet.colattribs.width[cr]);\r\n                  if (rest.length > 0 ) {\r\n                     sheet.colattribs.width[cr] = rest;\r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs.width[cr];\r\n                     }\r\n                  }\r\n               else if (attrib==\"hide\") {\r\n                  sheet.hiddencolrow = \"col\";\r\n                  cr = SocialCalc.rcColname(col);\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" hide\", sheet.colattribs.hide[cr]);\r\n                  if (rest.length > 0) {\r\n                     sheet.colattribs.hide[cr] = rest; \r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs.hide[cr];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         else if (/^\\d+(:\\d+)?$/i.test(what)) { // row attributes\r\n            sheet.renderneeded = true;\r\n            what = what.toUpperCase();\r\n            pos = what.indexOf(\":\");\r\n            if (pos>=0) {\r\n               cr1 = SocialCalc.coordToCr(\"A\"+what.substring(0,pos));\r\n               cr2 = SocialCalc.coordToCr(\"A\"+what.substring(pos+1));\r\n               }\r\n            else {\r\n               cr1 = SocialCalc.coordToCr(\"A\"+what);\r\n               cr2 = cr1;\r\n               }\r\n            for (row=cr1.row; row <= cr2.row; row++) {\r\n               if (attrib==\"height\") {\r\n                  if (saveundo) changes.AddUndo(\"set \"+row+\" height\", sheet.rowattribs.height[row]);\r\n                  if (rest.length > 0 ) {\r\n                     sheet.rowattribs.height[row] = rest;\r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs.height[row];\r\n                     }\r\n                  }\r\n               else if (attrib==\"hide\") {\r\n                  sheet.hiddencolrow = \"row\";\r\n                  if (saveundo) changes.AddUndo(\"set \"+row+\" hide\", sheet.rowattribs.hide[row]);\r\n                  if (rest.length > 0) {\r\n                     sheet.rowattribs.hide[row] = rest; \r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs.hide[row];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         else if (/^[a-z]{1,2}\\d+(:[a-z]{1,2}\\d+)?$/i.test(what)) { // cell attributes\r\n           cellChanged = true;\r\n            ParseRange();\r\n            if (cr1.row!=cr2.row || cr1.col!=cr2.col || sheet.celldisplayneeded || sheet.renderneeded) { // not one cell\r\n               sheet.renderneeded = true;\r\n               sheet.celldisplayneeded = \"\";\r\n               }\r\n            else {\r\n               sheet.celldisplayneeded = SocialCalc.crToCoord(cr1.col, cr1.row);\r\n               }\r\n            for (row=cr1.row; row <= cr2.row; row++) {\r\n               for (col=cr1.col; col <= cr2.col; col++) {\r\n                  cr = SocialCalc.crToCoord(col, row);\r\n                  cell=sheet.GetAssuredCell(cr);\r\n                  if (cell.readonly && attrib!=\"readonly\") continue;\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n                  if (attrib==\"value\") { // set coord value type numeric-value\r\n                     pos = rest.indexOf(\" \");\r\n                     cell.datavalue = rest.substring(pos+1)-0;\r\n                     delete cell.errors;\r\n                     cell.datatype = \"v\";\r\n                     cell.valuetype = rest.substring(0,pos);\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"text\") { // set coord text type text-value\r\n                     pos = rest.indexOf(\" \");\r\n                     cell.datavalue = SocialCalc.decodeFromSave(rest.substring(pos+1));\r\n                     delete cell.errors;\r\n                     cell.datatype = \"t\";\r\n                     cell.valuetype = rest.substring(0,pos);\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"formula\") { // set coord formula formula-body-less-initial-=\r\n                     cell.datavalue = 0; // until recalc\r\n                     delete cell.errors;\r\n                     cell.datatype = \"f\";\r\n                     if(SocialCalc._app && cell.valuetype != \"e#N/A\") cell.prevvaluetype = cell.valuetype;  // repaint when widgets added/removed \r\n                     cell.valuetype = \"e#N/A\"; // until recalc\r\n                     cell.formula = rest;\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"constant\") { // set coord constant type numeric-value source-text\r\n                     pos = rest.indexOf(\" \");\r\n                     pos2 = rest.substring(pos+1).indexOf(\" \");\r\n                     cell.datavalue = rest.substring(pos+1,pos+1+pos2)-0;\r\n                     cell.valuetype = rest.substring(0,pos);\r\n                     if (cell.valuetype.charAt(0)==\"e\") { // error\r\n                        cell.errors = cell.valuetype.substring(1);\r\n                        }\r\n                     else {\r\n                        delete cell.errors;\r\n                        }\r\n                     cell.datatype = \"c\";\r\n                     cell.formula = rest.substring(pos+pos2+2);\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"empty\") { // erase value\r\n                     cell.datavalue = \"\";\r\n                     delete cell.errors;\r\n                     cell.datatype = null;\r\n                     cell.formula = \"\";\r\n                     cell.valuetype = \"b\";\r\n                     delete cell.displaystring;\r\n                     delete cell.parseinfo;\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (attrib==\"all\") { // set coord all :this:val1:that:val2...\r\n                     if (rest.length>0) {\r\n                        cell = new SocialCalc.Cell(cr);\r\n                        sheet.CellFromStringParts(cell, rest.split(\":\"), 1);\r\n                        sheet.cells[cr] = cell;\r\n                        }\r\n                     else {\r\n                        delete sheet.cells[cr];\r\n                        }\r\n                     attribs.needsrecalc = \"yes\";\r\n                     }\r\n                  else if (/^b[trbl]$/.test(attrib)) { // set coord bt 1px solid black\r\n                     cell[attrib] = sheet.GetStyleNum(\"borderstyle\", rest);\r\n                     sheet.renderneeded = true; // affects more than just one cell\r\n                     }\r\n                  else if (attrib==\"color\" || attrib==\"bgcolor\") {\r\n                     cell[attrib] = sheet.GetStyleNum(\"color\", rest);\r\n                     }\r\n                  else if (attrib==\"layout\" || attrib==\"cellformat\") {\r\n                     cell[attrib] = sheet.GetStyleNum(attrib, rest);\r\n                     }\r\n                  else if (attrib==\"font\") { // set coord font style weight size family\r\n                     if (rest==\"* * *\") rest = \"\";\r\n                     cell[attrib] = sheet.GetStyleNum(\"font\", rest);\r\n                     }\r\n                  else if (attrib==\"textvalueformat\" || attrib==\"nontextvalueformat\") {\r\n                     cell[attrib] = sheet.GetStyleNum(\"valueformat\", rest);\r\n                     delete cell.displaystring;\r\n                     }\r\n                  else if (attrib==\"cssc\") {\r\n                     rest = rest.replace(/[^a-zA-Z0-9\\-]/g, \"\");\r\n                     cell.cssc = rest;\r\n                     }\r\n                  else if (attrib==\"csss\") {\r\n                     rest = rest.replace(/\\n/g, \"\");\r\n                     cell.csss = rest;\r\n                     }\r\n                  else if (attrib==\"mod\") {\r\n                     rest = rest.replace(/[^yY]/g, \"\").toLowerCase();\r\n                     cell.mod = rest;\r\n                     }\r\n                  else if (attrib==\"comment\") {\r\n                     cell.comment = SocialCalc.decodeFromSave(rest);\r\n                     }\r\n                  else if (attrib==\"readonly\") {\r\n                     cell.readonly = rest.toLowerCase()==\"yes\";\r\n                     }\r\n                  else {\r\n                     errortext = scc.s_escUnknownSetCoordCmd+cmdstr;\r\n                     }\r\n                  }\r\n               }\r\n\r\n            }\r\n         break;\r\n\r\n      case \"merge\":\r\n         sheet.renderneeded = true;\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         cell=sheet.GetAssuredCell(cr1.coord);\r\n         if (cell.readonly) break;\r\n         if (saveundo) changes.AddUndo(\"unmerge \"+cr1.coord);\r\n\r\n         if (cr2.col > cr1.col) cell.colspan = cr2.col - cr1.col + 1;\r\n         else delete cell.colspan;\r\n         if (cr2.row > cr1.row) cell.rowspan = cr2.row - cr1.row + 1;\r\n         else delete cell.rowspan;\r\n\r\n         sheet.changedrendervalues = true;\r\n\r\n         break;\r\n\r\n      case \"unmerge\":\r\n         sheet.renderneeded = true;\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         cell=sheet.GetAssuredCell(cr1.coord);\r\n         if (cell.readonly) break;\r\n         if (saveundo) changes.AddUndo(\"merge \"+cr1.coord+\":\"+SocialCalc.crToCoord(cr1.col+(cell.colspan||1)-1, cr1.row+(cell.rowspan||1)-1));\r\n\r\n         delete cell.colspan;\r\n         delete cell.rowspan;\r\n\r\n         sheet.changedrendervalues = true;\r\n\r\n         break;\r\n\r\n      case \"erase\":\r\n      case \"cut\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         if (cmd1==\"cut\") { // save copy of whole thing before erasing\r\n            if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n            SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\r\n            }\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) {\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n               if (rest==\"all\") {\r\n                  delete sheet.cells[cr];\r\n                  }\r\n               else if (rest == \"formulas\") {\r\n                  cell.datavalue = \"\";\r\n                  cell.datatype = null;\r\n                  cell.formula = \"\";\r\n                  cell.valuetype = \"b\";\r\n                  delete cell.errors;\r\n                  delete cell.displaystring;\r\n                  delete cell.parseinfo;\r\n                  if (cell.comment) { // comments are considered content for erasing\r\n                     delete cell.comment;\r\n                     }\r\n                  }\r\n               else if (rest == \"formats\") {\r\n                  newcell = new SocialCalc.Cell(cr); // create a new cell without attributes\r\n                  newcell.datavalue = cell.datavalue; // copy existing values\r\n                  newcell.datatype = cell.datatype;\r\n                  newcell.formula = cell.formula;\r\n                  newcell.valuetype = cell.valuetype;\r\n                  if (cell.comment) {\r\n                     newcell.comment = cell.comment;\r\n                     }\r\n                  sheet.cells[cr] = newcell; // replace\r\n                  }\r\n               }\r\n            }\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"fillright\":\r\n      case \"filldown\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         function increment_amount(down) {\r\n            function valid_datatype(type) {\r\n\t\treturn type == \"v\" || type == \"c\";\r\n            }\r\n            var editor = SocialCalc.GetSpreadsheetControlObject().editor;\r\n            var range = editor.range2;\r\n            var returnval = undefined; \r\n            if (range.hasrange) {\r\n                var startcell, endcell;\r\n                if (down && (range.bottom - range.top == 1) && range.left == range.right) {\r\n                  startcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.top));\r\n                  endcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.bottom));\r\n                  if (valid_datatype(startcell.datatype) && valid_datatype(endcell.datatype)) {\r\n                      returnval =  endcell.datavalue - startcell.datavalue;\r\n                  }\r\n                } else if (!down && range.left != range.right) {\r\n                  startcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.left, range.top));\r\n                  endcell = sheet.GetAssuredCell(SocialCalc.crToCoord(range.right, range.top));\r\n                  if (valid_datatype(startcell.datatype) && valid_datatype(endcell.datatype)) {\r\n                      returnval =  endcell.datavalue - startcell.datavalue;\r\n\t\t  }\r\n                }\r\n            }\r\n           editor.Range2Remove();\r\n           return returnval;\r\n         }\r\n\t var inc;\r\n         if (cmd1 == \"fillright\") {\r\n            fillright = true;\r\n            rowstart = cr1.row;\r\n            colstart = cr1.col + 1;\r\n\t    inc = increment_amount(false);\r\n            }\r\n         else {\r\n            fillright = false;\r\n            rowstart = cr1.row + 1;\r\n            colstart = cr1.col;\r\n\t    inc = increment_amount(true);\r\n            }\r\n         for (row = rowstart; row <= cr2.row; row++) {\r\n            for (col = colstart; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n               if (fillright) {\r\n                  crbase = SocialCalc.crToCoord(cr1.col, row);\r\n                  coloffset = col - colstart + 1;\r\n                  rowoffset = 0;\r\n                  }\r\n               else {\r\n                  crbase = SocialCalc.crToCoord(col, cr1.row);\r\n                  coloffset = 0;\r\n                  rowoffset = row - rowstart + 1;\r\n                  }\r\n               basecell = sheet.GetAssuredCell(crbase);\r\n               if (rest == \"all\" || rest == \"formats\") {\r\n                  for (attrib in cellProperties) {\r\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     else {\r\n                        cell[attrib] = basecell[attrib];\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"all\" || rest == \"formulas\") {\r\n                  if (inc !== undefined) {\r\n                      cell.datavalue = basecell.datavalue + (fillright ? coloffset : rowoffset)*inc;\r\n                  } else {\r\n                      cell.datavalue = basecell.datavalue;\r\n                  }\r\n                  cell.datatype = basecell.datatype;            \r\n                  cell.valuetype = basecell.valuetype;\r\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\r\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\r\n                     }\r\n                  else {\r\n                     cell.formula = basecell.formula;\r\n                     }\r\n                  delete cell.parseinfo;\r\n                  cell.errors = basecell.errors;\r\n                  }\r\n               delete cell.displaystring;\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"copy\":\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n         SocialCalc.Clipboard.clipboard = SocialCalc.CreateSheetSave(sheet, what);\r\n         break;\r\n\r\n      case \"loadclipboard\":\r\n         rest = cmd.RestOfString();\r\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n         SocialCalc.Clipboard.clipboard = SocialCalc.decodeFromSave(rest);\r\n         break;\r\n\r\n      case \"clearclipboard\":\r\n         if (saveundo) changes.AddUndo(\"loadclipboard\", SocialCalc.encodeForSave(SocialCalc.Clipboard.clipboard));\r\n         SocialCalc.Clipboard.clipboard = \"\";\r\n         break;\r\n\r\n      case \"paste\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n         if (!SocialCalc.Clipboard.clipboard) {\r\n            break;\r\n            }\r\n         clipsheet = new SocialCalc.Sheet(); // load clipboard contents as another sheet\r\n         clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\r\n         cliprange = SocialCalc.ParseRange(clipsheet.copiedfrom);\r\n         coloffset = cr1.col - cliprange.cr1.col; // get sizes, etc.\r\n         rowoffset = cr1.row - cliprange.cr1.row;\r\n         numcols = Math.max(cr2.col - cr1.col + 1, cliprange.cr2.col - cliprange.cr1.col + 1);\r\n         numrows = Math.max(cr2.row - cr1.row + 1, cliprange.cr2.row - cliprange.cr1.row + 1);\r\n         if (cr1.col+numcols-1 > attribs.lastcol) attribs.lastcol = cr1.col+numcols-1;\r\n         if (cr1.row+numrows-1 > attribs.lastrow) attribs.lastrow = cr1.row+numrows-1;\r\n\r\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\r\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n               crbase = SocialCalc.crToCoord(\r\n                  cliprange.cr1.col + ((col-cr1.col) % (cliprange.cr2.col - cliprange.cr1.col + 1)), \r\n                  cliprange.cr1.row + ((row-cr1.row) % (cliprange.cr2.row - cliprange.cr1.row + 1)));\r\n               basecell = clipsheet.GetAssuredCell(crbase);\r\n               if (rest == \"all\" || rest == \"formats\") {\r\n                  for (attrib in cellProperties) {\r\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     else {\r\n                        attribtable = SocialCalc.CellPropertiesTable[attrib];\r\n                        if (attribtable && basecell[attrib]) { // table indexes to expand to strings since other sheet may have diff indexes\r\n                           cell[attrib] = sheet.GetStyleNum(attribtable, clipsheet.GetStyleString(attribtable, basecell[attrib]));\r\n                           }\r\n                        else { // these are not table indexes\r\n                           cell[attrib] = basecell[attrib];\r\n                           }\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"all\" || rest == \"formulas\") {\r\n                  cell.datavalue = basecell.datavalue;\r\n                  cell.datatype = basecell.datatype;            \r\n                  cell.valuetype = basecell.valuetype;\r\n                  if (cell.datatype == \"f\") { // offset relative coords, even in sheet references\r\n                     cell.formula = SocialCalc.OffsetFormulaCoords(basecell.formula, coloffset, rowoffset);\r\n                     }\r\n                  else {\r\n                     cell.formula = basecell.formula;\r\n                     }\r\n                  delete cell.parseinfo;\r\n                  cell.errors = basecell.errors;\r\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\r\n                     cell.comment = basecell.comment;\r\n                     }\r\n                  else if (cell.comment) {\r\n                     delete cell.comment;\r\n                     }\r\n                  }\r\n               delete cell.displaystring;\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"sort\": // sort cr1:cr2 col1 up/down col2 up/down col3 up/down\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         ParseRange();\r\n         cols = []; // get columns and sort directions (or \"\")\r\n         dirs = [];\r\n         lastsortcol = 0;\r\n         for (i=0; i<=3; i++) {\r\n            cols[i] = cmd.NextToken();\r\n            dirs[i] = cmd.NextToken();\r\n            if (cols[i]) lastsortcol = i;\r\n            }\r\n\r\n         sortcells = {}; // a copy of the data which will replace the original, but in the new order\r\n         sortlist = []; // an array of 0, 1, ..., nrows-1 needed for sorting\r\n         sortvalues = []; // values to be sorted corresponding to sortlist\r\n         sorttypes = []; // basic types of the values\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) { // fill in the sort info\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.cells[cr];\r\n               if (cell) { // only copy non-empty cells\r\n                  sortcells[cr] = sheet.CellToString(cell);\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sortcells[cr]);\r\n                  }\r\n               else {\r\n                  if (saveundo) changes.AddUndo(\"set \"+cr+\" all\");\r\n                  }\r\n               }\r\n            sortlist.push(sortlist.length);\r\n            sortvalues.push([]);\r\n            sorttypes.push([]);\r\n            slast = sorttypes.length-1;\r\n            for (i = 0; i <= lastsortcol; i++) {\r\n               cr = cols[i] + row; // get cr on this row in sort col\r\n               cell = sheet.GetAssuredCell(cr);\r\n               val = cell.datavalue;\r\n               valtype = cell.valuetype.charAt(0) || \"b\";\r\n               if (valtype == \"t\") val = val.toLowerCase();\r\n               sortvalues[slast].push(val);\r\n               sorttypes[slast].push(valtype);\r\n               }\r\n            }\r\n\r\n         sortfunction = function(a, b) { // a comparison function that can handle all the type variations\r\n            var i, a1, b1, ta, cresult;\r\n            for (i=0; i<=lastsortcol; i++) {\r\n               if (dirs[i] == \"up\") { // handle sort direction\r\n                  a1 = a; b1 = b;\r\n                  }\r\n               else {\r\n                  a1 = b; b1 = a;\r\n                  }\r\n               ta = sorttypes[a1][i];\r\n               tb = sorttypes[b1][i];\r\n               if (ta == \"t\") { // numbers < text < errors, blank always last no matter what dir\r\n                  if (tb == \"t\") {\r\n                     a1 = sortvalues[a1][i];\r\n                     b1 = sortvalues[b1][i];\r\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\r\n                     }\r\n                  else if (tb == \"n\") {\r\n                     cresult = 1;\r\n                     }\r\n                  else if (tb == \"b\") {\r\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\r\n                     }\r\n                  else if (tb == \"e\") {\r\n                     cresult = -1;\r\n                     }\r\n                  }\r\n               else if (ta == \"n\") {\r\n                  if (tb == \"t\") {\r\n                     cresult = -1;\r\n                     }\r\n                  else if (tb == \"n\") {\r\n                     a1 = sortvalues[a1][i]-0; // force to numeric, just in case\r\n                     b1 = sortvalues[b1][i]-0;\r\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\r\n                     }\r\n                  else if (tb == \"b\") {\r\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\r\n                     }\r\n                  else if (tb == \"e\") {\r\n                     cresult = -1;\r\n                     }\r\n                  }\r\n               else if (ta == \"e\") {\r\n                  if (tb == \"e\") {\r\n                     a1 = sortvalues[a1][i];\r\n                     b1 = sortvalues[b1][i];\r\n                     cresult = a1 > b1 ? 1 : (a1 < b1 ? -1 : 0);\r\n                     }\r\n                  else if (tb == \"b\") {\r\n                     cresult = dirs[i] == \"up\" ? -1 : 1;\r\n                     }\r\n                  else {\r\n                     cresult = 1;\r\n                     }\r\n                  }\r\n               else if (ta == \"b\") {\r\n                  if (tb == \"b\") {\r\n                     cresult = 0;\r\n                     }\r\n                  else {\r\n                     cresult = dirs[i] == \"up\" ? 1 : -1;\r\n                     }\r\n                  }\r\n               if (cresult) { // return if tested not equal, otherwise do next column\r\n                  return cresult;\r\n                  }\r\n               }\r\n            cresult = a > b ? 1 : (a < b ? -1 : 0); // equal - return position in original to maintain it\r\n            return cresult;\r\n            }\r\n\r\n         sortlist.sort(sortfunction);\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) { // copy original rows into sorted positions\r\n            originalrow = sortlist[row-cr1.row]; // relative position where it was in original\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               sortedcr = SocialCalc.crToCoord(col, originalrow+cr1.row); // original cell to be put in new place\r\n               if (sortcells[sortedcr]) {\r\n                  cell = new SocialCalc.Cell(cr);\r\n                  sheet.CellFromStringParts(cell, sortcells[sortedcr].split(\":\"), 1);\r\n                  if (cell.datatype == \"f\") { // offset coord refs, even to ***relative*** coords in other sheets\r\n                     cell.formula = SocialCalc.OffsetFormulaCoords(cell.formula, 0, (row-cr1.row)-originalrow);\r\n                     }\r\n                  sheet.cells[cr] = cell;\r\n                  }\r\n               else {\r\n                  delete sheet.cells[cr];\r\n                  }\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"insertcol\":\r\n      case \"insertrow\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         sheet.widgetsClean = false; //  force widgets to repaint - update cell reference in widget HTML \r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         ParseRange();\r\n\r\n         if (cmd1 == \"insertcol\") {\r\n            coloffset = 1;\r\n            colend = cr1.col;\r\n            rowoffset = 0;\r\n            rowend = 1;\r\n            newcolstart = cr1.col;\r\n            newcolend = cr1.col;\r\n            newrowstart = 1;\r\n            newrowend = attribs.lastrow;\r\n            if (saveundo) changes.AddUndo(\"deletecol \"+cr1.coord);\r\n            }\r\n         else {\r\n            coloffset = 0;\r\n            colend = 1;\r\n            rowoffset = 1;\r\n            rowend = cr1.row;\r\n            newcolstart = 1;\r\n            newcolend = attribs.lastcol;\r\n            newrowstart = cr1.row;\r\n            newrowend = cr1.row;\r\n            if (saveundo) changes.AddUndo(\"deleterow \"+cr1.coord);\r\n            }\r\n\r\n         for (row=attribs.lastrow; row >= rowend; row--) { // copy the cells forward\r\n            for (col=attribs.lastcol; col >= colend; col--) {\r\n               crbase = SocialCalc.crToCoord(col, row);\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               if (!sheet.cells[crbase]) { // copying empty cell\r\n                  delete sheet.cells[cr]; // delete anything that may have been there\r\n                  }\r\n               else { // overwrite existing cell with moved contents\r\n                  sheet.cells[cr] = sheet.cells[crbase];\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (row=newrowstart; row <= newrowend; row++) { // fill the \"new\" empty cells\r\n            for (col=newcolstart; col <= newcolend; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell = new SocialCalc.Cell(cr);\r\n               sheet.cells[cr] = cell;\r\n               crbase = SocialCalc.crToCoord(col-coloffset, row-rowoffset); // copy attribs of the one before (0 gives you A or 1)\r\n               basecell = sheet.GetAssuredCell(crbase);\r\n               for (attrib in cellProperties) {\r\n                  if (cellProperties[attrib] == 2) { // copy only format attributes\r\n                     cell[attrib] = basecell[attrib];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\r\n             cell = sheet.cells[cr];\r\n             if (cell && cell.datatype == \"f\") {\r\n                cell.formula = SocialCalc.AdjustFormulaCoords(cell.formula, cr1.col, coloffset, cr1.row, rowoffset);\r\n                }\r\n             if (cell) {\r\n                delete cell.parseinfo;\r\n                }\r\n             }\r\n\r\n         for (name in sheet.names) { // update cell references to moved cells in names\r\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\r\n               v1 = sheet.names[name].definition;\r\n               v2 = \"\";\r\n               if (v1.charAt(0) == \"=\") {\r\n                  v2 = \"=\";\r\n                  v1 = v1.substring(1);\r\n                  }\r\n               sheet.names[name].definition = v2 +\r\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\r\n               }\r\n            }\r\n\r\n         for (row = attribs.lastrow; row >= rowend && cmd1 == \"insertrow\"; row--) { // copy the row attributes forward\r\n            rownext = row + rowoffset;\r\n            for (attrib in sheet.rowattribs) {\r\n               val = sheet.rowattribs[attrib][row];\r\n               if (sheet.rowattribs[attrib][rownext] != val) { // make assignment only if different\r\n                  if (val) {\r\n                     sheet.rowattribs[attrib][rownext] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs[attrib][rownext];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (col = attribs.lastcol; col >= colend && cmd1 == \"insertcol\"; col--) { // copy the column attributes forward\r\n            colthis = SocialCalc.rcColname(col);\r\n            colnext = SocialCalc.rcColname(col + coloffset);\r\n            for (attrib in sheet.colattribs) {\r\n               val = sheet.colattribs[attrib][colthis];\r\n               if (sheet.colattribs[attrib][colnext] != val) { // make assignment only if different\r\n                  if (val) {\r\n                     sheet.colattribs[attrib][colnext] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs[attrib][colnext];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         attribs.lastcol += coloffset;\r\n         attribs.lastrow += rowoffset;\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"deletecol\":\r\n      case \"deleterow\":\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         sheet.widgetsClean = false; // update cell reference in widget HTML - force widgets to repaint\r\n         what = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n         lastcol = attribs.lastcol; // save old values since ParseRange sets...\r\n         lastrow = attribs.lastrow;\r\n         ParseRange();\r\n\r\n         if (cmd1 == \"deletecol\") {\r\n            coloffset = cr1.col - cr2.col - 1;\r\n            rowoffset = 0;\r\n            colstart = cr2.col + 1;\r\n            rowstart = 1;\r\n            }\r\n         else {\r\n            coloffset = 0;\r\n            rowoffset = cr1.row - cr2.row - 1;\r\n            colstart = 1;\r\n            rowstart = cr2.row + 1;\r\n            }\r\n\r\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // check for readonly cells\r\n            for (col=colstart; col <= lastcol - coloffset; col++) {\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               cell = sheet.cells[cr];\r\n               if (cell && cell.readonly) {\r\n                    errortext = \"Unable to remove \" + (cmd1 == \"deletecol\" ? \"column\" : \"row\") + \", because cell \" + cell.coord + \" is locked\";\r\n                    return errortext; \r\n               }\r\n            }\r\n         }\r\n\r\n         for (row=rowstart; row <= lastrow - rowoffset; row++) { // copy the cells backwards - extra so no dup of last set\r\n            for (col=colstart; col <= lastcol - coloffset; col++) {\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               if (saveundo && (row<rowstart-rowoffset || col<colstart\t-coloffset)) { // save cells that are overwritten as undo info\r\n                  cell = sheet.cells[cr];\r\n                  if (!cell) { // empty cell\r\n                     changes.AddUndo(\"erase \"+cr+\" all\");\r\n                     }\r\n                  else {\r\n                     changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n                     }\r\n                  }\r\n               crbase = SocialCalc.crToCoord(col, row);\r\n               cell = sheet.cells[crbase];\r\n               if (!cell) { // copying empty cell\r\n                  delete sheet.cells[cr]; // delete anything that may have been there\r\n                  }\r\n               else { // overwrite existing cell with moved contents\r\n                  sheet.cells[cr] = cell;\r\n                  }\r\n               }\r\n            }\r\n\r\n//!!! multiple deletes isn't setting #REF!; need to fix up #REF!'s on undo but only those!\r\n\r\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\r\n             cell = sheet.cells[cr];\r\n             if (cell) {\r\n                if (cell.datatype == \"f\") {\r\n                   oldformula = cell.formula;\r\n                   cell.formula = SocialCalc.AdjustFormulaCoords(oldformula, cr1.col, coloffset, cr1.row, rowoffset);\r\n                   if (cell.formula != oldformula) {\r\n                      delete cell.parseinfo;\r\n                      if (saveundo && cell.formula.indexOf(\"#REF!\")!=-1) { // save old version only if removed coord\r\n                         oldcr = SocialCalc.coordToCr(cr);\r\n                         changes.AddUndo(\"set \"+SocialCalc.rcColname(oldcr.col-coloffset)+(oldcr.row-rowoffset)+\r\n                                         \" formula \"+oldformula);\r\n                         }\r\n                      }\r\n                   }\r\n                else {\r\n                   delete cell.parseinfo;\r\n                   }\r\n                }\r\n             }\r\n\r\n         for (name in sheet.names) { // update cell references to moved cells in names\r\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\r\n               v1 = sheet.names[name].definition;\r\n               v2 = \"\";\r\n               if (v1.charAt(0) == \"=\") {\r\n                  v2 = \"=\";\r\n                  v1 = v1.substring(1);\r\n                  }\r\n               sheet.names[name].definition = v2 +\r\n                  SocialCalc.AdjustFormulaCoords(v1, cr1.col, coloffset, cr1.row, rowoffset);\r\n               }\r\n            }\r\n\r\n         for (row = rowstart; row <= lastrow - rowoffset && cmd1 == \"deleterow\"; row++) { // copy the row attributes backwards\r\n            rowbefore = row + rowoffset;\r\n            for (attrib in sheet.rowattribs) {\r\n               val = sheet.rowattribs[attrib][row];\r\n               if (sheet.rowattribs[attrib][rowbefore] != val) { // make assignment only if different\r\n                  if (saveundo) changes.AddUndo(\"set \"+rowbefore+\" \"+attrib, sheet.rowattribs[attrib][rowbefore]);\r\n                  if (val) {\r\n                     sheet.rowattribs[attrib][rowbefore] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.rowattribs[attrib][rowbefore];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         for (col = colstart; col <= lastcol - coloffset && cmd1 == \"deletecol\"; col++) { // copy the column attributes backwards\r\n            colthis = SocialCalc.rcColname(col);\r\n            colbefore = SocialCalc.rcColname(col + coloffset);\r\n            for (attrib in sheet.colattribs) {\r\n               val = sheet.colattribs[attrib][colthis];\r\n               if (sheet.colattribs[attrib][colbefore] != val) { // make assignment only if different\r\n                  if (saveundo) changes.AddUndo(\"set \"+colbefore+\" \"+attrib, sheet.colattribs[attrib][colbefore]);\r\n                  if (val) {\r\n                     sheet.colattribs[attrib][colbefore] = val;\r\n                     }\r\n                  else {\r\n                     delete sheet.colattribs[attrib][colbefore];\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n\r\n         if (saveundo) {\r\n            if (cmd1 == \"deletecol\") {\r\n               for (col=cr1.col; col<=cr2.col; col++) {\r\n                  changes.AddUndo(\"insertcol \"+SocialCalc.rcColname(cr1.col));\r\n                  }\r\n               }\r\n            else {\r\n               for (row=cr1.row; row<=cr2.row; row++) {\r\n                  changes.AddUndo(\"insertrow \"+cr1.row);\r\n                  }\r\n               }\r\n            }\r\n\r\n         if (cmd1 == \"deletecol\") {\r\n            if (cr1.col <= lastcol) { // shrink sheet unless deleted phantom cols off the end\r\n               if (cr2.col <= lastcol) {\r\n                  attribs.lastcol += coloffset;\r\n                  }\r\n               else {\r\n                  attribs.lastcol = cr1.col - 1;\r\n                  }\r\n               }\r\n            }\r\n         else {\r\n            if (cr1.row <= lastrow) { // shrink sheet unless deleted phantom rows off the end\r\n               if (cr2.row <= lastrow) {\r\n                  attribs.lastrow += rowoffset;\r\n                  }\r\n               else {\r\n                  attribs.lastrow = cr1.row - 1;\r\n                  }\r\n               }\r\n            }\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n\r\n      case \"movepaste\":\r\n      case \"moveinsert\":\r\n\r\n         var movingcells, dest, destcr, inserthoriz, insertvert, pushamount, movedto;\r\n\r\n         sheet.renderneeded = true;\r\n         sheet.changedrendervalues = true;\r\n         if (saveundo) changes.AddUndo(\"changedrendervalues\"); // to take care of undone pasted spans\r\n         what = cmd.NextToken();\r\n         dest = cmd.NextToken();\r\n         rest = cmd.RestOfString(); // rest is all/formulas/formats\r\n         if (rest==\"\") rest = \"all\";\r\n\r\n         ParseRange();\r\n\r\n         destcr = SocialCalc.coordToCr(dest);\r\n\r\n         coloffset = destcr.col - cr1.col;\r\n         rowoffset = destcr.row - cr1.row;\r\n         numcols = cr2.col - cr1.col + 1;\r\n         numrows = cr2.row - cr1.row + 1;\r\n\r\n         // get a copy of moving cells and erase from where they were\r\n\r\n         movingcells = {};\r\n\r\n         for (row = cr1.row; row <= cr2.row; row++) {\r\n            for (col = cr1.col; col <= cr2.col; col++) {\r\n               cr = SocialCalc.crToCoord(col, row);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n\r\n               if (!sheet.cells[cr]) { // if had nothing\r\n                  continue; // don't save anything\r\n                  }\r\n               movingcells[cr] = new SocialCalc.Cell(cr); // create new cell to copy\r\n\r\n               for (attrib in cellProperties) { // go through each property\r\n                  if (typeof cell[attrib] === undefined) { // don't copy undefined things and no need to delete\r\n                     continue;\r\n                     }\r\n                  else {\r\n                     movingcells[cr][attrib] = cell[attrib]; // copy for potential moving\r\n                     }\r\n                  if (rest == \"all\") {\r\n                     delete cell[attrib];\r\n                     }\r\n                  if (rest == \"formulas\") {\r\n                     if (cellProperties[attrib] == 1 || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     }\r\n                  if (rest == \"formats\") {\r\n                     if (cellProperties[attrib] == 2) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"formulas\") { // leave pristene deleted cell\r\n                  cell.datavalue = \"\";\r\n                  cell.datatype = null;\r\n                  cell.formula = \"\";\r\n                  cell.valuetype = \"b\";\r\n                  }\r\n               if (rest == \"all\") { // leave nothing for move all\r\n                  delete sheet.cells[cr];\r\n                  }\r\n               }\r\n            }\r\n\r\n         // if moveinsert, check destination OK, and calculate pushing parameters\r\n\r\n         if (cmd1 == \"moveinsert\") {\r\n            inserthoriz = false;\r\n            insertvert = false;\r\n            if (rowoffset==0 && (destcr.col < cr1.col || destcr.col > cr2.col)) {\r\n               if (destcr.col < cr1.col) { // moving left\r\n                  pushamount = cr1.col - destcr.col;\r\n                  inserthoriz = -1;\r\n                  }\r\n               else {\r\n                  destcr.col -= 1;\r\n                  coloffset = destcr.col - cr2.col;\r\n                  pushamount = destcr.col - cr2.col;\r\n                  inserthoriz = 1;\r\n                  }\r\n               }\r\n            else if (coloffset==0 && (destcr.row < cr1.row || destcr.row > cr2.row)) {\r\n               if (destcr.row < cr1.row) { // moving up\r\n                  pushamount = cr1.row - destcr.row;\r\n                  insertvert = -1;\r\n                  }\r\n               else {\r\n                  destcr.row -= 1;\r\n                  rowoffset = destcr.row - cr2.row;\r\n                  pushamount = destcr.row - cr2.row;\r\n                  insertvert = 1;\r\n                  }\r\n               }\r\n            else {\r\n               cmd1 = \"movepaste\"; // not allowed right now - ignore\r\n               }                \r\n            }\r\n\r\n         // push any cells that need pushing\r\n\r\n         movedto = {}; // remember what was moved where\r\n\r\n         if (insertvert) {\r\n            for (row = 0; row < pushamount; row++) {\r\n               for (col = cr1.col; col <= cr2.col; col++) {\r\n                  if (insertvert < 0) {\r\n                     crbase = SocialCalc.crToCoord(col, destcr.row+pushamount-row-1); // from cell\r\n                     cr = SocialCalc.crToCoord(col, cr2.row-row); // to cell\r\n                     }\r\n                  else {\r\n                     crbase = SocialCalc.crToCoord(col, destcr.row-pushamount+row+1); // from cell\r\n                     cr = SocialCalc.crToCoord(col, cr1.row+row); // to cell\r\n                     }\r\n\r\n                  basecell = sheet.GetAssuredCell(crbase);\r\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\r\n\r\n                  cell = sheet.GetAssuredCell(cr);\r\n                  if (rest == \"all\" || rest == \"formats\") {\r\n                     for (attrib in cellProperties) {\r\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                           delete cell[attrib];\r\n                           }\r\n                        else {\r\n                           cell[attrib] = basecell[attrib];\r\n                           }\r\n                        }\r\n                     }\r\n                  if (rest == \"all\" || rest == \"formulas\") {\r\n                     cell.datavalue = basecell.datavalue;\r\n                     cell.datatype = basecell.datatype;            \r\n                     cell.valuetype = basecell.valuetype;\r\n                     cell.formula = basecell.formula;\r\n                     delete cell.parseinfo;\r\n                     cell.errors = basecell.errors;\r\n                     }\r\n                  delete cell.displaystring;\r\n\r\n                  movedto[crbase] = cr; // old crbase is now at cr\r\n                  }\r\n               }\r\n            }\r\n         if (inserthoriz) {\r\n            for (col = 0; col < pushamount; col++) {\r\n               for (row = cr1.row; row <= cr2.row; row++) {\r\n                  if (inserthoriz < 0) {\r\n                     crbase = SocialCalc.crToCoord(destcr.col+pushamount-col-1, row);\r\n                     cr = SocialCalc.crToCoord(cr2.col-col, row);\r\n                     }\r\n                  else {\r\n                     crbase = SocialCalc.crToCoord(destcr.col-pushamount+col+1, row);\r\n                     cr = SocialCalc.crToCoord(cr1.col+col, row);\r\n                     }\r\n\r\n                  basecell = sheet.GetAssuredCell(crbase);\r\n                  if (saveundo) changes.AddUndo(\"set \"+crbase+\" all\", sheet.CellToString(basecell));\r\n\r\n                  cell = sheet.GetAssuredCell(cr);\r\n                  if (rest == \"all\" || rest == \"formats\") {\r\n                     for (attrib in cellProperties) {\r\n                        if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                        if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                           delete cell[attrib];\r\n                           }\r\n                        else {\r\n                           cell[attrib] = basecell[attrib];\r\n                           }\r\n                        }\r\n                     }\r\n                  if (rest == \"all\" || rest == \"formulas\") {\r\n                     cell.datavalue = basecell.datavalue;\r\n                     cell.datatype = basecell.datatype;            \r\n                     cell.valuetype = basecell.valuetype;\r\n                     cell.formula = basecell.formula;\r\n                     delete cell.parseinfo;\r\n                     cell.errors = basecell.errors;\r\n                     }\r\n                  delete cell.displaystring;\r\n\r\n                  movedto[crbase] = cr; // old crbase is now at cr\r\n                  }\r\n               }\r\n            }\r\n\r\n         // paste moved cells into new place\r\n\r\n         if (destcr.col+numcols-1 > attribs.lastcol) attribs.lastcol = destcr.col+numcols-1;\r\n         if (destcr.row+numrows-1 > attribs.lastrow) attribs.lastrow = destcr.row+numrows-1;\r\n\r\n         for (row = cr1.row; row < cr1.row+numrows; row++) {\r\n            for (col = cr1.col; col < cr1.col+numcols; col++) {\r\n               cr = SocialCalc.crToCoord(col+coloffset, row+rowoffset);\r\n               cell=sheet.GetAssuredCell(cr);\r\n               if (cell.readonly) continue;\r\n               if (saveundo) changes.AddUndo(\"set \"+cr+\" all\", sheet.CellToString(cell));\r\n\r\n               crbase = SocialCalc.crToCoord(col, row); // get old cell to move\r\n\r\n               movedto[crbase] = cr; // old crbase (moved cell) will now be at cr (destination)\r\n\r\n               if (rest == \"all\" && !movingcells[crbase]) { // moving an empty cell\r\n                  delete sheet.cells[cr]; // make the cell empty\r\n                  continue;\r\n                  }\r\n\r\n               basecell = movingcells[crbase];\r\n               if (!basecell) basecell = sheet.GetAssuredCell(crbase);\r\n\r\n               if (rest == \"all\" || rest == \"formats\") {\r\n                  for (attrib in cellProperties) {\r\n                     if (cellProperties[attrib] == 1) continue; // copy only format attributes\r\n                     if (typeof basecell[attrib] === undefined || cellProperties[attrib] == 3) {\r\n                        delete cell[attrib];\r\n                        }\r\n                     else {\r\n                        cell[attrib] = basecell[attrib];\r\n                        }\r\n                     }\r\n                  }\r\n               if (rest == \"all\" || rest == \"formulas\") {\r\n                  cell.datavalue = basecell.datavalue;\r\n                  cell.datatype = basecell.datatype;            \r\n                  cell.valuetype = basecell.valuetype;\r\n                  cell.formula = basecell.formula;\r\n                  delete cell.parseinfo;\r\n                  cell.errors = basecell.errors;\r\n                  if (basecell.comment) { // comments are pasted as part of content, though not filled, etc.\r\n                     cell.comment = basecell.comment;\r\n                     }\r\n                  else if (cell.comment) {\r\n                     delete cell.comment;\r\n                     }\r\n                  }\r\n               delete cell.displaystring;\r\n               }\r\n            }\r\n\r\n         // do fixups\r\n\r\n         for (cr in sheet.cells) { // update cell references to moved cells in calculated formulas\r\n             cell = sheet.cells[cr];\r\n             if (cell) {\r\n                if (cell.datatype == \"f\") {\r\n                   oldformula = cell.formula;\r\n                   cell.formula = SocialCalc.ReplaceFormulaCoords(oldformula, movedto);\r\n                   if (cell.formula != oldformula) {\r\n                      delete cell.parseinfo;\r\n                      if (saveundo && !movedto[cr]) { // moved cells are already saved for undo\r\n                         changes.AddUndo(\"set \"+cr+\" formula \"+oldformula);\r\n                         }\r\n                      }\r\n                   }\r\n                else {\r\n                   delete cell.parseinfo;\r\n                   }\r\n                }\r\n             }\r\n\r\n         for (name in sheet.names) { // update cell references to moved cells in names\r\n            if (sheet.names[name]) { // works with \"A1\", \"A1:A20\", and \"=formula\" forms\r\n               v1 = sheet.names[name].definition;\r\n               oldformula = v1;\r\n               v2 = \"\";\r\n               if (v1.charAt(0) == \"=\") {\r\n                  v2 = \"=\";\r\n                  v1 = v1.substring(1);\r\n                  }\r\n               sheet.names[name].definition = v2 +\r\n                  SocialCalc.ReplaceFormulaCoords(v1, movedto);\r\n               if (saveundo && sheet.names[name].definition != oldformula) { // save changes\r\n                  changes.AddUndo(\"name define \"+name+\" \"+oldformula);\r\n                  }\r\n               }\r\n            }\r\n\r\n         attribs.needsrecalc = \"yes\";\r\n         break;\r\n\r\n      case \"name\":\r\n         what = cmd.NextToken();\r\n         name = cmd.NextToken();\r\n         rest = cmd.RestOfString();\r\n\r\n         name = name.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\r\n         if (name == \"\") break; // must have something\r\n\r\n         if (what == \"define\") {\r\n            if (rest == \"\") break; // must have something\r\n            if (sheet.names[name]) { // already exists\r\n               if (saveundo) changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\r\n               sheet.names[name].definition = rest;\r\n               }\r\n            else { // new\r\n               if (saveundo) changes.AddUndo(\"name delete \"+name);\r\n               sheet.names[name] = {definition: rest, desc: \"\"};\r\n               }\r\n            }\r\n         else if (what == \"desc\") {\r\n            if (sheet.names[name]) { // must already exist\r\n               if (saveundo) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\r\n               sheet.names[name].desc = rest;\r\n               }\r\n            }\r\n         else if (what == \"delete\") {\r\n            if (saveundo) {\r\n               if (sheet.names[name].desc) changes.AddUndo(\"name desc \"+name+\" \"+sheet.names[name].desc);\r\n               changes.AddUndo(\"name define \"+name+\" \"+sheet.names[name].definition);\r\n               }\r\n            delete sheet.names[name];\r\n            }\r\n         attribs.needsrecalc = \"yes\";\r\n\r\n         break;\r\n\r\n      case \"recalc\":\r\n         attribs.needsrecalc = \"yes\"; // request recalc\r\n         sheet.recalconce = true; // even if turned off\r\n         break;\r\n\r\n      case \"redisplay\":\r\n         sheet.renderneeded = true;\r\n         break;\r\n\r\n      case \"changedrendervalues\": // needed for undo sometimes\r\n         sheet.changedrendervalues = true;\r\n         break;\r\n\r\n      case \"pane\":\r\n\r\n         name = cmd.NextToken().toUpperCase();\r\n         undoNum = 1;\r\n         editor = SocialCalc.GetSpreadsheetControlObject().editor;\r\n\r\n         if (name.toUpperCase() === 'ROW') {\r\n           row = parseInt(cmd.NextToken(), 10);\r\n\r\n           if (typeof(editor.context.rowpanes[1]) !== 'undefined' && typeof(editor.context.rowpanes[1].first) === 'number') {\r\n             undoNum = editor.context.rowpanes[1].first;\r\n           }\r\n           if (saveundo) changes.AddUndo('pane row ' + undoNum);\r\n\r\n           // Handle hidden row.\r\n           while (editor.context.sheetobj.rowattribs.hide[row] == 'yes') {\r\n             row++;\r\n           }\r\n\r\n           if ((!row || row<=editor.context.rowpanes[0].first) && editor.context.rowpanes.length>1) { // set to no panes, leaving first pane settings\r\n             editor.context.rowpanes.length = 1;\r\n           } else if (editor.context.rowpanes.length-1 && !editor.timeout) { // has 2 already\r\n             // not waiting for position calc (so positions could be wrong)\r\n             editor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\r\n             editor.context.SetRowPaneFirstLast(1, row, row);\r\n           } else {\r\n             editor.context.SetRowPaneFirstLast(0, editor.context.rowpanes[0].first, row-1);\r\n             editor.context.SetRowPaneFirstLast(1, row, row);\r\n           }\r\n           \r\n           // remove tracklingine\r\n           if (editor.griddiv) {\r\n             //trackingline-horizon\r\n             trackLine = document.getElementById('trackingline-vertical');\r\n             if (trackLine) {\r\n               editor.griddiv.removeChild(trackLine);\r\n               editor.FitToEditTable();\r\n             }\r\n           }\r\n\r\n         } else {\r\n\r\n           col = parseInt(cmd.NextToken(), 10);\r\n\r\n           if (typeof(editor.context.colpanes[1]) !== 'undefined' && typeof(editor.context.colpanes[1].first) === 'number') {\r\n             undoNum = editor.context.colpanes[1].first;\r\n           }\r\n           if (saveundo) changes.AddUndo('pane col ' + undoNum);\r\n\r\n           // Handle hidden column.\r\n           while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == 'yes') {\r\n             col++;\r\n           }\r\n\r\n           if ((!col || col<=editor.context.colpanes[0].first) && editor.context.colpanes.length > 1) { // set to no panes, leaving first pane settings\r\n             editor.context.colpanes.length = 1;\r\n           } else if (editor.context.colpanes.length-1 && !editor.timeout) { // has 2 already\r\n             // not waiting for position calc (so positions could be wrong)\r\n             editor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\r\n             editor.context.SetColPaneFirstLast(1, col, col);\r\n           } else {\r\n             editor.context.SetColPaneFirstLast(0, editor.context.colpanes[0].first, col-1);\r\n             editor.context.SetColPaneFirstLast(1, col, col);\r\n           }\r\n\r\n           // remove tracklingine\r\n           if (editor.griddiv) {\r\n             trackLine = document.getElementById('trackingline-horizon');\r\n             if (trackLine) {\r\n               editor.griddiv.removeChild(trackLine);\r\n               editor.FitToEditTable();\r\n             }\r\n           }\r\n         }\r\n\r\n         sheet.renderneeded = true;\r\n\r\n         break;\r\n\r\n      case \"startcmdextension\": // startcmdextension extension rest-of-command\r\n         name = cmd.NextToken();\r\n         cmdextension = sheet.sci.CmdExtensionCallbacks[name];\r\n         if (cmdextension) {\r\n            cmdextension.func(name, cmdextension.data, sheet, cmd, saveundo);\r\n            }\r\n         break;\r\n\r\n         // eddy ExecuteSheetCommand {\r\n//      case \"setemailparameters\":    \t  \r\n//    \t  break;\r\n    \t  \r\n      case \"settimetrigger\":    \r\n      case \"sendemail\":    \r\n      case \"submitform\":    \r\n      case \"updateopsettings\":\r\n    \t  // email/form/timetrigger handled by server, so ignore here\r\n    \t  break;\r\n         // } eddy ExecuteSheetCommand \r\n    \t  \r\n      default:\r\n         errortext = scc.s_escUnknownCmd+cmdstr;\r\n         break;\r\n      }\r\n\r\n/* For Debugging:\r\nvar ustack=\"\";\r\nfor (var i=0;i<sheet.changes.stack.length;i++) {\r\n   ustack+=(i-0)+\":\"+sheet.changes.stack[i].command[0]+\" of \"+sheet.changes.stack[i].command.length+\"/\"+sheet.changes.stack[i].undo[0]+\" of \"+sheet.changes.stack[i].undo.length+\",\";\r\n   }\r\nalert(cmdstr+\"|\"+sheet.changes.stack.length+\"--\"+ustack);\r\n*/\r\n   if(SocialCalc._app) {\r\n     // widgets need focus. In app mode, render widgets only when required. Rather than default of render everything\r\n     if(cellChanged) {\r\n       if(sheet.renderneeded == true && attrib!=\"value\" && attrib!=\"text\" && attrib!=\"formula\" && attrib!=\"constant\" && attrib!=\"empty\") sheet.widgetsClean = false;  // force widgets to render\r\n       else if(attrib==\"all\") sheet.widgetsClean = false;  // force widgets to render - because of undo\r\n       } \r\n     else {\r\n       if(sheet.renderneeded == true) sheet.widgetsClean = false;  // force widgets to render\r\n       }\r\n     }\r\n   \r\n   return errortext;\r\n\r\n   }\r\n\r\nSocialCalc.SheetUndo = function(sheet) {\r\n\r\n   var i;\r\n   var tos = sheet.changes.TOS();\r\n   var lastone = tos ? tos.undo.length-1 : -1;\r\n   var cmdstr = \"\";\r\n\r\n   for (i=lastone; i>=0; i--) { // do them backwards\r\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\r\n      cmdstr += tos.undo[i];\r\n      }\r\n   sheet.changes.Undo();\r\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\r\n\r\n   }\r\n\r\nSocialCalc.SheetRedo = function(sheet) {\r\n\r\n   var tos, i;\r\n   var didredo = sheet.changes.Redo();\r\n   if (!didredo) {\r\n      sheet.ScheduleSheetCommands(\"\", false); // schedule doing nothing\r\n      return;\r\n      }\r\n   tos = sheet.changes.TOS();\r\n   var cmdstr = \"\";\r\n\r\n   for (i=0; tos && i<tos.command.length; i++) {\r\n      if (cmdstr) cmdstr += \"\\n\"; // concatenate with separate lines\r\n      cmdstr += tos.command[i];\r\n      }\r\n   sheet.ScheduleSheetCommands(cmdstr, false); // do undo operations\r\n\r\n   }\r\n\r\nSocialCalc.CreateAuditString = function(sheet) {\r\n\r\n   var i, j;\r\n   var result = \"\";\r\n   var stack = sheet.changes.stack;\r\n   var tos = sheet.changes.tos;\r\n   for (i=0; i<=tos; i++) {\r\n      for (j=0; j<stack[i].command.length; j++) {\r\n         result += stack[i].command[j] + \"\\n\";\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\nSocialCalc.GetStyleNum = function(sheet, atype, style) {\r\n\r\n   var num;\r\n\r\n   if (style.length==0) return 0; // null means use zero, which means default or global default\r\n\r\n   num = sheet[atype+\"hash\"][style];\r\n   if (!num) {\r\n      if (sheet[atype+\"s\"].length<1) sheet[atype+\"s\"].push(\"\");\r\n      num = sheet[atype+\"s\"].push(style) - 1;\r\n      sheet[atype+\"hash\"][style] = num;\r\n      sheet.changedrendervalues = true;\r\n      }\r\n   return num;\r\n\r\n   }\r\n\r\nSocialCalc.GetStyleString = function(sheet, atype, num) {\r\n\r\n   if (!num) return null; // zero, null, and undefined return null\r\n\r\n   return sheet[atype+\"s\"][num];\r\n\r\n   }\r\n\r\n//\r\n// updatedformula = SocialCalc.OffsetFormulaCoords(formula, coloffset, rowoffset)\r\n//\r\n// Change relative cell references by offsets (even those to other worksheets so fill, paste, sort work as expected).\r\n// If not what you want, use absolute references.\r\n//\r\n\r\nSocialCalc.OffsetFormulaCoords = function(formula, coloffset, rowoffset) {\r\n\r\n   var parseinfo, ttext, ttype, i, cr, newcr;\r\n   var updatedformula = \"\";\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_string = tokentype.string;\r\n   var token_coord = tokentype.coord;\r\n   var tokenOpExpansion = scf.TokenOpExpansion;\r\n\r\n   parseinfo = scf.ParseFormulaIntoTokens(formula);\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      ttype = parseinfo[i].type;\r\n      ttext = parseinfo[i].text;\r\n      if (ttype == token_coord) {\r\n         newcr = \"\";\r\n         cr = SocialCalc.coordToCr(ttext);\r\n         if (ttext.charAt(0)!=\"$\") { // add col offset unless absolute column\r\n            cr.col += coloffset;\r\n            }\r\n         else {\r\n            newcr += \"$\";\r\n            }\r\n         newcr += SocialCalc.rcColname(cr.col);\r\n         if (ttext.indexOf(\"$\", 1)==-1) { // add row offset unless absolute row\r\n            cr.row += rowoffset;\r\n            }\r\n         else {\r\n            newcr += \"$\";\r\n            }\r\n         newcr += cr.row;\r\n         if (cr.row < 1 || cr.col < 1) {\r\n            newcr = \"#REF!\";\r\n            }\r\n         updatedformula += newcr;\r\n         }\r\n      else if (ttype == token_string) {\r\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\r\n            updatedformula += '\"' + ttext.replace(/\"/, '\"\"') + '\"';\r\n            }\r\n         else updatedformula += '\"' + ttext + '\"';\r\n         }\r\n      else if (ttype == token_op) {\r\n         updatedformula += tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\r\n         }\r\n      else { // leave everything else alone\r\n         updatedformula += ttext;\r\n         }\r\n      }\r\n\r\n   return updatedformula;\r\n\r\n   }\r\n\r\n//\r\n// updatedformula = SocialCalc.AdjustFormulaCoords(formula, col, coloffset, row, rowoffset)\r\n//\r\n// Change all cell references to cells starting with col/row by offsets\r\n//\r\n\r\nSocialCalc.AdjustFormulaCoords = function(formula, col, coloffset, row, rowoffset) {\r\n\r\n   var ttype, ttext, i, newcr;\r\n   var updatedformula = \"\";\r\n   var sheetref = false;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_string = tokentype.string;\r\n   var token_coord = tokentype.coord;\r\n   var tokenOpExpansion = scf.TokenOpExpansion;\r\n\r\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      ttype = parseinfo[i].type;\r\n      ttext = parseinfo[i].text;\r\n      if (ttype == token_op) { // references with sheet specifier are not offset\r\n         if (ttext == \"!\") {\r\n            sheetref = true; // found a sheet reference\r\n            }\r\n         else if (ttext != \":\") { // for everything but a range, reset\r\n            sheetref = false;\r\n            }\r\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\r\n         }\r\n      if (ttype == token_coord) {\r\n         cr = SocialCalc.coordToCr(ttext);\r\n         if ((coloffset < 0 && cr.col >= col && cr.col < col-coloffset) ||\r\n             (rowoffset < 0 && cr.row >= row && cr.row < row-rowoffset)) { // refs to deleted cells become invalid\r\n            if (!sheetref) {\r\n               cr.col = 0;\r\n               cr.row = 0;\r\n               }\r\n            }\r\n         if (!sheetref) {\r\n            if (cr.col >= col) {\r\n               cr.col += coloffset;\r\n               }\r\n            if (cr.row >= row) {\r\n               cr.row += rowoffset;\r\n               }\r\n            }\r\n         if (ttext.charAt(0)==\"$\") {\r\n            newcr = \"$\"+SocialCalc.rcColname(cr.col);\r\n            }\r\n         else {\r\n            newcr = SocialCalc.rcColname(cr.col);\r\n            }\r\n         if (ttext.indexOf(\"$\", 1)!=-1) {\r\n            newcr += \"$\" + cr.row;\r\n            }\r\n         else {\r\n            newcr += cr.row;\r\n            }\r\n         if (cr.row < 1 || cr.col < 1) {\r\n            newcr = \"#REF!\";\r\n            }\r\n         ttext = newcr;\r\n         }\r\n      else if (ttype == token_string) {\r\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\r\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\r\n            }\r\n         else ttext = '\"' + ttext + '\"';\r\n         }\r\n      updatedformula += ttext;\r\n      }\r\n\r\n   return updatedformula;\r\n\r\n   }\r\n\r\n//\r\n// updatedformula = SocialCalc.ReplaceFormulaCoords(formula, movedto)\r\n//\r\n// Change all cell references to cells that are keys in moveto to be to moveto[coord].\r\n// Don't change references to other sheets.\r\n// Handle range extents specially.\r\n//\r\n\r\nSocialCalc.ReplaceFormulaCoords = function(formula, movedto) {\r\n\r\n   var ttype, ttext, i, newcr, coord;\r\n   var updatedformula = \"\";\r\n   var sheetref = false;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_string = tokentype.string;\r\n   var token_coord = tokentype.coord;\r\n   var tokenOpExpansion = scf.TokenOpExpansion;\r\n\r\n   parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(formula);\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      ttype = parseinfo[i].type;\r\n      ttext = parseinfo[i].text;\r\n      if (ttype == token_op) { // references with sheet specifier are not change\r\n         if (ttext == \"!\") {\r\n            sheetref = true; // found a sheet reference\r\n            }\r\n         else if (ttext != \":\") { // for everything but a range, reset\r\n            sheetref = false;\r\n            }\r\n\r\n//!!!! HANDLE RANGE EXTENT MOVES\r\n\r\n         ttext = tokenOpExpansion[ttext] || ttext; // make sure short tokens (e.g., \"G\") go back full (\">=\")\r\n         }\r\n      if (ttype == token_coord) {\r\n         cr = SocialCalc.coordToCr(ttext); // get parts\r\n         coord = SocialCalc.crToCoord(cr.col, cr.row); // get \"clean\" reference\r\n         if (movedto[coord] && !sheetref) { // this is a reference to a moved cell\r\n            cr = SocialCalc.coordToCr(movedto[coord]); // get new row and col\r\n            if (ttext.charAt(0)==\"$\") { // copy absolute ref marks if present\r\n               newcr = \"$\"+SocialCalc.rcColname(cr.col);\r\n               }\r\n            else {\r\n               newcr = SocialCalc.rcColname(cr.col);\r\n               }\r\n            if (ttext.indexOf(\"$\", 1)!=-1) {\r\n               newcr += \"$\" + cr.row;\r\n               }\r\n            else {\r\n               newcr += cr.row;\r\n               }\r\n            ttext = newcr;\r\n            }\r\n         }\r\n      else if (ttype == token_string) {\r\n         if (ttext.indexOf('\"') >= 0) { // quotes to double\r\n            ttext = '\"' + ttext.replace(/\"/, '\"\"') + '\"';\r\n            }\r\n         else ttext = '\"' + ttext + '\"';\r\n         }\r\n      updatedformula += ttext;\r\n      }\r\n\r\n   return updatedformula;\r\n\r\n   }\r\n\r\n\r\n// ************************\r\n//\r\n// Recalc Loop Code\r\n//\r\n// ************************\r\n\r\n//\r\n// How recalc works:\r\n//\r\n// !!!!!!!!!!!!!!\r\n//\r\n\r\n// SocialCalc.RecalcInfo - object with global recalc info\r\n\r\nSocialCalc.RecalcInfo = {\r\n\r\n   sheet: null, // which sheet is being recalced\r\n\r\n   currentState: 0, // current state\r\n   state: {idle: 0, start_calc: 1, order: 2, calc: 3, start_wait: 4, done_wait: 5}, // allowed state values\r\n\r\n   recalctimer: null, // value to cancel timer\r\n   maxtimeslice: 100, // maximum milliseconds per slice of recalc time before a wait\r\n   timeslicedelay: 1, // milliseconds to wait between recalc time slices\r\n   starttime: 0, // when recalc started\r\n\r\n   queue: [], // queue of sheet waiting to be recalced\r\n\r\n   // LoadSheet: a function that returns true if started a load or false if not.\r\n   //\r\n\r\n   LoadSheet: function(sheetname) {return false;} // default returns not found\r\n\r\n   }\r\n\r\n// SocialCalc.RecalcData - object with recalc info while determining recalc order and afterward\r\n\r\nSocialCalc.RecalcData = function() { // initialize a RecalcData object\r\n\r\n   this.inrecalc = true; // if true, doing a recalc\r\n   this.celllist = []; // list with all potential cells to calculate\r\n   this.celllistitem = 0; // cell to check next when ordering\r\n   this.calclist = null; // object which is the chained list of cells to calculate\r\n                         // each in the form of \"coord: nextcoord\"\r\n                         // e.g., if B8 is calculated right after A8, then calclist.A8==\"B8\"\r\n                         // if null, need to create the list\r\n   this.calclistlength = 0; // number of items in calclist\r\n\r\n   this.firstcalc = null; // start of the calc list - a string or null\r\n   this.lastcalc = null; // last one on chain (used to add more to the end)\r\n\r\n   this.nextcalc = null; // used to keep track during background recalc to make it restartable\r\n   this.count = 0; // number calculated\r\n\r\n   // checkinfo is used when determining calc order:\r\n\r\n   this.checkinfo = {}; // attributes are coords; if no attrib for a coord, it wasn't checked or doesn't need it\r\n                        // values are RecalcCheckInfo objects while checking or TRUE when complete\r\n\r\n   }\r\n\r\n// SocialCalc.RecalcCheckInfo - object that stores checking info while determining recalc order\r\n\r\nSocialCalc.RecalcCheckInfo = function() { // initialize a RecalcCheckInfo object\r\n\r\n   this.oldcoord = null; // chain back up of cells referring to cells\r\n   this.parsepos = 0; // which token we are up to\r\n\r\n   // range info\r\n\r\n   this.inrange = false; // if true, in the process of checking a range of coords\r\n   this.inrangestart = false; // if true, have not yet filled in range loop values\r\n   this.cr1 = null; // range first coord as a cr object\r\n   this.cr2 = null; // range second coord as a cr object\r\n   this.c1 = null; // range extents\r\n   this.c2 = null;\r\n   this.r1 = null;\r\n   this.r2 = null;\r\n   this.c = null; // looping values\r\n   this.r = null;\r\n   \r\n   }\r\n\r\n// Recalc the entire sheet\r\n\r\nSocialCalc.RecalcSheet = function(sheet) {\r\n\r\n   var coord, err, recalcdata;\r\n   var scri = SocialCalc.RecalcInfo;\r\n\r\n   if (scri.currentState != scri.state.idle) {\r\n      scri.queue.push(sheet);\r\n      return;\r\n      }\r\n\r\n   delete sheet.attribs.circularreferencecell; // reset recalc-wide things\r\n   SocialCalc.Formula.FreshnessInfoReset();\r\n\r\n   SocialCalc.RecalcClearTimeout();\r\n\r\n   scri.sheet = sheet; // set values needed by background recalc\r\n   scri.currentState = scri.state.start_calc;\r\n\r\n   scri.starttime = new Date();\r\n\r\n   if (sheet.statuscallback) {\r\n      sheet.statuscallback(scri, \"calcstart\", null, sheet.statuscallbackparams);\r\n      }\r\n\r\n   SocialCalc.RecalcSetTimeout();\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.RecalcSetTimeout - set a timer for next recalc step\r\n//\r\n\r\nSocialCalc.RecalcSetTimeout = function() {\r\n\r\n   var scri = SocialCalc.RecalcInfo;\r\n\r\n   scri.recalctimer = window.setTimeout(SocialCalc.RecalcTimerRoutine, scri.timeslicedelay);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.RecalcClearTimeout - cancel any timeouts\r\n//\r\n\r\nSocialCalc.RecalcClearTimeout = function() {\r\n\r\n   var scri = SocialCalc.RecalcInfo;\r\n\r\n   if (scri.recalctimer) {\r\n      window.clearTimeout(scri.recalctimer);\r\n      scri.recalctimer = null;\r\n      }\r\n\r\n   }\r\n\r\n  \r\n//\r\n// SocialCalc.RecalcLoadedSheet(sheetname, str, recalcneeded, live)\r\n//\r\n// Called when a sheet finishes loading with name, string, and t/f whether it should be recalced.\r\n// If loaded sheet has sheet.attribs.recalc==\"off\", then no recalc done.\r\n// If sheetname is null, then the sheetname waiting for will be used.\r\n//\r\n\r\nSocialCalc.RecalcLoadedSheet = function(sheetname, str, recalcneeded, live) {\r\n\r\n   var sheet;\r\n   var scri = SocialCalc.RecalcInfo;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   sheet = SocialCalc.Formula.AddSheetToCache(sheetname || scf.SheetCache.waitingForLoading, str, live);\r\n\r\n   if (recalcneeded && sheet && sheet.attribs.recalc!=\"off\") { // if recalcneeded, and not manual sheet, chain in this new sheet to recalc loop\r\n      sheet.previousrecalcsheet = scri.sheet;\r\n      scri.sheet = sheet;\r\n      scri.currentState = scri.state.start_calc;\r\n      }\r\n   scf.SheetCache.waitingForLoading = null;\r\n\r\n   SocialCalc.RecalcSetTimeout();\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.RecalcTimerRoutine - handles the actual order determination and cell-by-cell recalculation in the background\r\n//\r\n\r\nSocialCalc.RecalcTimerRoutine = function() {\r\n\r\n   var eresult, cell, coord, err, status;\r\n   var starttime = new Date();\r\n   var count = 0;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var scri = SocialCalc.RecalcInfo;\r\n   var sheet = scri.sheet;\r\n   if (!sheet) {\r\n      return;\r\n      }\r\n   var recalcdata = sheet.recalcdata || (sheet.recalcdata = {});\r\n\r\n   var do_statuscallback = function(status, arg) { // routine to do callback if required\r\n      if (sheet.statuscallback) {\r\n         sheet.statuscallback(recalcdata, status, arg, sheet.statuscallbackparams);\r\n         }\r\n      }\r\n\r\n   SocialCalc.RecalcClearTimeout();\r\n\r\n   if (scri.currentState == scri.state.start_calc) {\r\n\r\n      recalcdata = new SocialCalc.RecalcData();\r\n      sheet.recalcdata = recalcdata;\r\n\r\n      for (coord in sheet.cells) { // get list of cells to check for order\r\n         if (!coord) continue;\r\n         recalcdata.celllist.push(coord);\r\n         }\r\n\r\n      recalcdata.calclist = {}; // start with empty list\r\n      scri.currentState = scri.state.order; // drop through to determining recalc order\r\n      }\r\n\r\n   if (scri.currentState == scri.state.order) {\r\n      while (recalcdata.celllistitem < recalcdata.celllist.length) { // check all the cells to see if they should be on the list\r\n         coord = recalcdata.celllist[recalcdata.celllistitem++];\r\n         err = SocialCalc.RecalcCheckCell(sheet, coord);\r\n         if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\r\n            do_statuscallback(\"calcorder\", {coord: coord, total: recalcdata.celllist.length, count: recalcdata.celllistitem});\r\n            SocialCalc.RecalcSetTimeout();\r\n            return;\r\n            }\r\n         }\r\n\r\n      do_statuscallback(\"calccheckdone\", recalcdata.calclistlength);\r\n\r\n      recalcdata.nextcalc = recalcdata.firstcalc; // start at the beginning of the recalc chain\r\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\r\n      SocialCalc.RecalcSetTimeout();\r\n      return;\r\n      }\r\n\r\n   if (scri.currentState == scri.state.start_wait) { // starting to wait for something\r\n      scri.currentState = scri.state.done_wait; // finished on next timer call\r\n      if (scri.LoadSheet) {\r\n         status = scri.LoadSheet(scf.SheetCache.waitingForLoading);\r\n         if (status) { // started a load operation\r\n            return;\r\n            }\r\n         }\r\n      SocialCalc.RecalcLoadedSheet(null, \"\", false);\r\n      return;\r\n      }\r\n\r\n   if (scri.currentState == scri.state.done_wait) {\r\n      scri.currentState = scri.state.calc; // loop through cells on next timer call\r\n      SocialCalc.RecalcSetTimeout();\r\n      return;\r\n      }\r\n\r\n   // otherwise should be scri.state.calc\r\n\r\n   if (scri.currentState != scri.state.calc) {\r\n      alert(\"Recalc state error: \"+scri.currentState+\". Error in SocialCalc code.\");\r\n      }\r\n\r\n   coord = sheet.recalcdata.nextcalc;\r\n   while (coord) {\r\n      cell = sheet.cells[coord];\r\n\t  // app widgets need cell ID so store in parseinfo {\r\n      if (!cell.parseinfo) { // cache parsed formula\r\n        cell.parseinfo = scf.ParseFormulaIntoTokens(cell.formula);\r\n        }\r\n      cell.parseinfo.coord = coord;\r\n\t  // }\r\n      eresult = scf.evaluate_parsed_formula(cell.parseinfo, sheet, false);\r\n      if (scf.SheetCache.waitingForLoading) { // wait until restarted\r\n         // schedule render to run while waiting for dependent sheet to load - schedules first render of sheet\r\n         if (scri.firstRenderScheduled != true) {\r\n           var editor = SocialCalc.GetSpreadsheetControlObject().editor;\r\n           editor.ScheduleRender(false);    \r\n           scri.firstRenderScheduled = true; // stop more renders because done first render of sheet\r\n         }\r\n         recalcdata.nextcalc = coord; // start with this cell again\r\n         recalcdata.count += count;\r\n         do_statuscallback(\"calcloading\", {sheetname: scf.SheetCache.waitingForLoading});\r\n         scri.currentState = scri.state.start_wait; // start load on next timer call\r\n         SocialCalc.RecalcSetTimeout();\r\n         return;\r\n         }\r\n\r\n      if (scf.RemoteFunctionInfo.waitingForServer) { // wait until restarted\r\n         recalcdata.nextcalc = coord; // start with this cell again\r\n         recalcdata.count += count;\r\n         do_statuscallback(\"calcserverfunc\",\r\n            {funcname: scf.RemoteFunctionInfo.waitingForServer, coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\r\n         scri.currentState = scri.state.done_wait; // start load on next timer call\r\n         return; // return and wait for next recalc timer event\r\n         }\r\n\r\n      if (cell.datavalue != eresult.value ||\r\n       cell.valuetype != eresult.type) { // only update if changed from last time\r\n         cell.datavalue = eresult.value;\r\n         cell.valuetype = eresult.type;\r\n         delete cell.displaystring;\r\n         sheet.recalcchangedavalue = true; // remember something changed in case other code wants to know\r\n         }\r\n      if (eresult.error) {\r\n         cell.errors = eresult.error;\r\n         }\r\n      count++;\r\n      coord = sheet.recalcdata.calclist[coord];\r\n\r\n      if (((new Date()) - starttime) >= scri.maxtimeslice) { // if taking too long, give up CPU for a while\r\n         recalcdata.nextcalc = coord; // start with next cell on chain\r\n         recalcdata.count += count;\r\n         do_statuscallback(\"calcstep\", {coord: coord, total: recalcdata.calclistlength, count: recalcdata.count});\r\n         SocialCalc.RecalcSetTimeout();\r\n         return;\r\n         }\r\n      }\r\n\r\n   recalcdata.inrecalc = false;\r\n\r\n   sheet.reRenderCellList = sheet.recalcdata.celllist; // GUI widgets need focus - if app then only re-render non-widget cells\r\n   delete sheet.recalcdata; // save memory and clear out for name lookup formula evaluation\r\n\r\n   delete sheet.attribs.needsrecalc; // remember recalc done\r\n\r\n   scri.sheet = sheet.previousrecalcsheet || null; // chain back if doing recalc of loaded sheets\r\n   if (scri.sheet) {\r\n      scri.currentState = scri.state.calc; // start where we left off\r\n      SocialCalc.RecalcSetTimeout();\r\n      return;\r\n      }\r\n\r\n   scf.FreshnessInfo.recalc_completed = true; // say freshness info is complete\r\n   scri.currentState = scri.state.idle; // we are idle\r\n\r\n   do_statuscallback(\"calcfinished\", (new Date()) - scri.starttime);\r\n\r\n   // Check queue for more sheets.\r\n   if (scri.queue.length > 0) {\r\n      sheet = scri.queue.shift();\r\n      sheet.RecalcSheet();\r\n      }\r\n   }\r\n\r\n\r\n//\r\n// circref = SocialCalc.RecalcCheckCell(sheet, coord)\r\n//\r\n// Checks cell to put on calclist, looking at parsed tokens.\r\n// Also checks cells this cell is dependent upon\r\n// if it contains a formula with cell references.\r\n// If circular reference, returns non-null.\r\n//\r\n\r\nSocialCalc.RecalcCheckCell = function(sheet, startcoord) {\r\n\r\n   var parseinfo, ttext, ttype, i, rangecoord, circref, value, pos, pos2, cell, coordvals;\r\n   var scf = SocialCalc.Formula;\r\n   if (!scf) {\r\n      return \"Need SocialCalc.Formula\";\r\n      }\r\n   var tokentype = scf.TokenType;\r\n   var token_op = tokentype.op;\r\n   var token_name = tokentype.name;\r\n   var token_coord = tokentype.coord;\r\n\r\n   var recalcdata = sheet.recalcdata;\r\n   var checkinfo = recalcdata.checkinfo;\r\n\r\n   var sheetref = false; // if true, a sheet reference is in effect, so don't check that\r\n   var oldcoord = null; // coord of formula that referred to this one when checking down the tree\r\n   var coord = startcoord; // the coord of the cell we are checking\r\n\r\n   // Start with requested cell, and then continue down or up the dependency tree\r\n   // oldcoord (and checkinfo[coord].oldcoord) maintains the reference stack during the tree walk\r\n   // checkinfo[coord] maintains the stack of checking looping values, e.g., token number being checked\r\n\r\nmainloop:\r\n   while (coord) {\r\n      cell = sheet.cells[coord];\r\n      coordvals = checkinfo[coord];\r\n\r\n      if (!cell || cell.datatype != \"f\" || // Don't calculate if not a formula\r\n          (coordvals && typeof coordvals != \"object\")) { // Don't calc if already calculated\r\n         coord = oldcoord; // go back up dependency tree to coord that referred to us\r\n         if (checkinfo[coord]) oldcoord = checkinfo[coord].oldcoord;\r\n         continue;\r\n         }\r\n\r\n      if (!coordvals) { // do we have checking information about this cell?\r\n         coordvals = new SocialCalc.RecalcCheckInfo(); // no - make a place to hold it\r\n         checkinfo[coord] = coordvals;\r\n         }\r\n\r\n      if (cell.errors) { // delete errors from previous recalcs\r\n         delete cell.errors;\r\n         }\r\n\r\n      if (!cell.parseinfo) { // cache parsed formula\r\n         cell.parseinfo = scf.ParseFormulaIntoTokens(cell.formula);\r\n         }\r\n      parseinfo = cell.parseinfo;\r\n\r\n      for (i=coordvals.parsepos; i<parseinfo.length; i++) { // go through each token in formula\r\n\r\n         if (coordvals.inrange) { // processing a range of coords\r\n            if (coordvals.inrangestart) { // first time - fill in other values\r\n               if (coordvals.cr1.col > coordvals.cr2.col) { coordvals.c1 = coordvals.cr2.col; coordvals.c2 = coordvals.cr1.col; }\r\n               else { coordvals.c1 = coordvals.cr1.col; coordvals.c2 = coordvals.cr2.col; }\r\n               coordvals.c = coordvals.c1 - 1; // start one before\r\n\r\n               if (coordvals.cr1.row > coordvals.cr2.row) { coordvals.r1 = coordvals.cr2.row; coordvals.r2 = coordvals.cr1.row; }\r\n               else { coordvals.r1 = coordvals.cr1.row; coordvals.r2 = coordvals.cr2.row; }\r\n               coordvals.r = coordvals.r1; // start on this row\r\n               coordvals.inrangestart = false;\r\n               }\r\n            else { // not first time\r\n               }\r\n            coordvals.c += 1; // increment column\r\n            if (coordvals.c > coordvals.c2) { // finished the columns of this row\r\n               coordvals.r += 1; // increment row\r\n               if (coordvals.r > coordvals.r2) { // finished checking the entire range\r\n                  coordvals.inrange = false;\r\n                  continue;\r\n                  }\r\n               coordvals.c = coordvals.c1; // start at the beginning of next row\r\n               }\r\n            rangecoord = SocialCalc.crToCoord(coordvals.c, coordvals.r);\r\n\r\n            // now check that one\r\n\r\n            coordvals.parsepos = i; // remember our position\r\n            coordvals.oldcoord = oldcoord; // remember back up chain\r\n            oldcoord = coord; // come back to us\r\n            coord = rangecoord;\r\n            if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\r\n               cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\r\n               checkinfo[startcoord] = true; // this one should be calculated once at this point\r\n               if (!recalcdata.firstcalc) {\r\n                  recalcdata.firstcalc = startcoord;\r\n                  }\r\n               else {\r\n                  recalcdata.calclist[recalcdata.lastcalc] = startcoord;\r\n                  }\r\n               recalcdata.lastcalc = startcoord;\r\n               recalcdata.calclistlength++; // count number on list\r\n               sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\r\n               return cell.errors;\r\n               }\r\n            continue mainloop;\r\n            }\r\n\r\n         ttype = parseinfo[i].type; // get token details\r\n         ttext = parseinfo[i].text;\r\n         if (ttype == token_op) { // references with sheet specifier are not checked\r\n            if (ttext == \"!\") {\r\n               sheetref = true; // found a sheet reference\r\n               }\r\n            else if (ttext != \":\") { // for everything but a range, reset\r\n               sheetref = false;\r\n               }\r\n            }\r\n\r\n         if (ttype == token_name) { // look for named range\r\n            value = scf.LookupName(sheet, ttext);\r\n            if (value.type == \"range\") { // only need to recurse here for range, which may be just one cell\r\n               pos = value.value.indexOf(\"|\");\r\n               if (pos != -1) { // range - check each cell\r\n                  coordvals.cr1 = SocialCalc.coordToCr(value.value.substring(0,pos));\r\n                  pos2 = value.value.indexOf(\"|\", pos+1);\r\n                  coordvals.cr2 = SocialCalc.coordToCr(value.value.substring(pos+1,pos2));\r\n                  coordvals.inrange = true;\r\n                  coordvals.inrangestart = true;\r\n                  i = i-1; // back up so will start up again here\r\n                  continue;\r\n                  }\r\n               }\r\n            else if (value.type == \"coord\") { // just a coord\r\n               ttype = token_coord; // treat as a coord inline\r\n               ttext = value.value; // and then drop through to next test which should succeed\r\n               }\r\n            else { // not a defined name - probably a function\r\n               }\r\n            }\r\n\r\n         if (ttype == token_coord) { // token is a coord\r\n\r\n            if (i >= 2 // look for a range\r\n             && parseinfo[i-1].type == token_op && parseinfo[i-1].text == ':'\r\n             && parseinfo[i-2].type == token_coord\r\n             && !sheetref) { // Range -- check each cell\r\n               coordvals.cr1 = SocialCalc.coordToCr(parseinfo[i-2].text); // remember range extents\r\n               coordvals.cr2 = SocialCalc.coordToCr(ttext);\r\n               coordvals.inrange = true; // next time use the range looping code\r\n               coordvals.inrangestart = true;\r\n               i = i-1; // back up so will start up again here\r\n               continue;\r\n               }\r\n\r\n            else if (!sheetref) { // Single cell reference\r\n               if (ttext.indexOf(\"$\") != -1) ttext = ttext.replace(/\\$/g, \"\"); // remove any $'s\r\n               coordvals.parsepos = i+1; // remember our position - come back on next token\r\n               coordvals.oldcoord = oldcoord; // remember back up chain\r\n               oldcoord = coord; // come back to us\r\n               coord = ttext;\r\n               if (checkinfo[coord] && typeof checkinfo[coord] == \"object\") { // Circular reference\r\n                  cell.errors = SocialCalc.Constants.s_caccCircRef+startcoord; // set on original cell making the ref\r\n                  checkinfo[startcoord] = true; // this one should be calculated once at this point\r\n                  if (!recalcdata.firstcalc) { // add to calclist\r\n                     recalcdata.firstcalc = startcoord;\r\n                     }\r\n                  else {\r\n                     recalcdata.calclist[recalcdata.lastcalc] = startcoord;\r\n                     }\r\n                  recalcdata.lastcalc = startcoord;\r\n                  recalcdata.calclistlength++; // count number on list\r\n                  sheet.attribs.circularreferencecell = coord+\"|\"+oldcoord; // remember at least one circ ref\r\n                  return cell.errors;\r\n                  }\r\n               continue mainloop;\r\n               }\r\n            }\r\n         }\r\n\r\n      sheetref = false; // make sure off when bump back up\r\n\r\n      checkinfo[coord] = true; // this one is finished\r\n      if (!recalcdata.firstcalc) { // add to calclist\r\n         recalcdata.firstcalc = coord;\r\n         }\r\n      else {\r\n         recalcdata.calclist[recalcdata.lastcalc] = coord;\r\n         }\r\n      recalcdata.lastcalc = coord;\r\n      recalcdata.calclistlength++; // count number on list\r\n\r\n      coord = oldcoord; // go back to the formula that referred to us and continue\r\n      oldcoord = checkinfo[coord] ? checkinfo[coord].oldcoord : null;\r\n\r\n      }\r\n\r\n   return \"\";\r\n\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// Parse class:\r\n//\r\n// Used by ExecuteSheetCommand to get elements of commands to execute.\r\n// The string it works with consists of one or more lines each\r\n// made up of one or more tokens separated by a delimiter.\r\n//\r\n// *************************************\r\n\r\n// Initialize: set string to work with\r\n\r\nSocialCalc.Parse = function(str) {\r\n\r\n   // properties:\r\n\r\n   this.str = str;\r\n   this.pos = 0;\r\n   this.delimiter = \" \";\r\n   this.lineEnd = str.indexOf(\"\\n\");\r\n   if (this.lineEnd < 0) {\r\n      this.lineEnd = str.length;\r\n      }\r\n\r\n   }\r\n\r\n// Return next token as a string\r\n\r\nSocialCalc.Parse.prototype.NextToken = function() {\r\n   if (this.pos < 0) return \"\";\r\n   var pos2 = this.str.indexOf(this.delimiter, this.pos);\r\n   var pos1 = this.pos;\r\n   if (pos2 > this.lineEnd) { // don't go past end of line\r\n      pos2 = this.lineEnd;\r\n      }\r\n   if (pos2 >= 0) {\r\n      this.pos = pos2 + 1;\r\n      return this.str.substring(pos1, pos2);\r\n      }\r\n   else {\r\n      this.pos = this.lineEnd;\r\n      return this.str.substring(pos1, this.lineEnd);\r\n      }\r\n   }\r\n\r\n// Return everything from current point until end of line\r\n\r\nSocialCalc.Parse.prototype.RestOfString = function() {\r\n   var oldpos = this.pos;\r\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\r\n   this.pos = this.lineEnd;\r\n   return this.str.substring(oldpos, this.lineEnd);\r\n   }\r\n\r\nSocialCalc.Parse.prototype.RestOfStringNoMove = function() {\r\n   if (this.pos < 0 || this.pos >= this.lineEnd) return \"\";\r\n   return this.str.substring(this.pos, this.lineEnd);\r\n   }\r\n\r\n// Move current point to next line\r\n\r\nSocialCalc.Parse.prototype.NextLine = function() {\r\n   this.pos = this.lineEnd + 1;\r\n   this.lineEnd = this.str.indexOf(\"\\n\", this.pos);\r\n   if (this.lineEnd < 0) {\r\n      this.lineEnd = this.str.length;\r\n      }\r\n   }\r\n\r\n// Check to see if at end of string with no more to process\r\n\r\nSocialCalc.Parse.prototype.EOF = function() {\r\n   if (this.pos < 0 || this.pos >= this.str.length) return true;\r\n   return false;\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// UndoStack class:\r\n//\r\n// Implements the behavior needed for a normal application's undo/redo stack.\r\n// You add a new change sequence with PushChange.\r\n// The type argument is a string that can be used to lookup some general string \r\n// like \"typing\" or \"setting attribute\" for the menu prompts for undo/redo.\r\n//\r\n// You add the \"do\" steps with AddDo. The non-null, non-undefined arguments are\r\n// joined together with \" \" to make a command string to be saved.\r\n//\r\n// You add the undo steps as commands for the most recent change with AddUndo.\r\n// The non-null, non-undefined arguments are joined together with \" \" to make\r\n// a command string to be saved.\r\n//\r\n// The Undo and Redo functions move the Top Of Stack pointer through the changes stack\r\n// so you can undo and redo. Doing a new PushChange removes all undone items\r\n// after TOS.\r\n//\r\n// You can push more things than you can undo if you want.\r\n// There is a maximum to remember as the \"did\" stack for an audit trail (and as redo). This may be unlimited.\r\n// There is a separate maximum to remember that can be undone. This may be smaller than maxRedo.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.UndoStack = function() {\r\n\r\n   // properties:\r\n\r\n   this.stack = []; // {command: [], type: type, undo: []} -- multiple dos and undos allowed\r\n   this.tos = -1; // top of stack position, used for undo/redo\r\n   this.maxRedo = 0; // Maximum size of redo stack (and audit trail which is this.stack[n].command) or zero if no limit\r\n   this.maxUndo = 50; // Maximum number of steps kept for undo (usually the memory intensive part) or zero if no limit\r\n\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.PushChange = function(type) { // adding a new thing to the stack\r\n   while (this.stack.length > 0 && this.stack.length-1 > this.tos) { // pop off things not redone\r\n      this.stack.pop();\r\n      }\r\n   this.stack.push({command: [], type: type, undo: []});\r\n   if (this.maxRedo && this.stack.length > this.maxRedo) { // limit number kept as audit trail\r\n      this.stack.shift(); // remove the extra one\r\n      }\r\n   if (this.maxUndo && this.stack.length > this.maxUndo) { // need to trim excess undo info\r\n      this.stack[this.stack.length - this.maxUndo - 1].undo = []; // only need to remove one\r\n      }\r\n   this.tos = this.stack.length - 1;\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.AddDo = function() {\r\n   if (!this.stack[this.stack.length-1]) { return; }\r\n   var args = [];\r\n   for (var i=0; i<arguments.length; i++) {\r\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\r\n      }\r\n   var cmd = args.join(\" \");\r\n   this.stack[this.stack.length-1].command.push(cmd);\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.AddUndo = function() {\r\n   if (!this.stack[this.stack.length-1]) { return; }\r\n   var args = [];\r\n   for (var i=0; i<arguments.length; i++) {\r\n      if (arguments[i]!=null) args.push(arguments[i]); // ignore null or undefined\r\n      }\r\n   var cmd = args.join(\" \");\r\n   this.stack[this.stack.length-1].undo.push(cmd);\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.TOS = function() {\r\n   if (this.tos >= 0) return this.stack[this.tos];\r\n   else return null;\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.Undo = function() {\r\n   if (this.tos >= 0 && (!this.maxUndo || this.tos > this.stack.length - this.maxUndo - 1)) {\r\n      this.tos -= 1;\r\n      return true;\r\n      }\r\n   else {\r\n      return false;\r\n      }\r\n   }\r\n\r\nSocialCalc.UndoStack.prototype.Redo = function() {\r\n   if (this.tos < this.stack.length-1) {\r\n      this.tos += 1;\r\n      return true;\r\n      }\r\n   else {\r\n      return false;\r\n      }\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Clipboard Object:\r\n//\r\n// This is a single object.\r\n// Stores the clipboard, which is shared by all active sheets.\r\n// Like the undo stack, it does not persist from one editing session to another.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.Clipboard = {\r\n\r\n   // properties:\r\n\r\n   clipboard:  \"\" // empty or string in save format with \"copiedfrom:\" set to a range\r\n\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// RenderContext class:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.RenderContext = function(sheetobj) {\r\n\r\n   var parts, num, s;\r\n   var attribs = sheetobj.attribs;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // properties:\r\n\r\n   this.sheetobj = sheetobj;\r\n   this.hideRowsCols = false; // Rendering with panes only works with \"false\"\r\n                              // !!!! Note: not implemented yet in rendering, just saved as an attribute\r\n   this.showGrid = false;\r\n   this.showRCHeaders = false;\r\n   this.rownamewidth = scc.defaultRowNameWidth;\r\n   this.pixelsPerRow = scc.defaultAssumedRowHeight;\r\n\r\n   this.cellskip = {}; // if present, coord of cell covering this cell\r\n   this.coordToCR = {}; // for cells starting spans, coordToCR[coord]={row:row, col:col}\r\n   this.colwidth = []; // precomputed column widths, taking into account defaults\r\n   this.rowheight = []; // precomputed row height, taking into account defaults\r\n   this.totalwidth = 0; // precomputed total table width\r\n   this.totalheight = 0; // precomputed total table height\r\n\r\n   this.rowpanes = []; // for each pane, {first: firstrow, last: lastrow}\r\n   this.colpanes = []; // for each pane, {first: firstrow, last: lastrow}\r\n   this.colunhideleft = [];\r\n   this.colunhideright = [];\r\n   this.rowunhidetop = [];\r\n   this.rowunhidebottom = [];\r\n   this.maxcol=0; // max col and row to display, adding long spans, etc.\r\n   this.maxrow=0;\r\n\r\n   this.highlights = {}; // for each cell with special display: coord:highlightType (see this.highlightTypes)\r\n   this.cursorsuffix = \"\"; // added to highlights[cr]==\"cursor\" to get type to lookup\r\n\r\n   this.highlightTypes = // attributes to change when highlit\r\n      {\r\n         cursor: {style: scc.defaultHighlightTypeCursorStyle, className: scc.defaultHighlightTypeCursorClass},\r\n         range: {style: scc.defaultHighlightTypeRangeStyle, className: scc.defaultHighlightTypeRangeClass},\r\n         cursorinsertup: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-x;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertup.gif);\", className: scc.defaultHighlightTypeCursorClass},\r\n         cursorinsertleft: {style: \"color:#FFF;backgroundColor:#A6A6A6;backgroundRepeat:repeat-y;backgroundPosition:top left;backgroundImage:url(\"+scc.defaultImagePrefix+\"cursorinsertleft.gif);\", className: scc.defaultHighlightTypeCursorClass},\r\n         range2: {style: \"color:#000;backgroundColor:#FFF;backgroundImage:url(\"+scc.defaultImagePrefix+\"range2.gif);\", className: \"\"}\r\n      }\r\n\r\n   this.cellIDprefix = scc.defaultCellIDPrefix; // if non-null, each cell will render with an ID\r\n\r\n   this.defaultlinkstyle = null; // default linkstyle object (allows you to pass values to link renderer)\r\n   this.defaultHTMLlinkstyle = {type: \"html\"}; // default linkstyle for standalone HTML\r\n\r\n   // constants:\r\n\r\n   this.defaultfontstyle = scc.defaultCellFontStyle;\r\n   this.defaultfontsize = scc.defaultCellFontSize;\r\n   this.defaultfontfamily = scc.defaultCellFontFamily;\r\n\r\n   this.defaultlayout = scc.defaultCellLayout;\r\n\r\n   this.defaultpanedividerwidth = scc.defaultPaneDividerWidth;\r\n   this.defaultpanedividerheight = scc.defaultPaneDividerHeight;\r\n\r\n   this.gridCSS = scc.defaultGridCSS;\r\n\r\n   this.commentClassName = scc.defaultCommentClass; // for cells with non-blank comments when this.showGrid is true\r\n   this.commentCSS = scc.defaultCommentStyle; // any combination of classnames and styles may be used\r\n   this.commentNoGridClassName = scc.defaultCommentNoGridClass; // for cells when this.showGrid is false\r\n   this.commentNoGridCSS = scc.defaultCommentNoGridStyle; // any combination of classnames and styles may be used\r\n\r\n   this.readonlyClassName = scc.defaultReadonlyClass; // for readonly cells with non-blank comments when this.showGrid is true\r\n   this.readonlyCSS = scc.defaultReadonlyStyle; // any combination of classnames and styles may be used\r\n   this.readonlyNoGridClassName = scc.defaultReadonlyNoGridClass; // for readonly cells when this.showGrid is false\r\n   this.readonlyNoGridCSS = scc.defaultReadonlyNoGridStyle; // any combination of classnames and styles may be used\r\n   this.readonlyComment = scc.defaultReadonlyComment;\r\n\r\n   this.classnames = // any combination of classnames and explicitStyles can be used\r\n      {\r\n         colname: scc.defaultColnameClass,\r\n         rowname: scc.defaultRownameClass,\r\n         selectedcolname: scc.defaultSelectedColnameClass,\r\n         selectedrowname: scc.defaultSelectedRownameClass,\r\n         upperleft: scc.defaultUpperLeftClass,\r\n         skippedcell: scc.defaultSkippedCellClass,\r\n         panedivider: scc.defaultPaneDividerClass,\r\n         unhideleft: scc.defaultUnhideLeftClass,\r\n         unhideright: scc.defaultUnhideRightClass,\r\n         unhidetop: scc.defaultUnhideTopClass,\r\n         unhidebottom: scc.defaultUnhideBottomClass,\r\n         colresizebar: scc.defaultColResizeBarClass,\r\n         rowresizebar: scc.defaultRowResizeBarClass\r\n      };\r\n\r\n   this.explicitStyles = // these may be used so you won't need a stylesheet with the classnames\r\n      {\r\n         colname: scc.defaultColnameStyle,\r\n         rowname: scc.defaultRownameStyle,\r\n         selectedcolname: scc.defaultSelectedColnameStyle,\r\n         selectedrowname: scc.defaultSelectedRownameStyle,\r\n         upperleft: scc.defaultUpperLeftStyle,\r\n         skippedcell: scc.defaultSkippedCellStyle,\r\n         panedivider: scc.defaultPaneDividerStyle,\r\n         unhideleft: scc.defaultUnhideLeftStyle,\r\n         unhideright: scc.defaultUnhideRightStyle,\r\n         unhidetop: scc.defaultUnhideTopStyle,\r\n         unhidebottom: scc.defaultUnhideBottomStyle\r\n      };\r\n\r\n   // processed info about cell skipping\r\n\r\n   this.cellskip = null;\r\n   this.needcellskip = true;\r\n\r\n   // precomputed values, filling in defaults indicated by \"*\"\r\n\r\n   this.fonts=[]; // for each fontnum, {style: fs, weight: fw, size: fs, family: ff}\r\n   this.layouts=[]; // for each layout, \"padding:Tpx Rpx Bpx Lpx;vertical-align:va;\"\r\n\r\n   this.needprecompute = true; // need to call PrecomputeSheetFontsAndLayouts\r\n\r\n   // if have a sheet object, initialize constants and precomputed values\r\n\r\n   if (attribs) {\r\n      this.rowpanes[0] = {first: 1, last: attribs.lastrow};\r\n      this.colpanes[0] = {first: 1, last: attribs.lastcol};\r\n      this.usermaxcol = attribs.usermaxcol;\r\n      this.usermaxrow = attribs.usermaxrow;\r\n\r\n      }\r\n   else throw scc.s_rcMissingSheet;\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.RenderContext.prototype.PrecomputeSheetFontsAndLayouts = function() {SocialCalc.PrecomputeSheetFontsAndLayouts(this);};\r\nSocialCalc.RenderContext.prototype.CalculateCellSkipData = function() {SocialCalc.CalculateCellSkipData(this);};\r\nSocialCalc.RenderContext.prototype.CalculateColWidthData = function() {SocialCalc.CalculateColWidthData(this);};\r\nSocialCalc.RenderContext.prototype.CalculateRowHeightData = function() {SocialCalc.CalculateRowHeightData(this);};\r\nSocialCalc.RenderContext.prototype.SetRowPaneFirstLast = function(panenum, first, last) {this.rowpanes[panenum]={first:first, last:last};};\r\nSocialCalc.RenderContext.prototype.SetColPaneFirstLast = function(panenum, first, last) {this.colpanes[panenum]={first:first, last:last};};\r\nSocialCalc.RenderContext.prototype.CoordInPane = function(coord, rowpane, colpane) {return SocialCalc.CoordInPane(this, coord, rowpane, colpane);};\r\nSocialCalc.RenderContext.prototype.CellInPane = function(row, col, rowpane, colpane) {return SocialCalc.CellInPane(this, row, col, rowpane, colpane);};\r\nSocialCalc.RenderContext.prototype.InitializeTable = function(tableobj) {SocialCalc.InitializeTable(this, tableobj);};\r\nSocialCalc.RenderContext.prototype.RenderSheet = function(oldtable, linkstyle) {return SocialCalc.RenderSheet(this, oldtable, linkstyle);};\r\nSocialCalc.RenderContext.prototype.RenderColGroup = function() {return SocialCalc.RenderColGroup(this);};\r\nSocialCalc.RenderContext.prototype.RenderColHeaders = function() {return SocialCalc.RenderColHeaders(this);};\r\nSocialCalc.RenderContext.prototype.RenderSizingRow = function() {return SocialCalc.RenderSizingRow(this);};\r\nSocialCalc.RenderContext.prototype.RenderRow = function(rownum, rowpane, linkstyle) {return SocialCalc.RenderRow(this, rownum, rowpane, linkstyle);};\r\nSocialCalc.RenderContext.prototype.RenderSpacingRow = function() {return SocialCalc.RenderSpacingRow(this);};\r\nSocialCalc.RenderContext.prototype.RenderCell = function(rownum, colnum, rowpane, colpane, noElement, linkstyle)\r\n      {return SocialCalc.RenderCell(this, rownum, colnum, rowpane, colpane, noElement, linkstyle);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.PrecomputeSheetFontsAndLayouts = function(context) {\r\n\r\n   var defaultfont, parts, layoutre, dparts, sparts, num, s, i;\r\n   var sheetobj = context.sheetobj;\r\n   var attribs =  sheetobj.attribs;\r\n\r\n   if (attribs.defaultfont) {\r\n      defaultfont = sheetobj.fonts[attribs.defaultfont];\r\n      defaultfont = defaultfont.replace(/^\\*/,SocialCalc.Constants.defaultCellFontStyle);\r\n      defaultfont = defaultfont.replace(/(.+)\\*(.+)/,\"$1\"+SocialCalc.Constants.defaultCellFontSize+\"$2\");\r\n      defaultfont = defaultfont.replace(/\\*$/,SocialCalc.Constants.defaultCellFontFamily);\r\n      parts=defaultfont.match(/^(\\S+? \\S+?) (\\S+?) (\\S.*)$/);\r\n      context.defaultfontstyle = parts[1];\r\n      context.defaultfontsize = parts[2];\r\n      context.defaultfontfamily = parts[3];\r\n      }\r\n\r\n   for (num=1; num<sheetobj.fonts.length; num++) { // precompute fonts by filling in the *'s\r\n      s=sheetobj.fonts[num];\r\n      s=s.replace(/^\\*/,context.defaultfontstyle);\r\n      s=s.replace(/(.+)\\*(.+)/,\"$1\"+context.defaultfontsize+\"$2\");\r\n      s=s.replace(/\\*$/,context.defaultfontfamily);\r\n      parts=s.match(/^(\\S+?) (\\S+?) (\\S+?) (\\S.*)$/);\r\n      context.fonts[num] = {style: parts[1], weight: parts[2], size: parts[3], family: parts[4]};\r\n\r\n      }\r\n\r\n   layoutre = /^padding:\\s*(\\S+)\\s+(\\S+)\\s+(\\S+)\\s+(\\S+);vertical-align:\\s*(\\S+);/;\r\n   dparts = SocialCalc.Constants.defaultCellLayout.match(layoutre); // get built-in defaults\r\n\r\n   if (attribs.defaultlayout) {\r\n      sparts = sheetobj.layouts[attribs.defaultlayout].match(layoutre); // get sheet defaults, if set\r\n      }\r\n   else {\r\n      sparts = [\"\", \"*\", \"*\", \"*\", \"*\", \"*\"];\r\n      }\r\n\r\n   for (num=1; num<sheetobj.layouts.length; num++) { // precompute layouts by filling in the *'s\r\n      s=sheetobj.layouts[num];\r\n      parts = s.match(layoutre);\r\n      for (i=1; i<=5; i++) {\r\n         if (parts[i]==\"*\") {\r\n            parts[i] = (sparts[i] != \"*\" ? sparts[i] : dparts[i]); // if *, sheet default or built-in\r\n            }\r\n         }\r\n      context.layouts[num] = \"padding:\"+parts[1]+\" \"+parts[2]+\" \"+parts[3]+\" \"+parts[4]+\r\n         \";vertical-align:\"+parts[5]+\";\";\r\n      }\r\n\r\n   context.needprecompute = false;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateCellSkipData = function(context) {\r\n\r\n   var row, col, coord, cell, contextcell, colspan, rowspan, skiprow, skipcol, skipcoord;\r\n\r\n   var sheetobj=context.sheetobj;\r\n   var sheetrowattribs=sheetobj.rowattribs;\r\n   var sheetcolattribs=sheetobj.colattribs;\r\n   context.maxrow=0;\r\n   context.maxcol=0;\r\n   context.cellskip = {}; // reset\r\n\r\n   // Calculate cellskip data\r\n\r\n   for (row=1; row<=sheetobj.attribs.lastrow; row++) {\r\n      for (col=1; col<=sheetobj.attribs.lastcol; col++) { // look for spans and set cellskip for skipped cells\r\n         coord=SocialCalc.crToCoord(col, row);\r\n         cell=sheetobj.cells[coord];\r\n         // don't look at undefined cells (they have no spans) or skipped cells\r\n         if (cell===undefined || context.cellskip[coord]) continue;\r\n         colspan=cell.colspan || 1;\r\n         rowspan=cell.rowspan || 1;\r\n         if (colspan>1 || rowspan>1) {\r\n            for (skiprow=row; skiprow<row+rowspan; skiprow++) {\r\n               for (skipcol=col; skipcol<col+colspan; skipcol++) { // do the setting on individual cells\r\n                  skipcoord=SocialCalc.crToCoord(skipcol,skiprow);\r\n                  if (skipcoord==coord) { // for coord, remember row and col\r\n                     context.coordToCR[coord]={row: row, col: col};\r\n                     }\r\n                  else { // for other cells, flag with coord of here\r\n                     context.cellskip[skipcoord]=coord;\r\n                     }\r\n                  if (skiprow>context.maxrow) maxrow=skiprow;\r\n                  if (skipcol>context.maxcol) maxcol=skipcol;\r\n                  }\r\n               }\r\n            }\r\n         }\r\n      }\r\n\r\n   context.needcellskip = false;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateColWidthData = function(context) {\r\n\r\n   var colnum, colname, colwidth, totalwidth;\r\n\r\n   var sheetobj=context.sheetobj;\r\n   var sheetcolattribs=sheetobj.colattribs;\r\n\r\n   // Calculate column width data\r\n\r\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         colname=SocialCalc.rcColname(colnum);\r\n         if (sheetobj.colattribs.hide[colname] == \"yes\") {\r\n            context.colwidth[colnum] = 0;\r\n            }\r\n         else {\r\n            colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\r\n            if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\r\n            context.colwidth[colnum]=colwidth+\"\";\r\n            totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\r\n            }\r\n         }\r\n      }\r\n   context.totalwidth = totalwidth;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateRowHeightData = function(context) {\r\n  var rownum, rowheight, totalheight;\r\n  var sheetobj = context.sheetobj;\r\n\r\n  // Calculate row height data\r\n  totalheight = context.showRCHeaders ? context.pixelsPerRow : 0;\r\n  for (rowpane = 0; rowpane < context.rowpanes.length; rowpane++) {\r\n    for (rownum = context.rowpanes[rowpane].first; rownum <= context.rowpanes[rowpane].last; rownum++) {\r\n      if (sheetobj.rowattribs.hide[rownum] === \"yes\") {\r\n        context.rowheight[rownum] = 0;\r\n      } else {\r\n        rowheight = sheetobj.rowattribs.height[rownum] || sheetobj.attribs.defaultrowheight || SocialCalc.Constants.defaultAssumedRowHeight;\r\n        if (rowheight === \"blank\" || rowheight === \"auto\") rowheight = \"\";\r\n        context.rowheight[rownum] = rowheight+\"\";\r\n        totalheight += (rowheight && ((rowheight - 0) > 0)) ? (rowheight-0) : 10;\r\n      }\r\n    }\r\n  }\r\n  context.totalheight = totalheight;\r\n\r\n}\r\n\r\nSocialCalc.InitializeTable = function(context, tableobj) {\r\n\r\n/*\r\n\r\nUses border-collapse so corners don't have holes\r\nNote: IE and Firefox handle <col> differently (IE adds borders and padding)\r\nunder border-collapse and Safari has problems with <col> and wide text\r\nTablelayout \"fixed\" also leads to problems\r\n\r\n*/\r\n\r\n/*\r\n\r\n*** Discussion ***\r\n\r\nThe rendering assumes fixed column widths, even though SocialCalc allows \"auto\".\r\nThere may be issues with \"auto\" and it is hard to make it work cross-browser\r\nwith border-collapse, etc.\r\n\r\nThis and the RenderSheet routine are where in the code the specifics of\r\ntable attributes and column size definitions are set. As the browsers settle down\r\nand when we decide if we don't need auto width, we may want to revisit the way the\r\ncode does this (e.g., use table-layout:fixed).\r\n\r\n*/\r\n   tableobj.style.borderCollapse=\"collapse\";\r\n   tableobj.cellSpacing=\"0\";\r\n   tableobj.cellPadding=\"0\";\r\n\r\n   tableobj.style.width=context.totalwidth+\"px\";\r\n\r\n   }\r\n\r\n//\r\n// tableobj = SocialCalc.RenderSheet(context, oldtable, linkstyle)\r\n//\r\n// Renders a render context returning a DOM table object.\r\n// If there is an oldtable object, it replaces it in the parent node.\r\n// If oldtable is null, it just returns the new one.\r\n// The linkstyle is \"\" or null for editing rendering\r\n// and optionally an object passed on to formatting code.\r\n//\r\n\r\nSocialCalc.RenderSheet = function(context, oldtable, linkstyle) {\r\n\r\n   var newrow, rowpane;\r\n   var tableobj, colgroupobj, tbodyobj, parentnode;\r\n\r\n   // do precompute stuff if necessary\r\n\r\n   if (context.sheetobj.changedrendervalues) {\r\n      context.needcellskip = true;\r\n      context.needprecompute = true;\r\n      context.sheetobj.changedrendervalues = false;\r\n      }\r\n   if (context.needcellskip) {\r\n      context.CalculateCellSkipData();\r\n      }\r\n   if (context.needprecompute) {\r\n      context.PrecomputeSheetFontsAndLayouts();\r\n      }\r\n\r\n   context.CalculateColWidthData(); // always make sure col width values are up to date\r\n   context.CalculateRowHeightData();\r\n\r\n   // make the table element and fill it in\r\n\r\n   tableobj=document.createElement(\"table\");\r\n   context.InitializeTable(tableobj);\r\n\r\n   colgroupobj=context.RenderColGroup();\r\n   tableobj.appendChild(colgroupobj);\r\n\r\n   tbodyobj=document.createElement(\"tbody\");\r\n\r\n   tbodyobj.appendChild(context.RenderSizingRow());\r\n\r\n   if (context.showRCHeaders) {\r\n      newrow=context.RenderColHeaders();\r\n      if (newrow) tbodyobj.appendChild(newrow);\r\n      }\r\n\r\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\r\n      for (rownum=context.rowpanes[rowpane].first;rownum<=context.rowpanes[rowpane].last;rownum++) {\r\n         newrow=context.RenderRow(rownum, rowpane, linkstyle);\r\n         tbodyobj.appendChild(newrow);\r\n         }\r\n      if (rowpane<context.rowpanes.length-1) {\r\n         newrow=context.RenderSpacingRow();\r\n         tbodyobj.appendChild(newrow);\r\n         }\r\n      }\r\n\r\n   tableobj.appendChild(tbodyobj);\r\n\r\n   if (oldtable) {\r\n      parentnode = oldtable.parentNode;\r\n      if (parentnode) parentnode.replaceChild(tableobj, oldtable);\r\n      }\r\n\r\n   return tableobj;\r\n\r\n   }\r\n\r\nSocialCalc.RenderRow = function(context, rownum, rowpane, linkstyle) {\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n   var colnum, newcol, colpane, newdiv;\r\n\r\n   if (context.showRCHeaders) {\r\n      newcol=document.createElement(\"td\");\r\n      if (context.classnames) newcol.className=context.classnames.rowname;\r\n      if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.rowname;\r\n      newcol.width=context.rownamewidth;\r\n      newcol.height = context.rowheight[rownum];\r\n      newcol.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\r\n                                        // considered top of row (and can't get <row> position in Safari)\r\n      newcol.innerHTML=rownum+\"\";\r\n\r\n      // If neighbour is hidden, show an icon in this column.\r\n      if (rownum < context.rowpanes[context.rowpanes.length-1].last && sheetobj.rowattribs.hide[rownum+1] == \"yes\") {\r\n         // HACK: Because we likely want the icon floating at the bottom of the cell, we create an enclosing div \r\n         // with position relative and the icon's div will be placed inside it with position: absolute and bottom: 0.\r\n         var container = document.createElement(\"div\");\r\n         container.style.position = \"relative\";\r\n         var unhide = document.createElement(\"div\");\r\n         if (context.classnames) unhide.className=context.classnames.unhidetop;\r\n         if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhidetop;\r\n         var fixPosition = ((context.rowheight[rownum] - 0) - SocialCalc.Constants.defaultAssumedRowHeight);\r\n         fixPosition = (fixPosition === 0) ? 4 : fixPosition;\r\n         unhide.style.bottom = '-' + fixPosition + 'px';\r\n         context.rowunhidetop[rownum] = unhide;\r\n         container.appendChild(unhide);\r\n         newcol.appendChild(container);\r\n         }\r\n      if (rownum > 1 && sheetobj.rowattribs.hide[rownum-1] == \"yes\") {\r\n         var unhide = document.createElement(\"div\");\r\n         if (context.classnames) unhide.className=context.classnames.unhidebottom;\r\n         if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhidebottom;\r\n         context.rowunhidebottom[rownum] = unhide;\r\n         newcol.appendChild(unhide);\r\n         }\r\n\r\n      // add resize bar\r\n      var resizeBar = document.createElement('div');\r\n      resizeBar.className = context.classnames.rowresizebar;\r\n      newcol.appendChild(resizeBar);\r\n\r\n      result.appendChild(newcol);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=context.RenderCell(rownum, colnum, rowpane, colpane, null, linkstyle);\r\n         if (newcol) result.appendChild(newcol);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"td\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         newdiv=document.createElement(\"div\"); // for Firefox to avoid squishing\r\n         newdiv.style.width=context.defaultpanedividerwidth+\"px\";\r\n         newdiv.style.overflow=\"hidden\";\r\n         newcol.appendChild(newdiv);\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n\r\n   // If hidden row, display: none.\r\n   if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\r\n      result.style.cssText += \";display:none\";\r\n      }\r\n\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderSpacingRow = function(context) {\r\n\r\n   var colnum, newcol, colpane, w;\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n\r\n   if (context.showRCHeaders) {\r\n      newcol=document.createElement(\"td\");\r\n      newcol.width=context.rownamewidth;\r\n      newcol.height=context.defaultpanedividerheight;\r\n      if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n      if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n      result.appendChild(newcol);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=document.createElement(\"td\");\r\n         w = context.colwidth[colnum];\r\n         if (w) newcol.width=w;\r\n         newcol.height=context.defaultpanedividerheight;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         if (newcol) result.appendChild(newcol);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"td\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         newcol.height=context.defaultpanedividerheight;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderColHeaders = function(context) {\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n   var colnum, newcol;\r\n\r\n   if (!context.showRCHeaders) return null;\r\n\r\n   newcol=document.createElement(\"td\");\r\n   if (context.classnames) newcol.className=context.classnames.upperleft;\r\n   if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.upperleft;\r\n   newcol.width=context.rownamewidth;\r\n   result.appendChild(newcol);\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=document.createElement(\"td\");\r\n         if (context.classnames) newcol.className=context.classnames.colname;\r\n         if (context.explicitStyles) newcol.style.cssText=context.explicitStyles.colname;\r\n\r\n         // If hidden column, display: none.\r\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n            newcol.style.cssText += \";display:none\";\r\n            }\r\n\r\n         newcol.innerHTML=SocialCalc.rcColname(colnum);\r\n\r\n         // If neighbour is hidden, show an icon in this column.\r\n         if (colnum < context.colpanes[context.colpanes.length-1].last && sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+1)] == \"yes\") {\r\n            var unhide = document.createElement(\"div\");\r\n            if (context.classnames) unhide.className=context.classnames.unhideleft;\r\n            if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhideleft;\r\n            context.colunhideleft[colnum] = unhide;\r\n            newcol.appendChild(unhide);\r\n         }\r\n         if (colnum > 1 && sheetobj.colattribs.hide[SocialCalc.rcColname(colnum-1)] == \"yes\") {\r\n            unhide = document.createElement(\"div\");\r\n            if (context.classnames) unhide.className=context.classnames.unhideright;\r\n            if (context.explicitStyles) unhide.style.cssText=context.explicitStyles.unhideright;\r\n            context.colunhideright[colnum] = unhide;\r\n            newcol.appendChild(unhide);\r\n         }\r\n\r\n         // add resize bar\r\n         var resizeBar = document.createElement('span');\r\n         resizeBar.style.height = SocialCalc.Constants.defaultAssumedRowHeight + 'px';\r\n         resizeBar.className = context.classnames.colresizebar;\r\n         newcol.appendChild(resizeBar);\r\n\r\n         result.appendChild(newcol);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"td\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         if (context.classnames.panedivider) newcol.className=context.classnames.panedivider;\r\n         if (context.explicitStyles.panedivider) newcol.style.cssText=context.explicitStyles.panedivider;\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n   // eddy {\r\n//   if(context.formColNames != null) {\r\n//     for(var nodeIndex = 0;  nodeIndex < result.childNodes.length;  nodeIndex++ ) {\r\n//       var currentCol = result.childNodes[nodeIndex];\r\n//       if(context.formColNames[currentCol.innerText] != null) currentCol.innerText = context.formColNames[currentCol.innerText];\r\n//     }\r\n//   }\r\n   // }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderColGroup = function(context) {\r\n\r\n   var colpane, colnum, newcol, t;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"colgroup\");\r\n\r\n   if (context.showRCHeaders) {\r\n      newcol=document.createElement(\"col\");\r\n      newcol.width=context.rownamewidth;\r\n      result.appendChild(newcol);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcol=document.createElement(\"col\");\r\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n            newcol.width=\"1\";\r\n            }\r\n         else {\r\n            t = context.colwidth[colnum];\r\n            if (t) newcol.width=t;\r\n            result.appendChild(newcol);\r\n            }\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcol=document.createElement(\"col\");\r\n         newcol.width=context.defaultpanedividerwidth;\r\n         result.appendChild(newcol);\r\n         }\r\n      }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderSizingRow = function(context) {\r\n\r\n   var colpane, colnum, newcell, t;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var result=document.createElement(\"tr\");\r\n\r\n   if (context.showRCHeaders) {\r\n      newcell=document.createElement(\"td\");\r\n      newcell.style.width=context.rownamewidth+\"px\";\r\n      newcell.height=\"1\";\r\n      result.appendChild(newcell);\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         newcell=document.createElement(\"td\");\r\n         if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n            newcell.width=\"1\";\r\n            }\r\n         else {\r\n            t = context.colwidth[colnum];\r\n            if (t) newcell.width=t;\r\n            }\r\n         newcell.height=\"1\";\r\n         result.appendChild(newcell);\r\n         }\r\n      if (colpane<context.colpanes.length-1) {\r\n         newcell=document.createElement(\"td\");\r\n         newcell.width=context.defaultpanedividerwidth;\r\n         newcell.height=\"1\";\r\n         result.appendChild(newcell);\r\n         }\r\n      }\r\n   return result;\r\n   }\r\n\r\nSocialCalc.RenderCell = function(context, rownum, colnum, rowpane, colpane, noElement, linkstyle) {\r\n\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var num, t, result, span, stylename, cell, endcell, sheetattribs, scdefaults;\r\n   var stylestr=\"\";\r\n\r\n   rownum = rownum-0; // make sure a number\r\n   colnum = colnum-0;\r\n\r\n   var coord=SocialCalc.crToCoord(colnum, rownum);\r\n\r\n   if (context.cellskip[coord]) { // skip if within a span\r\n      if (context.CoordInPane(context.cellskip[coord], rowpane, colpane)) {\r\n         return null; // span starts in this pane -- so just skip\r\n         }\r\n      result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\"); // span start is scrolled away, so make a special cell\r\n      if (context.classnames.skippedcell) result.className=context.classnames.skippedcell;\r\n      if (context.explicitStyles.skippedcell) result.style.cssText=context.explicitStyles.skippedcell;\r\n      result.innerHTML=\"&nbsp;\"; // put something there so height is OK\r\n      // !!! Really need to add borders in case there isn't anything else shown in the pane to get height\r\n      return result;\r\n      }\r\n\r\n   result=noElement ? SocialCalc.CreatePseudoElement() : document.createElement(\"td\");\r\n\r\n   if (context.cellIDprefix) {\r\n      result.id = context.cellIDprefix+coord;\r\n      }\r\n\r\n   cell=sheetobj.cells[coord];\r\n\r\n   if (!cell) {\r\n      cell=new SocialCalc.Cell(coord);\r\n      }\r\n\r\n   sheetattribs=sheetobj.attribs;\r\n   scc=SocialCalc.Constants;\r\n\r\n   if (cell.colspan>1) {\r\n      span=1;\r\n      for (num=1; num<cell.colspan; num++) {\r\n          if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum+num)]!=\"yes\" &&\r\n                context.CellInPane(rownum, colnum+num, rowpane, colpane)) {\r\n             span++;\r\n             }\r\n          }\r\n      result.colSpan=span;\r\n      }\r\n\r\n   if (cell.rowspan>1) {\r\n      span=1;\r\n      for (num=1; num<cell.rowspan; num++) {\r\n          if (sheetobj.rowattribs.hide[(rownum+num)+\"\"]!=\"yes\" &&\r\n                context.CellInPane(rownum+num, colnum, rowpane, colpane))\r\n             span++;\r\n         }\r\n      result.rowSpan=span;\r\n      }\r\n\r\n   if (cell.displaystring==undefined || sheetobj.widgetsClean == false) { // cache the display value\r\n      cell.displaystring = SocialCalc.FormatValueForDisplay(sheetobj, cell.datavalue, coord, (linkstyle || context.defaultlinkstyle));\r\n      }\r\n\t\r\n   result.innerHTML = cell.displaystring;\r\n\t  \r\n   num=cell.layout || sheetattribs.defaultlayout;\r\n   if (num && typeof(context.layouts[num]) !== \"undefined\") {\r\n      stylestr+=context.layouts[num]; // use precomputed layout with \"*\"'s filled in\r\n      }\r\n   else {\r\n      stylestr+=scc.defaultCellLayout;\r\n      }\r\n\r\n   num=cell.font || sheetattribs.defaultfont;\r\n   if (num && typeof(context.fonts[num]) !== \"undefined\") { // get expanded font strings in context\r\n      t = context.fonts[num]; // do each - plain \"font:\" style sets all sorts of other values, too (Safari font-stretch problem on cssText)\r\n      stylestr+=\"font-style:\"+t.style+\";font-weight:\"+t.weight+\";font-size:\"+t.size+\";font-family:\"+t.family+\";\";\r\n      }\r\n   else {\r\n      if (scc.defaultCellFontSize) {\r\n         stylestr+=\"font-size:\"+scc.defaultCellFontSize+\";\";\r\n         }\r\n      if (scc.defaultCellFontFamily) {\r\n         stylestr+=\"font-family:\"+scc.defaultCellFontFamily+\";\";\r\n         }\r\n      }\r\n\r\n   num=cell.color || sheetattribs.defaultcolor;\r\n   if (num && typeof(sheetobj.colors[num]) !== \"undefined\") stylestr+=\"color:\"+sheetobj.colors[num]+\";\";\r\n\r\n   num=cell.bgcolor || sheetattribs.defaultbgcolor;\r\n   if (num && typeof(sheetobj.colors[num]) !== \"undefined\") stylestr+=\"background-color:\"+sheetobj.colors[num]+\";\";\r\n\r\n   num=cell.cellformat;\r\n   if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") {\r\n      stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\r\n      }\r\n   else {\r\n      t=cell.valuetype.charAt(0);\r\n      if (t==\"t\") {\r\n         num=sheetattribs.defaulttextformat;\r\n         if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\r\n         }\r\n      else if (t==\"n\") {\r\n         num=sheetattribs.defaultnontextformat;\r\n         if (num && typeof(sheetobj.cellformats[num]) !== \"undefined\") {\r\n            stylestr+=\"text-align:\"+sheetobj.cellformats[num]+\";\";\r\n            }\r\n         else {\r\n            stylestr+=\"text-align:right;\";\r\n            }\r\n         }\r\n      else stylestr+=\"text-align:left;\";\r\n      }\r\n\r\n   // get the end cell for border styling\r\n   if (cell.colspan > 1 || cell.rowspan > 1) {\r\n      endcell = sheetobj.cells[SocialCalc.crToCoord(colnum+(cell.colspan || 1)-1, rownum+(cell.rowspan || 1)-1)];\r\n      }\r\n\r\n   num=cell.bt;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-top:\"+sheetobj.borderstyles[num]+\";\";\r\n\r\n   num=typeof(endcell) != \"undefined\" ? endcell.br : cell.br;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-right:\"+sheetobj.borderstyles[num]+\";\";\r\n   else if (context.showGrid) {\r\n      if (context.CellInPane(rownum, colnum+(cell.colspan || 1), rowpane, colpane))\r\n         t=SocialCalc.crToCoord(colnum+(cell.colspan || 1), rownum);\r\n      else t=\"nomatch\";\r\n      if (context.cellskip[t]) t=context.cellskip[t];\r\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bl)\r\n         stylestr+=\"border-right:\"+context.gridCSS;\r\n      }\r\n\r\n   num=typeof(endcell) != \"undefined\" ? endcell.bb : cell.bb;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-bottom:\"+sheetobj.borderstyles[num]+\";\";\r\n   else if (context.showGrid) {\r\n      if (context.CellInPane(rownum+(cell.rowspan || 1), colnum, rowpane, colpane))\r\n         t=SocialCalc.crToCoord(colnum, rownum+(cell.rowspan || 1));\r\n      else t=\"nomatch\";\r\n      if (context.cellskip[t]) t=context.cellskip[t];\r\n      if (!sheetobj.cells[t] || !sheetobj.cells[t].bt)\r\n         stylestr+=\"border-bottom:\"+context.gridCSS;\r\n      }\r\n\r\n   num=cell.bl;\r\n   if (num && typeof(sheetobj.borderstyles[num]) !== \"undefined\") stylestr+=\"border-left:\"+sheetobj.borderstyles[num]+\";\";\r\n\r\n   if (cell.comment) {\r\n      result.title = cell.comment;\r\n      if (context.showGrid) {\r\n         if (context.commentClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentClassName;\r\n            }\r\n         stylestr+=context.commentCSS;\r\n         }\r\n      else {\r\n         if (context.commentNoGridClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.commentNoGridClassName;\r\n            }\r\n         stylestr+=context.commentNoGridCSS;\r\n         }\r\n      }\r\n\r\n   if (cell.readonly) {\r\n      if (!cell.comment) {\r\n         result.title = context.readonlyComment;\r\n         }\r\n      if (context.showGrid) {\r\n         if (context.readonlyClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.readonlyClassName;\r\n            }\r\n         stylestr+=context.readonlyCSS;\r\n         }\r\n      else {\r\n         if (context.readonlyNoGridClassName) {\r\n            result.className = (result.className ? result.className+\" \" : \"\") + context.readonlyNoGridClassName;\r\n            }\r\n         stylestr+=context.readonlyNoGridCSS;\r\n         }\r\n      }\r\n\r\n   result.style.cssText=stylestr;\r\n\r\n   //!!!!!!!!!\r\n   // NOTE: csss is not supported yet.\r\n   // csss needs to be parsed into pieces to override just the attributes specified, not all with assignment to cssText.\r\n   if (cell.cssc !== undefined) {\r\n      noElement ? (result.className = (result.className ? result.className + ' ' : '') + cell.cssc) : result.classList.add(cell.cssc);\r\n   }\r\n\r\n   t = context.highlights[coord];\r\n   if (t) { // this is a highlit cell: Override style appropriately\r\n      if (t==\"cursor\") t += context.cursorsuffix; // cursor can take alternative forms\r\n      if (context.highlightTypes[t].className) {\r\n         result.className = (result.className ? result.className+\" \" : \"\") + context.highlightTypes[t].className;\r\n         }\r\n      SocialCalc.setStyles(result, context.highlightTypes[t].style);\r\n      }\r\n\r\n   // If hidden column, display: none.\r\n   if (sheetobj.colattribs.hide[SocialCalc.rcColname(colnum)] == \"yes\") {\r\n      result.style.cssText+=\";display:none\";\r\n      }\r\n\r\n   // If hidden row, display: none.\r\n   if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\r\n      result.style.cssText+=\";display:none\";\r\n      }\r\n\r\n   return result;\r\n   }\r\n\r\nSocialCalc.CoordInPane = function(context, coord, rowpane, colpane) {\r\n   var coordToCR = context.coordToCR[coord];\r\n   if (!coordToCR || !coordToCR.row || !coordToCR.col) throw \"Bad coordToCR for \"+coord;\r\n   return context.CellInPane(coordToCR.row, coordToCR.col, rowpane, colpane);\r\n   }\r\n\r\n\r\nSocialCalc.CellInPane = function(context, row, col, rowpane, colpane) {\r\n   var panerowlimits = context.rowpanes[rowpane];\r\n   var panecollimits = context.colpanes[colpane];\r\n   if (!panerowlimits || !panecollimits) throw \"CellInPane called with unknown panes \"+rowpane+\"/\"+colpane;\r\n   if (row < panerowlimits.first || row > panerowlimits.last) return false;\r\n   if (col < panecollimits.first || col > panecollimits.last) return false;\r\n   return true;\r\n   }\r\n\r\nSocialCalc.CreatePseudoElement = function() {\r\n   return {style:{cssText:\"\"}, innerHTML: \"\", className: \"\"};\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// Misc. functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.rcColname = function(c) {\r\n   if (c > 702) c = 702; // maximum number of columns - ZZ\r\n   if (c < 1) c = 1;\r\n   var collow = (c - 1) % 26 + 65;\r\n   var colhigh = Math.floor((c - 1) / 26);\r\n   if (colhigh)\r\n      return String.fromCharCode(colhigh + 64) + String.fromCharCode(collow);\r\n   else\r\n      return String.fromCharCode(collow);\r\n   }\r\n\r\nSocialCalc.letters = [\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\r\n                      \"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\",\"U\",\"V\",\"W\",\"X\",\"Y\",\"Z\"];\r\n\r\nSocialCalc.crToCoord = function(c, r) {\r\n   var result;\r\n   if (c < 1) c = 1;\r\n   if (c > 702) c = 702; // maximum number of columns - ZZ\r\n   if (r < 1) r = 1;\r\n   var collow = (c - 1) % 26;\r\n   var colhigh = Math.floor((c - 1) / 26);\r\n   if (colhigh)\r\n      result = SocialCalc.letters[colhigh-1] + SocialCalc.letters[collow] + r;\r\n   else\r\n      result = SocialCalc.letters[collow] + r;\r\n   return result;\r\n   }\r\n\r\nSocialCalc.coordToCol = {}; // too expensive to set in crToCoord since that is called so many times\r\nSocialCalc.coordToRow = {};\r\n\r\nSocialCalc.coordToCr = function(cr) {\r\n   var c, i, ch;\r\n   var r = SocialCalc.coordToRow[cr];\r\n   if (r) return {row: r, col: SocialCalc.coordToCol[cr]};\r\n   c=0;r=0;\r\n   for (i=0; i<cr.length; i++) { // this was faster than using regexes; assumes well-formed\r\n      ch = cr.charCodeAt(i);\r\n      if (ch==36) ; // skip $'s\r\n      else if (ch<=57) r = 10*r + ch-48;\r\n      else if (ch>=97) c = 26*c + ch-96;\r\n      else if (ch>=65) c = 26*c + ch-64;\r\n      }\r\n   SocialCalc.coordToCol[cr] = c;\r\n   SocialCalc.coordToRow[cr] = r;\r\n   return {row: r, col: c};\r\n\r\n   }\r\n\r\nSocialCalc.ParseRange = function(range) {\r\n   var pos, cr, cr1, cr2;\r\n   if (!range) range = \"A1:A1\"; // error return, hopefully benign\r\n   range = range.toUpperCase();\r\n   pos = range.indexOf(\":\");\r\n   if (pos>=0) {\r\n      cr = range.substring(0,pos);\r\n      cr1 = SocialCalc.coordToCr(cr);\r\n      cr1.coord = cr;\r\n      cr = range.substring(pos+1);\r\n      cr2 = SocialCalc.coordToCr(cr);\r\n      cr2.coord = cr;\r\n      }\r\n   else {\r\n      cr1 = SocialCalc.coordToCr(range);\r\n      cr1.coord = range;\r\n      cr2 = SocialCalc.coordToCr(range);\r\n      cr2.coord = range;\r\n      }\r\n   return {cr1: cr1, cr2: cr2};\r\n   }\r\n\r\nSocialCalc.decodeFromSave = function(s) {\r\n   if (typeof s != \"string\") return s;\r\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\r\n   var r=s.replace(/\\\\c/g,\":\");\r\n   r=r.replace(/\\\\n/g,\"\\n\");\r\n   return r.replace(/\\\\b/g,\"\\\\\");\r\n   }\r\n\r\nSocialCalc.decodeFromAjax = function(s) {\r\n   if (typeof s != \"string\") return s;\r\n   if (s.indexOf(\"\\\\\")==-1) return s; // for performace reasons: replace nothing takes up time\r\n   var r=s.replace(/\\\\c/g,\":\");\r\n   r=r.replace(/\\\\n/g,\"\\n\");\r\n   r=r.replace(/\\\\e/g,\"]]\");\r\n   return r.replace(/\\\\b/g,\"\\\\\");\r\n   }\r\n\r\nSocialCalc.encodeForSave = function(s) {\r\n   if (typeof s != \"string\") return s;\r\n   if (s.indexOf(\"\\\\\")!=-1) // for performace reasons: replace nothing takes up time\r\n      s=s.replace(/\\\\/g,\"\\\\b\");\r\n   if (s.indexOf(\":\")!=-1)\r\n      s=s.replace(/:/g,\"\\\\c\");\r\n   if (s.indexOf(\"\\n\")!=-1)\r\n      s=s.replace(/\\n/g,\"\\\\n\");\r\n   return s;\r\n   }\r\n\r\n//\r\n// Returns estring where &, <, >, \" are HTML escaped\r\n// \r\nSocialCalc.special_chars = function(string) {\r\n\r\n   if (/[&<>\"]/.test(string)) { // only do \"slow\" replaces if something to replace\r\n      string = string.replace(/&/g, \"&amp;\");\r\n      string = string.replace(/</g, \"&lt;\");\r\n      string = string.replace(/>/g, \"&gt;\");\r\n      string = string.replace(/\"/g, \"&quot;\");\r\n      }\r\n   return string;\r\n\r\n   }\r\n\r\nSocialCalc.Lookup = function(value, list) {\r\n\r\n   for (i=0; i<list.length; i++) {\r\n      if (list[i] > value) {\r\n         if (i>0) return i-1;\r\n         else return null;\r\n         }\r\n      }\r\n   return list.length-1; // if all smaller, matches last\r\n\r\n   }\r\n\r\n//\r\n// setStyles(element, cssText)\r\n//\r\n// Takes a pseudo style string (e.g., text-align must be textAlign) and sets\r\n// the element's style value for each style name listed (leaving others unchanged).\r\n// OK to call with null cssText.\r\n//\r\n\r\nSocialCalc.setStyles = function (element, cssText) {\r\n\r\n   var parts, part, pos, name, value;\r\n\r\n   if (!cssText) return;\r\n\r\n   parts = cssText.split(\";\");\r\n   for (part=0; part<parts.length; part++) {\r\n      pos = parts[part].indexOf(\":\"); // find first colon (could be one in url)\r\n      if (pos != -1) {\r\n         name = parts[part].substring(0, pos);\r\n         value = parts[part].substring(pos+1);\r\n         if (name && value) { // if non-null name and value, set style\r\n            element.style[name] = value;\r\n            }\r\n         }\r\n//      namevalue = parts[part].split(\":\");\r\n//      if (namevalue[0]) element.style[namevalue[0]] = namevalue[1];\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// GetViewportInfo() - returns object with viewport width and height, and scroll offsets\r\n//\r\n// Flanagan, JavaScript, 5th Edition, page 276\r\n//\r\n\r\nSocialCalc.GetViewportInfo = function () {\r\n\r\n   var result = {};\r\n\r\n   if (window.innerWidth) { // all but IE\r\n      result.width = window.innerWidth;\r\n      result.height = window.innerHeight;\r\n      result.horizontalScroll = window.pageXOffset;\r\n      result.verticalScroll = window.pageYOffset;\r\n      }\r\n   else {\r\n      if (document.documentElement && document.documentElement.clientWidth) {\r\n         result.width = document.documentElement.clientWidth;\r\n         result.height = document.documentElement.clientHeight;\r\n         result.horizontalScroll = document.documentElement.scrollLeft;\r\n         result.verticalScroll = document.documentElement.scrollTop;\r\n         }\r\n      else if (document.body.clientWidth) {\r\n         result.width = document.body.clientWidth;\r\n         result.height = document.body.clientHeight;\r\n         result.horizontalScroll = document.body.scrollLeft;\r\n         result.verticalScroll = document.body.scrollTop;\r\n         }\r\n      }\r\n\r\n   return result;\r\n   }\r\n\r\n//\r\n// GetElementPosition(element) - returns object with left and top position of the element in the document\r\n//\r\n// Goodman's JavaScript & DHTML Cookbook, 2nd Edition, page 415\r\n//\r\n\r\nSocialCalc.GetElementPosition = function (element) {\r\n\r\n   var offsetLeft = 0;\r\n   var offsetTop = 0;\r\n   while (element) {\r\n      if (SocialCalc.GetComputedStyle(element,'position')=='relative') break;\r\n      offsetLeft+=element.offsetLeft;\r\n      offsetTop+=element.offsetTop;\r\n      element=element.offsetParent;\r\n      }\r\n   return {left:offsetLeft, top:offsetTop};\r\n\r\n   }\r\n\r\n//\r\n// GetElementPositionWithScroll(element) - returns object with left and top position of the element in the document\r\n//\r\n\r\nSocialCalc.GetElementPositionWithScroll = function (element) {\r\n  \r\n   var rect = element.getBoundingClientRect();\r\n   return {\r\n      left:rect.left,\r\n      right:rect.right,\r\n      top:rect.top,\r\n      bottom:rect.bottom,\r\n      width:rect.width?rect.width:rect.right-rect.left,\r\n      height:rect.height?rect.height:rect.bottom-rect.top\r\n      };\r\n\r\n   }\r\n\r\n//\r\n// GetElementFixedParent(element) - checks whether element has a parent with position:fixed\r\n//\r\n\r\nSocialCalc.GetElementFixedParent = function(element) {\r\n\r\n   while (element) {\r\n      if (element.tagName==\"HTML\") break;\r\n      if (SocialCalc.GetComputedStyle(element,'position')=='fixed') return element;\r\n      element=element.parentNode;\r\n      }\r\n      return false;\r\n\r\n   }\r\n\r\n//\r\n// GetComputedStyle(element, style) - returns computed style value\r\n//\r\n// http://blog.stchur.com/2006/06/21/css-computed-style/\r\n//\r\n\r\nSocialCalc.GetComputedStyle = function (element, style) {\r\n\r\n   var computedStyle;\r\n   if (typeof element.currentStyle != 'undefined') { // IE\r\n      computedStyle = element.currentStyle;\r\n      }\r\n   else {\r\n      computedStyle = document.defaultView.getComputedStyle(element, null);\r\n      }\r\n   return computedStyle[style];\r\n\r\n   }\r\n\r\n//\r\n// LookupElement(element, array) - returns array element which is an object with \"element\" of element\r\n//\r\n\r\nSocialCalc.LookupElement = function (element, array) {\r\n\r\n   var i;\r\n   for (i=0; i<array.length; i++) {\r\n      if (array[i].element == element) return array[i];\r\n      }\r\n   return null;\r\n\r\n   }\r\n\r\n//\r\n// AssignID(obj, element, id) - Optionally assigns an ID with a prefix to the element\r\n//\r\n\r\nSocialCalc.AssignID = function (obj, element, id) {\r\n\r\n   if (obj.idPrefix) { // Object must have a non-empty idPrefix attribute\r\n      element.id = obj.idPrefix + id;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.GetCellContents(sheetobj, coord)\r\n//\r\n// Returns the contents (value, formula, constant, etc.) of a cell\r\n// with appropriate prefix (\"'\", \"=\", etc.)\r\n//\r\n\r\nSocialCalc.GetCellContents = function(sheetobj, coord) {\r\n\r\n   var result = \"\";\r\n   var cellobj = sheetobj.cells[coord];\r\n   if (cellobj) {\r\n      switch (cellobj.datatype) {\r\n         case \"v\":\r\n            result = cellobj.datavalue+\"\";\r\n            break;\r\n         case \"t\":\r\n            result = \"'\"+cellobj.datavalue;\r\n            break;\r\n         case \"f\":\r\n            result = \"=\"+cellobj.formula;\r\n            break;\r\n         case \"c\":\r\n            result = cellobj.formula;\r\n            break;\r\n         default:\r\n            break;\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// Routines translated from the SocialCalc 1.1.0 Perl code:\r\n//\r\n// (Makes use of the FormatNumber JavaScript code translated from the Perl.)\r\n//\r\n\r\n//\r\n// displayvalue = FormatValueForDisplay(sheetobj, value, cr, linkstyle)\r\n//\r\n// Returns a string, in HTML, for the contents of a cell.\r\n//\r\n// The value is a either numeric or text, the cr is the coord of the cell\r\n// (its cell properties are used to determine formatting), and linkstyle\r\n// is a value passed to wiki-text expansion routines specifying the\r\n// purpose of the rendering so, for example, links can be rendered differently\r\n// during edit than with plain HTML.\r\n//\r\n\r\nSocialCalc.FormatValueForDisplay = function(sheetobj, value, cr, linkstyle) {\r\n\r\n   var valueformat, has_parens, has_commas, valuetype, valuesubtype;\r\n   var displayvalue;\r\n\r\n   var sheetattribs=sheetobj.attribs;\r\n   var scc=SocialCalc.Constants;\r\n\r\n   var cell=sheetobj.cells[cr];\r\n\r\n   if (!cell) { // get an empty cell if not there\r\n      cell=new SocialCalc.Cell(cr);\r\n      }\r\n\r\n   displayvalue = value;\r\n\r\n   valuetype = cell.valuetype || \"\"; // get type of value to determine formatting\r\n   valuesubtype = valuetype.substring(1);\r\n   \r\n   // eddy setup display cell {\r\n   valueinputwidget = valuetype.charAt(1); \r\n   var formula_name= valuetype.substring(2);\r\n   var html_display_value = null; \r\n   var html_formated_value = null;\r\n   // }\r\n\r\n   valuetype = valuetype.charAt(0);\r\n   \r\n   \r\n   if (cell.errors || valuetype==\"e\") {\r\n      displayvalue = cell.errors || valuesubtype || \"Error in cell\";\r\n      return displayvalue;\r\n      }\r\n\r\n   if (valuetype==\"t\") {\r\n      valueformat = sheetobj.valueformats[cell.textvalueformat-0] || sheetobj.valueformats[sheetattribs.defaulttextvalueformat-0] || \"\";\r\n      if (valueformat==\"formula\") {\r\n         if (cell.datatype==\"f\") {\r\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else if (cell.datatype==\"c\") {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\r\n            }\r\n         return displayvalue;\r\n         }\r\n\t  var html_display_value = displayvalue; // eddy\r\n      displayvalue = SocialCalc.format_text_for_display(displayvalue, cell.valuetype, valueformat, sheetobj, linkstyle, cell.nontextvalueformat);\r\n\t  var html_formated_value = displayvalue; // eddy\r\n\t  \r\n      }\r\n\r\n   else if (valuetype==\"n\") {\r\n      valueformat = cell.nontextvalueformat;\r\n      if (valueformat==null || valueformat==\"\") { //\r\n         valueformat = sheetattribs.defaultnontextvalueformat;\r\n         }\r\n      valueformat = sheetobj.valueformats[valueformat-0];\r\n      if (valueformat==null || valueformat==\"none\") {\r\n         valueformat = \"\";\r\n         }\r\n\t\t \r\n\t\t \r\n      if (valueformat==\"formula\") {\r\n         if (cell.datatype==\"f\") {\r\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else if (cell.datatype==\"c\") {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else {\r\n            displayvalue = SocialCalc.special_chars(\"'\"+displayvalue) || \"&nbsp;\";\r\n            }\r\n         return displayvalue;\r\n         }\r\n      else if (valueformat==\"forcetext\") {\r\n         if (cell.datatype==\"f\") {\r\n            displayvalue = SocialCalc.special_chars(\"=\"+cell.formula) || \"&nbsp;\";\r\n            }\r\n         else if (cell.datatype==\"c\") {\r\n            displayvalue = SocialCalc.special_chars(cell.formula) || \"&nbsp;\";\r\n            }\r\n         else {\r\n            displayvalue = SocialCalc.special_chars(displayvalue) || \"&nbsp;\";\r\n            }\r\n         return displayvalue;\r\n         }\r\n\t\t \r\n\t  var html_display_value = displayvalue; // eddy\r\n      displayvalue = SocialCalc.format_number_for_display(displayvalue, cell.valuetype, valueformat);\r\n\t  var html_formated_value = displayvalue; // eddy\r\n\r\n      }\r\n   else { // unknown type - probably blank\r\n      displayvalue = \"&nbsp;\";\r\n      }\r\n\r\n\r\n   // eddy display cell HTML {      \r\n   if(valueinputwidget==\"i\" && html_display_value!=null && html_formated_value!=null) {\r\n     var parameters = sheetobj.ioParameterList[cr];\r\n    \r\n\t   var formula_details = SocialCalc.Formula.FunctionList[formula_name]; \r\n//\t var ecell = SocialCalc.GetSpreadsheetControlObject().editor.ecell; // check if widget has focus\r\n//\t SocialCalc.GetSpreadsheetControlObject().debug.push({formula_name:formula_name});\r\n\t\t if( formula_details) {\r\n\t\t\t var cell_html = formula_details[5];\r\n\t\t\t // var cell_html = \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction('<%=cell_reference%>');\\\"><%=display_value%></button>\";\r\n\t\t\t \r\n\t\t\t var checkedValue = (html_display_value == 0) ? \"\" : \"checked\"; // for checkbox\r\n\t\t\t cell_html = cell_html.replace(/<%=checked%>/g, checkedValue);\r\n\t\t\t cell_html = cell_html.replace(/<%=formated_value%>/g, html_formated_value);\r\n       cell_html = cell_html.replace(/<%=display_value%>/g, html_display_value);\r\n       // replace widget HTML with parameter \r\n       // FOR each parameter\r\n       var parameterValue; // set to value of param for if coord, value of cell\r\n       if(parameters) { \r\n         // add forumla parameters to widget html\r\n         for(var index=0; index < parameters.length; index ++) {\r\n           // IF coord THEN replace with cell value\r\n           if(parameters[index].type == 'coord') {\r\n             parameterValue = sheetobj.GetAssuredCell(parameters[index].value).datavalue;\r\n           } else {\r\n             // ELSE with param value \r\n             parameterValue = parameters[index].value;\r\n           }\r\n           var paramRegExp = new RegExp(\"<%=parameter\"+index+\"_value%>\",'g');\r\n           cell_html = cell_html.replace(paramRegExp, parameterValue);\r\n         }\r\n         if(parameters.html) { // add html created in formula1.js to widget\r\n           for(var htmlIndex=0; htmlIndex < parameters.html.length; htmlIndex ++) {\r\n             var paramRegExp = new RegExp(\"<%=html\"+htmlIndex+\"_value%>\",'g');\r\n             cell_html = cell_html.replace(paramRegExp, parameters.html[htmlIndex]);\r\n           }\r\n         }\r\n         if(parameters.css) { // add style(css) formula css value, if any - e.g. =textbox(\"\")+style(\"margin: 8px 0;\")\r\n           // * RegEx Unit Test **  https://regex101.com/r/oV7wU5/2\r\n           cell_html = cell_html.replace(/^(<\\w+)(\\W)/, \"$1 style='\"+parameters.css+ \"'$2\");\r\n         }\r\n\r\n       }\r\n       \r\n\t\t\t return cell_html.replace(/<%=cell_reference%>/g, cr);\r\n\t\t\t }\r\n\t\t return \"error:Widget HTML missing\";\r\n\t }\r\n   // }\r\n\t  \r\n\t  \r\n\t  \r\n   return displayvalue;\r\n\r\n   }\r\n\r\n \r\n   \r\n//\r\n// displayvalue = format_text_for_display(rawvalue, valuetype, valueformat, sheetobj, linkstyle, nontextvalueformat)\r\n//\r\n\r\nSocialCalc.format_text_for_display = function(rawvalue, valuetype, valueformat, sheetobj, linkstyle, nontextvalueformat) {\r\n\r\n   var valueformat, valuesubtype, dvsc, dvue, textval;\r\n   var displayvalue;\r\n\r\n   valuesubtype = valuetype.substring(1);\r\n\r\n   displayvalue = rawvalue;\r\n\r\n   if (valueformat==\"none\" || valueformat==null) valueformat=\"\";\r\n   if (!/^(text-|custom|hidden)/.test(valueformat)) valueformat=\"\";\r\n   if (valueformat==\"\" || valueformat==\"General\") { // determine format from type\r\n      if (valuesubtype==\"h\") valueformat=\"text-html\";\r\n      if (valuesubtype==\"w\" || valuesubtype==\"r\") valueformat=\"text-wiki\";\r\n      if (valuesubtype==\"l\") valueformat=\"text-link\";\r\n      if (!valuesubtype) valueformat=\"text-plain\";\r\n      }\r\n   if (valueformat==\"text-html\") { // HTML - output as it as is\r\n      ;\r\n      }\r\n   else if (SocialCalc.Callbacks.expand_wiki && /^text-wiki/.test(valueformat)) { // do general wiki markup\r\n      displayvalue = SocialCalc.Callbacks.expand_wiki(displayvalue, sheetobj, linkstyle, valueformat);\r\n      }\r\n   else if (valueformat==\"text-wiki\") { // wiki text\r\n      displayvalue = (SocialCalc.Callbacks.expand_markup\r\n                      && SocialCalc.Callbacks.expand_markup(displayvalue, sheetobj, linkstyle)) || // do old wiki markup\r\n                     SocialCalc.special_chars(\"wiki-text:\"+displayvalue);\r\n      }\r\n   else if (valueformat==\"text-url\") { // text is a URL for a link\r\n      dvsc = SocialCalc.special_chars(displayvalue);\r\n      dvue = encodeURI(displayvalue);\r\n      displayvalue = '<a href=\"'+dvue+'\">'+dvsc+'</a>';\r\n      }\r\n   else if (valueformat==\"text-link\") { // more extensive link capabilities for regular web links\r\n      displayvalue = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat);\r\n      }\r\n   else if (valueformat==\"text-image\") { // text is a URL for an image\r\n      dvue = encodeURI(displayvalue);\r\n      displayvalue = '<img src=\"'+dvue+'\">';\r\n      }\r\n   else if (valueformat.substring(0,12)==\"text-custom:\") { // construct a custom text format: @r = text raw, @s = special chars, @u = url encoded\r\n      dvsc = SocialCalc.special_chars(displayvalue); // do special chars\r\n      dvsc = dvsc.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n      dvsc = dvsc.replace(/\\n/g, \"<br>\");  // keep line breaks\r\n      dvue = encodeURI(displayvalue);\r\n      textval={};\r\n      textval.r = displayvalue;\r\n      textval.s = dvsc;\r\n      textval.u = dvue;\r\n      displayvalue = valueformat.substring(12); // remove \"text-custom:\"\r\n      displayvalue = displayvalue.replace(/@(r|s|u)/g, function(a,c){return textval[c];}); // replace placeholders\r\n      }\r\n   else if (valueformat.substring(0,6)==\"custom\") { // custom\r\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\r\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\r\n      displayvalue += \" (custom format)\";\r\n      }\r\n   else if (valueformat==\"hidden\") {\r\n      displayvalue = \"&nbsp;\";\r\n      }\r\n   else if (nontextvalueformat != null && nontextvalueformat != \"\" && sheetobj.valueformats[nontextvalueformat-0] != \"none\" && sheetobj.valueformats[nontextvalueformat-0] != \"\" ) {\r\n      valueformat = sheetobj.valueformats[nontextvalueformat];\r\n      displayvalue = SocialCalc.format_number_for_display(rawvalue, valuetype, valueformat);\r\n      }\r\n   else { // plain text\r\n      displayvalue = SocialCalc.special_chars(displayvalue); // do special chars\r\n      displayvalue = displayvalue.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n      displayvalue = displayvalue.replace(/\\n/g, \"<br>\"); // keep line breaks\r\n      }\r\n\r\n   return displayvalue;\r\n\r\n   }\r\n\r\n\r\n//\r\n// displayvalue = format_number_for_display(rawvalue, valuetype, valueformat)\r\n//\r\n\r\nSocialCalc.format_number_for_display = function(rawvalue, valuetype, valueformat) {\r\n\r\n   var value, valuesubtype;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   value = rawvalue-0;\r\n\r\n   valuesubtype = valuetype.substring(1);\r\n\r\n   if (valueformat==\"Auto\" || valueformat==\"\") { // cases with default format\r\n      if (valuesubtype==\"%\") { // will display a % character\r\n         valueformat = scc.defaultFormatp;\r\n         }\r\n      else if (valuesubtype=='$') {\r\n         valueformat = scc.defaultFormatc;\r\n         }\r\n      else if (valuesubtype=='dt') {\r\n         valueformat = scc.defaultFormatdt;\r\n         }\r\n      else if (valuesubtype=='d') {\r\n         valueformat = scc.defaultFormatd;\r\n         }\r\n      else if (valuesubtype=='t') {\r\n         valueformat = scc.defaultFormatt;\r\n         }\r\n      else if (valuesubtype=='l') {\r\n         valueformat = 'logical';\r\n         }\r\n      else {\r\n         valueformat = \"General\";\r\n         }\r\n      }\r\n\r\n   if (valueformat==\"logical\") { // do logical format\r\n      return value ? scc.defaultDisplayTRUE : scc.defaultDisplayFALSE;\r\n      }\r\n\r\n   if (valueformat==\"hidden\") { // do hidden format\r\n      return \"&nbsp;\";\r\n      }\r\n\r\n   // Use format\r\n\r\n   return SocialCalc.FormatNumber.formatNumberWithFormat(rawvalue, valueformat, \"\");\r\n\r\n   }\r\n\r\n//\r\n// valueinfo = DetermineValueType(rawvalue)\r\n//\r\n// Takes a value and looks for special formatting like $, %, numbers, etc.\r\n// Returns the value as a number or string and the type as {value: value, type: type}.\r\n// Tries to follow the spec for spreadsheet function VALUE(v).\r\n//\r\n\r\nSocialCalc.DetermineValueType = function(rawvalue) {\r\n\r\n   var value = rawvalue + \"\";\r\n   var type = \"t\";\r\n   var tvalue, matches, year, hour, minute, second, denom, num, intgr, constr;\r\n\r\n   tvalue = value.replace(/^\\s+/, \"\"); // remove leading and trailing blanks\r\n   tvalue = tvalue.replace(/\\s+$/, \"\");\r\n\r\n   if (value.length==0) {\r\n      type = \"\";\r\n      }\r\n   else if (value.match(/^\\s+$/)) { // just blanks\r\n      ; // leave type \"t\"\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*(?:[eE][-+]?\\d+)?$/)) { // general number, including E\r\n      value = tvalue - 0; // try converting to number\r\n      if (isNaN(value)) { // leave alone - catches things like plain \"-\"\r\n         value = rawvalue + \"\";\r\n         }\r\n      else {\r\n         type = \"n\";\r\n         }\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\d*(?:\\.)?\\d*\\s*%$/)) { // percent form: 15.1%\r\n      value = (tvalue.slice(0, -1) - 0) / 100; // convert and scale\r\n      type = \"n%\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\$\\s*\\d*(?:\\.)?\\d*\\s*$/) && tvalue.match(/\\d/)) { // $ format: $1.49\r\n      value = tvalue.replace(/\\$/, \"\") - 0;\r\n      type = \"n$\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*$/)) { // number format ignoring commas: 1,234.49\r\n      value = tvalue.replace(/,/g, \"\") - 0;\r\n      type = \"n\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?(\\d*,\\d*)+(?:\\.)?\\d*\\s*%$/)) { // % with commas: 1,234.49%\r\n      value = (tvalue.replace(/[%,]/g, \"\") - 0) / 100;\r\n      type = \"n%\";\r\n      }\r\n   else if (tvalue.match(/^[-+]?\\$\\s*(\\d*,\\d*)+(?:\\.)?\\d*$/) && tvalue.match(/\\d/)) { // $ and commas: $1,234.49\r\n      value = tvalue.replace(/[\\$,]/g, \"\") - 0;\r\n      type = \"n$\";\r\n      }\r\n   else if (matches=value.match(/^(\\d{1,2})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,4})\\s*$/)) { // MM-DD-YYYY, MM/DD/YYYY\r\n      year = matches[3] - 0;\r\n      year = year < 1000 ? year + 2000 : year;\r\n      value = ((navigator.language).indexOf(\"fr\") === 0)  ? (SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[1]-0)-2415019) : (SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[1]-0, matches[2]-0)-2415019);\r\n      type = \"nd\";\r\n      }\r\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD\r\n      year = matches[1]-0;\r\n      year = year < 1000 ? year + 2000 : year;\r\n      value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\r\n      type = \"nd\";\r\n      }\r\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2}) (\\d{1,2}):(\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD HH:MM\r\n     // eddy added YYYY-MM-DD, YYYY/MM/DD HH:MM\r\n     year = matches[1]-0;\r\n     year = year < 1000 ? year + 2000 : year;\r\n     hour = matches[4]-0;\r\n     minute = matches[5]-0;\r\n     value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\r\n     type = \"nd\";\r\n     if (hour < 24 && minute < 60) {\r\n       value += hour/24 + minute/(24*60);\r\n       type = \"ndt\";\r\n       }\r\n     }\r\n   else if (matches=value.match(/^(\\d{4})[\\/\\-](\\d{1,2})[\\/\\-](\\d{1,2}) (\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // YYYY-MM-DD, YYYY/MM/DD HH:MM:SS\r\n     // eddy added YYYY-MM-DD, YYYY/MM/DD HH:MM:SS\r\n     year = matches[1]-0;\r\n     year = year < 1000 ? year + 2000 : year;\r\n     hour = matches[4]-0;\r\n     minute = matches[5]-0;\r\n     second = matches[6]-0;\r\n     value = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, matches[2]-0, matches[3]-0)-2415019;\r\n     type = \"nd\";\r\n     if (hour < 24 && minute < 60 && second < 60) {\r\n       value += hour/24 + minute/(24*60) + second/(24*60*60);\r\n       type = \"ndt\";\r\n       }\r\n     }\r\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM\r\n      hour = matches[1]-0;\r\n      minute = matches[2]-0;\r\n      if (hour < 24 && minute < 60) {\r\n         value = hour/24 + minute/(24*60);\r\n         type = \"nt\";\r\n         }\r\n      }\r\n   else if (matches=value.match(/^(\\d{1,2}):(\\d{1,2}):(\\d{1,2})\\s*$/)) { // HH:MM:SS\r\n      hour = matches[1]-0;\r\n      minute = matches[2]-0;\r\n      second = matches[3]-0;\r\n      if (hour < 24 && minute < 60 && second < 60) {\r\n         value = hour/24 + minute/(24*60) + second/(24*60*60);\r\n         type = \"nt\";\r\n         }\r\n      }\r\n   else if (matches=value.match(/^\\s*([-+]?\\d+) (\\d+)\\/(\\d+)\\s*$/)) { // 1 1/2\r\n      intgr = matches[1]-0;\r\n      num = matches[2]-0;\r\n      denom = matches[3]-0;\r\n      if (denom && denom > 0) {\r\n         value = intgr + (intgr < 0 ? -num/denom : num/denom);\r\n         type = \"n\";\r\n         }\r\n      }\r\n   else if (constr=SocialCalc.InputConstants[value.toUpperCase()]) { // special constants, like \"false\" and #N/A\r\n      num = constr.indexOf(\",\");\r\n      value = constr.substring(0,num)-0;\r\n      type = constr.substring(num+1);\r\n      }\r\n   else if (tvalue.length > 7 && tvalue.substring(0,7).toLowerCase()==\"http://\") { // URL\r\n      value = tvalue;\r\n      type = \"tl\";\r\n      }\r\n   else if (tvalue.match(/<([A-Z][A-Z0-9]*)\\b[^>]*>[\\s\\S]*?<\\/\\1>/i)) { // HTML\r\n      value = tvalue;\r\n      type = \"th\";\r\n      }\r\n\r\n   return {value: value, type: type};\r\n\r\n   }\r\n\r\nSocialCalc.InputConstants = { // strings that turn into constants for SocialCalc.DetermineValueType\r\n      \"TRUE\": \"1,nl\", \"FALSE\": \"0,nl\", \"#N/A\": \"0,e#N/A\", \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\",\r\n      \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\", \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\r\n\r\n//\r\n// result = default_expand_markup(displayvalue, sheetobj, linkstyle)\r\n//\r\n// Processes wiki-text -- this is a placeholder.\r\n// Reference to here in SocialCalc.expand_markup should be replaced by application-specific routine.\r\n//\r\n\r\nSocialCalc.default_expand_markup = function(displayvalue, sheetobj, linkstyle) {\r\n\r\n   var result = displayvalue;\r\n\r\n   result = SocialCalc.special_chars(result); // do special chars\r\n   result = result.replace(/  /g, \"&nbsp; \"); // keep multiple spaces\r\n   result = result.replace(/\\n/g, \"<br>\"); // keep line breaks\r\n\r\n   return result; // do very little by default\r\n\r\n   result = result.replace(/('*)'''(.*?)'''/g, \"$1<b>$2<\\/b>\"); // Wiki-style bold/italics\r\n   result = result.replace(/''(.*?)''/g, \"<i>$1<\\/i>\");\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.expand_text_link(displayvalue, sheetobj, linkstyle, valueformat)\r\n//\r\n// Parses link text (URL, descriptions, pagenames, workspace names) and returns HTML\r\n//\r\n\r\nSocialCalc.expand_text_link = function(displayvalue, sheetobj, linkstyle, valueformat) {\r\n\r\n   var desc, tb, str;\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var url = \"\";\r\n   var parts = SocialCalc.ParseCellLinkText(displayvalue+\"\");\r\n\r\n   if (parts.desc) {\r\n      desc = SocialCalc.special_chars(parts.desc);\r\n      }\r\n   else {\r\n      desc = parts.pagename ? scc.defaultPageLinkFormatString : scc.defaultLinkFormatString;\r\n      }\r\n\r\n   if (displayvalue.length > 7 && displayvalue.substring(0,7).toLowerCase()==\"http://\" \r\n      && displayvalue.charAt(displayvalue.length-1)!=\">\") {\r\n      desc = desc.substring(7); // remove http:// unless explicit\r\n      }\r\n\r\n   tb = (parts.newwin || !linkstyle) ? ' target=\"_blank\"' : \"\";\r\n\r\n   if (parts.pagename) {\r\n      if (SocialCalc.Callbacks.MakePageLink) {\r\n         url = SocialCalc.Callbacks.MakePageLink(parts.pagename, parts.workspacename, linkstyle, valueformat);\r\n         }\r\n//      else if (parts.workspace) {\r\n//         url = \"/\" + encodeURI(parts.workspace) + \"/\" + encodeURI(parts.pagename);\r\n//         }\r\n//      else {\r\n//         url = parts.pagename;\r\n//         }\r\n      }\r\n   else {\r\n      url = encodeURI(parts.url);\r\n      }\r\n   str = '<a href=\"' + url + '\"' + tb + '>' + desc + '</a>';\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.ParseCellLinkText(str)\r\n//\r\n// Given: url = http://www.someurl.com/more, desc = Some descriptive text\r\n//\r\n// Takes the following:\r\n//\r\n//    url\r\n//    <url>\r\n//    desc<url>\r\n//    \"desc\"<url>\r\n//    <<>> instead of <> => target=\"_blank\" (new window)\r\n//\r\n//    [page name]\r\n//    \"desc\"[page name]\r\n//    desc[page name]\r\n//    {workspace name [page name]}\r\n//    \"desc\"{workspace name [page name]}\r\n//    [[]] instead of [] => target=\"_blank\" (new window)\r\n//\r\n//\r\n// Returns: {url: url, desc: desc, newwin: t/f, pagename: pagename, workspace: workspace}\r\n//\r\n\r\nSocialCalc.ParseCellLinkText = function(str) {\r\n\r\n   var result = {url: \"\", desc: \"\", newwin: false, pagename: \"\", workspace: \"\"};\r\n\r\n   var pageform = false;\r\n   var urlend = str.length - 1;\r\n   var descstart = 0;\r\n   var lastlt = str.lastIndexOf(\"<\");\r\n   var lastbrkt = str.lastIndexOf(\"[\");\r\n   var lastbrace = str.lastIndexOf(\"{\");\r\n   var descend = -1;\r\n\r\n   if ((str.charAt(urlend) != \">\" || lastlt == -1)\r\n         && (str.charAt(urlend) != \"]\" || lastbrkt == -1)\r\n         && (str.charAt(urlend) != \"}\" || str.charAt(urlend-1) != \"]\" || \r\n             lastbrace == -1 || lastbrkt == -1 || lastbrkt < lastbrace)) { // plain url\r\n      urlend++;\r\n      descend = urlend;\r\n      }\r\n   else { // some markup\r\n      if (str.charAt(urlend)==\">\") { // url form\r\n         descend = lastlt - 1;\r\n         if (lastlt > 0 && str.charAt(descend) == \"<\" && str.charAt(urlend-1) == \">\") {\r\n            descend--;\r\n            urlend--;\r\n            result.newwin = true;\r\n            }\r\n         }\r\n\r\n      else if (str.charAt(urlend)==\"]\") { // plain page form\r\n         descend = lastbrkt - 1;\r\n         pageform = true;\r\n         if (lastbrkt > 0 && str.charAt(descend) == \"[\" && str.charAt(urlend-1) == \"]\") {\r\n            descend--;\r\n            urlend--;\r\n            result.newwin = true;\r\n            }\r\n         }\r\n\r\n      else if (str.charAt(urlend)==\"}\") { // page and workspace form\r\n         descend = lastbrace - 1;\r\n         pageform = true;\r\n         wsend = lastbrkt;\r\n         urlend--;\r\n         if (lastbrkt > 0 && str.charAt(lastbrkt-1) == \"[\" && str.charAt(urlend-1) == \"]\") {\r\n            wsend = lastbrkt-1;\r\n            urlend--;\r\n            result.newwin = true;\r\n            }\r\n         if (str.charAt(wsend-1)==\" \") { // trim trailing space in workspace name\r\n            wsend--;\r\n            }\r\n         result.workspace = str.substring(lastbrace+1, wsend) || \"\";\r\n         }\r\n\r\n      if (str.charAt(descend)==\" \") { // trim trailing space on desc\r\n         descend--;\r\n         }\r\n\r\n      if (str.charAt(descstart) == '\"' && str.charAt(descend) == '\"') {\r\n         descstart++;\r\n         descend--;\r\n         }\r\n      }\r\n\r\n   if (pageform) {\r\n      result.pagename = str.substring(lastbrkt+1, urlend) || \"\";\r\n      }\r\n   else {\r\n      result.url = str.substring(lastlt+1, urlend) || \"\";\r\n      }\r\n\r\n   if (descend >= descstart) {\r\n      result.desc = str.substring(descstart, descend+1);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.ConvertSaveToOtherFormat(savestr, outputformat, dorecalc)\r\n//\r\n// Returns a string in the specificed format: \"scsave\", \"html\", \"csv\", \"tab\" (tab delimited)\r\n// If dorecalc is true, performs a recalc after loading (NO: obsolete!).\r\n//\r\n\r\nSocialCalc.ConvertSaveToOtherFormat = function(savestr, outputformat, dorecalc) {\r\n\r\n   var sheet, context, clipextents, div, ele, row, col, cr, cell, str;\r\n\r\n   var result = \"\";\r\n\r\n   if (outputformat == \"scsave\") {\r\n      return savestr;\r\n      }\r\n\r\n   if (savestr == \"\") {\r\n      return \"\";\r\n      }\r\n\r\n   sheet = new SocialCalc.Sheet();\r\n   sheet.ParseSheetSave(savestr);\r\n\r\n   if (dorecalc) {\r\n      // no longer supported as of 9/10/08\r\n      // Recalc is now async, so can't do it this way\r\n      throw(\"SocialCalc.ConvertSaveToOtherFormat: Not doing recalc.\");\r\n      }\r\n\r\n   if (sheet.copiedfrom) {\r\n      clipextents = SocialCalc.ParseRange(sheet.copiedfrom);\r\n      }\r\n   else {\r\n      clipextents = {cr1: {row: 1, col: 1}, cr2: {row: sheet.attribs.lastrow, col: sheet.attribs.lastcol}};\r\n      }\r\n\r\n   if (outputformat == \"html\") {\r\n      context=new SocialCalc.RenderContext(sheet);\r\n      if (sheet.copiedfrom) {\r\n         context.rowpanes[0] = {first: clipextents.cr1.row, last: clipextents.cr2.row};\r\n         context.colpanes[0] = {first: clipextents.cr1.col, last: clipextents.cr2.col};\r\n         }\r\n      div = document.createElement(\"div\");\r\n      ele = context.RenderSheet(null, context.defaultHTMLlinkstyle);\r\n      div.appendChild(ele);\r\n      delete context;\r\n      delete sheet;\r\n      result = div.innerHTML;\r\n      delete ele;\r\n      delete div;\r\n      return result;\r\n      }\r\n\r\n   for (row = clipextents.cr1.row; row <= clipextents.cr2.row; row++) {\r\n      for (col = clipextents.cr1.col; col <= clipextents.cr2.col; col++) {\r\n         cr = SocialCalc.crToCoord(col, row);\r\n         cell = sheet.GetAssuredCell(cr);\r\n\r\n         if (cell.errors) {\r\n            str = cell.errors;\r\n            }\r\n         else {\r\n            str = cell.datavalue+\"\"; // get value as text\r\n            }\r\n\r\n         if (outputformat == \"csv\") {\r\n            if (str.indexOf('\"')!=-1) {\r\n               str = str.replace(/\"/g, '\"\"'); // double quotes\r\n               }\r\n            if (/[, \\n\"]/.test(str)) {\r\n               str = '\"' + str + '\"'; // add quotes\r\n               }\r\n            if (col>clipextents.cr1.col) {\r\n               str = \",\" + str; // add commas\r\n               }\r\n            }\r\n         else if (outputformat == \"tab\") {\r\n            if (str.indexOf('\\n')!=-1) { // if multiple lines\r\n               if (str.indexOf('\"')!=-1) {\r\n                  str = str.replace(/\"/g, '\"\"'); // double quotes\r\n                  }\r\n               str = '\"' + str + '\"'; // add quotes\r\n               }\r\n            if (col>clipextents.cr1.col) {\r\n               str = \"\\t\" + str; // add tabs\r\n               }\r\n            }\r\n         result += str;\r\n         }\r\n      result += \"\\n\";\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.ConvertOtherFormatToSave(inputstr, inputformat)\r\n//\r\n// Returns a string converted from the specified format: \"scsave\", \"csv\", \"tab\" (tab delimited)\r\n//\r\n\r\nSocialCalc.ConvertOtherFormatToSave = function(inputstr, inputformat) {\r\n\r\n   var sheet, context, lines, i, line, value, inquote, j, ch, values, row, col, cr, maxc;\r\n\r\n   var result = \"\";\r\n\r\n   var AddCell = function() {\r\n      col++;\r\n      if (col>maxc) maxc = col;\r\n      cr = SocialCalc.crToCoord(col, row);\r\n      SocialCalc.SetConvertedCell(sheet, cr, value);\r\n      value = \"\";\r\n      }\r\n\r\n   if (inputformat == \"scsave\") {\r\n      return inputstr;\r\n      }\r\n\r\n   sheet = new SocialCalc.Sheet();\r\n\r\n   lines = inputstr.split(/\\r\\n|\\n/);\r\n\r\n   maxc = 0;\r\n   if (inputformat == \"csv\") {\r\n      row = 0;\r\n      inquote = false;\r\n      for (i=0; i<lines.length; i++) {\r\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\r\n            break;\r\n            }\r\n         if (inquote) { // if inquote, just continue from where left off\r\n            value += \"\\n\";\r\n            }\r\n         else { // otherwise next row\r\n            value = \"\";\r\n            row++;\r\n            col = 0;\r\n            }\r\n         line = lines[i];\r\n         for (j=0; j<line.length; j++) {\r\n            ch = line.charAt(j);\r\n            if (ch == '\"') {\r\n               if (inquote) {\r\n                  if (j<line.length-1 && line.charAt(j+1) == '\"') { // double quotes\r\n                     j++; // skip the second one\r\n                     value += '\"'; // add one quote\r\n                     }\r\n                  else {\r\n                     inquote = false;\r\n                     if (j==line.length-1) { // at end of line\r\n                        AddCell();\r\n                        }\r\n                     }\r\n                  }\r\n               else {\r\n                  inquote = true;\r\n                  }\r\n               continue;\r\n               }\r\n            if (ch == \",\" && !inquote) {\r\n               AddCell();\r\n               }\r\n            else {\r\n               value += ch;\r\n               }\r\n            if (j==line.length-1 && !inquote) {\r\n               AddCell();\r\n               }\r\n            }\r\n         }\r\n      if (maxc>0) {\r\n         sheet.attribs.lastrow = row;\r\n         sheet.attribs.lastcol = maxc;\r\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\r\n         }\r\n      }\r\n\r\n   if (inputformat == \"tab\") {\r\n      row = 0;\r\n      inquote = false;\r\n      for (i=0; i<lines.length; i++) {\r\n         if (i==lines.length-1 && lines[i]==\"\") { // extra null line - ignore\r\n            break;\r\n            }\r\n         if (inquote) { // if inquote, just continue from where left off\r\n            value += \"\\n\";\r\n            }\r\n         else { // otherwise next row\r\n            value = \"\";\r\n            row++;\r\n            col = 0;\r\n            }\r\n         line = lines[i];\r\n         for (j=0; j<line.length; j++) {\r\n            ch = line.charAt(j);\r\n            if (ch == '\"') {\r\n               if (inquote) {\r\n                  if (j<line.length-1) {\r\n                     if (line.charAt(j+1) == '\"') { // double quotes\r\n                        j++; // skip the second one\r\n                        value += '\"'; // add one quote\r\n                        }\r\n                     else if (line.charAt(j+1) == '\\t') { // end of quoted item\r\n                        j++;\r\n                        inquote = false;\r\n                        AddCell();\r\n                        }\r\n                     }\r\n                  else { // at end of line\r\n                     inquote = false;\r\n                     AddCell();\r\n                     }\r\n                  continue;\r\n                  }\r\n               if (value==\"\") { // quote at start of item\r\n                  inquote = true;\r\n                  continue;\r\n                  }\r\n               }\r\n            if (ch == \"\\t\" && !inquote) {\r\n               AddCell();\r\n               }\r\n            else {\r\n               value += ch;\r\n               }\r\n            if (j==line.length-1 && !inquote) {\r\n               AddCell();\r\n               }\r\n            }\r\n         }\r\n      if (maxc>0) {\r\n         sheet.attribs.lastrow = row;\r\n         sheet.attribs.lastcol = maxc;\r\n         result = sheet.CreateSheetSave(\"A1:\"+SocialCalc.crToCoord(maxc, row));\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SetConvertedCell(sheet, cr, rawvalue)\r\n//\r\n// Sets the cell cr with a value and type determined from rawvalue\r\n//\r\n\r\nSocialCalc.SetConvertedCell = function(sheet, cr, rawvalue) {\r\n\r\n   var cell, value;\r\n\r\n   cell = sheet.GetAssuredCell(cr);\r\n\r\n   value = SocialCalc.DetermineValueType(rawvalue);\r\n\r\n   if (value.type == 'n' && value.value == rawvalue) { // check that we don't need \"constant\" to remember original value\r\n      cell.datatype = \"v\";\r\n      cell.valuetype = \"n\";\r\n      cell.datavalue = value.value;\r\n      }\r\n   else if (value.type.charAt(0) == 't') { // text of some sort but left unchanged\r\n      cell.datatype = \"t\";\r\n      cell.valuetype = value.type;\r\n      cell.datavalue = value.value;\r\n      }\r\n   else { // special number types\r\n      cell.datatype = \"c\";\r\n      cell.valuetype = value.type;\r\n      cell.datavalue = value.value;\r\n      cell.formula = rawvalue;\r\n      }\r\n\r\n   }\r\n\r\n","//\r\n// SocialCalcTableEditor\r\n//\r\n/*\r\n// The code module of the SocialCalc package that displays a scrolling grid with panes\r\n// and handles keyboard and mouse I/O.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n*/\r\n\r\n/*\r\n\r\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\r\n\r\nEXHIBIT A. Common Public Attribution License Version 1.0.\r\n\r\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \r\n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \r\nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \r\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \r\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \r\nconsistent with Exhibit B.\r\n\r\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \r\nKIND, either express or implied. See the License for the specific language governing rights and \r\nlimitations under the License.\r\n\r\nThe Original Code is SocialCalc JavaScript TableEditor.\r\n\r\nThe Original Developer is the Initial Developer.\r\n\r\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \r\nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\r\n\r\nContributor: Dan Bricklin.\r\n\r\n\r\nEXHIBIT B. Attribution Information\r\n\r\nWhen the TableEditor is producing and/or controlling the display the Graphic Image must be\r\ndisplayed on the screen visible to the user in a manner comparable to that in the \r\nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\r\nthat image. The image must be linked to the Attribution URL so as to access that page\r\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\r\nfactual prominent attribution in a form similar to that in the \"about\" display included\r\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\r\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\r\n\r\nAttribution Copyright Notice:\r\n\r\n Copyright (C) 2010 Socialtext, Inc.\r\n All Rights Reserved.\r\n\r\nAttribution Phrase (not exceeding 10 words): SocialCalc\r\n\r\nAttribution URL: http://www.socialcalc.org/xoattrib\r\n\r\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\r\na suitable replacement from http://www.socialcalc.org/licenses specified as\r\nbeing for SocialCalc.\r\n\r\nDisplay of Attribution Information is required in Larger Works which are defined \r\nin the CPAL as a work which combines Covered Code or portions thereof with code \r\nnot governed by the terms of the CPAL.\r\n\r\n*/\r\n\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n\r\n/*\r\n\r\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\r\n\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) { // created here, too, in case load order is wrong, but main routines are required\r\n      SocialCalc = {};\r\n      }\r\n\r\n// *************************************\r\n//\r\n// Table Editor class:\r\n//\r\n// *************************************\r\n\r\n// Constructor:\r\n\r\nSocialCalc.TableEditor = function(context) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // Properties:\r\n\r\n   this.context = context; // editing context\r\n   this.toplevel = null; // top level HTML element for this table editor\r\n   this.fullgrid = null; // rendered editing context\r\n\r\n   this.noEdit = false; // if true, disable all edit UI and make read-only\r\n\r\n   this.width = null;\r\n   this.tablewidth = null;\r\n   this.height = null;\r\n   this.tableheight = null;\r\n\r\n   this.inputBox = null;\r\n   this.inputEcho = null;\r\n   this.verticaltablecontrol = null;\r\n   this.horizontaltablecontrol = null;\r\n\r\n   this.logo = null;\r\n\r\n   this.cellhandles = null;\r\n\r\n   // Dynamic properties:\r\n\r\n   this.timeout = null; // if non-null, timer id for position calculations\r\n   this.busy = false; // true when executing command, calculating, etc.\r\n   this.ensureecell = false; // if true, ensure ecell is visible after timeout\r\n   this.deferredCommands = []; // commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\r\n   this.deferredEmailCommands = []; // Email commands to execute after busy, in form: {cmdstr: \"cmds\", saveundo: t/f}\r\n\r\n   this.gridposition = null; // screen coords of full grid\r\n   this.headposition = null; // screen coords of upper left of grid within header rows\r\n   this.firstscrollingrow = null; // row number of top row in last (the scrolling) pane\r\n   this.firstscrollingrowtop = null;  // position of top row in last (the scrolling) pane\r\n   this.lastnonscrollingrow = null; // row number of last displayed row in last non-scrolling\r\n                                    // pane, or zero (for thumb position calculations)\r\n   this.lastvisiblerow = null; // used for paging down\r\n   this.firstscrollingcol = null; // column number of top col in last (the scrolling) pane\r\n   this.firstscrollingcolleft = null;  // position of top col in last (the scrolling) pane\r\n   this.lastnonscrollingcol = null; // col number of last displayed column in last non-scrolling\r\n                                    // pane, or zero (for thumb position calculations)\r\n   this.lastvisiblecol = null; // used for paging right\r\n\r\n   this.rowpositions = []; // screen positions of the top of some rows\r\n   this.colpositions = []; // screen positions of the left side of some rows\r\n   this.rowheight = []; // size in pixels of each row when last checked, or null/undefined, for page up\r\n   this.colwidth = []; // size in pixels of each column when last checked, or null/undefined, for page left\r\n\r\n   this.ecell = null; // either null or {coord: c, row: r, col: c}\r\n   this.state = \"start\"; // the keyboard states: see EditorProcessKey\r\n\r\n   this.workingvalues = {}; // values used during keyboard editing, etc.\r\n\r\n   // Constants:\r\n\r\n   this.imageprefix = scc.defaultImagePrefix; // URL prefix for images (e.g., \"/images/sc\")\r\n   this.idPrefix = scc.defaultTableEditorIDPrefix;\r\n   this.pageUpDnAmount = scc.defaultPageUpDnAmount; // number of rows to move cursor on PgUp/PgDn keys (numeric)\r\n\r\n   // Callbacks\r\n\r\n   // recalcFunction: if present, function(editor) {...}, called to do a recalc\r\n   // Default (sheet.RecalcSheet) does all the right stuff.\r\n\r\n   this.recalcFunction = function(editor) {\r\n      if (editor.context.sheetobj.RecalcSheet) {\r\n         editor.context.sheetobj.RecalcSheet(SocialCalc.EditorSheetStatusCallback, editor);\r\n         }\r\n      else return null;\r\n      };\r\n\r\n   // ctrlkeyFunction: if present, function(editor, charname) {...}, called to handle ctrl-V, etc., at top level\r\n   // Returns true (pass through for continued processing) or false (stop processing this key).\r\n\r\n   this.ctrlkeyFunction = function(editor, charname) {\r\n\r\n      var ta, cell, position, cmd, sel, cliptext;\r\n\r\n      switch (charname) {\r\n         case \"[ctrl-c]\":\r\n         case \"[ctrl-x]\":\r\n            ta = editor.pasteTextarea;\r\n            ta.value = \"\";\r\n            cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n            if (cell) {\r\n               position = SocialCalc.GetElementPosition(cell.element);\r\n               ta.style.left = (position.left-1)+\"px\";\r\n               ta.style.top = (position.top-1)+\"px\";\r\n               }\r\n            if (editor.range.hasrange) {\r\n               sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n                  \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n               }\r\n            else {\r\n               sel = editor.ecell.coord;\r\n               }\r\n\r\n            // get what to copy to clipboard\r\n            cliptext = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.CreateSheetSave(editor.context.sheetobj, sel), \"tab\");\r\n\r\n            if (charname == \"[ctrl-c]\" || editor.noEdit || editor.ECellReadonly()) { // if copy or cut but in no edit\r\n               cmd = \"copy \"+sel+\" formulas\";\r\n               }\r\n            else { // [ctrl-x]\r\n               cmd = \"cut \"+sel+\" formulas\";\r\n               }\r\n            editor.EditorScheduleSheetCommands(cmd, true, false); // queue up command to put on SocialCalc clipboard\r\n\r\n            ta.style.display = \"block\";\r\n            ta.value = cliptext; // must follow \"block\" setting for Webkit\r\n            ta.focus();\r\n            ta.select();\r\n            window.setTimeout(function() {\r\n               var ta = editor.pasteTextarea;\r\n               ta.blur();\r\n               ta.style.display = \"none\";\r\n               SocialCalc.KeyboardFocus();\r\n               }, 200);\r\n\r\n            return true;\r\n\r\n         case \"[ctrl-v]\":\r\n            if (editor.noEdit || editor.ECellReadonly()) return true; // not if no edit\r\n            ta = editor.pasteTextarea;\r\n            ta.value = \"\";\r\n            cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n            if (cell) {\r\n               position = SocialCalc.GetElementPosition(cell.element);\r\n               ta.style.left = (position.left-1)+\"px\";\r\n               ta.style.top = (position.top-1)+\"px\";\r\n               }\r\n            ta.style.display = \"block\";\r\n            ta.value = \"\";  // must follow \"block\" setting for Webkit\r\n            ta.focus();\r\n            window.setTimeout(function() {\r\n               var ta = editor.pasteTextarea;\r\n               var value = ta.value;\r\n               ta.blur();\r\n               ta.style.display = \"none\";\r\n               var cmd = \"\";\r\n               if(editor.pastescclipboard) {\r\n                 // Clipboard loaded from \"clipboard tab\" - see  SpreadsheetControlClipboardLoad \r\n                 // ignore windows clipboard contents\r\n                 editor.pastescclipboard = false;\r\n                 } \r\n               else {\r\n                 // Use windows clipboard contents if value does not match last copy\r\n                 var clipstr = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\r\n                 value = value.replace(/\\r\\n/g, \"\\n\");\r\n                 // pastes SocialCalc clipboard if did a Ctrl-C and contents still the same\r\n                 // Webkit adds an extra blank line, so need to allow for that\r\n                 if (value != clipstr && (value.length-clipstr.length!=1 || value.substring(0,value.length-1)!=clipstr)) {\r\n                    cmd = \"loadclipboard \"+\r\n                    SocialCalc.encodeForSave(SocialCalc.ConvertOtherFormatToSave(value, \"tab\")) + \"\\n\";\r\n                    }\r\n                 }\r\n               var cr;\r\n               if (editor.range.hasrange) {\r\n                  var clipsheet = new SocialCalc.Sheet();\r\n                  clipsheet.ParseSheetSave(SocialCalc.Clipboard.clipboard);\r\n                  var matches = clipsheet.copiedfrom.match(/(.+):(.+)/);\r\n                  if (matches !== null && matches[1] === matches[2]) {\r\n                    // copy one cell to selected range\r\n                    cr = SocialCalc.crToCoord(editor.range.left, editor.range.top) +\r\n                      ':' + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n                  } else {\r\n                    cr = SocialCalc.crToCoord(editor.range.left, editor.range.top);\r\n                  }\r\n                  }\r\n               else {\r\n                  cr = editor.ecell.coord;\r\n                  }\r\n               cmd += \"paste \"+cr+\" formulas\";\r\n               editor.EditorScheduleSheetCommands(cmd, true, false);\r\n               SocialCalc.KeyboardFocus();\r\n               }, 200);\r\n            return true;\r\n\r\n         case \"[ctrl-z]\":\r\n            editor.EditorScheduleSheetCommands(\"undo\", true, false);\r\n            return false;\r\n\r\n         case \"[ctrl-s]\": // !!!! temporary hack\r\n            if (!SocialCalc.Constants.AllowCtrlS) break;\r\n            window.setTimeout(\r\n               function() {\r\n                  var sheet = editor.context.sheetobj;\r\n                  var cell = sheet.GetAssuredCell(editor.ecell.coord);\r\n                  var ntvf = cell.nontextvalueformat ? sheet.valueformats[cell.nontextvalueformat-0] || \"\" : \"\";\r\n                  var newntvf = window.prompt(\"Advanced Feature:\\n\\nCustom Numeric Format or Command\", ntvf);\r\n                  if (newntvf != null) { // not cancelled\r\n                     if (newntvf.match(/^cmd:/)) {\r\n                        cmd = newntvf.substring(4); // execute as command\r\n                        }\r\n                     else if (newntvf.match(/^edit:/)) {\r\n                        cmd = newntvf.substring(5); // execute as command\r\n                        if (SocialCalc.CtrlSEditor) {\r\n                           SocialCalc.CtrlSEditor(cmd);\r\n                           }\r\n                        return;\r\n                        }\r\n                     else {\r\n                        if (editor.range.hasrange) {\r\n                           sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n                              \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n                           }\r\n                        else {\r\n                          sel = editor.ecell.coord;\r\n                           }\r\n                        cmd = \"set \"+sel+\" nontextvalueformat \"+newntvf;\r\n                        }\r\n                     editor.EditorScheduleSheetCommands(cmd, true, false);\r\n                     }\r\n                  },\r\n               200);\r\n            return false;\r\n\r\n         default:\r\n            break;\r\n            }\r\n      return true;\r\n      };\r\n\r\n   // Set sheet's status callback:\r\n\r\n   context.sheetobj.statuscallback = SocialCalc.EditorSheetStatusCallback;\r\n   context.sheetobj.statuscallbackparams = this; // this object: the table editor object\r\n\r\n\r\n   // StatusCallback: all values are called at appropriate times, add with unique name, delete when done\r\n   //\r\n   // Each value must be an object in the form of:\r\n   //\r\n   //    func: function(editor, status, arg, params) {...},\r\n   //    params: params value to call func with\r\n   //\r\n   // The values for status and arg are:\r\n   //\r\n   //    all the SocialCalc RecalcSheet statuscallbacks, including:\r\n   //\r\n   //       calccheckdone, calclist length\r\n   //       calcorder, {coord: coord, total: celllist length, count: count}\r\n   //       calcstep, {coord: coord, total: calclist length, count: count}\r\n   //       calcfinished, time in milliseconds\r\n   //\r\n   //    the command callbacks, like cmdstart and cmdend\r\n   //    cmdendnorender\r\n   //\r\n   //    calcstart, null\r\n   //    moveecell, new ecell coord\r\n   //    rangechange, \"coord:coord\" or \"coord\" or \"\"\r\n   //    specialkey, keyname (\"[esc]\")\r\n   //\r\n\r\n   this.StatusCallback = {};\r\n\r\n\r\n   this.MoveECellCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\r\n   this.RangeChangeCallback = {}; // all values are called with editor as arg; add with unique name, delete when done\r\n   this.SettingsCallbacks = {}; // See SocialCalc.SaveEditorSettings\r\n\r\n   // Set initial cursor\r\n\r\n   this.ecell = {coord: \"A1\", row: 1, col: 1};\r\n   context.highlights[this.ecell.coord] = \"cursor\";\r\n\r\n   // Initialize range data\r\n   // Range has at least hasrange (true/false).\r\n   // It may also have: anchorcoord, anchorrow, anchorcol, top, bottom, left, and right.\r\n\r\n   this.range = {hasrange: false};\r\n\r\n   // Initialize range2 data (used to show selections, such as for move)\r\n   // Range2 has at least hasrange (true/false).\r\n   // It may also have: top, bottom, left, and right.\r\n\r\n   this.range2 = {hasrange: false};\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.TableEditor.prototype.CreateTableEditor = function(width, height) {return SocialCalc.CreateTableEditor(this, width, height);};\r\nSocialCalc.TableEditor.prototype.ResizeTableEditor = function(width, height) {return SocialCalc.ResizeTableEditor(this, width, height);};\r\n\r\nSocialCalc.TableEditor.prototype.SaveEditorSettings = function() {return SocialCalc.SaveEditorSettings(this);};\r\nSocialCalc.TableEditor.prototype.LoadEditorSettings = function(str, flags) {return SocialCalc.LoadEditorSettings(this, str, flags);};\r\n\r\nSocialCalc.TableEditor.prototype.EditorRenderSheet = function() {SocialCalc.EditorRenderSheet(this);};\r\nSocialCalc.TableEditor.prototype.EditorScheduleSheetCommands = function(cmdstr, saveundo, ignorebusy) {SocialCalc.EditorScheduleSheetCommands(this, cmdstr, saveundo, ignorebusy);};\r\nSocialCalc.TableEditor.prototype.ScheduleSheetCommands = function(cmdstr, saveundo) {\r\n   this.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\r\n   };\r\nSocialCalc.TableEditor.prototype.SheetUndo = function() {\r\n   this.context.sheetobj.SheetUndo();\r\n   };\r\nSocialCalc.TableEditor.prototype.SheetRedo = function() {\r\n   this.context.sheetobj.SheetRedo();\r\n   };\r\nSocialCalc.TableEditor.prototype.EditorStepSet = function(status, arg) {SocialCalc.EditorStepSet(this, status, arg);};\r\nSocialCalc.TableEditor.prototype.GetStatuslineString = function(status, arg, params) {return SocialCalc.EditorGetStatuslineString(this, status, arg, params);};\r\n\r\nSocialCalc.TableEditor.prototype.EditorMouseRegister = function() {return SocialCalc.EditorMouseRegister(this);};\r\nSocialCalc.TableEditor.prototype.EditorMouseUnregister = function() {return SocialCalc.EditorMouseUnregister(this);};\r\nSocialCalc.TableEditor.prototype.EditorMouseRange = function(coord) {return SocialCalc.EditorMouseRange(this, coord);};\r\n\r\nSocialCalc.TableEditor.prototype.EditorProcessKey = function(ch, e) {return SocialCalc.EditorProcessKey(this, ch, e);};\r\nSocialCalc.TableEditor.prototype.EditorAddToInput = function(str, prefix) {return SocialCalc.EditorAddToInput(this, str, prefix);};\r\nSocialCalc.TableEditor.prototype.DisplayCellContents = function() {return SocialCalc.EditorDisplayCellContents(this);};\r\nSocialCalc.TableEditor.prototype.EditorSaveEdit = function(text) {return SocialCalc.EditorSaveEdit(this, text);};\r\nSocialCalc.TableEditor.prototype.EditorApplySetCommandsToRange = function(cmdline, type) {return SocialCalc.EditorApplySetCommandsToRange(this, cmdline, type);};\r\n\r\nSocialCalc.TableEditor.prototype.MoveECellWithKey = function(ch) {return SocialCalc.MoveECellWithKey(this, ch);};\r\nSocialCalc.TableEditor.prototype.MoveECell = function(newcell) { if (SocialCalc._app) return \"A1\"; return SocialCalc.MoveECell(this, newcell);};\r\nSocialCalc.TableEditor.prototype.ReplaceCell = function(cell, row, col) {SocialCalc.ReplaceCell(this, cell, row, col);};\r\nSocialCalc.TableEditor.prototype.UpdateCellCSS = function(cell, row, col) {SocialCalc.UpdateCellCSS(this, cell, row, col);};\r\nSocialCalc.TableEditor.prototype.SetECellHeaders = function(selected) {SocialCalc.SetECellHeaders(this, selected);};\r\nSocialCalc.TableEditor.prototype.EnsureECellVisible = function() {SocialCalc.EnsureECellVisible(this);};\r\nSocialCalc.TableEditor.prototype.ECellReadonly = function(coord) {return SocialCalc.ECellReadonly(this, coord);};\r\nSocialCalc.TableEditor.prototype.RangeAnchor = function(coord) {SocialCalc.RangeAnchor(this, coord);};\r\nSocialCalc.TableEditor.prototype.RangeExtend = function(coord) {SocialCalc.RangeExtend(this, coord);};\r\nSocialCalc.TableEditor.prototype.RangeRemove = function() {SocialCalc.RangeRemove(this);};\r\nSocialCalc.TableEditor.prototype.Range2Remove = function() {SocialCalc.Range2Remove(this);};\r\n\r\nSocialCalc.TableEditor.prototype.FitToEditTable = function() {SocialCalc.FitToEditTable(this);};\r\nSocialCalc.TableEditor.prototype.CalculateEditorPositions = function() {SocialCalc.CalculateEditorPositions(this);};\r\nSocialCalc.TableEditor.prototype.ScheduleRender = function() {this.ScheduleRender(true);};\r\nSocialCalc.TableEditor.prototype.ScheduleRender = function(renderwidgets) {    \r\n  // App widgets need focus - so only render widgets when needed, rather than the default of rendering everything. \r\n  if(SocialCalc._app && renderwidgets == true) this.context.sheetobj.widgetsClean = false;  \r\n  SocialCalc.ScheduleRender(this);\r\n  };\r\nSocialCalc.TableEditor.prototype.DoRenderStep = function() {SocialCalc.DoRenderStep(this);};\r\nSocialCalc.TableEditor.prototype.SchedulePositionCalculations = function() {SocialCalc.SchedulePositionCalculations(this);};\r\nSocialCalc.TableEditor.prototype.DoPositionCalculations = function() {SocialCalc.DoPositionCalculations(this);};\r\nSocialCalc.TableEditor.prototype.CalculateRowPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateRowPositions(this,  panenum, positions, sizes);};\r\nSocialCalc.TableEditor.prototype.CalculateColPositions = function(panenum, positions, sizes) {return SocialCalc.CalculateColPositions(this,  panenum, positions, sizes);};\r\n\r\nSocialCalc.TableEditor.prototype.ScrollRelative = function(vertical, amount) {SocialCalc.ScrollRelative(this, vertical, amount);};\r\nSocialCalc.TableEditor.prototype.ScrollRelativeBoth = function(vamount, hamount) {SocialCalc.ScrollRelativeBoth(this, vamount, hamount);};\r\nSocialCalc.TableEditor.prototype.PageRelative = function(vertical, direction) {SocialCalc.PageRelative(this, vertical, direction);};\r\nSocialCalc.TableEditor.prototype.LimitLastPanes = function() {SocialCalc.LimitLastPanes(this);};\r\n\r\nSocialCalc.TableEditor.prototype.ScrollTableUpOneRow = function() {return SocialCalc.ScrollTableUpOneRow(this);};\r\nSocialCalc.TableEditor.prototype.ScrollTableDownOneRow = function() {return SocialCalc.ScrollTableDownOneRow(this);};\r\nSocialCalc.TableEditor.prototype.ScrollTableLeftOneCol = function() {return SocialCalc.ScrollTableLeftOneCol(this);};\r\nSocialCalc.TableEditor.prototype.ScrollTableRightOneCol = function() {return SocialCalc.ScrollTableRightOneCol(this);};\r\n\r\nSocialCalc.TableEditor.prototype.StopPropagation = function() {\r\n    return SocialCalc.StopPropagation(this);\r\n};\r\n\r\nSocialCalc.TableEditor.prototype.SetMouseMoveUp = function() {\r\n    return SocialCalc.SetMouseMoveUp(this);\r\n};\r\n\r\nSocialCalc.TableEditor.prototype.RemoveMouseMoveUp = function() {\r\n    return SocialCalc.RemoveMouseMoveUp(this);\r\n};\r\n\r\n// Functions:\r\n\r\nSocialCalc.CreateTableEditor = function(editor, width, height) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var AssignID = SocialCalc.AssignID;\r\n\r\n   editor.toplevel = document.createElement(\"div\");\r\n   editor.toplevel.style.position = \"relative\";\r\n   AssignID(editor, editor.toplevel, \"toplevel\");\r\n   editor.width = width;\r\n   editor.height = height;\r\n\r\n   editor.griddiv = document.createElement(\"div\");\r\n   editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);\r\n   editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\r\n   editor.griddiv.style.width = editor.tablewidth+\"px\";\r\n   editor.griddiv.style.height = editor.tableheight+\"px\";\r\n   editor.griddiv.style.overflow = \"hidden\";\r\n   editor.griddiv.style.cursor = \"default\";\r\n   if (scc.cteGriddivClass) editor.griddiv.className = scc.cteGriddivClass;\r\n   AssignID(editor, editor.griddiv, \"griddiv\");\r\n\r\n   editor.FitToEditTable();\r\n\r\n   editor.EditorRenderSheet();\r\n\r\n   editor.griddiv.appendChild(editor.fullgrid);\r\n\r\n   editor.verticaltablecontrol = new SocialCalc.TableControl(editor, true, editor.tableheight);\r\n   editor.verticaltablecontrol.CreateTableControl();\r\n   AssignID(editor, editor.verticaltablecontrol.main, \"tablecontrolv\");\r\n\r\n   editor.horizontaltablecontrol = new SocialCalc.TableControl(editor, false, editor.tablewidth);\r\n   editor.horizontaltablecontrol.CreateTableControl();\r\n   AssignID(editor, editor.horizontaltablecontrol.main, \"tablecontrolh\");\r\n\r\n   var table, tbody, tr, td, img, anchor, ta;\r\n\r\n   table = document.createElement(\"table\");\r\n   editor.layouttable = table;\r\n   table.cellSpacing = 0;\r\n   table.cellPadding = 0;\r\n   AssignID(editor, table, \"layouttable\");\r\n\r\n   tbody = document.createElement(\"tbody\");\r\n   table.appendChild(tbody);\r\n\r\n   tr = document.createElement(\"tr\");\r\n   tbody.appendChild(tr);\r\n   td = document.createElement(\"td\");\r\n   td.appendChild(editor.griddiv);\r\n   tr.appendChild(td);\r\n   if (SocialCalc._app != true) { // no scroll bar in app\r\n     // Add v scroll bar  \r\n     td = document.createElement(\"td\");\r\n     td.appendChild(editor.verticaltablecontrol.main);\r\n     tr.appendChild(td);\r\n   }\r\n   tr = document.createElement(\"tr\");\r\n   tbody.appendChild(tr);\r\n   if (SocialCalc._app != true) { // no scroll bar in app\r\n     // Add h scroll bar  \r\n     td = document.createElement(\"td\");\r\n     td.appendChild(editor.horizontaltablecontrol.main);\r\n     tr.appendChild(td);\r\n   }\r\n\r\n   td = document.createElement(\"td\"); // logo display: Required by CPAL License for this code!\r\n   if (SocialCalc._app) { // in app right align Required CPAL License logo\r\n     td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat right center\";\r\n   } else {\r\n     td.style.background=\"url(\"+editor.imageprefix+\"logo.gif) no-repeat center center\";\r\n   }\r\n   td.innerHTML = \"<div style='cursor:pointer;font-size:1px;'><img src='\"+editor.imageprefix+\"1x1.gif' border='0' width='18' height='18'></div>\";\r\n   tr.appendChild(td);\r\n   editor.logo = td;\r\n   AssignID(editor, editor.logo, \"logo\");\r\n   SocialCalc.TooltipRegister(td.firstChild.firstChild, \"SocialCalc\", null, editor.toplevel);\r\n\r\n   editor.toplevel.appendChild(editor.layouttable);\r\n\r\n   if (!editor.noEdit) {\r\n      editor.inputEcho = new SocialCalc.InputEcho(editor);\r\n      AssignID(editor, editor.inputEcho.main, \"inputecho\");\r\n      }\r\n\r\n   editor.cellhandles = new SocialCalc.CellHandles(editor);\r\n\r\n   ta = document.createElement(\"textarea\"); // used for ctrl-c/ctrl-v where an invisible text area is needed\r\n   SocialCalc.setStyles(ta, \"display:none;position:absolute;height:1px;width:1px;opacity:0;filter:alpha(opacity=0);\");\r\n   ta.value = \"\";\r\n   editor.pasteTextarea = ta;\r\n   AssignID(editor, editor.pasteTextarea, \"pastetextarea\");\r\n\r\n   if (navigator.userAgent.match(/Safari\\//) &&!navigator.userAgent.match(/Chrome\\//)) { // special code for Safari 5 change\r\n      window.removeEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\r\n      window.addEventListener('beforepaste', SocialCalc.SafariPasteFunction, false);\r\n      window.removeEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\r\n      window.addEventListener('beforecopy', SocialCalc.SafariPasteFunction, false);\r\n      window.removeEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\r\n      window.addEventListener('beforecut', SocialCalc.SafariPasteFunction, false);\r\n      }\r\n\r\n   editor.toplevel.appendChild(editor.pasteTextarea);\r\n\r\n   SocialCalc.MouseWheelRegister(editor.toplevel, {WheelMove: SocialCalc.EditorProcessMouseWheel, editor: editor});\r\n\r\n   SocialCalc.KeyboardSetFocus(editor);\r\n\r\n   // do status reporting things\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"startup\", null, editor);\r\n\r\n   // done\r\n\r\n   return editor.toplevel;\r\n\r\n   }\r\n\r\n// Special code needed for change that occurred with Safari 5 that made paste not work for some reason\r\n\r\nSocialCalc.SafariPasteFunction = function(e) {\r\n   e.preventDefault();\r\n   }\r\n\r\n//\r\n// SocialCalc.ResizeTableEditor(editor, width, height)\r\n//\r\n// Move things around as appropriate and resize\r\n//\r\n\r\nSocialCalc.ResizeTableEditor = function(editor, width, height) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   editor.width = width;\r\n   editor.height = height;\r\n\r\n   editor.toplevel.style.width = width+\"px\";\r\n   editor.toplevel.style.height = height+\"px\";\r\n\r\n   if (SocialCalc._app) {\r\n     editor.tablewidth = Math.max(0, width ); // no v scroll bar with app\r\n   } else {\r\n     editor.tablewidth = Math.max(0, width - scc.defaultTableControlThickness);     \r\n   }\r\n   editor.tableheight = Math.max(0, height - scc.defaultTableControlThickness);\r\n   editor.griddiv.style.width=editor.tablewidth+\"px\";\r\n   editor.griddiv.style.height=editor.tableheight+\"px\";\r\n\r\n   editor.verticaltablecontrol.main.style.height = editor.tableheight + \"px\";\r\n   editor.horizontaltablecontrol.main.style.width = editor.tablewidth + \"px\";\r\n\r\n   editor.FitToEditTable();\r\n\r\n   editor.ScheduleRender();\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// str = SaveEditorSettings(editor)\r\n//\r\n// Returns a string representation of the pane settings, etc.\r\n//\r\n// The format is:\r\n//\r\n//    version:1.0\r\n//    rowpane:panenumber:firstnum:lastnum\r\n//    colpane:panenumber:firstnum:lastnum\r\n//    ecell:coord -- if set\r\n//    range:anchorcoord:top:bottom:left:right -- if set\r\n//\r\n// You can add additional values to be saved by using editor.SettingsCallbacks:\r\n//\r\n//   editor.SettingsCallbacks[\"item-name\"] = {save: savefunction, load: loadfunction}\r\n//\r\n// where savefunction(editor, \"item-name\") returns a string with the new lines to be added to the saved settings\r\n// which include the trailing newlines, and loadfunction(editor, \"item-name\", line, flags) is given the line to process\r\n// without the trailing newlines.\r\n//\r\n\r\nSocialCalc.SaveEditorSettings = function(editor) {\r\n\r\n   var i, setting;\r\n   var context = editor.context;\r\n   var range = editor.range;\r\n   var result = \"\";\r\n\r\n   result += \"version:1.0\\n\";\r\n\r\n   for (i=0; i<context.rowpanes.length; i++) {\r\n      result += \"rowpane:\"+i+\":\"+context.rowpanes[i].first+\":\"+context.rowpanes[i].last+\"\\n\";\r\n      }\r\n   for (i=0; i<context.colpanes.length; i++) {\r\n      result += \"colpane:\"+i+\":\"+context.colpanes[i].first+\":\"+context.colpanes[i].last+\"\\n\";\r\n      }\r\n\r\n   if (editor.ecell) {\r\n      result += \"ecell:\"+editor.ecell.coord+\"\\n\";\r\n      }\r\n\r\n   if (range.hasrange) {\r\n      result += \"range:\"+range.anchorcoord+\":\"+range.top+\":\"+range.bottom+\":\"+range.left+\":\"+range.right+\"\\n\";\r\n      }\r\n\r\n   for (setting in editor.SettingsCallbacks) {\r\n      result += editor.SettingsCallbacks[setting].save(editor, setting);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// LoadEditorSettings(editor, str, flags)\r\n//\r\n// Sets the editor settings based on str. See SocialCalc.SaveEditorSettings for more details.\r\n// Unrecognized lines are ignored.\r\n//\r\n\r\nSocialCalc.LoadEditorSettings = function(editor, str, flags) {\r\n\r\n   var lines=str.split(/\\r\\n|\\n/);\r\n   var parts=[];\r\n   var line, i, cr, row, col, coord, setting;\r\n   var context = editor.context;\r\n   var highlights, range;\r\n\r\n   context.rowpanes = [{first: 1, last: 1}]; // reset to start\r\n   context.colpanes = [{first: 1, last: 1}];\r\n   editor.ecell = null;\r\n   editor.range = {hasrange: false};\r\n   editor.range2 = {hasrange: false};\r\n   range = editor.range;\r\n   context.highlights = {};\r\n   highlights = context.highlights;\r\n\r\n   for (i=0; i<lines.length; i++) {\r\n      line=lines[i];\r\n      parts = line.split(\":\");\r\n      setting = parts[0];\r\n      switch (setting) {\r\n         case \"version\":\r\n            break;\r\n\r\n         case \"rowpane\":\r\n            context.rowpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\r\n            break;\r\n\r\n         case \"colpane\":\r\n            context.colpanes[parts[1]-0] = {first: parts[2]-0, last: parts[3]-0};\r\n            break;\r\n\r\n         case \"ecell\":\r\n            editor.ecell = SocialCalc.coordToCr(parts[1]);\r\n            editor.ecell.coord = parts[1];\r\n            highlights[parts[1]] = \"cursor\";\r\n            break;\r\n\r\n         case \"range\":\r\n            range.hasrange = true;\r\n            range.anchorcoord = parts[1];\r\n            cr = SocialCalc.coordToCr(range.anchorcoord);\r\n            range.anchorrow = cr.row;\r\n            range.anchorcol = cr.col;\r\n            range.top = parts[2]-0;\r\n            range.bottom = parts[3]-0;\r\n            range.left = parts[4]-0;\r\n            range.right = parts[5]-0;\r\n            for (row=range.top; row<=range.bottom; row++) {\r\n               for (col=range.left; col<=range.right; col++) {\r\n                  coord = SocialCalc.crToCoord(col, row);\r\n                  if (highlights[coord]!=\"cursor\") {\r\n                     highlights[coord] = \"range\";\r\n                     }\r\n                  }\r\n               }\r\n            break;\r\n\r\n         default:\r\n            if (editor.SettingsCallbacks[setting]) {\r\n               editor.SettingsCallbacks[setting].load(editor, setting, line, flags);\r\n               }\r\n            break;\r\n         }\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// EditorRenderSheet(editor)\r\n//\r\n// Renders the sheet and updates editor.fullgrid.\r\n// Sets event handlers.\r\n//\r\n\r\nSocialCalc.EditorRenderSheet = function(editor) {\r\n\r\n   editor.EditorMouseUnregister();\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   // App widgets need to keep focus -  only render widgets if needed \r\n   if(sheetobj.reRenderCellList != null && SocialCalc._app && sheetobj.widgetsClean === true) {\r\n     // re-render each individual cells - but not widget with focus \r\n     for(var index in sheetobj.reRenderCellList) {\r\n       var coord = sheetobj.reRenderCellList[index];\r\n       var valuetype = sheetobj.cells[coord].valuetype;\r\n       if(valuetype.charAt(1) != \"i\" || valuetype !=  sheetobj.cells[coord].prevvaluetype) { // skip widgets - but paint when added/replaced\r\n         cr = SocialCalc.coordToCr(coord);\r\n         cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n         if(cell!=null) editor.ReplaceCell(cell, cr.row, cr.col);\r\n       }\r\n     }\r\n     sheetobj.reRenderCellList = [];\r\n   } else {\r\n      editor.fullgrid = editor.context.RenderSheet(editor.fullgrid);\r\n      if (sheetobj.reRenderCellList != null && SocialCalc._app) {\r\n        sheetobj.widgetsClean = true; // widgets have been rendered\r\n        sheetobj.reRenderCellList = [];        \r\n      }\r\n   }\r\n   \r\n   if (editor.ecell) editor.SetECellHeaders(\"selected\");\r\n\r\n   SocialCalc.AssignID(editor, editor.fullgrid, \"fullgrid\"); // give it an id\r\n   // eddy EditorRenderSheet {\r\n   if(!SocialCalc._app) editor.fullgrid.className = \"te_download\";\r\n   editor.EditorMouseRegister();\r\n   // } EditorRenderSheet\r\n   \r\n   }\r\n\r\n//\r\n// EditorScheduleSheetCommands(editor, cmdstr, saveundo, ignorebusy)\r\n//\r\n\r\nSocialCalc.EditorScheduleSheetCommands = function(editor, cmdstr, saveundo, ignorebusy) {\r\n\r\n   if (editor.state!=\"start\" && !ignorebusy) { // ignore commands if editing a cell\r\n      return;\r\n      }\r\n\r\n   if (editor.busy && !ignorebusy) { // hold off on commands if doing one\r\n      editor.deferredCommands.push({cmdstr: cmdstr, saveundo: saveundo});\r\n      return;\r\n      }\r\n\r\n   // eddy ExecuteSheetCommand {\r\n   var cmdTokens = cmdstr.split(\" \");\r\n\r\n   switch (cmdTokens[0]) {\r\n\t   // } eddy ExecuteSheetCommand \r\n      case \"recalc\":\r\n      case \"redisplay\":\r\n         editor.context.sheetobj.ScheduleSheetCommands(cmdstr, false);\r\n         break;\r\n\r\n      case \"undo\":\r\n         if(SocialCalc._app ) editor.context.sheetobj.widgetsClean = false;     // force app widgets to render     \r\n         editor.SheetUndo();\r\n         break;\r\n\r\n      case \"redo\":\r\n         if(SocialCalc._app ) editor.context.sheetobj.widgetsClean = false;     // force app widgets to render\r\n         editor.SheetRedo();\r\n         break;\r\n         \r\n      case \"setemailparameters\":    \t  \r\n\t\t  SocialCalc.TriggerIoAction.Email(cmdTokens[1], cmdTokens[2]);\r\n    \t  break;\r\n         \r\n         \r\n      default:\r\n         editor.context.sheetobj.ScheduleSheetCommands(cmdstr, saveundo);\r\n         break;\r\n      }\r\n   }\r\n\r\n\r\n//\r\n// EditorSheetStatusCallback(recalcdata, status, arg, editor)\r\n//\r\n// Called during recalc, executing commands, etc.\r\n//\r\n\r\nSocialCalc.EditorSheetStatusCallback = function(recalcdata, status, arg, editor) {\r\n\r\n   var f, cell, dcmd;\r\n   var sheetobj = editor.context.sheetobj;\r\n\r\n   var signalstatus = function(s) {\r\n      for (f in editor.StatusCallback) {\r\n         if (editor.StatusCallback[f].func) {\r\n            editor.StatusCallback[f].func(editor, s, arg, editor.StatusCallback[f].params);\r\n            }\r\n         }\r\n      }\r\n\r\n   switch (status) {\r\n\r\n      case \"startup\":\r\n         break;\r\n\r\n      case \"cmdstart\":\r\n         editor.busy = true;\r\n         sheetobj.celldisplayneeded = \"\";\r\n         break;\r\n\r\n      case \"cmdextension\":\r\n         break;\r\n\r\n      case \"cmdend\":\r\n         signalstatus(status);\r\n\r\n         if (sheetobj.changedrendervalues) {\r\n            editor.context.PrecomputeSheetFontsAndLayouts();\r\n            editor.context.CalculateCellSkipData();\r\n            sheetobj.changedrendervalues = false;\r\n            }\r\n\r\n         if (sheetobj.celldisplayneeded && !sheetobj.renderneeded) {\r\n             if (sheetobj.cells[sheetobj.celldisplayneeded] && sheetobj.cells[sheetobj.celldisplayneeded].valuetype != \"e#N/A\") {\r\n                cr = SocialCalc.coordToCr(sheetobj.celldisplayneeded);\r\n                cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n                editor.ReplaceCell(cell, cr.row, cr.col); // if no value set, wait for recalc and render . \r\n                }\r\n             }\r\n         if (editor.deferredCommands.length) {\r\n            dcmd = editor.deferredCommands.shift();\r\n            editor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\r\n            return;\r\n            }\r\n         if (sheetobj.attribs.needsrecalc &&\r\n               (sheetobj.attribs.recalc!=\"off\" || sheetobj.recalconce)\r\n               && editor.recalcFunction) {\r\n            editor.FitToEditTable();\r\n            sheetobj.renderneeded = false; // recalc will force a render\r\n            if (sheetobj.recalconce) delete sheetobj.recalconce; // only do once\r\n            editor.recalcFunction(editor);\r\n            }\r\n         else {\r\n            if (sheetobj.renderneeded) {\r\n               editor.FitToEditTable();\r\n               sheetobj.renderneeded = false;\r\n               editor.ScheduleRender(false);\r\n               }\r\n            else {\r\n               editor.SchedulePositionCalculations(); // just in case command changed positions\r\n//               editor.busy = false;\r\n//               signalstatus(\"cmdendnorender\");\r\n               }\r\n            }\r\n\r\n         // Handle hidden column.\r\n         if (sheetobj.hiddencolrow == \"col\") {\r\n            if (editor.ecell !== null) {\r\n               var col = editor.ecell.col;\r\n               while (sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n                  col++;\r\n                  }\r\n               var coord = SocialCalc.crToCoord(col, editor.ecell.row);\r\n               editor.MoveECell(coord);\r\n               sheetobj.hiddencolrow = \"\";\r\n               }\r\n            }\r\n\r\n         // Handle hidden row.\r\n         if (sheetobj.hiddencolrow == \"row\") {\r\n            if (editor.ecell !== null) {\r\n               var row = editor.ecell.row;\r\n               while (sheetobj.rowattribs.hide[row] == \"yes\") {\r\n                  row++;\r\n                  }\r\n               var coord = SocialCalc.crToCoord(editor.ecell.col, row);\r\n               editor.MoveECell(coord);\r\n               sheetobj.hiddencolrow = \"\";\r\n               }\r\n            }\r\n\r\n         return;\r\n\r\n      case \"calcstart\":\r\n         editor.busy = true;\r\n         break;\r\n\r\n      case \"calccheckdone\":\r\n      case \"calcorder\":\r\n      case \"calcstep\":\r\n      case \"calcloading\":\r\n      case \"calcserverfunc\":\r\n         break;\r\n\r\n      case \"calcfinished\":\r\n         signalstatus(status);\r\n         editor.ScheduleRender(false);                        \r\n         return;\r\n\r\n      case \"schedrender\":\r\n         editor.busy = true; // in case got here without cmd or recalc\r\n         break;\r\n\r\n      case \"renderdone\":\r\n         break;\r\n\r\n      case \"schedposcalc\":\r\n         editor.busy = true; // in case got here without cmd or recalc\r\n         break;\r\n\r\n      case \"doneposcalc\":\r\n          if (editor.deferredEmailCommands.length) {\r\n              signalstatus(status);\r\n              var emailcmd = editor.deferredEmailCommands.shift();\r\n              editor.EditorScheduleSheetCommands(emailcmd.cmdstr, emailcmd.saveundo, true);\r\n              return;\r\n              }\r\n    \t  \r\n    \t  \r\n         if (editor.deferredCommands.length) {\r\n            signalstatus(status);\r\n            dcmd = editor.deferredCommands.shift();\r\n            editor.EditorScheduleSheetCommands(dcmd.cmdstr, dcmd.saveundo, true);\r\n            }\r\n         else {\r\n            editor.busy = false;\r\n            signalstatus(status);\r\n            if (editor.state==\"start\") editor.DisplayCellContents(); // make sure up to date\r\n            }\r\n         return;\r\n      // eddy EditorSheetStatusCallback {\r\n      case \"emailing\":\r\n      case \"confirmemailsent\":\r\n        break;\r\n      // } EditorSheetStatusCallback eddy \r\n      case \"updatingopsettings\":\r\n      case \"confirmupdateop\":\r\n         break;\r\n\r\n      default:\r\n    \t alert(\"Unknown status: \"+status);\r\n         break;\r\n\r\n      }\r\n\r\n   signalstatus(status);\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// str = SocialCalc.EditorGetStatuslineString(editor, status, arg, params)\r\n//\r\n// Assumes params is an object where it can use \"calculating\" and \"command\"\r\n// to keep track of state.\r\n// Returns string for status line.\r\n//\r\n\r\nSocialCalc.EditorGetStatuslineString = function(editor, status, arg, params) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var sstr, progress, coord, circ, r, c, cell, sum, ele;\r\n\r\n   progress = \"\";\r\n\r\n   switch (status) {\r\n      case \"moveecell\":\r\n      case \"rangechange\":\r\n      case \"startup\":\r\n         break;\r\n      case \"cmdstart\":\r\n         params.command = true;\r\n         document.body.style.cursor = \"progress\";\r\n         editor.griddiv.style.cursor = \"progress\";\r\n         progress = scc.s_statusline_executing;\r\n         break;\r\n      case \"cmdextension\":\r\n         progress = \"Command Extension: \"+arg;\r\n         break;\r\n      case \"cmdend\":\r\n         params.command = false;\r\n         break;\r\n      case \"schedrender\":\r\n         progress = scc.s_statusline_displaying;\r\n         break;\r\n      case \"renderdone\":\r\n         progress = \" \";\r\n         break;\r\n      case \"schedposcalc\":\r\n         progress = scc.s_statusline_displaying;\r\n         break;\r\n      case \"cmdendnorender\":\r\n      case \"doneposcalc\":\r\n         document.body.style.cursor = \"default\";\r\n         editor.griddiv.style.cursor = \"default\";\r\n         // eddy EditorGetStatuslineString {\r\n         // all updates done, So let future event clear the \"sent\" message in the status bar\r\n         if(params.emailing == \"sent\") {\r\n        \t progress = params.emailreponse;\r\n        \t params.emailreponse = \"\";\r\n        \t params.emailing = \"done\";\r\n         }\r\n         // } eddy EditorGetStatuslineString \r\n         if (params.updatingopsettings == \"updated\") {\r\n            progress = params.updatingopresponse;\r\n            params.updatingopresponse = \"\";\r\n            params.updatingopsettings = \"done\";\r\n         }\r\n         break;\r\n         \r\n      case \"calcorder\":\r\n         progress = scc.s_statusline_ordering+Math.floor(100*arg.count/(arg.total||1))+\"%\";\r\n         break;\r\n      case \"calcstep\":\r\n         progress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%\";\r\n         break;\r\n      case \"calcloading\":\r\n         progress = scc.s_statusline_calculatingls+\": \"+arg.sheetname;\r\n         break;\r\n      case \"calcserverfunc\":\r\n         progress = scc.s_statusline_calculating+Math.floor(100*arg.count/(arg.total||1))+\"%, \"+scc.s_statusline_doingserverfunc+arg.funcname+scc.s_statusline_incell+arg.coord;\r\n         break;\r\n      case \"calcstart\":\r\n         params.calculating = true;\r\n         document.body.style.cursor = \"progress\";\r\n         editor.griddiv.style.cursor = \"progress\"; // griddiv has an explicit cursor style\r\n         progress = scc.s_statusline_calcstart;\r\n         break;\r\n      case \"calccheckdone\":\r\n         break;\r\n      case \"calcfinished\":\r\n         params.calculating = false;\r\n         break;\r\n      // eddy EditorGetStatuslineString {\r\n      case \"emailing\":\r\n    \t params.emailing = \"sending\";\r\n    \t params.emailreponse =\"\";\r\n         break;\r\n      case \"confirmemailsent\":\r\n     \t params.emailing = \"sent\";\r\n     \t if(typeof params.emailreponse === 'undefined') params.emailreponse =\"\";\r\n     \t params.emailreponse += arg;\r\n         break;    \t  \r\n      // } eddy EditorGetStatuslineString \r\n      case \"updatingopsettings\":\r\n         params.updatingopsettings = \"updating\";\r\n         params.updatingopresponse = \"\";\r\n      case \"confirmupdateop\":\r\n         params.updatingopsettings = \"updated\";\r\n         if (typeof params.updatingopresponse === 'undefined') params.updatingopresponse = \"\";\r\n         params.updatingopresponse += arg;\r\n         //break;\r\n         \r\n      default:\r\n         progress = status;\r\n         break;\r\n      }\r\n\r\n   // eddy EditorGetStatuslineString {\r\n   // if send email then update status bar with \"sending\" and then \"sent\"\r\n   if(params.emailing == \"sending\") {\r\n  \t progress += scc.s_statusline_sendemail;\r\n   }\r\n   if(params.emailing == \"sent\") {\r\n  \t progress += params.emailreponse;\r\n   }   \r\n   // } eddy EditorGetStatuslineString \r\n   if (params.updatingopsettings == \"updating\") {\r\n      progress = \"Updating Order Presc. settings...\";\r\n   }\r\n   if (params.updatingopsettings == \"updated\") {\r\n      progress = params.updatingopresponse;\r\n   }\r\n   if (!progress && params.calculating) {\r\n      progress = scc.s_statusline_calculating;\r\n      }\r\n\r\n   // if there is a range, calculate sum (not during busy times)\r\n   if (!params.calculating && !params.command && !progress && editor.range.hasrange \r\n       && (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom)) {\r\n      sum = 0;\r\n      for (r=editor.range.top; r <= editor.range.bottom; r++) {\r\n         for (c=editor.range.left; c <= editor.range.right; c++) {\r\n            cell = editor.context.sheetobj.cells[SocialCalc.crToCoord(c, r)];\r\n            if (!cell) continue;\r\n            if (cell.valuetype && cell.valuetype.charAt(0)==\"n\") {\r\n               sum += cell.datavalue-0;\r\n               }\r\n            }\r\n         }\r\n\r\n      sum = SocialCalc.FormatNumber.formatNumberWithFormat(sum, \"[,]General\", \"\");\r\n\r\n      coord = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n         SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      progress = coord + \" (\" + (editor.range.right-editor.range.left+1) + \"x\" + (editor.range.bottom-editor.range.top+1) +\r\n                 \") \"+scc.s_statusline_sum+\"=\" + sum + \" \" + progress;\r\n      }\r\n   sstr = (editor.ecell || {}).coord+\" &nbsp; \"+progress;\r\n\r\n   if (!params.calculating && editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\r\n      sstr += ' &nbsp; '+scc.s_statusline_recalcneeded;\r\n      }\r\n\r\n   circ = editor.context.sheetobj.attribs.circularreferencecell;\r\n   if (circ) {\r\n      circ = circ.replace(/\\|/, \" referenced by \");\r\n      sstr += ' &nbsp; '+scc.s_statusline_circref + circ + '</span>';\r\n      }\r\n   // eddy EditorGetStatuslineString {\r\n   sstr += \"\";\r\n   // } eddy EditorGetStatuslineString \r\n   return sstr;\r\n\r\n   }\r\n\r\n\r\n//\r\n// Mouse stuff\r\n//\r\n\r\nSocialCalc.EditorMouseInfo = {\r\n\r\n   // The registeredElements array is used to identify editor grid in which the mouse is doing things.\r\n\r\n   // One item for each active editor, each an object with:\r\n   //    .element, .editor\r\n\r\n   registeredElements: [],\r\n\r\n   editor: null, // editor being processed (between mousedown and mouseup)\r\n   element: null, // element being processed\r\n\r\n   ignore: false, // if true, mousedowns are ignored\r\n\r\n   mousedowncoord: \"\", // coord where mouse went down for drag range\r\n   mouselastcoord: \"\", // coord where mouse last was during drag\r\n   mouseresizecol: \"\", // col being resized\r\n   mouseresizeclientx: null, // where resize started\r\n   mouseresizedisplay: null // element tracking new size\r\n   }\r\n\r\n//\r\n// EditorMouseRegister(editor)\r\n//\r\n\r\nSocialCalc.EditorMouseRegister = function(editor) {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var element = editor.fullgrid;\r\n   var i;\r\n\r\n   for (i=0; i<mouseinfo.registeredElements.length; i++) {\r\n      if (mouseinfo.registeredElements[i].editor == editor) {\r\n         if (mouseinfo.registeredElements[i].element == element) {\r\n            return; // already set - don't do it again\r\n            }\r\n         break;\r\n         }\r\n      }\r\n\r\n   if (i<mouseinfo.registeredElements.length) {\r\n      mouseinfo.registeredElements[i].element = element;\r\n      }\r\n   else {\r\n      mouseinfo.registeredElements.push({element: element, editor: editor});\r\n      }\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\r\n      element.addEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\r\n      element.attachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\r\n      }\r\n   else { // don't handle this\r\n      throw \"Browser not supported\";\r\n      }\r\n\r\n   mouseinfo.ignore = false; // just in case\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// EditorMouseUnregister(editor)\r\n//\r\n\r\nSocialCalc.EditorMouseUnregister = function(editor) {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var element = editor.fullgrid;\r\n   var i, oldelement;\r\n\r\n   for (i=0; i<mouseinfo.registeredElements.length; i++) {\r\n      if (mouseinfo.registeredElements[i].editor == editor) {\r\n         break;\r\n         }\r\n      }\r\n\r\n   if (i<mouseinfo.registeredElements.length) {\r\n      oldelement = mouseinfo.registeredElements[i].element; // remove old handlers\r\n      if (oldelement.removeEventListener) { // DOM Level 2\r\n         oldelement.removeEventListener(\"mousedown\", SocialCalc.ProcessEditorMouseDown, false);\r\n         oldelement.removeEventListener(\"dblclick\", SocialCalc.ProcessEditorDblClick, false);\r\n         }\r\n      else if (oldelement.detachEvent) { // IE\r\n         oldelement.detachEvent(\"onmousedown\", SocialCalc.ProcessEditorMouseDown);\r\n         oldelement.detachEvent(\"ondblclick\", SocialCalc.ProcessEditorDblClick);\r\n         }\r\n      mouseinfo.registeredElements.splice(i, 1);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.StopPropagation = function(event) {\r\n    if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\r\n    else event.cancelBubble = true; // IE 5+\r\n    if (event.preventDefault) event.preventDefault(); // DOM Level 2\r\n    else event.returnValue = false; // IE 5+\r\n}\r\n\r\nSocialCalc.SetMouseMoveUp = function(move, up, element, event) {\r\n       // Event code from JavaScript, Flanagan, 5th Edition, pg. 422\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mousemove\", move, true); // capture everywhere\r\n      document.addEventListener(\"mouseup\", up, true); // capture everywhere\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.setCapture();\r\n      element.attachEvent(\"onmousemove\", move);\r\n      element.attachEvent(\"onmouseup\", up);\r\n      element.attachEvent(\"onlosecapture\", up);\r\n   }\r\n    SocialCalc.StopPropagation(event);\r\n}\r\n\r\nSocialCalc.RemoveMouseMoveUp = function(move, up, element, event) {\r\n    SocialCalc.StopPropagation(event);\r\n    if (document.removeEventListener) { // DOM Level 2\r\n\tdocument.removeEventListener(\"mousemove\", move, true);\r\n\tdocument.removeEventListener(\"mouseup\", up, true);\r\n    }\r\n    else if (element.detachEvent) { // IE\r\n\telement.detachEvent(\"onlosecapture\", up);\r\n\telement.detachEvent(\"onmouseup\", up);\r\n\telement.detachEvent(\"onmousemove\", move);\r\n\telement.releaseCapture();\r\n    }\r\n}\r\n\r\nSocialCalc.ProcessEditorMouseDown = function(e) {\r\n\r\n   var editor, result, coord, textarea, wval, range;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var ele = event.target || event.srcElement; // source object is often within what we want\r\n   var target = ele; \r\n   if (target.nodeType == 3) target = target.parentNode; // defeat Safari bug\r\n     \r\n   var mobj;\r\n\r\n   if (mouseinfo.ignore) return; // ignore this\r\n\r\n   for (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\r\n      mobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\r\n      }\r\n   if (!mobj) {\r\n      mouseinfo.editor = null;\r\n      return; // not one of our elements\r\n      }\r\n\r\n   editor = mobj.editor;\r\n   mouseinfo.element = ele;\r\n   range = editor.range;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n\r\n   if (!result) return; // not on a cell or col header\r\n   mouseinfo.editor = editor; // remember for later\r\n\r\n    if (result.rowheader) {\r\n\tif (result.rowselect)  {\r\n\t    SocialCalc.ProcessEditorRowselectMouseDown(e, ele, result);\r\n\t} else {\r\n\t    SocialCalc.ProcessEditorRowsizeMouseDown(e, ele, result);\r\n\t}\r\n\treturn;\r\n    }\r\n\r\n    if (result.colheader) {\r\n\tif (result.colselect)  {\r\n\t    SocialCalc.ProcessEditorColselectMouseDown(e, ele, result);\r\n\t} else {\r\n\t    SocialCalc.ProcessEditorColsizeMouseDown(e, ele, result);\r\n\t}\r\n\treturn;\r\n    }\r\n\r\n   if (!result.coord) return; // not us\r\n\r\n   if (!range.hasrange) {\r\n      if (e.shiftKey)\r\n         editor.RangeAnchor();\r\n      }\r\n   coord = editor.MoveECell(result.coord);\r\n   // eddy ProcessEditorMouseDown {\r\n   if(SocialCalc._app == true) { // \"app\" wigets need to keep focus - needed because \"coord\" always equals A1 \r\n     SocialCalc.CmdGotFocus(true); // cell widgets need to keep focus\r\n     return;\r\n   }\r\n   \r\n   var clickedCell = editor.context.sheetobj.cells[coord];\r\n   if(clickedCell) {\r\n     if(clickedCell.valuetype.charAt(1) == 'i') { // IF cell contains ioWidget\r\n       var formula_name= clickedCell.valuetype.substring(2);\r\n       var widget_id = formula_name+'_'+coord;\r\n       if(target && widget_id == target.id) { // if widget was clicked (rather than cell containing widget) \r\n         var cell_widget=document.getElementById(widget_id);\r\n         SocialCalc.CmdGotFocus(cell_widget); // cell widgets need to keep focus \r\n       }\r\n\t\treturn; // let ioWidget keep the focus \r\n\t\t}\r\n\t }\r\n   // }\r\n\r\n   if (range.hasrange) {\r\n      if (e.shiftKey)\r\n         editor.RangeExtend();\r\n      else\r\n         editor.RangeRemove();\r\n      }\r\n\r\n   mouseinfo.mousedowncoord = coord; // remember if starting drag range select\r\n   mouseinfo.mouselastcoord = coord;\r\n\r\n   editor.EditorMouseRange(coord);\r\n\r\n   SocialCalc.KeyboardSetFocus(editor);\r\n   if (editor.state!=\"start\" && editor.inputBox) editor.inputBox.element.focus();\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorMouseUp,\r\n\t\t\t      ele,\r\n\t\t\t      event);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.EditorMouseRange = function(editor, coord) {\r\n\r\n   var inputtext, wval;\r\n   var range = editor.range;\r\n\r\n   switch (editor.state) { // editing a cell - shouldn't get here if no inputBox\r\n      case \"input\":\r\n         inputtext = editor.inputBox.GetText();\r\n         wval = editor.workingvalues;\r\n         if ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\r\n             (inputtext == \"=\")) {\r\n            wval.partialexpr = inputtext;\r\n            }\r\n\r\n         if (wval.partialexpr) { // if in pointing operation\r\n            if (coord) {\r\n               if (range.hasrange) {\r\n                  editor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\r\n                     SocialCalc.crToCoord(range.right, range.bottom));\r\n                  }\r\n               else {\r\n                  editor.inputBox.SetText(wval.partialexpr + coord);\r\n                  }\r\n               }\r\n            }\r\n         else { // not in point -- done editing\r\n            editor.inputBox.Blur();\r\n            editor.inputBox.ShowInputBox(false);\r\n            editor.state = \"start\";\r\n            editor.cellhandles.ShowCellHandles(true);\r\n            editor.EditorSaveEdit();\r\n            editor.inputBox.DisplayCellContents(null);\r\n            }\r\n         break;\r\n\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.Blur();\r\n         editor.inputBox.ShowInputBox(false);\r\n         editor.state = \"start\";\r\n         editor.cellhandles.ShowCellHandles(true);\r\n         editor.EditorSaveEdit();\r\n         editor.inputBox.DisplayCellContents(null);\r\n         break;\r\n      }\r\n   }\r\n\r\nSocialCalc.ProcessEditorMouseMove = function(e) {\r\n\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   if (mouseinfo.ignore) return; // ignore this\r\n   element = mouseinfo.element;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\r\n\r\n   if (!result) return;\r\n\r\n   if (result && !result.coord) {\r\n      SocialCalc.SetDragAutoRepeat(editor, result);\r\n      return;\r\n      }\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   if (!result.coord) return;\r\n\r\n   if (result.coord!=mouseinfo.mouselastcoord) {\r\n      if (!e.shiftKey && !editor.range.hasrange) {\r\n         editor.RangeAnchor(mouseinfo.mousedowncoord);\r\n         }\r\n      editor.MoveECell(result.coord);\r\n      editor.RangeExtend();\r\n      }\r\n   mouseinfo.mouselastcoord = result.coord;\r\n\r\n   editor.EditorMouseRange(result.coord);\r\n   SocialCalc.StopPropagation(event); \r\n   return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorMouseUp = function(e) {\r\n\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   if (mouseinfo.ignore) return; // ignore this\r\n   element = mouseinfo.element;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   if (!result) return;\r\n\r\n   if (!result.coord) result.coord = editor.ecell.coord;\r\n\r\n   if (editor.range.hasrange) {\r\n      editor.MoveECell(result.coord);\r\n      editor.RangeExtend();\r\n      }\r\n   else if (result.coord && result.coord!=mouseinfo.mousedowncoord) {\r\n      editor.RangeAnchor(mouseinfo.mousedowncoord);\r\n      editor.MoveECell(result.coord);\r\n      editor.RangeExtend();\r\n      }\r\n\r\n   editor.EditorMouseRange(result.coord);\r\n   mouseinfo.editor = null;\r\n   SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorMouseMove,\r\n\t\t\t\t  SocialCalc.ProcessEditorMouseUp,\r\n\t\t\t\t  element,\r\n\t\t\t\t  event);\r\n   return false;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorColsizeMouseDown = function(e, ele, result) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n\r\n   mouseinfo.mouseresizecolnum = result.coltoresize; // remember col being resized\r\n   mouseinfo.mouseresizecol = SocialCalc.rcColname(result.coltoresize);\r\n   mouseinfo.mousedownclientx = clientX;\r\n   mouseinfo.mousecoltounhide = result.coltounhide;\r\n\r\n   if (result.coltoresize) {\r\n      var sizedisplay = document.createElement(\"div\");\r\n      mouseinfo.mouseresizedisplay = sizedisplay;\r\n      sizedisplay.style.width = \"auto\";\r\n      sizedisplay.style.position = \"absolute\";\r\n      sizedisplay.style.zIndex = 100;\r\n      sizedisplay.style.top = editor.headposition.top+\"px\";\r\n      sizedisplay.style.left = editor.colpositions[result.coltoresize]+\"px\";\r\n      sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\r\n        'border:1px dashed black;background-color:white;width:' +\r\n        (editor.context.colwidth[mouseinfo.mouseresizecolnum]-2) + 'px;\">&nbsp;</td>'+\r\n        '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n        editor.context.colwidth[mouseinfo.mouseresizecolnum] + '</div></td></tr></table>';\r\n      SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\r\n\r\n      editor.toplevel.appendChild(sizedisplay);\r\n      }\r\n    SocialCalc.SetMouseMoveUp( SocialCalc.ProcessEditorColsizeMouseMove,\r\n\t\t\t       SocialCalc.ProcessEditorColsizeMouseUp,\r\n\t\t\t       editor.toplevel,\r\n\t\t\t       event);\r\n   return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorColsizeMouseMove = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n\r\n   if (mouseinfo.mouseresizecolnum) {\r\n      var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n      var clientX = event.clientX - pos.left;\r\n\r\n      var newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\r\n      if (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\r\n\r\n      var sizedisplay = mouseinfo.mouseresizedisplay;\r\n//      sizedisplay.firstChild.lastChild.firstChild.childNodes[1].firstChild.innerHTML = newsize+\"\";\r\n//      sizedisplay.firstChild.lastChild.firstChild.childNodes[0].firstChild.style.width = (newsize-2)+\"px\";\r\n      sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"height:100px;'+\r\n          'border:1px dashed black;background-color:white;width:' + (newsize-2) + 'px;\">&nbsp;</td>'+\r\n          '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n          newsize + '</div></td></tr></table>';\r\n      SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.85;\"); // so no warning msg with Firefox about filter\r\n      }\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorColsizeMouseUp = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   element = mouseinfo.element;\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   SocialCalc.RemoveMouseMoveUp(\r\n       SocialCalc.ProcessEditorColsizeMouseMove,\r\n       SocialCalc.ProcessEditorColsizeMouseUp, \r\n       editor.toplevel,\r\n       event);\r\n\r\n   if (mouseinfo.mousecoltounhide) {\r\n      editor.EditorScheduleSheetCommands(\"set \"+SocialCalc.rcColname(mouseinfo.mousecoltounhide)+\" hide\", true, false);\r\n      /*\r\n      if (editor.ecell && editor.ecell.col == mouseinfo.mousecoltounhide+1) {\r\n         editor.MoveECell(SocialCalc.crToCoord(mouseinfo.mousecoltounhide, editor.ecell.row));\r\n         }*/\r\n      }\r\n   else if (mouseinfo.mouseresizecolnum) {\r\n      var newsize = (editor.context.colwidth[mouseinfo.mouseresizecolnum]-0) + (clientX - mouseinfo.mousedownclientx);\r\n      if (newsize < SocialCalc.Constants.defaultMinimumColWidth) newsize = SocialCalc.Constants.defaultMinimumColWidth;\r\n\r\n      editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizecol+\" width \"+newsize, true, false);\r\n\r\n      if (editor.timeout) window.clearTimeout(editor.timeout);\r\n      editor.timeout = window.setTimeout(SocialCalc.FinishColRowSize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\r\n      }\r\n\r\n   return false;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.FinishColRowSize = function() {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return;\r\n\r\n   editor.toplevel.removeChild(mouseinfo.mouseresizedisplay);\r\n   mouseinfo.mouseresizedisplay = null;\r\n\r\n//   editor.FitToEditTable();\r\n//   editor.EditorRenderSheet();\r\n//   editor.SchedulePositionCalculations();\r\n\r\n   mouseinfo.editor = null;\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorRowselectMouseDown = function(e, ele, result) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n    coord1 = SocialCalc.crToCoord(1, result.row)\r\n    coord2 = SocialCalc.crToCoord(sheet.LastCol(),\r\n\t\t\t\t  result.row)\r\n    coord3 = SocialCalc.crToCoord(editor.firstscrollingcol,\r\n\t\t\t\t  result.row)\r\n    editor.RangeAnchor(coord1);\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorRowselectMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorRowselectMouseUp,\r\n\t\t\t      editor.toplevel,\r\n\t\t\t      event);\r\n}\r\n\r\nSocialCalc.ProcessEditorRowselectMouseMove = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n\r\n    if (!editor) return; // not us, ignore\r\n\r\n    var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n    var clientX = event.clientX - pos.left;\r\n    var clientY = event.clientY - pos.top;\r\n    result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n    coord2 = SocialCalc.crToCoord(sheet.LastCol(),\r\n\t\t\t\t  result.row)\r\n    coord3 = SocialCalc.crToCoord(editor.firstscrollingcol,\r\n\t\t\t\t  result.row)\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorRowselectMouseUp = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    if (!editor) return; // not us, ignore\r\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorRowselectMouseMove,\r\n\t\t\t\t SocialCalc.ProcessEditorRowselectMouseUp,\r\n\t\t\t\t editor.toplevel,\r\n\t\t\t\t e);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorColselectMouseDown = function(e, ele, result) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n\r\n    coord1 = SocialCalc.crToCoord(result.col, 1)\r\n    coord2 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  sheet.LastRow())\r\n    coord3 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  editor.firstscrollingrow)\r\n    \r\n    editor.RangeAnchor(coord1);\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorColselectMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorColselectMouseUp,\r\n\t\t\t      editor.toplevel,\r\n\t\t\t      event);\r\n\r\n}\r\n\r\nSocialCalc.ProcessEditorColselectMouseMove = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    var sheet = SocialCalc.GetSpreadsheetControlObject().sheet;\r\n\r\n    if (!editor) return; // not us, ignore\r\n\r\n    var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n    var clientX = event.clientX - pos.left;\r\n    var clientY = event.clientY - pos.top;\r\n    result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n    coord2 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  sheet.LastRow())\r\n    coord3 = SocialCalc.crToCoord(result.col,\r\n\t\t\t\t  editor.firstscrollingrow)\r\n    editor.RangeExtend(coord2);\r\n    editor.MoveECell(coord3);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorColselectMouseUp = function(e) {\r\n    var event = e || window.event;\r\n    var mouseinfo = SocialCalc.EditorMouseInfo;\r\n    var editor = mouseinfo.editor;\r\n    if (!editor) return; // not us, ignore\r\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.ProcessEditorColselectMouseMove,\r\n\t\t\t\t SocialCalc.ProcessEditorColselectMouseUp,\r\n\t\t\t\t editor.toplevel,\r\n\t\t\t\t e);\r\n    return;\r\n}\r\n\r\nSocialCalc.ProcessEditorRowsizeMouseDown = function(e, ele, result) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\r\n   var clientY = event.clientY - pos;\r\n\r\n   mouseinfo.mouseresizerownum = result.rowtoresize; // remember col being resized\r\n   mouseinfo.mouseresizerow = result.rowtoresize;\r\n   mouseinfo.mousedownclienty = clientY;\r\n   mouseinfo.mouserowtounhide = result.rowtounhide;\r\n\r\n  if (result.rowtoresize) {\r\n    var sizedisplay = document.createElement(\"div\");\r\n    mouseinfo.mouseresizedisplay = sizedisplay;\r\n    sizedisplay.style.width = editor.context.totalwidth+\"px\";\r\n    sizedisplay.style.height = editor.rowpositions[result.rowtoresize]+\"px\";\r\n    sizedisplay.style.position = \"absolute\";\r\n    sizedisplay.style.zIndex = 100;\r\n    sizedisplay.style.top = editor.rowpositions[result.rowtoresize]+\"px\";\r\n    sizedisplay.style.left = editor.headposition.left+\"px\";\r\n    sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:100px' +\r\n      'border:1px dashed black;background-color:white;height:' +\r\n      (editor.context.rowheight[mouseinfo.mouseresizerownum]-2) + 'px;\">&nbsp;</td>'+\r\n      '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n      editor.context.rowheight[mouseinfo.mouseresizerownum] + '</div></td></tr></table>';\r\n    SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.5;\"); // so no warning msg with Firefox about filter\r\n\r\n    editor.toplevel.appendChild(sizedisplay);\r\n  }\r\n    SocialCalc.SetMouseMoveUp(SocialCalc.ProcessEditorRowsizeMouseMove,\r\n\t\t\t      SocialCalc.ProcessEditorRowsizeMouseUp,\r\n\t\t\t      editor.toplevel,\r\n\t\t\t      event);\r\n    return;\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorRowsizeMouseMove = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n\r\n  if (mouseinfo.mouseresizerownum) {\r\n    var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\r\n    var clientY = event.clientY - pos;\r\n\r\n    var newsize = (editor.context.rowheight[mouseinfo.mouseresizerownum]-0) + (clientY - mouseinfo.mousedownclienty);\r\n    if (newsize < SocialCalc.Constants.defaultAssumedRowHeight) newsize = SocialCalc.Constants.defaultAssumedRowHeight;\r\n\r\n    var sizedisplay = mouseinfo.mouseresizedisplay;\r\n    sizedisplay.innerHTML = '<table cellpadding=\"0\" cellspacing=\"0\"><tr><td style=\"width:100px;'+\r\n      'border:1px dashed black;background-color:white;height:' + (newsize-2) + 'px;\">&nbsp;</td>'+\r\n      '<td><div style=\"font-size:small;color:white;background-color:gray;padding:4px;\">'+\r\n      newsize + '</div></td></tr></table>';\r\n    SocialCalc.setStyles(sizedisplay.firstChild.lastChild.firstChild.childNodes[0], \"filter:alpha(opacity=85);opacity:.5;\"); // so no warning msg with Firefox about filter\r\n  }\r\n\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.ProcessEditorRowsizeMouseUp = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   element = mouseinfo.element;\r\n   var pos = SocialCalc.GetSpreadsheetControlObject().spreadsheetDiv.firstChild.offsetHeight;\r\n   var clientY = event.clientY - pos;\r\n   SocialCalc.RemoveMouseMoveUp(\r\n       SocialCalc.ProcessEditorRowsizeMouseMove,\r\n       SocialCalc.ProcessEditorRowsizeMouseUp,\r\n       editor.toplevel,\r\n       event);\r\n   if (mouseinfo.mouserowtounhide) {\r\n      editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouserowtounhide+\" hide\", true, false);\r\n      }\r\n   else if (mouseinfo.mouseresizerownum) {\r\n     var newsize = (editor.context.rowheight[mouseinfo.mouseresizerownum]-0) + (clientY - mouseinfo.mousedownclienty);\r\n     if (newsize < SocialCalc.Constants.defaultAssumedRowHeight) newsize = SocialCalc.Constants.defaultAssumedRowHeight;\r\n     editor.EditorScheduleSheetCommands(\"set \"+mouseinfo.mouseresizerownum+\" height \"+newsize, true, false);\r\n\r\n     if (editor.timeout) window.clearTimeout(editor.timeout);\r\n     editor.timeout = window.setTimeout(SocialCalc.FinishColRowSize, 1); // wait - Firefox 2 has a bug otherwise with next mousedown\r\n   }\r\n\r\n   return false;\r\n\r\n   }\r\n\r\n\r\n//\r\n// Handle auto-repeat of dragging the cursor into the borders of the sheet\r\n//\r\n\r\nSocialCalc.AutoRepeatInfo = {\r\n\r\n   timer: null, // timer object for repeating\r\n   mouseinfo: null, // result from SocialCalc.GridMousePosition\r\n   repeatinterval: 1000, // milliseconds to wait between repeats\r\n   editor: null, // editor object to use when it repeats\r\n   repeatcallback: null // used instead of default when repeating (e.g., for cellhandles)\r\n                        // called as: repeatcallback(newcoord, direction)\r\n\r\n};\r\n\r\n// Control auto-repeat. If mouseinfo==null, cancel.\r\n\r\nSocialCalc.SetDragAutoRepeat = function(editor, mouseinfo, callback) {\r\n\r\n   var repeatinfo = SocialCalc.AutoRepeatInfo;\r\n   var coord, direction;\r\n\r\n   repeatinfo.repeatcallback = callback; // null in regular case\r\n\r\n   if (!mouseinfo) { // cancel\r\n      if (repeatinfo.timer) { // If was repeating, stop\r\n         window.clearTimeout(repeatinfo.timer); // cancel timer\r\n         repeatinfo.timer = null;\r\n         }\r\n      repeatinfo.mouseinfo = null;\r\n      return; // done\r\n      }\r\n\r\n   repeatinfo.editor = editor;\r\n\r\n   if (repeatinfo.mouseinfo) { // check for change while repeating\r\n      if (mouseinfo.rowheader || mouseinfo.rowfooter) {\r\n         if (mouseinfo.row != repeatinfo.mouseinfo.row) { // changed row while dragging sidewards\r\n            coord = SocialCalc.crToCoord(editor.ecell.col, mouseinfo.row); // change to it\r\n            if (repeatinfo.repeatcallback) {\r\n               if (mouseinfo.row < repeatinfo.mouseinfo.row) {\r\n                  direction = \"left\";\r\n                  }\r\n               else if (mouseinfo.row > repeatinfo.mouseinfo.row) {\r\n                  direction = \"right\";\r\n                  }\r\n               else {\r\n                  direction = \"\";\r\n                  }\r\n               repeatinfo.repeatcallback(coord, direction);\r\n               }\r\n            else {\r\n               editor.MoveECell(coord);\r\n               editor.MoveECell(coord);\r\n               editor.RangeExtend();\r\n               editor.EditorMouseRange(coord);\r\n               }\r\n            }            \r\n         }\r\n      else if (mouseinfo.colheader || mouseinfo.colfooter) {\r\n         if (mouseinfo.col != repeatinfo.mouseinfo.col) { // changed col while dragging vertically\r\n            coord = SocialCalc.crToCoord(mouseinfo.col, editor.ecell.row); // change to it\r\n            if (repeatinfo.repeatcallback) {\r\n               if (mouseinfo.row < repeatinfo.mouseinfo.row) {\r\n                  direction = \"left\";\r\n                  }\r\n               else if (mouseinfo.row > repeatinfo.mouseinfo.row) {\r\n                  direction = \"right\";\r\n                  }\r\n               else {\r\n                  direction = \"\";\r\n                  }\r\n               repeatinfo.repeatcallback(coord, direction);\r\n               }\r\n            else {\r\n               editor.MoveECell(coord);\r\n               editor.RangeExtend();\r\n               editor.EditorMouseRange(coord);\r\n               }\r\n            }            \r\n         }\r\n      }\r\n\r\n   repeatinfo.mouseinfo = mouseinfo;\r\n\r\n   if (mouseinfo.distance < 5) repeatinfo.repeatinterval = 333;\r\n   else if (mouseinfo.distance < 10) repeatinfo.repeatinterval = 250;\r\n   else if (mouseinfo.distance < 25) repeatinfo.repeatinterval = 100;\r\n   else if (mouseinfo.distance < 35) repeatinfo.repeatinterval = 75;\r\n   else { // too far - stop repeating\r\n      if (repeatinfo.timer) { // if repeating, cancel it\r\n         window.clearTimeout(repeatinfo.timer); // cancel timer\r\n         repeatinfo.timer = null;\r\n         }\r\n      return;\r\n      }\r\n\r\n   if (!repeatinfo.timer) { // start if not already running\r\n      repeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// DragAutoRepeat()\r\n//\r\n\r\nSocialCalc.DragAutoRepeat = function() {\r\n\r\n   var repeatinfo = SocialCalc.AutoRepeatInfo;\r\n   var mouseinfo = repeatinfo.mouseinfo;\r\n\r\n   var direction, coord, cr;\r\n\r\n   if (mouseinfo.rowheader) direction = \"left\";\r\n   else if (mouseinfo.rowfooter) direction = \"right\";\r\n   else if (mouseinfo.colheader) direction = \"up\";\r\n   else if (mouseinfo.colfooter) direction = \"down\";\r\n\r\n   if (repeatinfo.repeatcallback) {\r\n      cr = SocialCalc.coordToCr(repeatinfo.editor.ecell.coord);\r\n      if (direction == \"left\" && cr.col > 1) cr.col--;\r\n      else if (direction == \"right\") cr.col++;\r\n      else if (direction == \"up\" && cr.row > 1) cr.row--;\r\n      else if (direction == \"down\") cr.row++;\r\n      coord = SocialCalc.crToCoord(cr.col, cr.row);\r\n      repeatinfo.repeatcallback(coord, direction);\r\n      }\r\n   else {\r\n      coord = repeatinfo.editor.MoveECellWithKey(\"[a\"+direction+\"]shifted\");\r\n      if (coord) repeatinfo.editor.EditorMouseRange(coord);\r\n      }\r\n\r\n   repeatinfo.timer = window.setTimeout(SocialCalc.DragAutoRepeat, repeatinfo.repeatinterval);\r\n\r\n   }\r\n\r\n//\r\n// Handling Clicking\r\n//\r\n\r\nSocialCalc.ProcessEditorDblClick = function(e) {\r\n\r\n   var editor, result, coord, textarea, wval, range;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var ele = event.target || event.srcElement; // source object is often within what we want\r\n   var mobj;\r\n\r\n   if (mouseinfo.ignore) return; // ignore this\r\n\r\n   for (mobj=null; !mobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\r\n      mobj = SocialCalc.LookupElement(ele, mouseinfo.registeredElements);\r\n      }\r\n   if (!mobj) {\r\n      mouseinfo.editor = null;\r\n      return; // not one of our elements\r\n      }\r\n\r\n   editor = mobj.editor;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY);\r\n   if (!result || !result.coord) return; // not within cell area - ignore\r\n\r\n   mouseinfo.editor = editor; // remember for later\r\n   mouseinfo.element = ele;\r\n   range = editor.range;\r\n\r\n   sheetobj = editor.context.sheetobj;\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         SocialCalc.EditorOpenCellEdit(editor);\r\n         break;\r\n\r\n      case \"input\":\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.EditorOpenCellEdit = function(editor) {\r\n\r\n   var wval;\r\n\r\n   if (!editor.ecell) return true; // no ecell\r\n   if (!editor.inputBox) return true; // no input box, so no editing (happens on noEdit)\r\n   if (editor.inputBox.element.disabled) return true; // multi-line: ignore\r\n   editor.inputBox.ShowInputBox(true);\r\n   editor.inputBox.Focus();\r\n   editor.inputBox.SetText(\"\");\r\n   editor.inputBox.DisplayCellContents();\r\n   editor.inputBox.Select(\"end\");\r\n   wval = editor.workingvalues;\r\n   wval.partialexpr = \"\";\r\n   wval.ecoord = editor.ecell.coord;\r\n   wval.erow = editor.ecell.row;\r\n   wval.ecol = editor.ecell.col;\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.EditorProcessKey = function(editor, ch, e) {\r\n\r\n   var result, cell, cellobj, valueinfo, fch, coord, inputtext, f;\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   var wval = editor.workingvalues;\r\n   var range = editor.range;\r\n\r\n   if (typeof ch != \"string\") ch = \"\";\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         if (e.shiftKey && ch.substr(0,2)==\"[a\") {\r\n            ch = ch + \"shifted\";\r\n            }\r\n         if (ch==\"[enter]\") ch = \"[adown]\";\r\n         if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\r\n         if (ch.substr(0,2)==\"[a\" || ch.substr(0,3)==\"[pg\" || ch==\"[home]\") {\r\n            result = editor.MoveECellWithKey(ch);\r\n            return !result;\r\n            }\r\n         if (ch==\"[del]\" || ch==\"[backspace]\") {\r\n            if (!editor.noEdit && !editor.ECellReadonly()) {\r\n               editor.EditorApplySetCommandsToRange(\"empty\", \"\");\r\n               }\r\n            break;\r\n            }\r\n         if (ch==\"[esc]\") {\r\n            if (range.hasrange) {\r\n               editor.RangeRemove();\r\n               editor.MoveECell(range.anchorcoord);\r\n               for (f in editor.StatusCallback) {\r\n                  editor.StatusCallback[f].func(editor, \"specialkey\", ch, editor.StatusCallback[f].params);\r\n                  }\r\n               }\r\n            return false;\r\n            }\r\n\r\n         if (ch==\"[f2]\") {\r\n            if (editor.noEdit || editor.ECellReadonly()) return true;\r\n            SocialCalc.EditorOpenCellEdit(editor);\r\n            editor.state=\"inputboxdirect\"; // arrow keys move left and right, rather than select cells\r\n            return false;\r\n            }\r\n\r\n         if ((ch.length>1 && ch.substr(0,1)==\"[\") || ch.length==0) { // some control key\r\n            if (editor.ctrlkeyFunction && ch.length>0) {\r\n               return editor.ctrlkeyFunction(editor, ch);\r\n               }\r\n            else {\r\n               return true;\r\n               }\r\n            }\r\n         if (!editor.ecell) return true; // no ecell\r\n         if (!editor.inputBox) return true; // no inputBox so no editing\r\n         if (editor.ECellReadonly()) return true;\r\n         editor.inputBox.element.disabled = false; // make sure editable\r\n         editor.state = \"input\";\r\n         editor.inputBox.ShowInputBox(true);\r\n         editor.inputBox.Focus();\r\n         editor.inputBox.SetText(ch);\r\n         editor.inputBox.Select(\"end\");\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      case \"input\":\r\n         inputtext = editor.inputBox.GetText(); // should not get here if no inputBox\r\n         if (editor.inputBox.skipOne) return false; // ignore a key already handled\r\n         if (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\" || (ch && ch.substr(0,2)==\"[a\")) {\r\n            if ((\"(+-*/,:!&<>=^\".indexOf(inputtext.slice(-1))>=0 && inputtext.slice(0,1)==\"=\") ||\r\n                (inputtext == \"=\")) {\r\n               wval.partialexpr = inputtext;\r\n               }\r\n            if (wval.partialexpr) { // if in pointing operation\r\n               if (e.shiftKey && ch.substr(0,2)==\"[a\") {\r\n                  ch = ch + \"shifted\";\r\n                  }\r\n               coord = editor.MoveECellWithKey(ch);\r\n               if (coord) {\r\n                  if (range.hasrange) {\r\n                     editor.inputBox.SetText(wval.partialexpr + SocialCalc.crToCoord(range.left, range.top) + \":\" +\r\n                        SocialCalc.crToCoord(range.right, range.bottom));\r\n                     }\r\n                  else {\r\n                     editor.inputBox.SetText(wval.partialexpr + coord);\r\n                     }\r\n                  return false;\r\n                  }\r\n               }\r\n            editor.inputBox.Blur();\r\n            editor.inputBox.ShowInputBox(false);\r\n            editor.state = \"start\";\r\n            editor.cellhandles.ShowCellHandles(true);\r\n            if (ch != \"[esc]\") {\r\n               editor.EditorSaveEdit();\r\n               if (editor.ecell.coord != wval.ecoord) {\r\n                  editor.MoveECell(wval.ecoord);\r\n                  }\r\n               if (ch==\"[enter]\") ch = \"[adown]\";\r\n               if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\r\n               if (ch.substr(0,2)==\"[a\") {\r\n                  editor.MoveECellWithKey(ch);\r\n                  }\r\n               }\r\n            else {\r\n               editor.inputBox.DisplayCellContents();\r\n               editor.RangeRemove();\r\n               editor.MoveECell(wval.ecoord);\r\n               }\r\n            break;\r\n            }\r\n         if (wval.partialexpr && ch==\"[backspace]\") {\r\n            editor.inputBox.SetText(wval.partialexpr);\r\n            wval.partialexpr = \"\";\r\n            editor.RangeRemove();\r\n            editor.MoveECell(wval.ecoord);\r\n            editor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\r\n            return false;\r\n            }\r\n         if (ch==\"[f2]\") {\r\n           editor.state = \"inputboxdirect\"; \r\n           return false;\r\n           }\r\n         if (range.hasrange) {\r\n            editor.RangeRemove();\r\n            }\r\n         editor.MoveECell(wval.ecoord);\r\n         if (wval.partialexpr) {\r\n            editor.inputBox.ShowInputBox(true); // make sure it's moved back if necessary\r\n            wval.partialexpr = \"\"; // not pointing\r\n            }\r\n         return true;\r\n\r\n      case \"inputboxdirect\":\r\n         inputtext = editor.inputBox.GetText(); // should not get here if no inputBox\r\n         if (ch==\"[esc]\" || ch==\"[enter]\" || ch==\"[tab]\") {\r\n            editor.inputBox.Blur();\r\n            editor.inputBox.ShowInputBox(false);\r\n            editor.state = \"start\";\r\n            editor.cellhandles.ShowCellHandles(true);\r\n            if (ch == \"[esc]\") {\r\n               editor.inputBox.DisplayCellContents();\r\n               }\r\n            else {\r\n               editor.EditorSaveEdit();\r\n               if (editor.ecell.coord != wval.ecoord) {\r\n                  editor.MoveECell(wval.ecoord);\r\n                  }\r\n               if (ch==\"[enter]\") ch = \"[adown]\";\r\n               if (ch==\"[tab]\") ch = e.shiftKey ? \"[aleft]\" : \"[aright]\";\r\n               if (ch.substr(0,2)==\"[a\") {\r\n                  editor.MoveECellWithKey(ch);\r\n                  }\r\n               }\r\n            break;\r\n            }\r\n         if (ch==\"[f2]\") { \r\n           editor.state = \"input\"; // arrow keys add range/coord to inputbox formula\r\n           return false;\r\n           }\r\n         return true;\r\n\r\n      case \"skip-and-start\":\r\n         editor.state = \"start\";\r\n         editor.cellhandles.ShowCellHandles(true);\r\n         return false;\r\n\r\n      default:\r\n         return true;\r\n      }\r\n\r\n   return false;\r\n\r\n   }\r\n\r\nSocialCalc.EditorAddToInput = function(editor, str, prefix) {\r\n\r\n   var wval = editor.workingvalues;\r\n\r\n   if (editor.noEdit || editor.ECellReadonly()) return;\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.state = \"input\";\r\n         editor.inputBox.ShowInputBox(true);\r\n         editor.inputBox.element.disabled = false; // make sure editable and overwrite old\r\n         editor.inputBox.Focus();\r\n         editor.inputBox.SetText((prefix||\"\")+str);\r\n         editor.inputBox.Select(\"end\");\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.element.focus();\r\n         if (wval.partialexpr) {\r\n            editor.inputBox.SetText(wval.partialexpr);\r\n            wval.partialexpr = \"\";\r\n            editor.RangeRemove();\r\n            editor.MoveECell(wval.ecoord);\r\n            }\r\n         editor.inputBox.SetText(editor.inputBox.GetText()+str);\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.EditorDisplayCellContents = function(editor) {\r\n\r\n   if (editor.inputBox) editor.inputBox.DisplayCellContents();\r\n\r\n   }\r\n\r\nSocialCalc.EditorSaveEdit = function(editor, text) {\r\n\r\n   var result, cell, valueinfo, fch, type, value, oldvalue, cmdline;\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   var wval = editor.workingvalues;\r\n\r\n   type = \"text t\";\r\n   value = typeof text == \"string\" ? text : editor.inputBox.GetText(); // either explicit or from input box\r\n\r\n   oldvalue = SocialCalc.GetCellContents(sheetobj, wval.ecoord)+\"\";\r\n   if (value == oldvalue) { // no change\r\n      return;\r\n      }\r\n   fch = value.charAt(0);\r\n   if (fch==\"=\" && value.indexOf(\"\\n\")==-1) {\r\n      type = \"formula\";\r\n      value = value.substring(1);\r\n      }\r\n   else if (fch==\"'\") {\r\n      type = \"text t\";\r\n      value = value.substring(1);\r\n      valueinfo = SocialCalc.DetermineValueType(value); // determine type again\r\n      if (valueinfo.type.charAt(0)==\"t\") {\r\n         type = \"text \"+valueinfo.type;\r\n         }\r\n      }\r\n   else if (value.length==0) {\r\n      type = \"empty\";\r\n      }\r\n   else {\r\n      valueinfo = SocialCalc.DetermineValueType(value);\r\n      if (valueinfo.type==\"n\" && value==(valueinfo.value+\"\")) { // see if don't need \"constant\"\r\n         type = \"value n\";\r\n         }\r\n      else if (valueinfo.type.charAt(0)==\"t\") {\r\n         type = \"text \"+valueinfo.type;\r\n         }\r\n      else if (valueinfo.type==\"\") {\r\n         type = \"text t\";\r\n         }\r\n      else {\r\n         type = \"constant \"+valueinfo.type+\" \"+valueinfo.value;\r\n         }\r\n      }\r\n\r\n   if (type.charAt(0)==\"t\") { // text\r\n      value = SocialCalc.encodeForSave(value); // newlines, :, and \\ are escaped\r\n      }\r\n\r\n   cmdline = \"set \"+wval.ecoord+\" \"+type+\" \"+value;\r\n   editor.EditorScheduleSheetCommands(cmdline, true, false);\r\n   // eddy EditorSaveEdit {\r\n   if(typeof sheetobj.ioEventTree === 'undefined') return;\t\r\n   if(typeof sheetobj.ioParameterList === 'undefined') return;\r\n   if(typeof sheetobj.ioEventTree[wval.ecoord] !== 'undefined') {\r\n\t   SocialCalc.EditedTriggerCell(sheetobj.ioEventTree[wval.ecoord], wval.ecoord, editor, sheetobj);   \t\t\r\n   }\r\n   \t\t\r\n   // }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n// Eddy EditedTriggerCell {\r\n\r\n\r\nSocialCalc.EditedTriggerCell  = function(actionFormulaCells, editedCellRef, editor, sheet) {\r\n \r\n\t for(var actionCellId in actionFormulaCells) {\r\n\t\t \r\n\t\t\tvar parameters = sheet.ioParameterList[actionCellId];\r\n            if(typeof parameters === 'undefined') continue;\t\r\n\t\t\t\r\n\t\t\tswitch(parameters.function_name) {\r\n              case \"ONEDITDO\":\r\n\t\t\t\t  case \"EMAILONEDIT\" :\r\n\t\t\t\t  case \"EMAILONEDITIF\" :\r\n\t\t\t\t\t  cmdline = \"setemailparameters \"+actionCellId+ \" \" + editedCellRef;\r\n\t\t\t\t\t// hold off on commands until recalc done\r\n\t\t\t\t      editor.deferredEmailCommands.push({cmdstr: cmdline, saveundo: false});\r\n//\t\t\t\t\t  editor.EditorScheduleSheetCommands(cmdline, false, false);\r\n\t\t\t\t\t  break;\r\n\t\t\t}\r\n\t }\r\n\t\r\n}\t\r\n// } Eddy EditedTriggerCell\r\n\r\n\r\n\r\n\r\n\r\n\r\n//\r\n// SocialCalc.EditorApplySetCommandsToRange(editor, cmd)\r\n//\r\n// Takes ecell or range and does a \"set\" command with cmd.\r\n//\r\n\r\nSocialCalc.EditorApplySetCommandsToRange = function(editor, cmd) {\r\n\r\n   var cell, row, col, line, errortext;\r\n\r\n   var sheetobj = editor.context.sheetobj;\r\n   var ecell = editor.ecell;\r\n   var range = editor.range;\r\n\r\n   if (range.hasrange) {\r\n      coord = SocialCalc.crToCoord(range.left, range.top)+\":\"+SocialCalc.crToCoord(range.right, range.bottom);\r\n      line = \"set \"+coord+\" \"+cmd;\r\n      errortext = editor.EditorScheduleSheetCommands(line, true, false);\r\n      }\r\n   else {\r\n      line = \"set \"+ecell.coord+\" \"+cmd;\r\n      errortext = editor.EditorScheduleSheetCommands(line, true, false);\r\n      }\r\n\r\n   editor.DisplayCellContents();\r\n\r\n   }\r\n\r\nSocialCalc.EditorProcessMouseWheel = function(event, delta, mousewheelinfo, wobj) {\r\n\r\n   if (wobj.functionobj.editor.busy) return; // ignore if busy\r\n\r\n   if (delta > 0) {\r\n      wobj.functionobj.editor.ScrollRelative(true, Math.floor(-delta * 1.5));\r\n      }\r\n   if (delta < 0) {\r\n      wobj.functionobj.editor.ScrollRelative(true, Math.ceil(-delta * 1.5));\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// GridMousePosition(editor, clientX, clientY)\r\n//\r\n// Returns an object with row and col numbers and coord (spans handled for coords),\r\n// and rowheader/colheader true if in header (where coord will be undefined).\r\n// If in colheader, will return coltoresize if on appropriate place in col header.\r\n// Also, there is rowfooter (on right) and colfooter (on bottom).\r\n// In row/col header/footer, returns \"distance\" as pixels over the edge.\r\n//\r\n\r\nSocialCalc.GridMousePosition = function(editor, clientX, clientY) { \r\n\r\n   var row, rowpane, col, colpane, rowtoresize, coltoresize;\r\n   var result = {};\r\n\r\n   for (row=1; row<editor.rowpositions.length; row++) {\r\n      if (!editor.rowheight[row]) continue; // not rendered yet -- may be above or below us\r\n      if (editor.rowpositions[row]+editor.rowheight[row]>clientY) {\r\n         break;\r\n         }\r\n      }\r\n   for (col=1; col<editor.colpositions.length; col++) {\r\n      if (!editor.colwidth[col]) continue;\r\n      if (editor.colpositions[col]+editor.colwidth[col]>clientX) {\r\n         break;\r\n         }\r\n      }\r\n\r\n   result.row = row;\r\n   result.col = col;\r\n\r\n   if (editor.headposition) {\r\n      if (clientX < editor.headposition.left && clientX >= editor.gridposition.left) {\r\n         result.rowheader = true;\r\n         result.distance = editor.headposition.left - clientX;\r\n         result.rowtoresize = false;\r\n         result.rowselect = false;\r\n\r\n         // resize bar\r\n         for (rowtoresize=1; rowtoresize<editor.rowpositions.length; rowtoresize++) {\r\n            if (!editor.rowheight[rowtoresize]) continue;\r\n            if (((editor.rowpositions[rowtoresize] + editor.rowheight[rowtoresize]) - 3) <= clientY\r\n               && ((editor.rowpositions[rowtoresize] + editor.rowheight[rowtoresize]) + 3) >= clientY) {\r\n               result.rowtoresize = rowtoresize;\r\n               break;\r\n            }\r\n         }\r\n\r\n         // Handle unhide row.\r\n         if (unhide = editor.context.rowunhidetop[row]) {\r\n           pos = SocialCalc.GetElementPosition(unhide);\r\n           if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth\r\n               && clientY >= (editor.rowpositions[row] + editor.rowheight[row] - unhide.offsetHeight)\r\n               && clientY < (editor.rowpositions[row] + editor.rowheight[row])) {\r\n             result.rowtounhide = row+1;\r\n           }\r\n         }\r\n         if (unhide = editor.context.rowunhidebottom[row]) {\r\n           pos = SocialCalc.GetElementPosition(unhide);\r\n           if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth\r\n               && clientY >= (editor.rowpositions[row])\r\n               && clientY < (editor.rowpositions[row] + unhide.offsetHeight)) {\r\n             result.rowtounhide = row-1;\r\n           }\r\n         }\r\n         for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\r\n           if (result.rowtoresize >= editor.context.rowpanes[rowpane].first &&\r\n             result.rowtoresize <= editor.context.rowpanes[rowpane].last) { // visible column\r\n             return result;\r\n           }\r\n         }\r\n         delete result.rowtoresize;\r\n         result.rowselect = true;\r\n         return result;\r\n         }\r\n      else if (clientY < editor.headposition.top && clientY > editor.gridposition.top) { // > because of sizing row\r\n         result.colheader = true;\r\n         result.distance = editor.headposition.top - clientY;\r\n         result.coltoresize = false;\r\n\t result.colselect = false;\r\n\r\n         // resize bar\r\n         for (coltoresize=1; coltoresize<editor.colpositions.length; coltoresize++) {\r\n            if (!editor.colwidth[coltoresize]) continue;\r\n            if (((editor.colpositions[coltoresize] + editor.colwidth[coltoresize]) - 3) <= clientX\r\n               && ((editor.colpositions[coltoresize] + editor.colwidth[coltoresize]) + 3) >= clientX) {\r\n               result.coltoresize = coltoresize;\r\n               break;\r\n            }\r\n         }\r\n\r\n         // Handle unhide column.\r\n         if (unhide = editor.context.colunhideleft[col]) {\r\n            pos = SocialCalc.GetElementPosition(unhide);\r\n            if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth && clientY >= pos.top  && clientY < pos.top+unhide.offsetHeight) {\r\n               result.coltounhide = col+1;\r\n               }\r\n            }\r\n         if (unhide = editor.context.colunhideright[col]) {\r\n            pos = SocialCalc.GetElementPosition(unhide);\r\n            if (clientX >= pos.left && clientX < pos.left+unhide.offsetWidth && clientY >= pos.top  && clientY < pos.top+unhide.offsetHeight) {\r\n               result.coltounhide = col-1;\r\n               }\r\n            }\r\n\r\n         for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\r\n            if (result.coltoresize >= editor.context.colpanes[colpane].first &&\r\n                result.coltoresize <= editor.context.colpanes[colpane].last) { // visible column\r\n               return result;\r\n               }\r\n            }\r\n         delete result.coltoresize;\r\n         result.colselect = true;\r\n         return result;\r\n         }\r\n      else if (clientX >= editor.verticaltablecontrol.controlborder) {\r\n         result.rowfooter = true;\r\n         result.distance = clientX - editor.verticaltablecontrol.controlborder;\r\n         return result;\r\n         }\r\n      else if (clientY >= editor.horizontaltablecontrol.controlborder) {\r\n         result.colfooter = true;\r\n         result.distance = clientY - editor.horizontaltablecontrol.controlborder;\r\n         return result;\r\n         }\r\n      else if (clientX < editor.gridposition.left) {\r\n         result.rowheader = true;\r\n         result.distance = editor.headposition.left - clientX;\r\n         return result;\r\n         }\r\n      else if (clientY <= editor.gridposition.top) {\r\n         result.colheader = true;\r\n         result.distance = editor.headposition.top - clientY;\r\n         return result;\r\n         }\r\n      else {\r\n         result.coord = SocialCalc.crToCoord(result.col, result.row);\r\n         if (editor.context.cellskip[result.coord]) { // handle skipped cells\r\n            result.coord = editor.context.cellskip[result.coord];\r\n            }\r\n         return result;\r\n         }\r\n      }\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n//\r\n// GetEditorCellElement(editor, row, col)\r\n//\r\n// Returns an object with element, the table cell element in the DOM that corresponds to row and column,\r\n// as well as rowpane and colpane, the panes with the cell.\r\n// If no such element, then returns null;\r\n//\r\n\r\nSocialCalc.GetEditorCellElement = function(editor, row, col) {\r\n\r\n  var headerColOffset = 0;\r\n  var headerRowOffset = 0;\r\n   //Adjust for row/col headers\r\n   if (editor.context.showRCHeaders == false) {     \r\n     var headerColOffset = -1;\r\n     var headerRowOffset = -1;\r\n   }\r\n   var rowpane, colpane, c, coord;\r\n   var rowindex = 0;\r\n   var colindex = 0;\r\n\r\n   for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\r\n      if (row >= editor.context.rowpanes[rowpane].first && row <= editor.context.rowpanes[rowpane].last) {\r\n         for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\r\n            if (col >= editor.context.colpanes[colpane].first && col <= editor.context.colpanes[colpane].last) {\r\n               rowindex += row - editor.context.rowpanes[rowpane].first + 2;\r\n               for (c=editor.context.colpanes[colpane].first; c<=col; c++) {\r\n                  coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\r\n                  if (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\r\n                     colindex++;\r\n                  }\r\n               return {\r\n                  element: editor.griddiv.firstChild.lastChild.childNodes[rowindex +headerRowOffset].childNodes[colindex + headerColOffset],\r\n                  rowpane: rowpane, colpane: colpane};\r\n               }\r\n            for (c=editor.context.colpanes[colpane].first; c<=editor.context.colpanes[colpane].last; c++) {\r\n               coord=editor.context.cellskip[SocialCalc.crToCoord(c,row)];\r\n               if (!coord || !editor.context.CoordInPane(coord, rowpane, colpane)) // don't count col-spanned cells\r\n                  colindex++;\r\n               }\r\n            colindex += 1;\r\n            }\r\n         }\r\n      rowindex += editor.context.rowpanes[rowpane].last - editor.context.rowpanes[rowpane].first + 1 + 1;\r\n      }\r\n\r\n   return null;\r\n}\r\n\r\n//\r\n// cellcoord = MoveECellWithKey(editor, ch)\r\n//\r\n// Processes an arrow key, etc., moving the edit cell.\r\n// If not a movement key, returns null.\r\n//\r\n\r\nSocialCalc.MoveECellWithKey = function(editor, ch) {\r\n\r\n   var coord, row, col, cell;\r\n   var shifted = false;\r\n   var delta = 1;\r\n\r\n   if (!editor.ecell) {\r\n      return null;\r\n      }\r\n\r\n   if (ch.slice(-7)==\"shifted\") {\r\n      ch = ch.slice(0,-7);\r\n      shifted = true;\r\n      }\r\n\r\n   row = editor.ecell.row;\r\n   col = editor.ecell.col;\r\n   cell = editor.context.sheetobj.cells[editor.ecell.coord];\r\n\r\n   switch (ch) {\r\n      case \"[adown]\":\r\n         row += (cell && cell.rowspan) || 1;\r\n         break;\r\n      case \"[aup]\":\r\n         row--;\r\n         delta = -1;\r\n         break;\r\n      case \"[pgdn]\":\r\n         row += editor.pageUpDnAmount - 1 + ((cell && cell.rowspan) || 1);\r\n         break;\r\n      case \"[pgup]\":\r\n         row -= editor.pageUpDnAmount;\r\n         delta = -1;\r\n         break;\r\n      case \"[aright]\":\r\n         col += (cell && cell.colspan) || 1;\r\n         break;\r\n      case \"[aleft]\":\r\n         col--;\r\n         delta = -1;\r\n         break;\r\n      case \"[home]\":\r\n         row = 1;\r\n         col = 1;\r\n         break;\r\n      default:\r\n         return null;\r\n      }\r\n\r\n   // Adjust against usermax col and row.\r\n   if (editor.context.sheetobj.attribs.usermaxcol) col = Math.min(editor.context.sheetobj.attribs.usermaxcol, col);\r\n   if (editor.context.sheetobj.attribs.usermaxrow) row = Math.min(editor.context.sheetobj.attribs.usermaxrow, row);\r\n\r\n   // Handle hidden column.\r\n   while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n      col += delta;\r\n      if (col < 1) {\r\n         delta = -delta;\r\n         col = 1;\r\n         }\r\n      }\r\n   \r\n   // Handle hidden row.\r\n   while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\r\n      row += delta;\r\n      if (row < 1) {\r\n         delta = -delta;\r\n         row = 1;\r\n         }\r\n      }\r\n   \r\n   if (!editor.range.hasrange) {\r\n      if (shifted)\r\n         editor.RangeAnchor();\r\n      }\r\n\r\n   coord = editor.MoveECell(SocialCalc.crToCoord(col, row));\r\n\r\n   if (editor.range.hasrange) {\r\n      if (shifted)\r\n         editor.RangeExtend();\r\n      else\r\n         editor.RangeRemove();\r\n      }\r\n\r\n   return coord;\r\n\r\n   }\r\n\r\n//\r\n// cellcoord = MoveECell(editor, newecell)\r\n//\r\n// Takes a coordinate and returns the new edit cell coordinate (which may be\r\n// different if newecell is covered by a span).\r\n//\r\n\r\nSocialCalc.MoveECell = function(editor, newcell) {\r\n\r\n   var cell, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   \r\n   // adjust against user max col/row\r\n   var ecell = SocialCalc.coordToCr(newcell);\r\n   if (editor.context.sheetobj.attribs.usermaxcol && ecell.col > editor.context.sheetobj.attribs.usermaxcol)\r\n      ecell.col = editor.context.sheetobj.attribs.usermaxcol;\r\n   if (editor.context.sheetobj.attribs.usermaxrow && ecell.row > editor.context.sheetobj.attribs.usermaxrow)\r\n      ecell.row = editor.context.sheetobj.attribs.usermaxrow;\r\n   newcell = SocialCalc.crToCoord(ecell.col, ecell.row);\r\n\r\n   if (editor.ecell) {\r\n      if (editor.ecell.coord==newcell) return newcell; // already there - don't do anything and don't tell anybody\r\n      cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n      delete highlights[editor.ecell.coord];\r\n      if (editor.range2.hasrange &&\r\n        editor.ecell.row>=editor.range2.top && editor.ecell.row<=editor.range2.bottom &&\r\n        editor.ecell.col>=editor.range2.left && editor.ecell.col<=editor.range2.right) {\r\n         highlights[editor.ecell.coord] = \"range2\";\r\n         }\r\n      editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\r\n      editor.SetECellHeaders(\"\"); // set to regular col/rowname styles\r\n      if(editor.cellhandles) editor.cellhandles.ShowCellHandles(false); // only if row/col visible \r\n      }\r\n   newcell = editor.context.cellskip[newcell] || newcell;\r\n   editor.ecell = SocialCalc.coordToCr(newcell);\r\n   editor.ecell.coord = newcell;\r\n   cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n   // eddy MoveECell {\r\n   // }\r\n   highlights[newcell] = \"cursor\";\r\n\r\n   for (f in editor.MoveECellCallback) { // let others know\r\n      editor.MoveECellCallback[f](editor);\r\n      }\r\n\r\n   editor.UpdateCellCSS(cell, editor.ecell.row, editor.ecell.col);\r\n   editor.SetECellHeaders(\"selected\");\r\n\r\n   for (f in editor.StatusCallback) { // let status line, etc., know\r\n      editor.StatusCallback[f].func(editor, \"moveecell\", newcell, editor.StatusCallback[f].params);\r\n      }\r\n\r\n   if (editor.busy) {\r\n      editor.ensureecell = true; // wait for when not busy\r\n      }\r\n   else {\r\n      editor.ensureecell = false;\r\n      editor.EnsureECellVisible();\r\n      }\r\n\r\n   return newcell;\r\n\r\n   }\r\n\r\nSocialCalc.EnsureECellVisible = function(editor) {\r\n\r\n   var vamount = 0;\r\n   var hamount = 0;\r\n\r\n   if (editor.ecell.row > editor.lastnonscrollingrow) {\r\n      if (editor.ecell.row < editor.firstscrollingrow) {\r\n         vamount = editor.ecell.row - editor.firstscrollingrow - Math.floor((editor.lastvisiblerow - editor.firstscrollingrow)/2);\r\n         }\r\n      else if (editor.ecell.row + 1 > editor.lastvisiblerow) {\r\n         vamount = editor.ecell.row - editor.lastvisiblerow + Math.floor((editor.lastvisiblerow - editor.firstscrollingrow)/2);\r\n         }\r\n      }   \r\n   if (editor.ecell.col > editor.lastnonscrollingcol) {\r\n      if (editor.ecell.col < editor.firstscrollingcol) {\r\n         hamount = editor.ecell.col - editor.firstscrollingcol - Math.floor((editor.lastvisiblecol - editor.firstscrollingcol)/2);\r\n         }\r\n      else if (editor.ecell.col + 1 > editor.lastvisiblecol) {\r\n        hamount = editor.ecell.col- editor.lastvisiblecol + Math.floor((editor.lastvisiblecol - editor.firstscrollingcol)/2);\r\n         }\r\n      }\r\n\r\n   if (vamount!=0 || hamount!=0) {\r\n      editor.ScrollRelativeBoth(vamount, hamount);\r\n      }\r\n   else {\r\n      editor.cellhandles.ShowCellHandles(true);\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.ReplaceCell = function(editor, cell, row, col) {\r\n\r\n   var newelement, a;\r\n   if (!cell) return;\r\n   newelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\r\n   if (newelement && cell.element) { // skip hidden cells\r\n      // Don't use a real element and replaceChild, which seems to have focus issues with IE, Firefox, and speed issues\r\n      cell.element.innerHTML = newelement.innerHTML;\r\n      cell.element.style.cssText = \"\";\r\n      cell.element.className = newelement.className;\r\n      for (a in newelement.style) {\r\n         if (newelement.style[a]!=\"cssText\")\r\n            cell.element.style[a] = newelement.style[a];\r\n         }\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.UpdateCellCSS = function(editor, cell, row, col) {\r\n\r\n   var newelement, a;\r\n   if (!cell) return;\r\n   newelement = editor.context.RenderCell(row, col, cell.rowpane, cell.colpane, true, null);\r\n   if (newelement) {\r\n      cell.element.style.cssText = \"\";\r\n      cell.element.className = newelement.className;\r\n      for (a in newelement.style) {\r\n         if (newelement.style[a]!=\"cssText\")\r\n            cell.element.style[a] = newelement.style[a];\r\n         }\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.SetECellHeaders = function(editor, selected) {\r\n\r\n   // eddy SetECellHeaders {\r\n   if(editor.context.showRCHeaders === false) return;\r\n   // } SetECellHeaders\r\n   var ecell = editor.ecell;\r\n   var context = editor.context;\r\n\r\n   var rowpane, colpane, first, last;\r\n   var rowindex = 0;\r\n   var colindex = 0;\r\n   var headercell;\r\n\r\n   if (!ecell) return;\r\n\r\n   // Handle ecell on a hidden column/row.\r\n   while (context.sheetobj.colattribs.hide[SocialCalc.rcColname(ecell.col)] == \"yes\") {\r\n      ecell.col++;\r\n      }\r\n   while (context.sheetobj.rowattribs.hide[ecell.row] == \"yes\") {\r\n      ecell.row++;\r\n      }\r\n\r\n   ecell.coord = SocialCalc.crToCoord(ecell.col, ecell.row);\r\n\r\n   for (rowpane=0; rowpane<context.rowpanes.length; rowpane++) {\r\n      first = context.rowpanes[rowpane].first;\r\n      last = context.rowpanes[rowpane].last;\r\n      if (ecell.row >= first && ecell.row <= last) {\r\n         if (editor.fullgrid !== null) {\r\n            headercell = editor.fullgrid.childNodes[1].childNodes[2+rowindex+ecell.row-first].childNodes[0];\r\n            if (headercell) {\r\n               if (context.classnames) headercell.className=context.classnames[selected+\"rowname\"];\r\n               if (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"rowname\"];\r\n               headercell.style.verticalAlign=\"top\"; // to get around Safari making top of centered row number be\r\n                                                     // considered top of row (and can't get <row> position in Safari)\r\n               }\r\n            }\r\n         }\r\n      rowindex += last - first + 1 + 1;\r\n      }\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      first = context.colpanes[colpane].first;\r\n      last = context.colpanes[colpane].last;\r\n      if (ecell.col >= first && ecell.col <= last) {\r\n         if (editor.fullgrid !== null) {\r\n            headercell = editor.fullgrid.childNodes[1].childNodes[1].childNodes[1+colindex+ecell.col-first];\r\n            if (headercell) {\r\n               if (context.classnames) headercell.className=context.classnames[selected+\"colname\"];\r\n               if (context.explicitStyles) headercell.style.cssText=context.explicitStyles[selected+\"colname\"];\r\n               }\r\n            }\r\n         }\r\n      colindex += last - first + 1 + 1;\r\n      }\r\n   }\r\n\r\n//\r\n// ECellReadonly(editor, ecoord)\r\n//\r\n// Returns true if ecoord is readonly (or ecell if missing).\r\n//\r\n\r\nSocialCalc.ECellReadonly = function(editor, ecoord) {\r\n   \r\n   if (!ecoord && editor.ecell) {\r\n      ecoord = editor.ecell.coord; \r\n      }\r\n\r\n   if (!ecoord) return false;\r\n\r\n   var cell = editor.context.sheetobj.cells[ecoord];\r\n   return cell && cell.readonly;\r\n\r\n   }\r\n\r\n//\r\n// RangeAnchor(editor, ecoord)\r\n//\r\n// Sets the anchor of a range to ecoord (or ecell if missing).\r\n//\r\n\r\nSocialCalc.RangeAnchor = function(editor, ecoord) {\r\n\r\n   if (editor.range.hasrange) {\r\n      editor.RangeRemove();\r\n      }\r\n\r\n   editor.RangeExtend(ecoord);\r\n\r\n   }\r\n\r\n//\r\n// RangeExtend(editor, ecoord)\r\n//\r\n// Sets the other corner of the range to ecoord or, if missing, ecell.\r\n//\r\n\r\nSocialCalc.RangeExtend = function(editor, ecoord) {\r\n\r\n   var a, cell, cr, coord, row, col, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   var range = editor.range;\r\n   var range2 = editor.range2;\r\n\r\n   var ecell;\r\n   if (ecoord) {\r\n      ecell = SocialCalc.coordToCr(ecoord);\r\n      ecell.coord = ecoord;\r\n      }\r\n   else ecell = editor.ecell;\r\n\r\n   if (!ecell) return; // just in case\r\n\r\n   if (!range.hasrange) { // called without RangeAnchor...\r\n      range.anchorcoord = ecell.coord;\r\n      range.anchorrow = ecell.row;\r\n      range.top = ecell.row;\r\n      range.bottom = ecell.row;\r\n      range.anchorcol = ecell.col;\r\n      range.left = ecell.col;\r\n      range.right = ecell.col;\r\n      range.hasrange = true;\r\n      }\r\n\r\n   if (range.anchorrow < ecell.row) {\r\n      range.top = range.anchorrow;\r\n      range.bottom = ecell.row;\r\n      }\r\n   else {\r\n      range.top = ecell.row;\r\n      range.bottom = range.anchorrow;\r\n      }\r\n   if (range.anchorcol < ecell.col) {\r\n      range.left = range.anchorcol;\r\n      range.right = ecell.col;\r\n      }\r\n   else {\r\n      range.left = ecell.col;\r\n      range.right = range.anchorcol;\r\n      }\r\n\r\n   for (coord in highlights) {\r\n      switch (highlights[coord]) {\r\n         case \"range\":\r\n            highlights[coord] = \"unrange\";\r\n            break;\r\n         case \"range2\":\r\n            highlights[coord] = \"unrange2\";\r\n            break;\r\n         }\r\n      }\r\n\r\n   for (row=range.top; row<=range.bottom; row++) {\r\n      for (col=range.left; col<=range.right; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         switch (highlights[coord]) {\r\n            case \"unrange\":\r\n               highlights[coord] = \"range\";\r\n               break;\r\n            case \"cursor\":\r\n               break;\r\n            case \"unrange2\":\r\n            default:\r\n               highlights[coord] = \"newrange\";\r\n               break;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\r\n      for (col=range2.left; col<=range2.right; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         switch (highlights[coord]) {\r\n            case \"unrange2\":\r\n               highlights[coord] = \"range2\";\r\n               break;\r\n            case \"range\":\r\n            case \"newrange\":\r\n            case \"cursor\":\r\n               break;\r\n            default:\r\n               highlights[coord] = \"newrange2\";\r\n               break;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (coord in highlights) {\r\n\r\n      switch (highlights[coord]) {\r\n         case \"unrange\":\r\n            delete highlights[coord];\r\n            break;\r\n         case \"newrange\":\r\n            highlights[coord] = \"range\";\r\n            break;\r\n         case \"newrange2\":\r\n            highlights[coord] = \"range2\";\r\n            break;\r\n         case \"range\":\r\n         case \"range2\":\r\n         case \"cursor\":\r\n            continue;\r\n         }\r\n\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell = SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\r\n\r\n      }\r\n\r\n   for (f in editor.RangeChangeCallback) { // let others know\r\n      editor.RangeChangeCallback[f](editor);\r\n      }\r\n\r\n   // create range/coord string and do status callback\r\n\r\n   coord = SocialCalc.crToCoord(editor.range.left, editor.range.top);\r\n   if (editor.range.left!=editor.range.right || editor.range.top!=editor.range.bottom) { // more than one cell\r\n      coord += \":\" + SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      }\r\n   for (f in editor.StatusCallback) {\r\n      editor.StatusCallback[f].func(editor, \"rangechange\", coord, editor.StatusCallback[f].params);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// RangeRemove(editor)\r\n//\r\n// Turns off the range.\r\n//\r\n\r\nSocialCalc.RangeRemove = function(editor) {\r\n\r\n   var cell, cr, coord, row, col, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   var range = editor.range;\r\n   var range2 = editor.range2;\r\n\r\n   if (!range.hasrange && !range2.hasrange) return;\r\n\r\n   for (row=range2.top; range2.hasrange && row<=range2.bottom; row++) {\r\n      for (col=range2.left; col<=range2.right; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         switch (highlights[coord]) {\r\n            case \"range\":\r\n               highlights[coord] = \"newrange2\";\r\n               break;\r\n            case \"range2\":\r\n            case \"cursor\":\r\n               break;\r\n            default:\r\n               highlights[coord] = \"newrange2\";\r\n               break;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (coord in highlights) {\r\n      switch (highlights[coord]) {\r\n         case \"range\":\r\n            delete highlights[coord];\r\n            break;\r\n         case \"newrange2\":\r\n            highlights[coord] = \"range2\";\r\n            break;\r\n         case \"cursor\":\r\n            continue;\r\n         }\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\r\n      }\r\n\r\n   range.hasrange = false;\r\n\r\n   for (f in editor.RangeChangeCallback) { // let others know\r\n      editor.RangeChangeCallback[f](editor);\r\n      }\r\n\r\n   for (f in editor.StatusCallback) {\r\n      editor.StatusCallback[f].func(editor, \"rangechange\", \"\", editor.StatusCallback[f].params);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// Range2Remove(editor)\r\n//\r\n// Turns off the range2.\r\n//\r\n\r\nSocialCalc.Range2Remove = function(editor) {\r\n\r\n   var cell, cr, coord, row, col, f;\r\n\r\n   var highlights = editor.context.highlights;\r\n   var range2 = editor.range2;\r\n\r\n   if (!range2.hasrange) return;\r\n\r\n   for (coord in highlights) {\r\n      switch (highlights[coord]) {\r\n         case \"range2\":\r\n            delete highlights[coord];\r\n            break;\r\n         case \"range\":\r\n         case \"cursor\":\r\n            continue;\r\n         }\r\n      cr = SocialCalc.coordToCr(coord);\r\n      cell=SocialCalc.GetEditorCellElement(editor, cr.row, cr.col);\r\n      editor.UpdateCellCSS(cell, cr.row, cr.col);\r\n      }\r\n\r\n   range2.hasrange = false;\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// FitToEditTable(editor)\r\n//\r\n// Figure out (through column width declarations and approximation of pixels per row)\r\n// how many rendered rows and columns you need to be at least a little larger than\r\n// the editor's editing area.\r\n//\r\n\r\nSocialCalc.FitToEditTable = function(editor) {\r\n\r\n   var colnum, colname, colwidth, totalwidth, totalrows, rownum, rowpane, needed;\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n   var sheetcolattribs=sheetobj.colattribs;\r\n\r\n   // Calculate column width data\r\n\r\n   totalwidth=context.showRCHeaders ? context.rownamewidth-0 : 0;\r\n   for (colpane=0; colpane<context.colpanes.length-1; colpane++) { // Get width of all but last pane\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         colname=SocialCalc.rcColname(colnum);\r\n         if (sheetobj.colattribs.hide[colname] != \"yes\") {\r\n            colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\r\n            if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\r\n            totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\r\n            }\r\n         }\r\n      }\r\n\r\n   for (colnum=context.colpanes[colpane].first; colnum<=10000; colnum++) { //!!! max for safety, but makes that col max!!!\r\n      colname=SocialCalc.rcColname(colnum);\r\n      if (sheetobj.colattribs.hide[colname] != \"yes\") {\r\n         colwidth = sheetobj.colattribs.width[colname] || sheetobj.attribs.defaultcolwidth || SocialCalc.Constants.defaultColWidth;\r\n         if (colwidth==\"blank\" || colwidth==\"auto\") colwidth=\"\";\r\n         totalwidth+=(colwidth && ((colwidth-0)>0)) ? (colwidth-0) : 10;\r\n         }\r\n      if (totalwidth > editor.tablewidth) break;\r\n      }\r\n\r\n   context.colpanes[colpane].last = context.sheetobj.attribs.usermaxcol || colnum;\r\n\r\n   // Calculate row height data\r\n   \r\n   // find first visible row\r\n   var firstRow = context.rowpanes[0].first;\r\n   var lastRow = context.sheetobj.attribs.lastrow;\r\n   while(sheetobj.rowattribs.hide[firstRow] == \"yes\" && firstRow <lastRow) firstRow++;\r\n   context.rowpanes[0].first = firstRow;\r\n   \r\n   // count visible rows in pane(s)\r\n   totalrows=context.showRCHeaders ? 1 : 0;\r\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) { // count all panes but last one\r\n      totalrows += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 1;\r\n      for (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\r\n         if (sheetobj.rowattribs.hide[rownum] == \"yes\") {\r\n            totalrows--;\r\n            }\r\n         }\r\n      }\r\n\r\n   needed = editor.tableheight - totalrows * context.pixelsPerRow; // estimate amount needed\r\n\r\n   context.rowpanes[rowpane].last = context.sheetobj.attribs.usermaxrow || context.rowpanes[rowpane].first + Math.floor(needed / context.pixelsPerRow) + 1;\r\n\r\n   }\r\n\r\n//\r\n// CalculateEditorPositions(editor)\r\n//\r\n// Calculate the screen positions and other values of various editing elements\r\n// These values change and need to be recomputed when the pane first/last or cell contents change,\r\n// as well as new column widths, etc.\r\n//\r\n// Note: Only call this after the grid has been rendered! You may have to wait for a timeout...\r\n//\r\n\r\nSocialCalc.CalculateEditorPositions = function(editor) {\r\n\r\n   var rowpane, colpane, i;\r\n\r\n   editor.gridposition = SocialCalc.GetElementPosition(editor.griddiv);\r\n   \r\n   var element = editor.griddiv.firstChild.lastChild.childNodes[1].childNodes[0]; // 2nd tr 1st td\r\n   editor.headposition = SocialCalc.GetElementPosition(element);\r\n   editor.headposition.left += element.offsetWidth;\r\n   editor.headposition.top += element.offsetHeight;\r\n\r\n   editor.rowpositions = [];\r\n   for (rowpane=0; rowpane<editor.context.rowpanes.length; rowpane++) {\r\n      editor.CalculateRowPositions(rowpane, editor.rowpositions, editor.rowheight);\r\n      }\r\n   for (i=0; i<editor.rowpositions.length; i++) {\r\n      if (editor.rowpositions[i]>editor.gridposition.top+editor.tableheight) break;\r\n      }\r\n   editor.lastvisiblerow = i-1;\r\n\r\n   editor.colpositions = [];\r\n   for (colpane=0; colpane<editor.context.colpanes.length; colpane++) {\r\n      editor.CalculateColPositions(colpane, editor.colpositions, editor.colwidth);\r\n      }\r\n   for (i=0; i<editor.colpositions.length; i++) {\r\n      if (editor.colpositions[i]>editor.gridposition.left+editor.tablewidth) break;\r\n      }\r\n   editor.lastvisiblecol = i-1;\r\n\r\n   editor.firstscrollingrow = editor.context.rowpanes[editor.context.rowpanes.length-1].first;\r\n   while (editor.context.sheetobj.rowattribs.hide[editor.firstscrollingrow] == \"yes\") {\r\n      editor.firstscrollingrow++;\r\n      }\r\n   editor.firstscrollingrowtop = editor.rowpositions[editor.firstscrollingrow] || editor.headposition.top;\r\n   editor.lastnonscrollingrow = editor.context.rowpanes.length-1 > 0 ?\r\n         editor.context.rowpanes[editor.context.rowpanes.length-2].last : 0;\r\n   editor.firstscrollingcol = editor.context.colpanes[editor.context.colpanes.length-1].first;\r\n   while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(editor.firstscrollingcol)] == \"yes\") {\r\n      editor.firstscrollingcol++;\r\n      }\r\n   editor.firstscrollingcolleft = editor.colpositions[editor.firstscrollingcol] || editor.headposition.left;\r\n   editor.lastnonscrollingcol = editor.context.colpanes.length-1 > 0 ?\r\n         editor.context.colpanes[editor.context.colpanes.length-2].last : 0;\r\n\r\n   // Now do the table controls\r\n\r\n   editor.verticaltablecontrol.ComputeTableControlPositions();\r\n   editor.horizontaltablecontrol.ComputeTableControlPositions();\r\n   }\r\n\r\n//\r\n// ScheduleRender(editor)\r\n//\r\n// Do a series of timeouts to render the sheet, wait for background layout and\r\n// rendering by the browser, and then update editor visuals, sliders, etc.\r\n//\r\n\r\nSocialCalc.ScheduleRender = function(editor) {\r\n   if(editor.ignoreRender == true) return; // formDataViewer is only used for \"ExecuteSheetCommand\" fumctions - so skip render \r\n   if (editor.timeout) window.clearTimeout(editor.timeout); // in case called more than once, just use latest\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"schedrender\", null, editor);\r\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoRenderStep(editor); }, 1);\r\n\r\n   }\r\n\r\n// DoRenderStep(editor)\r\n//\r\n\r\nSocialCalc.DoRenderStep = function(editor) {\r\n\r\n   editor.timeout = null;\r\n\r\n   editor.EditorRenderSheet();\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"renderdone\", null, editor);\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\r\n\r\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoPositionCalculations(editor); }, 1);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SchedulePositionCalculations(editor)\r\n//\r\n\r\nSocialCalc.SchedulePositionCalculations = function(editor) {\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"schedposcalc\", null, editor);\r\n\r\n   editor.timeout = window.setTimeout(function() { SocialCalc.DoPositionCalculations(editor); }, 1);\r\n\r\n   }\r\n\r\n// DoPositionCalculations(editor)\r\n//\r\n// Update editor visuals, sliders, etc.\r\n//\r\n// Note: Only call this after the DOM objects have been modified and rendered!\r\n//\r\n\r\nSocialCalc.DoPositionCalculations = function(editor) {\r\n\r\n   editor.timeout = null;\r\n\r\n   editor.CalculateEditorPositions();\r\n   editor.verticaltablecontrol.PositionTableControlElements();\r\n   editor.horizontaltablecontrol.PositionTableControlElements();\r\n\r\n   SocialCalc.EditorSheetStatusCallback(null, \"doneposcalc\", null, editor);\r\n\r\n   if (editor.ensureecell && editor.ecell && !editor.deferredCommands.length) { // don't do if deferred cmd to execute\r\n      editor.ensureecell = false;\r\n      editor.EnsureECellVisible(); // this could cause another redisplay\r\n      }\r\n\r\n   editor.cellhandles.ShowCellHandles(true);\r\n\r\n\r\n//!!! Need to now check to see if this positioned controls out of the editing area\r\n//!!! (such as when there is a large wrapped cell and it pushes the pane boundary too far down).\r\n\r\n   }\r\n\r\nSocialCalc.CalculateRowPositions = function(editor, panenum, positions, sizes) {\r\n\r\n   var toprow, rowpane, rownum, offset, trowobj, cellposition;\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var tbodyobj;\r\n\r\n   // eddy CalculateRowPositions {\r\n//   if (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\r\n   if (!context.showRCHeaders) return;\r\n   // } CalculateRowPositions\r\n   \r\n   tbodyobj=editor.fullgrid.lastChild;\r\n\r\n   // Calculate start of this pane as row in this table:\r\n\r\n   toprow = 2;\r\n   for (rowpane=0; rowpane<panenum; rowpane++) {\r\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\r\n      }\r\n\r\n   offset = 0;\r\n   for (rownum=context.rowpanes[rowpane].first; rownum<=context.rowpanes[rowpane].last; rownum++) {\r\n      trowobj = tbodyobj.childNodes[toprow+offset];\r\n      offset++;\r\n      if (!trowobj) { continue; }\r\n\r\n      if (!positions[rownum]) {\r\n         positions[rownum] = trowobj.firstChild.offsetTop;\r\n         sizes[rownum] = trowobj.firstChild.offsetHeight;\r\n         }\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.CalculateColPositions = function(editor, panenum, positions, sizes) {\r\n\r\n   var leftcol, colpane, colnum, offset, trowobj, cellposition;\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n\r\n   var tbodyobj;\r\n\r\n   // eddy CalculateColPositions {\r\n   // if (!context.showRCHeaders) throw(\"Needs showRCHeaders=true\");\r\n   if (!context.showRCHeaders) return;\r\n   // } CalculateColPositions\r\n\r\n   tbodyobj=editor.fullgrid.lastChild;\r\n\r\n   // Calculate start of this pane as column in this table:\r\n\r\n   leftcol = 1;\r\n   for (colpane=0; colpane<panenum; colpane++) {\r\n      leftcol += context.colpanes[colpane].last - context.colpanes[colpane].first + 2; // skip pane and spacing col\r\n      }\r\n\r\n   trowobj = tbodyobj.childNodes[1]; // get heading row, which has all columns\r\n   offset = 0;\r\n   for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n      cellposition = SocialCalc.GetElementPosition(trowobj.childNodes[leftcol+offset]);\r\n      if (!positions[colnum]) {\r\n         positions[colnum] = cellposition.left; // first one takes precedence\r\n         if (trowobj.childNodes[leftcol+offset]) {\r\n            sizes[colnum] = trowobj.childNodes[leftcol+offset].offsetWidth;\r\n            }\r\n         }\r\n      offset++;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n// ScrollRelative(editor, vertical, amount)\r\n//\r\n// If vertical true, scrolls up(-)/down(+), else left(-)/right(+)\r\n\r\nSocialCalc.ScrollRelative = function(editor, vertical, amount) {\r\n\r\n   if (vertical) {\r\n      editor.ScrollRelativeBoth(amount, 0);\r\n      }\r\n   else {\r\n      editor.ScrollRelativeBoth(0, amount);\r\n      }\r\n   return;\r\n\r\n   }\r\n\r\n// ScrollRelativeBoth(editor, vamount, hamount)\r\n//\r\n// Does both with one render\r\n\r\nSocialCalc.ScrollRelativeBoth = function(editor, vamount, hamount) {\r\n\r\n   var context=editor.context;\r\n   var dv = vamount > 0 ? 1 : -1, dh = hamount > 0 ? 1 : -1;\r\n\r\n   var vplen=context.rowpanes.length;\r\n   var vlimit = vplen>1 ? context.rowpanes[vplen-2].last+1 : 1; // don't scroll past here\r\n   if (context.rowpanes[vplen-1].first+vamount < vlimit) { // limit amount\r\n      vamount = (-context.rowpanes[vplen-1].first) + vlimit;\r\n      }\r\n\r\n   var hplen=context.colpanes.length;\r\n   var hlimit = hplen>1 ? context.colpanes[hplen-2].last+1 : 1; // don't scroll past here\r\n   if (context.colpanes[hplen-1].first+hamount < hlimit) { // limit amount\r\n      hamount = (-context.colpanes[hplen-1].first) + hlimit;\r\n      }\r\n\r\n   // Handle hidden column by finding a next one that's not hidden.\r\n   while (context.sheetobj.colattribs.hide[SocialCalc.rcColname(context.colpanes[hplen-1].first+hamount)] == \"yes\") {\r\n      hamount += dh;\r\n      if (hamount < 1) {\r\n         hamount = 0;\r\n         break;\r\n         }\r\n      }\r\n\r\n   // Handle hidden row by finding a next one that's not hidden.\r\n   while (context.sheetobj.rowattribs.hide[context.rowpanes[vplen-1].first+vamount] == \"yes\") {\r\n      vamount += dv;\r\n      if (vamount < 1) {\r\n         vamount = 0;\r\n         break;\r\n         }\r\n      }\r\n\r\n   if ((vamount==1 || vamount==-1) && hamount==0) { // special case quick scrolls\r\n      if (vamount==1) {\r\n         editor.ScrollTableUpOneRow();\r\n         }\r\n      else {\r\n         editor.ScrollTableDownOneRow();\r\n         }\r\n      if (editor.ecell) editor.SetECellHeaders(\"selected\");\r\n      editor.SchedulePositionCalculations();\r\n      return;\r\n      }\r\n\r\n   // Do a gross move and render\r\n\r\n   if (vamount!=0 || hamount!=0) {\r\n      context.rowpanes[vplen-1].first += vamount;\r\n      context.rowpanes[vplen-1].last += vamount;\r\n      context.colpanes[hplen-1].first += hamount;\r\n      context.colpanes[hplen-1].last += hamount;\r\n      editor.LimitLastPanes();\r\n      editor.FitToEditTable();\r\n      editor.ScheduleRender();\r\n      }\r\n\r\n   }\r\n\r\n\r\n// PageRelative(editor, vertical, direction)\r\n//\r\n// If vertical true, pages up(direction is -)/down(+), else left(-)/right(+)\r\n\r\nSocialCalc.PageRelative = function(editor, vertical, direction) {\r\n\r\n   var context=editor.context;\r\n   var panes=vertical ? \"rowpanes\" : \"colpanes\";\r\n   var lastpane=context[panes][context[panes].length-1];\r\n   var lastvisible=vertical ? \"lastvisiblerow\" : \"lastvisiblecol\";\r\n   var sizearray=vertical ? editor.rowheight : editor.colwidth;\r\n   var defaultsize=vertical ? SocialCalc.Constants.defaultAssumedRowHeight : SocialCalc.Constants.defaultColWidth;\r\n   var size, newfirst, totalsize, current;\r\n\r\n   if (direction > 0) { // down/right\r\n      newfirst = editor[lastvisible];\r\n      if (newfirst == lastpane.first) newfirst += 1; // move at least one\r\n      }\r\n   else {\r\n      if (vertical) { // calculate amount to scroll\r\n         totalsize = editor.tableheight - (editor.firstscrollingrowtop - editor.gridposition.top);\r\n         }\r\n      else {\r\n         totalsize = editor.tablewidth - (editor.firstscrollingcolleft - editor.gridposition.left);\r\n         }\r\n      totalsize -= sizearray[editor[lastvisible]] > 0 ? sizearray[editor[lastvisible]] : defaultsize;\r\n\r\n      for (newfirst=lastpane.first-1; newfirst>0; newfirst--) {\r\n         size = sizearray[newfirst] > 0 ? sizearray[newfirst] : defaultsize;\r\n         if (totalsize < size) break;\r\n         totalsize -= size;\r\n         }\r\n\r\n      current = lastpane.first;\r\n      if (newfirst >= current) newfirst = current-1; // move at least 1\r\n      if (newfirst < 1) newfirst = 1;\r\n      }\r\n\r\n   lastpane.first = newfirst;\r\n   lastpane.last = newfirst+1;\r\n   editor.LimitLastPanes();\r\n   editor.FitToEditTable();\r\n   editor.ScheduleRender();\r\n\r\n   }\r\n\r\n// LimitLastPanes(editor)\r\n//\r\n// Makes sure that the \"first\" of the last panes isn't before the last of the previous pane\r\n//\r\n\r\nSocialCalc.LimitLastPanes = function(editor) {\r\n\r\n   var context=editor.context;\r\n   var plen;\r\n\r\n   plen = context.rowpanes.length;\r\n   if (plen>1 && context.rowpanes[plen-1].first <= context.rowpanes[plen-2].last)\r\n       context.rowpanes[plen-1].first = context.rowpanes[plen-2].last+1;\r\n   if (context.sheetobj.attribs.usermaxrow && context.rowpanes[plen-1].first > context.sheetobj.attribs.usermaxrow)\r\n       context.rowpanes[plen-1].first = context.sheetobj.attribs.usermaxrow;\r\n\r\n   plen = context.colpanes.length;\r\n   if (plen>1 && context.colpanes[plen-1].first <= context.colpanes[plen-2].last)\r\n       context.colpanes[plen-1].first = context.colpanes[plen-2].last+1;\r\n   if (context.sheetobj.attribs.usermaxcol && context.colpanes[plen-1].first > context.sheetobj.attribs.usermaxcol)\r\n       context.colpanes[plen-1].first = context.sheetobj.attribs.usermaxcol;\r\n\r\n   }\r\n\r\nSocialCalc.ScrollTableUpOneRow = function(editor) {\r\n\r\n   var toprow, rowpane, rownum, colnum, colpane, cell, oldrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\r\n   var rowneedsrefresh={};\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n   var tableobj=editor.fullgrid;\r\n\r\n   var tbodyobj;\r\n\r\n   tbodyobj=tableobj.lastChild;\r\n\r\n   toprow = context.showRCHeaders ? 2 : 1;\r\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\r\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\r\n      }\r\n\r\n   // abort if scrolling beyond user max row\r\n   if (context.sheetobj.attribs.usermaxrow && (context.sheetobj.attribs.usermaxrow - context.rowpanes[rowpane].first < 1)) {\r\n      return tableobj;\r\n      }\r\n  \r\n   tbodyobj.removeChild(tbodyobj.childNodes[toprow]);\r\n\r\n   context.rowpanes[rowpane].first++;\r\n   context.rowpanes[rowpane].last++;\r\n   editor.FitToEditTable();\r\n   context.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\r\n\r\n   if (!context.sheetobj.attribs.usermaxrow || context.rowpanes[rowpane].last != context.sheetobj.attribs.usermaxrow) {\r\n      newbottomrow = context.RenderRow(context.rowpanes[rowpane].last, rowpane);\r\n      tbodyobj.appendChild(newbottomrow);\r\n      }\r\n\r\n   // if scrolled off a row with starting rowspans, replace rows for the largest rowspan\r\n\r\n   maxrowspan = 1;\r\n   oldrownum=context.rowpanes[rowpane].first - 1;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=SocialCalc.crToCoord(colnum, oldrownum);\r\n         if (context.cellskip[coord]) continue;\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\r\n         }\r\n      }\r\n\r\n   if (maxrowspan>1) {\r\n      for (rownum=1; rownum<maxrowspan; rownum++) {\r\n         if (rownum+oldrownum >= context.rowpanes[rowpane].last) break;\r\n         newrow=context.RenderRow(rownum+oldrownum, rowpane);\r\n         oldchild=tbodyobj.childNodes[toprow+rownum-1];\r\n         tbodyobj.replaceChild(newrow,oldchild);\r\n         }\r\n      }\r\n\r\n   // if added a row that includes rowspans from above, update the size of those to include new row\r\n\r\n   bottomrownum=context.rowpanes[rowpane].last;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\r\n         if (!coord) continue; // only look at spanned cells\r\n         rownum=context.coordToCR[coord].row-0;\r\n         if (rownum==context.rowpanes[rowpane].last ||\r\n             rownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\r\n         }\r\n      }\r\n\r\n   for (rownum in rowneedsrefresh) {\r\n      newrow=context.RenderRow(rownum, rowpane);\r\n      oldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\r\n      tbodyobj.replaceChild(newrow,oldchild);\r\n      }\r\n\r\n   return tableobj;\r\n   }\r\n\r\nSocialCalc.ScrollTableDownOneRow = function(editor) {\r\n\r\n   var toprow, rowpane, rownum, colnum, colpane, cell, newrownum, maxspan, newbottomrow, newrow, oldchild, bottomrownum;\r\n   var rowneedsrefresh={};\r\n\r\n   var context=editor.context;\r\n   var sheetobj=context.sheetobj;\r\n   var tableobj=editor.fullgrid;\r\n\r\n   var tbodyobj;\r\n\r\n   tbodyobj=tableobj.lastChild;\r\n\r\n   toprow = context.showRCHeaders ? 2 : 1;\r\n   for (rowpane=0; rowpane<context.rowpanes.length-1; rowpane++) {\r\n      toprow += context.rowpanes[rowpane].last - context.rowpanes[rowpane].first + 2; // skip pane and spacing row\r\n      }\r\n\r\n   if (!context.sheetobj.attribs.usermaxrow) {\r\n      tbodyobj.removeChild(tbodyobj.childNodes[toprow+(context.rowpanes[rowpane].last-context.rowpanes[rowpane].first)]);\r\n      }\r\n\r\n   context.rowpanes[rowpane].first--;\r\n   context.rowpanes[rowpane].last--;\r\n   editor.FitToEditTable();\r\n   context.CalculateColWidthData(); // Just in case, since normally done in RenderSheet\r\n\r\n   newrow = context.RenderRow(context.rowpanes[rowpane].first, rowpane);\r\n   tbodyobj.insertBefore(newrow, tbodyobj.childNodes[toprow]);\r\n\r\n   // if inserted a row with starting rowspans, replace rows for the largest rowspan\r\n\r\n   maxrowspan = 1;\r\n   newrownum=context.rowpanes[rowpane].first;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=SocialCalc.crToCoord(colnum, newrownum);\r\n         if (context.cellskip[coord]) continue;\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>maxrowspan) maxrowspan=cell.rowspan;\r\n         }\r\n      }\r\n\r\n   if (maxrowspan>1) {\r\n      for (rownum=1; rownum<maxrowspan; rownum++) {\r\n         if (rownum+newrownum > context.rowpanes[rowpane].last) break;\r\n         newrow=context.RenderRow(rownum+newrownum, rowpane);\r\n         oldchild=tbodyobj.childNodes[toprow+rownum];\r\n         tbodyobj.replaceChild(newrow,oldchild);\r\n         }\r\n      }\r\n\r\n   // if last row now includes rowspans or rowspans from above, update the size of those to remove deleted row\r\n\r\n   bottomrownum=context.rowpanes[rowpane].last;\r\n\r\n   for (colpane=0; colpane<context.colpanes.length; colpane++) {\r\n      for (colnum=context.colpanes[colpane].first; colnum<=context.colpanes[colpane].last; colnum++) {\r\n         coord=SocialCalc.crToCoord(colnum, bottomrownum);\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>1) {\r\n            rowneedsrefresh[bottomrownum]=true; // need to update this row\r\n            continue;\r\n            }\r\n         coord=context.cellskip[SocialCalc.crToCoord(colnum, bottomrownum)];\r\n         if (!coord) continue; // only look at spanned cells\r\n         rownum=context.coordToCR[coord].row-0;\r\n         if (rownum==bottomrownum ||\r\n             rownum<context.rowpanes[rowpane].first) continue; // this row (colspan) or starts above pane\r\n         cell=sheetobj.cells[coord];\r\n         if (cell && cell.rowspan>1) rowneedsrefresh[rownum]=true; // remember row num to update\r\n         }\r\n      }\r\n\r\n   for (rownum in rowneedsrefresh) {\r\n      newrow=context.RenderRow(rownum, rowpane);\r\n      oldchild=tbodyobj.childNodes[(toprow+(rownum-context.rowpanes[rowpane].first))];\r\n      tbodyobj.replaceChild(newrow,oldchild);\r\n      }\r\n\r\n   return tableobj;\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// InputBox class:\r\n//\r\n// This class deals with the text box for editing cell contents.\r\n// It mainly controls a user input box for typed content and is used to interact with\r\n// the keyboard code, etc.\r\n//\r\n// You can use this inside a formula bar control of some sort.\r\n// You create this after you have created a table editor object (but not necessarily \r\n// done the CreateTableEditor method).\r\n//\r\n// When the user starts typing text, or double-clicks on a cell, this object\r\n// comes into play.\r\n//\r\n// The element given when this is first constructed should be an input HTMLElement or\r\n// something that acts like one. Check the code here to see what is done to it.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.InputBox = function(element, editor) {\r\n\r\n   if (!element) return; // invoked without enough data to work\r\n\r\n   this.element = element; // the input element associated with this InputBox\r\n   this.editor = editor; // the TableEditor this belongs to\r\n   this.inputEcho = null;\r\n\r\n   editor.inputBox = this;\r\n\r\n   element.onmousedown = SocialCalc.InputBoxOnMouseDown;\r\n\r\n   editor.MoveECellCallback.formulabar = function(e){\r\n      if (e.state!=\"start\") return; // if not in normal keyboard mode don't replace formula bar\r\n      editor.inputBox.DisplayCellContents(e.ecell.coord);\r\n      };\r\n   }\r\n\r\n\r\n// Methods:\r\n\r\nSocialCalc.InputBox.prototype.DisplayCellContents = function(coord) {SocialCalc.InputBoxDisplayCellContents(this, coord);};\r\nSocialCalc.InputBox.prototype.ShowInputBox = function(show) {this.editor.inputEcho.ShowInputEcho(show);};\r\nSocialCalc.InputBox.prototype.GetText = function() {return this.element.value;};\r\nSocialCalc.InputBox.prototype.SetText = function(newtext) {\r\n   if (!this.element) return;\r\n   this.element.value=newtext;\r\n   this.editor.inputEcho.SetText(newtext+\"_\");\r\n   };\r\nSocialCalc.InputBox.prototype.Focus = function() {SocialCalc.InputBoxFocus(this);};\r\nSocialCalc.InputBox.prototype.Blur = function() {return this.element.blur();};\r\nSocialCalc.InputBox.prototype.Select = function(t) {\r\n   if (!this.element) return;\r\n   switch (t) {\r\n      case \"end\":\r\n         if (document.selection && document.selection.createRange) {\r\n            /* IE 4+ - Safer than setting .selectionEnd as it also works for Textareas. */\r\n            try {\r\n               var range = document.selection.createRange().duplicate();\r\n               range.moveToElementText(this.element);\r\n               range.collapse(false);\r\n               range.select();\r\n            }\r\n            catch (e) {\r\n               if (this.element.selectionStart!=undefined) {\r\n                  this.element.selectionStart=this.element.value.length;\r\n                  this.element.selectionEnd=this.element.value.length;\r\n               }\r\n            }\r\n         } else if (this.element.selectionStart!=undefined) {\r\n            this.element.selectionStart=this.element.value.length;\r\n            this.element.selectionEnd=this.element.value.length;\r\n         }\r\n         break;\r\n      }\r\n   };\r\n\r\n// Functions:\r\n\r\n//\r\n// SocialCalc.InputBoxDisplayCellContents(inputbox, coord)\r\n//\r\n// Sets input box to the contents of the specified cell (or ecell if null).\r\n//\r\n\r\nSocialCalc.InputBoxDisplayCellContents = function(inputbox, coord) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   if (!inputbox) return;\r\n   if (!coord) {\r\n     if (!inputbox.editor) return; // not initialized yet\r\n     if (!inputbox.editor.ecell) return; // not initialized yet\r\n     coord = inputbox.editor.ecell.coord;\r\n   }\r\n   var text = SocialCalc.GetCellContents(inputbox.editor.context.sheetobj, coord);\r\n   if (text.indexOf(\"\\n\")!=-1) {\r\n      text = scc.s_inputboxdisplaymultilinetext;\r\n      inputbox.element.disabled = true;\r\n      }\r\n   else if (inputbox.editor.ECellReadonly()) {\r\n      inputbox.element.disabled = true;\r\n      }\r\n   else {\r\n      inputbox.element.disabled = false;\r\n      }\r\n   inputbox.SetText(text);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.InputBoxFocus(inputbox)\r\n//\r\n// Call this to have the input box get the focus and respond to keystrokes\r\n// but still pass them off to SocialCalc.ProcessKey.\r\n//\r\n\r\nSocialCalc.InputBoxFocus = function(inputbox) {\r\n\r\n   if (!inputbox) return;\r\n   inputbox.element.focus();\r\n   var editor = inputbox.editor;\r\n   editor.state = \"input\";\r\n   var wval = editor.workingvalues;\r\n   wval.partialexpr = \"\";\r\n   wval.ecoord = editor.ecell.coord;\r\n   wval.erow = editor.ecell.row;\r\n   wval.ecol = editor.ecell.col;\r\n\r\n   };\r\n\r\n//\r\n// SocialCalc.InputBoxOnMouseDown(e)\r\n//\r\n// This is called when the input box gets the focus. It then responds to keystrokes\r\n// and pass them off to SocialCalc.ProcessKey, but in a different editing state.\r\n//\r\n\r\nSocialCalc.InputBoxOnMouseDown = function(e) {\r\n\r\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var wval = editor.workingvalues;\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.state=\"inputboxdirect\";\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.inputEcho.ShowInputEcho(true);\r\n         break;\r\n\r\n      case \"input\":\r\n         wval.partialexpr = \"\"; // make sure not pointing\r\n         editor.MoveECell(wval.ecoord);\r\n         editor.state=\"inputboxdirect\";\r\n         SocialCalc.KeyboardFocus(); // may have come here from outside of grid\r\n         break;\r\n\r\n      case \"inputboxdirect\":\r\n         break;\r\n      }\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// InputEcho class:\r\n//\r\n// This object creates and controls an element that echos what's in the InputBox during editing\r\n// It is draggable.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.InputEcho = function(editor) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   this.editor = editor; // the TableEditor this belongs to\r\n   this.text = \"\"; // current value of what is displayed\r\n   this.interval = null; // timer handle\r\n\r\n   this.container = null; // element containing main echo as well as prompt line\r\n   this.main = null; // main echo area\r\n   this.prompt = null;\r\n   this.hint = null; // focus cell hint area\r\n\r\n   this.functionbox = null; // function chooser dialog\r\n\r\n   this.container = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.container, \"display:none;position:absolute;zIndex:10;\");\r\n\r\n   this.main = document.createElement(\"div\");\r\n   if (scc.defaultInputEchoClass) this.main.className = scc.defaultInputEchoClass;\r\n   if (scc.defaultInputEchoStyle) SocialCalc.setStyles(this.main, scc.defaultInputEchoStyle);\r\n   this.main.innerHTML = \"&nbsp;\";\r\n\r\n   this.hint = document.createElement(\"div\");\r\n   if (scc.defaultInputEchoHintClass) this.hint.className = scc.defaultInputEchoHintClass;\r\n   if (scc.defaultInputEchoHintStyle) SocialCalc.setStyles(this.hint, scc.defaultInputEchoHintStyle);\r\n   this.hint.innerHTML = \"\";\r\n\r\n   this.container.appendChild(this.hint);\r\n   this.container.appendChild(this.main);\r\n\r\n   this.prompt = document.createElement(\"div\");\r\n   if (scc.defaultInputEchoPromptClass) this.prompt.className = scc.defaultInputEchoPromptClass;\r\n   if (scc.defaultInputEchoPromptStyle) SocialCalc.setStyles(this.prompt, scc.defaultInputEchoPromptStyle);\r\n   this.prompt.innerHTML = \"\";\r\n\r\n   this.container.appendChild(this.prompt);\r\n\r\n   SocialCalc.DragRegister(this.main, true, true, \r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: this.container},\r\n                  this.editor.toplevel);\r\n\r\n   editor.toplevel.appendChild(this.container);\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.InputEcho.prototype.ShowInputEcho = function(show) {return SocialCalc.ShowInputEcho(this, show);};\r\nSocialCalc.InputEcho.prototype.SetText = function(str) {return SocialCalc.SetInputEchoText(this, str);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.ShowInputEcho = function(inputecho, show) {\r\n\r\n   var cell, position;\r\n   var editor = inputecho.editor;\r\n\r\n   if (!editor) return;\r\n\r\n   if (show) {\r\n      editor.cellhandles.ShowCellHandles(false);\r\n      cell=SocialCalc.GetEditorCellElement(editor, editor.ecell.row, editor.ecell.col);\r\n      if (cell) {\r\n         position = SocialCalc.GetElementPosition(cell.element);\r\n         inputecho.container.style.left = (position.left-1)+\"px\";\r\n         inputecho.container.style.top = (position.top-1)+\"px\";\r\n         }\r\n      inputecho.hint.innerHTML = editor.ecell.coord;\r\n      inputecho.container.style.display = \"block\";\r\n      if (inputecho.interval) window.clearInterval(inputecho.interval); // just in case\r\n      inputecho.interval = window.setInterval(SocialCalc.InputEchoHeartbeat, 50);\r\n      }\r\n   else {\r\n      if (inputecho.interval) window.clearInterval(inputecho.interval);\r\n      inputecho.container.style.display = \"none\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SetInputEchoText = function(inputecho, str) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var fname, fstr;\r\n   var newstr = SocialCalc.special_chars(str);\r\n   newstr = newstr.replace(/\\n/g,\"<br>\");\r\n\r\n   if (inputecho.text != newstr) {\r\n      inputecho.main.innerHTML = newstr;\r\n      inputecho.text = newstr;\r\n      }\r\n\r\n   var parts = str.match(/.*[\\+\\-\\*\\/\\&\\^\\<\\>\\=\\,\\(]([A-Za-z][A-Za-z][\\w\\.]*?)\\([^\\)]*$/);\r\n   if (str.charAt(0)==\"=\" && parts) {\r\n      fname = parts[1].toUpperCase();\r\n      if (SocialCalc.Formula.FunctionList[fname]) {\r\n         SocialCalc.Formula.FillFunctionInfo(); //  make sure filled\r\n         fstr = SocialCalc.special_chars(fname+\"(\"+SocialCalc.Formula.FunctionArgString(fname)+\")\");\r\n         }\r\n      else {\r\n         fstr = scc.ietUnknownFunction+fname;\r\n         }\r\n      if (inputecho.prompt.innerHTML != fstr) {\r\n         inputecho.prompt.innerHTML = fstr;\r\n         inputecho.prompt.style.display = \"block\";\r\n         }\r\n      }\r\n   else if (inputecho.prompt.style.display != \"none\") {\r\n      inputecho.prompt.innerHTML = \"\";\r\n      inputecho.prompt.style.display = \"none\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.InputEchoHeartbeat = function() {\r\n\r\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n\r\n   editor.inputEcho.SetText(editor.inputBox.GetText()+\"_\");\r\n\r\n   }\r\n\r\nSocialCalc.InputEchoMouseDown = function(e) {\r\n      var event = e || window.event;\r\n\r\n      var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n      if (!editor) return true; // we're not handling it -- let browser do default\r\n\r\n//      if (event.stopPropagation) event.stopPropagation(); // DOM Level 2\r\n//      else event.cancelBubble = true; // IE 5+\r\n//      if (event.preventDefault) event.preventDefault(); // DOM Level 2\r\n//      else event.returnValue = false; // IE 5+\r\n\r\n      editor.inputBox.element.focus();\r\n\r\n//      return false;\r\n      };\r\n\r\n\r\n// *************************************\r\n//\r\n// CellHandles class:\r\n//\r\n// This object creates and controls the elements around the cursor cell for dragging, etc.\r\n//\r\n// *************************************\r\n\r\nSocialCalc.CellHandles = function(editor) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var functions;\r\n\r\n   if (editor.noEdit) return; // leave us with nothing\r\n\r\n   this.editor = editor; // the TableEditor this belongs to\r\n\r\n   this.noCursorSuffix = false;\r\n\r\n   this.movedmouse = false; // used to detect no-op\r\n\r\n   this.draghandle = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.draghandle, \"display:none;position:absolute;zIndex:8;border:1px solid white;width:4px;height:4px;fontSize:1px;backgroundColor:#0E93D8;cursor:default;\");\r\n   this.draghandle.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.draghandle);\r\n   SocialCalc.AssignID(editor, this.draghandle, \"draghandle\");\r\n\r\n   var imagetype = \"png\";\r\n   if (navigator.userAgent.match(/MSIE 6\\.0/)) {\r\n      imagetype = \"gif\";\r\n      }\r\n\r\n   this.dragpalette = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.dragpalette, \"display:none;position:absolute;zIndex:8;width:90px;height:90px;fontSize:1px;textAlign:center;cursor:default;\"+\r\n      \"backgroundImage:url(\"+SocialCalc.Constants.defaultImagePrefix+\"drag-handles.\"+imagetype+\");\");\r\n   this.dragpalette.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.dragpalette);\r\n   SocialCalc.AssignID(editor, this.dragpalette, \"dragpalette\");\r\n\r\n   this.dragtooltip = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.dragtooltip, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:100px;height:auto;fontSize:10px;backgroundColor:#FFFFFF;\");\r\n   this.dragtooltip.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.dragtooltip);\r\n   SocialCalc.AssignID(editor, this.dragtooltip, \"dragtooltip\");\r\n\r\n   this.fillinghandle = document.createElement(\"div\");\r\n   SocialCalc.setStyles(this.fillinghandle, \"display:none;position:absolute;zIndex:9;border:1px solid black;width:auto;height:14px;fontSize:10px;backgroundColor:#FFFFFF;\");\r\n   this.fillinghandle.innerHTML = '&nbsp;';\r\n   editor.toplevel.appendChild(this.fillinghandle);\r\n   SocialCalc.AssignID(editor, this.fillinghandle, \"fillinghandle\");\r\n\r\n   if (this.draghandle.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      this.draghandle.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\r\n      this.dragpalette.addEventListener(\"mousedown\", SocialCalc.CellHandlesMouseDown, false);\r\n      this.dragpalette.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMoveOnHandle, false);\r\n      }\r\n   else if (this.draghandle.attachEvent) { // IE 5+\r\n      this.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\r\n      this.dragpalette.attachEvent(\"onmousedown\", SocialCalc.CellHandlesMouseDown);\r\n      this.dragpalette.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMoveOnHandle);\r\n      }\r\n   else { // don't handle this\r\n      throw \"Browser not supported\";\r\n      }\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.CellHandles.prototype.ShowCellHandles = function(show, moveshow) {return SocialCalc.ShowCellHandles(this, show, moveshow);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.ShowCellHandles = function(cellhandles, show, moveshow) {\r\n\r\n   var cell, cell2, position, position2;\r\n   var editor = cellhandles.editor;\r\n   var doshow = false;\r\n   var row, col;\r\n   var colinc = 1, rowinc = 1;\r\n\r\n   if (!editor) return;\r\n   if (!editor.ecell) return;\r\n\r\n   do { // a block that can you can \"break\" out of easily\r\n\r\n      if (!show) break;\r\n\r\n      row = editor.ecell.row;\r\n      col = editor.ecell.col;\r\n\r\n      if (editor.state != \"start\") break;\r\n      if (row >= editor.lastvisiblerow) break;\r\n      if (col >= editor.lastvisiblecol) break;\r\n      if (row < editor.firstscrollingrow) break;\r\n      if (col < editor.firstscrollingcol) break;\r\n\r\n      // Go beyond one column if hidden.\r\n      while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col+colinc)] == \"yes\") {\r\n         colinc++; \r\n         }     \r\n\r\n      // Go beyond one row if hidden.\r\n      while (editor.context.sheetobj.rowattribs.hide[row+rowinc] == \"yes\") {\r\n         rowinc++; \r\n         }     \r\n\r\n      // Check colspan and rowspan.\r\n      cell = editor.context.sheetobj.cells[SocialCalc.crToCoord(col+colinc-1, row+rowinc-1)];\r\n      if (typeof cell != \"undefined\") {\r\n         colinc += (cell.colspan || 1) - 1;\r\n         rowinc += (cell.rowspan || 1) - 1;\r\n         }\r\n\r\n      if (editor.rowpositions[row+rowinc]+20>editor.horizontaltablecontrol.controlborder) {\r\n         break;\r\n         }\r\n      if (editor.rowpositions[row+rowinc]-10<editor.headposition.top) {\r\n         break;\r\n         }\r\n      if (editor.colpositions[col+colinc]+20>editor.verticaltablecontrol.controlborder) {\r\n         break;\r\n         }\r\n      if (editor.colpositions[col+colinc]-30<editor.headposition.left) {\r\n         break;\r\n         }\r\n\r\n      cellhandles.draghandle.style.left = (editor.colpositions[col+colinc]-1)+\"px\";\r\n      cellhandles.draghandle.style.top = (editor.rowpositions[row+rowinc]-1)+\"px\";\r\n      cellhandles.draghandle.style.display = \"block\";\r\n\r\n      if (moveshow) {\r\n         cellhandles.draghandle.style.display = \"none\";\r\n         cellhandles.dragpalette.style.left = (editor.colpositions[col+colinc]-45)+\"px\";\r\n         cellhandles.dragpalette.style.top = (editor.rowpositions[row+rowinc]-45)+\"px\";\r\n         cellhandles.dragpalette.style.display = \"block\";\r\n         cellhandles.dragtooltip.style.left = (editor.colpositions[col+colinc]-45)+\"px\";\r\n         cellhandles.dragtooltip.style.top = (editor.rowpositions[row+rowinc]+45)+\"px\";\r\n         cellhandles.dragtooltip.style.display = \"none\";\r\n         }\r\n\r\n      doshow = true;\r\n\r\n      }\r\n   while (false); // only do once\r\n\r\n   if (!doshow) {\r\n      cellhandles.draghandle.style.display = \"none\";\r\n      }\r\n   if (!moveshow) {\r\n      cellhandles.dragpalette.style.display = \"none\";\r\n      cellhandles.dragtooltip.style.display = \"none\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.CellHandlesMouseMoveOnHandle = function(e) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var event = e || window.event;\r\n   var target = event.target || event.srcElement\r\n\r\n   var editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var cellhandles = editor.cellhandles;\r\n   if (!cellhandles.editor) return true; // no handles\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n\r\n   if (!editor.cellhandles.mouseDown) {\r\n      editor.cellhandles.ShowCellHandles(true, true); // show move handles, too\r\n\r\n      if (target == cellhandles.dragpalette) {\r\n         var whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\r\n         if (whichhandle==0) { // off of active part of palette\r\n            SocialCalc.CellHandlesHoverTimeout();\r\n            return;\r\n            }\r\n         if (cellhandles.tooltipstimer) {\r\n            window.clearTimeout(cellhandles.tooltipstimer);\r\n            cellhandles.tooltipstimer = null;\r\n            }\r\n         cellhandles.tooltipswhichhandle = whichhandle;\r\n         cellhandles.tooltipstimer = window.setTimeout(SocialCalc.CellHandlesTooltipsTimeout, 700);\r\n         }\r\n\r\n      if (cellhandles.timer) {\r\n         window.clearTimeout(cellhandles.timer);\r\n         cellhandles.timer = null;\r\n         }\r\n      cellhandles.timer = window.setTimeout(SocialCalc.CellHandlesHoverTimeout, 3000);\r\n   }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// whichsegment = SocialCalc.SegmentDivHit(segtable, divWithMouseHit, x, y)\r\n//\r\n// Takes segtable = [upperleft quadrant, upperright, bottomright, bottomleft]\r\n//  where each quadrant is either:\r\n//      0 = ignore hits here\r\n//      number = return this value\r\n//      array = a new segtable for this subquadrant\r\n//\r\n// Alternatively, segtable can be:\r\n//  [radius 1, radius 2] and it returns 0 if no hit,\r\n//  -1, -2, -3, -4 for inner quadrants, and +1...+4 for outer quadrants\r\n//\r\n\r\nSocialCalc.SegmentDivHit = function(segtable, divWithMouseHit, x, y) {\r\n\r\n   var width = divWithMouseHit.offsetWidth;\r\n   var height = divWithMouseHit.offsetHeight;\r\n   var left = divWithMouseHit.offsetLeft;\r\n   var top = divWithMouseHit.offsetTop;\r\n   var v = 0;\r\n   var table = segtable;\r\n   var len = Math.sqrt(Math.pow(x-left-(width/2.0-.5), 2)+Math.pow(y-top-(height/2.0-.5), 2));\r\n\r\n   if (table.length==2) { // type 2 segtable\r\n      if (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\r\n         if (len <= segtable[0]) v = -1;\r\n         else if (len <= segtable[1]) v = 1;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\r\n         if (len <= segtable[0]) v = -2;\r\n         else if (len <= segtable[1]) v = 2;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\r\n         if (len <= segtable[0]) v = -3;\r\n         else if (len <= segtable[1]) v = 3;\r\n         }\r\n      if (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\r\n         if (len <= segtable[0]) v = -4;\r\n         else if (len <= segtable[1]) v = 4;\r\n         }\r\n      return v;\r\n      }\r\n\r\n   while (true) {\r\n      if (x >= left && x < left+width/2 && y >= top && y < top+height/2) { // upper left\r\n         quadrant += \"1\";\r\n         v = table[0];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         height = height/2;\r\n         continue;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top && y < top+height/2) { // upper right\r\n         quadrant += \"2\";\r\n         v = table[1];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         left = left+width;\r\n         height = height/2;\r\n         continue;\r\n         }\r\n      if (x >= left+width/2 && x < left+width && y >= top+height/2 && y < top+height) { // bottom right\r\n         quadrant += \"3\";\r\n         v = table[2];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         left = left + width;\r\n         height = height/2;\r\n         top = top + height;\r\n         continue;\r\n         }\r\n      if (x >= left && x < left+width/2 && y >= top+height/2 && y < top+height) { // bottom right\r\n         quadrant += \"4\";\r\n         v = table[3];\r\n         if (typeof v == \"number\") {\r\n            break;\r\n            }\r\n         table = v;\r\n         width = width/2;\r\n         height = height/2;\r\n         top = top + height;\r\n         continue;\r\n         }\r\n      return 0; // didn't match\r\n      }\r\n\r\n//addmsg((x-divWithMouseHit.offsetLeft)+\",\"+(y-divWithMouseHit.offsetTop)+\"=\"+quadrant+\" \"+v);\r\n   return v;\r\n\r\n}\r\n\r\nSocialCalc.CellHandlesHoverTimeout = function() {\r\n\r\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var cellhandles = editor.cellhandles;\r\n   if (cellhandles.timer) {\r\n      window.clearTimeout(cellhandles.timer);\r\n      cellhandles.timer = null;\r\n      }\r\n   if (cellhandles.tooltipstimer) {\r\n      window.clearTimeout(cellhandles.tooltipstimer);\r\n      cellhandles.tooltipstimer = null;\r\n      }\r\n   editor.cellhandles.ShowCellHandles(true, false); // hide move handles\r\n\r\n}\r\n\r\nSocialCalc.CellHandlesTooltipsTimeout = function() {\r\n\r\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n   var cellhandles = editor.cellhandles;\r\n   if (cellhandles.tooltipstimer) {\r\n      window.clearTimeout(cellhandles.tooltipstimer);\r\n      cellhandles.tooltipstimer = null;\r\n      }\r\n\r\n   var whichhandle = cellhandles.tooltipswhichhandle;\r\n   if (whichhandle==0) { // off of active part of palette\r\n      SocialCalc.CellHandlesHoverTimeout();\r\n      return;\r\n      }\r\n   if (whichhandle==-3) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHfillAllTooltip;\r\n      }\r\n   else if (whichhandle==3) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHfillContentsTooltip;\r\n      }\r\n   else if (whichhandle==-2) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteAllTooltip;\r\n      }\r\n   else if (whichhandle==-4) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertAllTooltip;\r\n      }\r\n   else if (whichhandle==2) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmovePasteContentsTooltip;\r\n      }\r\n   else if (whichhandle==4) {\r\n      cellhandles.dragtooltip.innerHTML = scc.s_CHmoveInsertContentsTooltip;\r\n      }\r\n   else {\r\n      cellhandles.dragtooltip.innerHTML = \"&nbsp;\";\r\n      cellhandles.dragtooltip.style.display = \"none\";\r\n      return;\r\n      }\r\n\r\n   cellhandles.dragtooltip.style.display = \"block\";\r\n\r\n}\r\n\r\nSocialCalc.CellHandlesMouseDown = function(e) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var editor, result, coord, textarea, wval, range;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n\r\n   editor = SocialCalc.Keyboard.focusTable; // get TableEditor doing keyboard stuff\r\n   if (!editor) return true; // we're not handling it -- let browser do default\r\n\r\n   if (editor.busy) return; // don't do anything when busy (is this correct?)\r\n\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   cellhandles.movedmouse = false; // detect no-op\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n\r\n   if (cellhandles.timer) { // cancel timer\r\n      window.clearTimeout(cellhandles.timer);\r\n      cellhandles.timer = null;\r\n      }\r\n   if (cellhandles.tooltipstimer) {\r\n      window.clearTimeout(cellhandles.tooltipstimer);\r\n      cellhandles.tooltipstimer = null;\r\n      }\r\n   cellhandles.dragtooltip.innerHTML = \"&nbsp;\";\r\n   cellhandles.dragtooltip.style.display = \"none\";\r\n\r\n   range = editor.range;\r\n \r\n   var whichhandle = SocialCalc.SegmentDivHit([scc.CH_radius1, scc.CH_radius2], editor.cellhandles.dragpalette, clientX, clientY);\r\n   if (whichhandle==1 || whichhandle==-1 || whichhandle==0) {\r\n      cellhandles.ShowCellHandles(true, false); // hide move handles\r\n      return;\r\n      }\r\n\r\n   mouseinfo.ignore = true; // stop other code from looking at the mouse\r\n\r\n   if (whichhandle==-3) {\r\n      cellhandles.dragtype = \"Fill\";\r\n//      mouseinfo.element = editor.cellhandles.fillhandle;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n   else if (whichhandle==3) {\r\n      cellhandles.dragtype = \"FillC\";\r\n//      mouseinfo.element = editor.cellhandles.fillhandle;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n   else if (whichhandle==-2) {\r\n      cellhandles.dragtype = \"Move\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle1;\r\n      cellhandles.noCursorSuffix = true;\r\n      }\r\n   else if (whichhandle==-4) {\r\n      cellhandles.dragtype = \"MoveI\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle2;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n   else if (whichhandle==2) {\r\n      cellhandles.dragtype = \"MoveC\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle1;\r\n      cellhandles.noCursorSuffix = true;\r\n      }\r\n   else if (whichhandle==4) {\r\n      cellhandles.dragtype = \"MoveIC\";\r\n//      mouseinfo.element = editor.cellhandles.movehandle2;\r\n      cellhandles.noCursorSuffix = false;\r\n      }\r\n\r\n   cellhandles.filltype = null;\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n         if (!range.hasrange) {\r\n            editor.RangeAnchor();\r\n            }\r\n         editor.range2.top = editor.range.top;\r\n         editor.range2.right = editor.range.right;\r\n         editor.range2.bottom = editor.range.bottom;\r\n         editor.range2.left = editor.range.left;\r\n         editor.range2.hasrange = true;\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveI\":\r\n      case \"MoveC\":\r\n      case \"MoveIC\":\r\n         if (!range.hasrange) {\r\n            editor.RangeAnchor();\r\n            }\r\n         editor.range2.top = editor.range.top;\r\n         editor.range2.right = editor.range.right;\r\n         editor.range2.bottom = editor.range.bottom;\r\n         editor.range2.left = editor.range.left;\r\n         editor.range2.hasrange = true;\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      default:\r\n         return; // not for us\r\n      }\r\n\r\n   cellhandles.fillinghandle.style.left = (clientX)+\"px\";\r\n   cellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\r\n   cellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\r\n                                         (scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\r\n   cellhandles.fillinghandle.style.display = \"block\";\r\n\r\n   cellhandles.ShowCellHandles(true, false); // hide move handles\r\n   cellhandles.mouseDown = true;\r\n\r\n   mouseinfo.editor = editor; // remember for later\r\n\r\n   coord = editor.ecell.coord; // start with cell with handles\r\n\r\n   cellhandles.startingcoord = coord;\r\n   cellhandles.startingX = clientX;\r\n   cellhandles.startingY = clientY;\r\n\r\n   mouseinfo.mouselastcoord = coord;\r\n\r\n   SocialCalc.KeyboardSetFocus(editor);\r\n\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mousemove\", SocialCalc.CellHandlesMouseMove, true); // capture everywhere\r\n      document.addEventListener(\"mouseup\", SocialCalc.CellHandlesMouseUp, true); // capture everywhere\r\n      }\r\n   else if (cellhandles.draghandle.attachEvent) { // IE 5+\r\n      cellhandles.draghandle.setCapture();\r\n      cellhandles.draghandle.attachEvent(\"onmousemove\", SocialCalc.CellHandlesMouseMove);\r\n      cellhandles.draghandle.attachEvent(\"onmouseup\", SocialCalc.CellHandlesMouseUp);\r\n      cellhandles.draghandle.attachEvent(\"onlosecapture\", SocialCalc.CellHandlesMouseUp);\r\n     }\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.CellHandlesMouseMove = function(e) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval;\r\n   var crstart, crend, cr, c, r;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   element = mouseinfo.element;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with move\r\n\r\n   if (!result) return;\r\n\r\n   if (result && !result.coord) {\r\n      SocialCalc.SetDragAutoRepeat(editor, result, SocialCalc.CellHandlesDragAutoRepeat);\r\n      return;\r\n      }\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   if (!result.coord) return;\r\n\r\n   crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\r\n   crend = SocialCalc.coordToCr(result.coord);\r\n\r\n\r\n   cellhandles.movedmouse = true; // did move, so not no-op\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n\r\n         if (result.coord == cellhandles.startingcoord) { // reset when come back\r\n            cellhandles.filltype = null;\r\n            cellhandles.startingX = clientX;\r\n            cellhandles.startingY = clientY;\r\n            }\r\n         else {\r\n            if (cellhandles.filltype) { // moving and have already determined filltype\r\n               if (cellhandles.filltype==\"Down\") { // coerse to that\r\n                  crend.col = crstart.col;\r\n                  if (crend.row < crstart.row) crend.row = crstart.row;\r\n                  }\r\n               else {\r\n                  crend.row = crstart.row;\r\n                  if (crend.col < crstart.col) crend.col = crstart.col;\r\n                  }\r\n               }\r\n            else {\r\n               if (Math.abs(clientY - cellhandles.startingY) > 10) {\r\n                  cellhandles.filltype = \"Down\";\r\n                  }\r\n               else if (Math.abs(clientX - cellhandles.startingX) > 10) {\r\n                  cellhandles.filltype = \"Right\";\r\n                  }\r\n               crend.col = crstart.col; // until decide, leave it at start\r\n               crend.row = crstart.row;\r\n               }\r\n            }\r\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (result.coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(result.coord);\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveC\":\r\n         if (result.coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(result.coord);\r\n            c = editor.range2.right - editor.range2.left + result.col;\r\n            r = editor.range2.bottom - editor.range2.top + result.row;\r\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"MoveI\":\r\n      case \"MoveIC\":\r\n         if (result.coord == cellhandles.startingcoord) { // reset when come back\r\n            cellhandles.filltype = null;\r\n            cellhandles.startingX = clientX;\r\n            cellhandles.startingY = clientY;\r\n            }\r\n         else {\r\n            if (cellhandles.filltype) { // moving and have already determined filltype\r\n               if (cellhandles.filltype==\"Vertical\") { // coerse to that\r\n                  crend.col = editor.range2.left;\r\n                  if (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\r\n                  }\r\n               else {\r\n                  crend.row = editor.range2.top;\r\n                  if (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\r\n                  }\r\n               }\r\n            else {\r\n               if (Math.abs(clientY - cellhandles.startingY) > 10) {\r\n                  cellhandles.filltype = \"Vertical\";\r\n                  }\r\n               else if (Math.abs(clientX - cellhandles.startingX) > 10) {\r\n                  cellhandles.filltype = \"Horizontal\";\r\n                  }\r\n               crend.col = crstart.col; // until decide, leave it at start\r\n               crend.row = crstart.row;\r\n               }\r\n            }\r\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (result.coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(result.coord);\r\n            if (!cellhandles.filltype) { // no fill type\r\n               editor.RangeRemove();\r\n               }\r\n            else {\r\n               c = editor.range2.right - editor.range2.left + crend.col;\r\n               r = editor.range2.bottom - editor.range2.top + crend.row;\r\n               editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n               editor.RangeExtend();\r\n               }\r\n            }\r\n         break;\r\n\r\n      }\r\n\r\n\r\n   cellhandles.fillinghandle.style.left = clientX+\"px\";\r\n   cellhandles.fillinghandle.style.top = (clientY - 17)+\"px\";\r\n   cellhandles.fillinghandle.innerHTML = scc.s_CHindicatorOperationLookup[cellhandles.dragtype]+\r\n                                         (scc.s_CHindicatorDirectionLookup[editor.cellhandles.filltype] || \"\");\r\n   cellhandles.fillinghandle.style.display = \"block\";\r\n\r\n   mouseinfo.mouselastcoord = result.coord;\r\n   SocialCalc.StopPropagation(event);\r\n   return;\r\n   }\r\n\r\nSocialCalc.CellHandlesDragAutoRepeat = function(coord, direction) {\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   var editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   var crstart = SocialCalc.coordToCr(editor.cellhandles.startingcoord);\r\n   var crend = SocialCalc.coordToCr(coord);\r\n\r\n   var newcoord, c, r;\r\n\r\n   var vscroll = 0;\r\n   var hscroll = 0;\r\n\r\n   if (direction == \"left\") hscroll = -1;\r\n   else if (direction == \"right\") hscroll = 1;\r\n   else if (direction == \"up\") vscroll = -1;\r\n   else if (direction == \"down\") vscroll = 1;\r\n   editor.ScrollRelativeBoth(vscroll, hscroll);\r\n\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n         if (cellhandles.filltype) { // moving and have already determined filltype\r\n            if (cellhandles.filltype==\"Down\") { // coerse to that\r\n               crend.col = crstart.col;\r\n               if (crend.row < crstart.row) crend.row = crstart.row;\r\n               }\r\n            else {\r\n               crend.row = crstart.row;\r\n               if (crend.col < crstart.col) crend.col = crstart.col;\r\n               }\r\n            }\r\n         else {\r\n            crend.col = crstart.col; // until decide, leave it at start\r\n            crend.row = crstart.row;\r\n            }\r\n\r\n         newcoord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (newcoord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(coord);\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveC\":\r\n         if (coord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(coord);\r\n            c = editor.range2.right - editor.range2.left + editor.ecell.col;\r\n            r = editor.range2.bottom - editor.range2.top + editor.ecell.row;\r\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      case \"MoveI\":\r\n      case \"MoveIC\":\r\n         if (cellhandles.filltype) { // moving and have already determined filltype\r\n            if (cellhandles.filltype==\"Vertical\") { // coerse to that\r\n               crend.col = editor.range2.left;\r\n               if (crend.row>=editor.range2.top && crend.row<=editor.range2.bottom+1) crend.row = editor.range2.bottom+2;\r\n               }\r\n            else {\r\n               crend.row = editor.range2.top;\r\n               if (crend.col>=editor.range2.left && crend.col<=editor.range2.right+1) crend.col = editor.range2.right+2;\r\n               }\r\n            }\r\n         else {\r\n            crend.col = crstart.col; // until decide, leave it at start\r\n            crend.row = crstart.row;\r\n            }\r\n\r\n         newcoord = SocialCalc.crToCoord(crend.col, crend.row);\r\n         if (newcoord!=mouseinfo.mouselastcoord) {\r\n            editor.MoveECell(newcoord);\r\n            c = editor.range2.right - editor.range2.left + crend.col;\r\n            r = editor.range2.bottom - editor.range2.top + crend.row;\r\n            editor.RangeAnchor(SocialCalc.crToCoord(c, r));\r\n            editor.RangeExtend();\r\n            }\r\n         break;\r\n\r\n      }\r\n\r\n   mouseinfo.mouselastcoord = newcoord;\r\n\r\n   }\r\n\r\nSocialCalc.CellHandlesMouseUp = function(e) {\r\n\r\n   var editor, element, result, coord, now, textarea, sheetobj, cellobj, wval, cstr, cmdtype, cmdtype2;\r\n   var crstart, crend;\r\n   var sizec, sizer, deltac, deltar;\r\n\r\n   var event = e || window.event;\r\n\r\n   var mouseinfo = SocialCalc.EditorMouseInfo;\r\n   editor = mouseinfo.editor;\r\n   if (!editor) return; // not us, ignore\r\n   var cellhandles = editor.cellhandles;\r\n\r\n   element = mouseinfo.element;\r\n\r\n   mouseinfo.ignore = false;\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(editor.toplevel);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   result = SocialCalc.GridMousePosition(editor, clientX, clientY); // get cell with up\r\n\r\n   SocialCalc.SetDragAutoRepeat(editor, null); // stop repeating if it was\r\n\r\n   cellhandles.mouseDown = false;\r\n   cellhandles.noCursorSuffix = false;\r\n\r\n   cellhandles.fillinghandle.style.display = \"none\";\r\n\r\n   if (!result) result = {};\r\n   if (!result.coord) result.coord = editor.ecell.coord;\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Fill\":\r\n      case \"Move\":\r\n      case \"MoveI\":\r\n         cmdtype2 = \" all\";\r\n            break;\r\n      case \"FillC\":\r\n      case \"MoveC\":\r\n      case \"MoveIC\":\r\n         cmdtype2 = \" formulas\";\r\n         break;\r\n      }\r\n\r\n   if (!cellhandles.movedmouse) { // didn't move: just leave one cell selected\r\n      cellhandles.dragtype = \"Nothing\";\r\n      }\r\n\r\n   switch (cellhandles.dragtype) {\r\n      case \"Nothing\":\r\n         editor.Range2Remove();\r\n         editor.RangeRemove();\r\n         break;\r\n\r\n      case \"Fill\":\r\n      case \"FillC\":\r\n\r\n         crstart = SocialCalc.coordToCr(cellhandles.startingcoord);\r\n         crend = SocialCalc.coordToCr(result.coord);\r\n         if (cellhandles.filltype) {\r\n            if (cellhandles.filltype==\"Down\") {\r\n               crend.col = crstart.col;\r\n               }\r\n            else {\r\n               crend.row = crstart.row;\r\n               }\r\n            }\r\n         result.coord = SocialCalc.crToCoord(crend.col, crend.row);\r\n\r\n         editor.MoveECell(result.coord);\r\n         editor.RangeExtend();\r\n\r\n         if (editor.cellhandles.filltype==\"Right\") {\r\n            cmdtype = \"right\";\r\n            }\r\n         else {\r\n            cmdtype = \"down\";\r\n            }\r\n         cstr = \"fill\"+cmdtype+\" \"+SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n                   \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom)+cmdtype2;\r\n         editor.EditorScheduleSheetCommands(cstr, true, false);\r\n         break;\r\n\r\n      case \"Move\":\r\n      case \"MoveC\":\r\n         editor.context.cursorsuffix = \"\";\r\n         cstr = \"movepaste \"+\r\n                     SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\r\n                     SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\r\n                     +\" \"+editor.ecell.coord+cmdtype2;\r\n         editor.EditorScheduleSheetCommands(cstr, true, false);\r\n         editor.Range2Remove();\r\n\r\n         break;\r\n\r\n      case \"MoveI\":\r\n      case \"MoveIC\":\r\n         editor.context.cursorsuffix = \"\";\r\n         sizec = editor.range2.right - editor.range2.left;\r\n         sizer = editor.range2.bottom - editor.range2.top;\r\n         deltac = editor.ecell.col - editor.range2.left;\r\n         deltar = editor.ecell.row - editor.range2.top;\r\n         cstr = \"moveinsert \"+\r\n                     SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\r\n                     SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\r\n                     +\" \"+editor.ecell.coord+cmdtype2;\r\n         editor.EditorScheduleSheetCommands(cstr, true, false);\r\n         editor.Range2Remove();\r\n         editor.RangeRemove();\r\n         if (editor.cellhandles.filltype==\" Horizontal\" && deltac > 0) {\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col-sizec-1, editor.ecell.row));\r\n            }\r\n         else if (editor.cellhandles.filltype==\" Vertical\" && deltar > 0) {\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.ecell.col, editor.ecell.row-sizer-1));\r\n            }\r\n         editor.RangeAnchor(SocialCalc.crToCoord(editor.ecell.col+sizec, editor.ecell.row+sizer));\r\n         editor.RangeExtend();\r\n\r\n         break;\r\n\r\n      }\r\n    SocialCalc.RemoveMouseMoveUp(SocialCalc.CellHandlesMouseMove,\r\n\t\t\t\t    SocialCalc.CellHandlesMouseUp,\r\n\t\t\t\t    cellhandles.draghandle,\r\n\t\t\t\t    event);\r\n   mouseinfo.editor = null;\r\n   return false;\r\n   }\r\n\r\n// *************************************\r\n//\r\n// TableControl class:\r\n//\r\n// This class deals with the horizontal and verical scrollbars and pane sliders.\r\n//\r\n// +--------------+\r\n// | Endcap       |\r\n// +- - - - - - - +\r\n// |              |\r\n// +--------------+\r\n// | Pane Slider  |\r\n// +--------------+\r\n// |              |\r\n// | Less Button  |\r\n// |              |\r\n// +--------------+\r\n// | Scroll Area  |\r\n// |              |\r\n// |              |\r\n// +--------------+\r\n// | Thumb        |\r\n// +--------------+\r\n// |              |\r\n// +--------------+\r\n// |              |\r\n// | More Button  |\r\n// |              |\r\n// +--------------+\r\n//\r\n// *************************************\r\n\r\nSocialCalc.TableControl = function(editor, vertical, size) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   this.editor = editor; // the TableEditor this belongs to\r\n\r\n   this.vertical = vertical; // true if vertical control, false if horizontal\r\n   this.size = size; // length in pixels\r\n\r\n   this.main = null; // main element containing all the others\r\n   this.endcap = null; // the area at the top/left between the end and the pane slider\r\n   this.paneslider = null; // the slider to adjust the pane split\r\n   this.lessbutton = null; // the top/left scroll button\r\n   this.morebutton = null; // the bottom/right scroll button\r\n   this.scrollarea = null; // the area between the scroll buttons\r\n   this.thumb = null; // the sliding thing in the scrollarea\r\n\r\n   // computed position values:\r\n\r\n   this.controlborder = null; // left or top screen position for vertical or horizontal control\r\n   this.endcapstart = null; // top or left screen position for vertical or horizontal control\r\n   this.panesliderstart = null;\r\n   this.lessbuttonstart = null;\r\n   this.morebuttonstart = null;\r\n   this.scrollareastart = null;\r\n   this.scrollareaend = null;\r\n   this.scrollareasize = null;\r\n   this.thumbpos = null;\r\n\r\n   // constants:\r\n\r\n   this.controlthickness = scc.defaultTableControlThickness; // other dimension of complete control in pixels\r\n   this.sliderthickness = scc.defaultTCSliderThickness;\r\n   this.buttonthickness = scc.defaultTCButtonThickness;\r\n   this.thumbthickness = scc.defaultTCThumbThickness;\r\n   this.minscrollingpanesize = this.buttonthickness+this.buttonthickness+this.thumbthickness+20; // the 20 is to leave a little space\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.TableControl.prototype.CreateTableControl = function() {return SocialCalc.CreateTableControl(this);};\r\nSocialCalc.TableControl.prototype.PositionTableControlElements = function() {SocialCalc.PositionTableControlElements(this);};\r\nSocialCalc.TableControl.prototype.ComputeTableControlPositions = function() {SocialCalc.ComputeTableControlPositions(this);};\r\n\r\n// Functions:\r\n\r\nSocialCalc.CreateTableControl = function(control) {\r\n\r\n   var s, functions, params;\r\n   var AssignID = SocialCalc.AssignID;\r\n   var setStyles = SocialCalc.setStyles;\r\n   var scc = SocialCalc.Constants;\r\n   var TooltipRegister = function(element, etype, vh) {\r\n      if (scc[\"s_\"+etype+\"Tooltip\"+vh]) {\r\n         SocialCalc.TooltipRegister(element, scc[\"s_\"+etype+\"Tooltip\"+vh], null, control.editor.toplevel);\r\n         }\r\n      }\r\n\r\n   var imageprefix = control.editor.imageprefix;\r\n   var vh = control.vertical ? \"v\" : \"h\";\r\n\r\n   control.main = document.createElement(\"div\");\r\n   s = control.main.style;\r\n   s.height = (control.vertical ? control.size : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.size)+\"px\";\r\n   s.zIndex = 0;\r\n   setStyles(control.main, scc.TCmainStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"main-\"+vh+\".gif)\";\r\n   if (scc.TCmainClass) control.main.className = scc.TCmainClass;\r\n\r\n   control.main.style.display=\"none\"; // wait for layout\r\n\r\n   control.endcap = document.createElement(\"div\");\r\n   s = control.endcap.style;\r\n   s.height = control.controlthickness+\"px\";\r\n   s.width = control.controlthickness+\"px\";\r\n   s.zIndex = 1;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.endcap, scc.TCendcapStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"endcap-\"+vh+\".gif)\";\r\n   if (scc.TCendcapClass) control.endcap.className = scc.TCendcapClass;\r\n   AssignID(control.editor, control.endcap, \"endcap\"+vh);\r\n\r\n   control.main.appendChild(control.endcap);\r\n\r\n   control.paneslider = document.createElement(\"div\");\r\n   s = control.paneslider.style;\r\n   s.height = (control.vertical ? control.sliderthickness : control.controlthickness)+\"px\";\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.width = (control.vertical ? control.controlthickness : control.sliderthickness)+\"px\";\r\n   s.position = \"absolute\";\r\n   s[control.vertical?\"top\":\"left\"] = \"4px\";\r\n   s.zIndex = 3;\r\n   s.backgroundImage=\"url(\"+imageprefix+\"paneslider-\"+vh+\".gif)\";\r\n   if (scc.TCpanesliderClass) control.paneslider.className = scc.TCpanesliderClass;\r\n   AssignID(control.editor, control.paneslider, \"paneslider\"+vh);\r\n   TooltipRegister(control.paneslider, \"paneslider\", vh);\r\n\r\n   functions = {MouseDown:SocialCalc.TCPSDragFunctionStart,\r\n                    MouseMove: SocialCalc.TCPSDragFunctionMove,\r\n                    MouseUp: SocialCalc.TCPSDragFunctionStop,\r\n                    Disabled: function() {return control.editor.busy;}};\r\n\r\n   functions.control = control; // make sure this is there\r\n\r\n   // Drag pane slider - every thing but app view\r\n   if (SocialCalc._app != true) SocialCalc.DragRegister(control.paneslider, control.vertical, !control.vertical, functions, control.editor.toplevel);\r\n\r\n   control.main.appendChild(control.paneslider);\r\n\r\n   control.lessbutton = document.createElement(\"div\");\r\n   s = control.lessbutton.style;\r\n   s.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\r\n   s.zIndex = 2;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.lessbutton, scc.TClessbuttonStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"less-\"+vh+\"n.gif)\"\r\n   if (scc.TClessbuttonClass) control.lessbutton.className = scc.TClessbuttonClass;\r\n   AssignID(control.editor, control.lessbutton, \"lessbutton\"+vh);\r\n\r\n   params = {repeatwait:scc.TClessbuttonRepeatWait, repeatinterval:scc.TClessbuttonRepeatInterval,\r\n             normalstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"n.gif);\",\r\n             downstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"d.gif);\",\r\n             hoverstyle: \"backgroundImage:url(\"+imageprefix+\"less-\"+vh+\"h.gif);\"};\r\n   functions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\r\n                Repeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, -1);},\r\n                Disabled: function() {return control.editor.busy;}};\r\n\r\n   SocialCalc.ButtonRegister(control.editor, control.lessbutton, params, functions);\r\n\r\n   control.main.appendChild(control.lessbutton);\r\n\r\n   control.morebutton = document.createElement(\"div\");\r\n   s = control.morebutton.style;\r\n   s.height = (control.vertical ? control.buttonthickness : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.buttonthickness)+\"px\";\r\n   s.zIndex = 2;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.morebutton, scc.TCmorebuttonStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"more-\"+vh+\"n.gif)\"\r\n   if (scc.TCmorebuttonClass) control.morebutton.className = scc.TCmorebuttonClass;\r\n   AssignID(control.editor, control.morebutton, \"morebutton\"+vh);\r\n\r\n   params = {repeatwait:scc.TCmorebuttonRepeatWait, repeatinterval:scc.TCmorebuttonRepeatInterval,\r\n             normalstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"n.gif);\",\r\n             downstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"d.gif);\",\r\n             hoverstyle: \"backgroundImage:url(\"+imageprefix+\"more-\"+vh+\"h.gif);\"};\r\n   functions = {MouseDown:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\r\n                Repeat:function(){if(!control.editor.busy) control.editor.ScrollRelative(control.vertical, +1);},\r\n                Disabled: function() {return control.editor.busy;}};\r\n\r\n   SocialCalc.ButtonRegister(control.editor, control.morebutton, params, functions);\r\n\r\n   control.main.appendChild(control.morebutton);\r\n\r\n   control.scrollarea = document.createElement(\"div\");\r\n   s = control.scrollarea.style;\r\n   s.height = control.controlthickness+\"px\";\r\n   s.width = control.controlthickness+\"px\";\r\n   s.zIndex = 1;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.scrollarea, scc.TCscrollareaStyle);\r\n   s.backgroundImage=\"url(\"+imageprefix+\"scrollarea-\"+vh+\".gif)\";\r\n   if (scc.TCscrollareaClass) control.scrollarea.className = scc.TCscrollareaClass;\r\n   AssignID(control.editor, control.scrollarea, \"scrollarea\"+vh);\r\n\r\n   params = {repeatwait:scc.TCscrollareaRepeatWait, repeatinterval:scc.TCscrollareaRepeatWait};\r\n   functions = {MouseDown:SocialCalc.ScrollAreaClick, Repeat:SocialCalc.ScrollAreaClick,\r\n                Disabled: function() {return control.editor.busy;}};\r\n   functions.control = control;\r\n\r\n   SocialCalc.ButtonRegister(control.editor, control.scrollarea, params, functions);\r\n\r\n   control.main.appendChild(control.scrollarea);\r\n\r\n   control.thumb = document.createElement(\"div\");\r\n   s = control.thumb.style;\r\n   s.height =  (control.vertical ? control.thumbthickness : control.controlthickness)+\"px\";\r\n   s.width = (control.vertical ? control.controlthickness : control.thumbthickness)+\"px\";\r\n   s.zIndex = 2;\r\n   s.overflow = \"hidden\"; // IE will make the DIV at least font-size height...so use this\r\n   s.position = \"absolute\";\r\n   setStyles(control.thumb, scc.TCthumbStyle);\r\n   control.thumb.style.backgroundImage=\"url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\";\r\n   if (scc.TCthumbClass) control.thumb.className = scc.TCthumbClass;\r\n   AssignID(control.editor, control.thumb, \"thumb\"+vh);\r\n\r\n   functions = {MouseDown:SocialCalc.TCTDragFunctionStart,\r\n                MouseMove: SocialCalc.TCTDragFunctionMove,\r\n                MouseUp: SocialCalc.TCTDragFunctionStop,\r\n                Disabled: function() {return control.editor.busy;}};\r\n   functions.control = control; // make sure this is there\r\n   \r\n   // Drag pane slider - every thing but app view\r\n   if (SocialCalc._app != true) SocialCalc.DragRegister(control.thumb, control.vertical, !control.vertical, functions, control.editor.toplevel);\r\n\r\n   params = {normalstyle: \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"n.gif)\", name:\"Thumb\",\r\n             downstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"d.gif)\",\r\n             hoverstyle:  \"backgroundImage:url(\"+imageprefix+\"thumb-\"+vh+\"h.gif)\"};\r\n   SocialCalc.ButtonRegister(control.editor, control.thumb, params, null); // give it button-like visual behavior\r\n\r\n   control.main.appendChild(control.thumb);\r\n\r\n   return control.main;\r\n\r\n}\r\n\r\n//\r\n// ScrollAreaClick - Button function to process pageup/down clicks\r\n//\r\n\r\nSocialCalc.ScrollAreaClick = function(e, buttoninfo, bobj) {\r\n\r\n   var control = bobj.functionobj.control;\r\n   var pos = SocialCalc.GetElementPositionWithScroll(control.editor.toplevel);\r\n   var clickpos = control.vertical ? buttoninfo.clientY-pos.top : buttoninfo.clientX-pos.left;\r\n   if (control.editor.busy) { // ignore if busy - wait for next repeat\r\n      return;\r\n      }\r\n   control.editor.PageRelative(control.vertical, clickpos > control.thumbpos ? 1 : -1);\r\n\r\n   return;\r\n\r\n}\r\n\r\n//\r\n// PositionTableControlElements\r\n//\r\n\r\nSocialCalc.PositionTableControlElements = function(control) {\r\n\r\n   var border, realend, thumbpos;\r\n\r\n   var editor = control.editor;\r\n\r\n   if (control.vertical) {\r\n      border = control.controlborder+\"px\";\r\n      control.endcap.style.top = control.endcapstart+\"px\";\r\n      control.endcap.style.left = border;\r\n      control.paneslider.style.top = control.panesliderstart+\"px\";\r\n      control.paneslider.style.left = border\r\n      control.lessbutton.style.top = control.lessbuttonstart+\"px\";\r\n      control.lessbutton.style.left = border;\r\n      control.morebutton.style.top = control.morebuttonstart+\"px\";\r\n      control.morebutton.style.left = border;\r\n      control.scrollarea.style.top = control.scrollareastart+\"px\";\r\n      control.scrollarea.style.left = border;\r\n      control.scrollarea.style.height = control.scrollareasize+\"px\";\r\n      realend = Math.max(editor.context.sheetobj.attribs.lastrow, editor.firstscrollingrow+1);\r\n      thumbpos = ((editor.firstscrollingrow-(editor.lastnonscrollingrow+1))*(control.scrollareasize-3*control.thumbthickness))/\r\n         (realend-(editor.lastnonscrollingrow+1))+control.scrollareastart-1;\r\n      thumbpos = Math.floor(thumbpos);\r\n      control.thumb.style.top = thumbpos+\"px\";\r\n      control.thumb.style.left = border;\r\n      }\r\n   else {\r\n      border = control.controlborder+\"px\";\r\n      control.endcap.style.left = control.endcapstart+\"px\";\r\n      control.endcap.style.top = border;\r\n      control.paneslider.style.left = control.panesliderstart+\"px\";\r\n      control.paneslider.style.top = border\r\n      control.lessbutton.style.left = control.lessbuttonstart+\"px\";\r\n      control.lessbutton.style.top = border;\r\n      control.morebutton.style.left = control.morebuttonstart+\"px\";\r\n      control.morebutton.style.top = border;\r\n      control.scrollarea.style.left = control.scrollareastart+\"px\";\r\n      control.scrollarea.style.top = border;\r\n      control.scrollarea.style.width = control.scrollareasize+\"px\";\r\n      realend = Math.max(editor.context.sheetobj.attribs.lastcol, editor.firstscrollingcol+1);\r\n      thumbpos = ((editor.firstscrollingcol-(editor.lastnonscrollingcol+1))*(control.scrollareasize-control.thumbthickness))/\r\n         (realend-editor.lastnonscrollingcol)+control.scrollareastart-1;\r\n      thumbpos = Math.floor(thumbpos);\r\n      control.thumb.style.left = thumbpos+\"px\";\r\n      control.thumb.style.top = border;\r\n      }\r\n   control.thumbpos = thumbpos;\r\n   control.main.style.display=\"block\";\r\n\r\n   }\r\n\r\n//\r\n// ComputeTableControlPositions\r\n//\r\n// This routine computes the screen positions and other values needed for laying out\r\n// the table control elements.\r\n//\r\n\r\nSocialCalc.ComputeTableControlPositions = function(control) {\r\n\r\n   var editor = control.editor;\r\n\r\n   if (!editor.gridposition || !editor.headposition) throw(\"Can't compute table control positions before editor positions\");\r\n\r\n   if (control.vertical) {\r\n      control.controlborder = editor.gridposition.left+editor.tablewidth; // border=left position\r\n      control.endcapstart = editor.gridposition.top; // start=top position\r\n      control.panesliderstart = editor.firstscrollingrowtop-control.sliderthickness;\r\n      control.lessbuttonstart = editor.firstscrollingrowtop-1;\r\n      control.morebuttonstart = editor.gridposition.top+editor.tableheight-control.buttonthickness;\r\n      control.scrollareastart = editor.firstscrollingrowtop-1+control.buttonthickness;\r\n      control.scrollareaend = control.morebuttonstart-1;\r\n      control.scrollareasize = control.scrollareaend-control.scrollareastart+1;\r\n      }\r\n   else {\r\n      control.controlborder = editor.gridposition.top+editor.tableheight; // border=top position\r\n      control.endcapstart = editor.gridposition.left; // start=left position\r\n      control.panesliderstart = editor.firstscrollingcolleft-control.sliderthickness;\r\n      control.lessbuttonstart = editor.firstscrollingcolleft-1;\r\n      control.morebuttonstart = editor.gridposition.left+editor.tablewidth-control.buttonthickness;\r\n      control.scrollareastart = editor.firstscrollingcolleft-1+control.buttonthickness;\r\n      control.scrollareaend = control.morebuttonstart-1;\r\n      control.scrollareasize = control.scrollareaend-control.scrollareastart+1;\r\n      }\r\n   }\r\n\r\n////// TCPS - TableControl Pan Slider methods\r\n\r\n//\r\n// TCPSDragFunctionStart(event, draginfo, dobj)\r\n//\r\n// TableControlPaneSlider function for starting drag\r\n//\r\n\r\nSocialCalc.TCPSDragFunctionStart = function(event, draginfo, dobj) {\r\n\r\n   var editor = dobj.functionobj.control.editor;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   SocialCalc.DragFunctionStart(event, draginfo, dobj);\r\n\r\n   draginfo.trackingline = document.createElement(\"div\");\r\n   draginfo.trackingline.style.height = dobj.vertical ? scc.TCPStrackinglineThickness :\r\n      (editor.tableheight-(editor.headposition.top-editor.gridposition.top))+\"px\";\r\n   draginfo.trackingline.style.width = dobj.vertical ? \r\n      (editor.tablewidth-(editor.headposition.left-editor.gridposition.left))+\"px\" : scc.TCPStrackinglineThickness;\r\n   draginfo.trackingline.style.backgroundImage=\"url(\"+editor.imageprefix+\"trackingline-\"+(dobj.vertical?\"v\":\"h\")+\".gif)\";;\r\n   if (scc.TCPStrackinglineClass) draginfo.trackingline.className = scc.TCPStrackinglineClass;\r\n   SocialCalc.setStyles(draginfo.trackingline, scc.TCPStrackinglineStyle);\r\n\r\n   if (dobj.vertical) {\r\n      row = SocialCalc.Lookup(draginfo.clientY+dobj.functionobj.control.sliderthickness, editor.rowpositions);\r\n      draginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\r\n      draginfo.trackingline.style.left = editor.headposition.left+\"px\";\r\n      draginfo.trackingline.id = 'trackingline-vertical';\r\n      if (editor.context.rowpanes.length-1) { // has 2 already\r\n         editor.context.SetRowPaneFirstLast(1, editor.context.rowpanes[0].last+1, editor.context.rowpanes[0].last+1);\r\n         editor.FitToEditTable();\r\n         editor.ScheduleRender();\r\n         }\r\n      }\r\n   else {\r\n      col = SocialCalc.Lookup(draginfo.clientX+dobj.functionobj.control.sliderthickness, editor.colpositions);\r\n      draginfo.trackingline.style.top = editor.headposition.top+\"px\";\r\n      draginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\r\n      draginfo.trackingline.id = 'trackingline-horizon';\r\n      if (editor.context.colpanes.length-1) { // has 2 already\r\n         editor.context.SetColPaneFirstLast(1, editor.context.colpanes[0].last+1, editor.context.colpanes[0].last+1);\r\n         editor.FitToEditTable();\r\n         editor.ScheduleRender();\r\n         }\r\n      }\r\n\r\n   editor.griddiv.appendChild(draginfo.trackingline);\r\n\r\n   }\r\n\r\n//\r\n// TCPSDragFunctionMove(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCPSDragFunctionMove = function(event, draginfo, dobj) {\r\n\r\n   var row, col, max, min;\r\n   var control = dobj.functionobj.control;\r\n   var sliderthickness = control.sliderthickness;\r\n   var editor = control.editor;\r\n\r\n   if (dobj.vertical) {\r\n      max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\r\n      if (draginfo.clientY > max) draginfo.clientY = max;\r\n      min = editor.headposition.top - sliderthickness - draginfo.offsetY;\r\n      if (draginfo.clientY < min) draginfo.clientY = min;\r\n\r\n      row = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\r\n\r\n      // Handle hidden row.\r\n      while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\r\n         row++;\r\n         }\r\n\r\n      draginfo.trackingline.style.top = (editor.rowpositions[row] || editor.headposition.top)+\"px\";\r\n      }\r\n   else {\r\n      max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\r\n      if (draginfo.clientX > max) draginfo.clientX = max;\r\n      min = editor.headposition.left - sliderthickness - draginfo.offsetX;\r\n      if (draginfo.clientX < min) draginfo.clientX = min;\r\n\r\n      col = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\r\n\r\n      // Handle hidden column.\r\n      while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n         col++;\r\n         }\r\n\r\n      draginfo.trackingline.style.left = (editor.colpositions[col] || editor.headposition.left)+\"px\";\r\n      }\r\n\r\n   SocialCalc.DragFunctionPosition(event, draginfo, dobj);\r\n\r\n   }\r\n\r\n//\r\n// TCPSDragFunctionStop(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCPSDragFunctionStop = function(event, draginfo, dobj) {\r\n\r\n   var row, col, max, min, dc;\r\n   var control = dobj.functionobj.control;\r\n   var sliderthickness = control.sliderthickness;\r\n   var editor = control.editor;\r\n\r\n   if (dobj.vertical) {\r\n     max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetY; // restrict movement\r\n     if (draginfo.clientY > max) draginfo.clientY = max;\r\n     min = editor.headposition.top - sliderthickness - draginfo.offsetY;\r\n     if (draginfo.clientY < min) draginfo.clientY = min;\r\n\r\n     row = SocialCalc.Lookup(draginfo.clientY+sliderthickness, editor.rowpositions);\r\n     if (row>editor.context.sheetobj.attribs.lastrow) row=editor.context.sheetobj.attribs.lastrow; // can't extend sheet here\r\n\r\n     // Handle hidden row.\r\n     while (editor.context.sheetobj.rowattribs.hide[row] == \"yes\") {\r\n       row++;\r\n     }\r\n\r\n\r\n     editor.EditorScheduleSheetCommands('pane row ' + row, true, false);\r\n   }\r\n   else {\r\n     max = control.morebuttonstart - control.minscrollingpanesize - draginfo.offsetX;\r\n     if (draginfo.clientX > max) draginfo.clientX = max;\r\n     min = editor.headposition.left - sliderthickness - draginfo.offsetX;\r\n     if (draginfo.clientX < min) draginfo.clientX = min;\r\n\r\n     col = SocialCalc.Lookup(draginfo.clientX+sliderthickness, editor.colpositions);\r\n     if (col>editor.context.sheetobj.attribs.lastcol) col=editor.context.sheetobj.attribs.lastcol; // can't extend sheet here\r\n\r\n     // Handle hidden column.\r\n     while (editor.context.sheetobj.colattribs.hide[SocialCalc.rcColname(col)] == \"yes\") {\r\n       col++;\r\n     }\r\n\r\n     editor.EditorScheduleSheetCommands('pane col ' + col, true, false);\r\n   }\r\n\r\n   }\r\n\r\n////// TCT - TableControl Thumb methods\r\n\r\n//!!!! Note: Need to make start use same code as move/stop for determining row/col, since stop will set that\r\n//!!!! Note: Need to make start/move/stop use positioning code that corresponds closer to\r\n//!!!!       ComputeTableControlPositions calculations.\r\n\r\n//\r\n// TCTDragFunctionStart(event, draginfo, dobj)\r\n//\r\n// TableControlThumb function for starting drag\r\n//\r\n\r\nSocialCalc.TCTDragFunctionStart = function(event, draginfo, dobj) {\r\n\r\n   var rowpane, colpane, row, col;\r\n\r\n   var control = dobj.functionobj.control;\r\n   var editor = control.editor;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   SocialCalc.DragFunctionStart(event, draginfo, dobj);\r\n\r\n   if (draginfo.thumbstatus) { // get rid of old one if mouseup was out of window\r\n      if (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\r\n      if (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\r\n      editor.toplevel.removeChild(draginfo.thumbstatus);\r\n      draginfo.thumbstatus = null;\r\n      }\r\n\r\n   draginfo.thumbstatus = document.createElement(\"div\");\r\n\r\n   if (dobj.vertical) {\r\n      if (scc.TCTDFSthumbstatusvClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatusvClass;\r\n      SocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatusvStyle);\r\n      draginfo.thumbstatus.style.top = (draginfo.clientY+scc.TCTDFStopOffsetv)+\"px\";\r\n      draginfo.thumbstatus.style.left = (control.controlborder-10-(editor.tablewidth/2))+\"px\";\r\n      draginfo.thumbstatus.style.width = (editor.tablewidth/2)+\"px\";\r\n\r\n      draginfo.thumbcontext = new SocialCalc.RenderContext(editor.context.sheetobj);\r\n      draginfo.thumbcontext.showGrid = true;\r\n      draginfo.thumbcontext.rowpanes = [{first: 1, last: 1}];\r\n      var pane = editor.context.colpanes[editor.context.colpanes.length-1];\r\n      draginfo.thumbcontext.colpanes = [{first: pane.first, last: pane.last}];\r\n      draginfo.thumbstatus.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td valign=\"top\" style=\"'+\r\n        scc.TCTDFSthumbstatusrownumStyle+'\" class=\"'+scc.TCTDFSthumbstatusrownumClass+\r\n        '\"><div>msg</div></td><td valign=\"top\"><div style=\"overflow:hidden;\">preview</div></td></tr></table>';\r\n      draginfo.thumbstatus.rowmsgele = draginfo.thumbstatus.firstChild.firstChild.firstChild.firstChild.firstChild;\r\n      draginfo.thumbstatus.rowpreviewele = draginfo.thumbstatus.firstChild.firstChild.firstChild.childNodes[1].firstChild;\r\n      editor.toplevel.appendChild(draginfo.thumbstatus);\r\n      SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, editor.firstscrollingrow || 1);\r\n      }\r\n   else {\r\n      if (scc.TCTDFSthumbstatushClass) draginfo.thumbstatus.className = scc.TCTDFSthumbstatushClass;\r\n      SocialCalc.setStyles(draginfo.thumbstatus, scc.TCTDFSthumbstatushStyle);\r\n      draginfo.thumbstatus.style.top = (control.controlborder+scc.TCTDFStopOffseth)+\"px\";\r\n      draginfo.thumbstatus.style.left = (draginfo.clientX+scc.TCTDFSleftOffseth)+\"px\";\r\n      editor.toplevel.appendChild(draginfo.thumbstatus);\r\n      draginfo.thumbstatus.innerHTML = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(editor.firstscrollingcol);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, row)\r\n//\r\n// Render partial row\r\n//\r\n\r\nSocialCalc.TCTDragFunctionRowSetStatus = function(draginfo, editor, row) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var msg = scc.s_TCTDFthumbstatusPrefixv+row+\" \";\r\n\r\n   draginfo.thumbstatus.rowmsgele.innerHTML = msg;\r\n\r\n   draginfo.thumbcontext.rowpanes = [{first: row, last: row}];\r\n   draginfo.thumbrowshown = row;\r\n\r\n   var ele = draginfo.thumbcontext.RenderSheet(draginfo.thumbstatus.rowpreviewele.firstChild, {type: \"html\"});\r\n\r\n   }\r\n\r\n\r\n//\r\n// TCTDragFunctionMove(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCTDragFunctionMove = function(event, draginfo, dobj) {\r\n\r\n   var first, msg;\r\n   var control = dobj.functionobj.control;\r\n   var thumbthickness = control.thumbthickness;\r\n   var editor = control.editor;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   if (dobj.vertical) {\r\n      if (draginfo.clientY > control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2)\r\n         draginfo.clientY = control.scrollareaend - draginfo.offsetY - control.thumbthickness + 2;\r\n      if (draginfo.clientY < control.scrollareastart - draginfo.offsetY - 1)\r\n         draginfo.clientY = control.scrollareastart - draginfo.offsetY - 1;\r\n      draginfo.thumbstatus.style.top = draginfo.clientY+\"px\";\r\n\r\n      first =\r\n         ((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\r\n         + editor.lastnonscrollingrow + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\r\n//      msg = scc.s_TCTDFthumbstatusPrefixv+first;\r\n      if (first != draginfo.thumbrowshown) {\r\n         SocialCalc.TCTDragFunctionRowSetStatus(draginfo, editor, first);\r\n         }\r\n      }\r\n   else {\r\n      if (draginfo.clientX > control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2)\r\n         draginfo.clientX = control.scrollareaend - draginfo.offsetX - control.thumbthickness + 2;\r\n      if (draginfo.clientX < control.scrollareastart - draginfo.offsetX - 1)\r\n         draginfo.clientX = control.scrollareastart - draginfo.offsetX - 1;\r\n      draginfo.thumbstatus.style.left = draginfo.clientX+\"px\";\r\n\r\n      first =\r\n         ((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\r\n         + editor.lastnonscrollingcol + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\r\n      msg = scc.s_TCTDFthumbstatusPrefixh+SocialCalc.rcColname(first);\r\n      draginfo.thumbstatus.innerHTML = msg;\r\n      }\r\n\r\n   SocialCalc.DragFunctionPosition(event, draginfo, dobj);\r\n\r\n   }\r\n\r\n//\r\n// TCTDragFunctionStop(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.TCTDragFunctionStop = function(event, draginfo, dobj) {\r\n\r\n   var first;\r\n   var control = dobj.functionobj.control;\r\n   var editor = control.editor;\r\n\r\n   if (dobj.vertical) {\r\n      first =\r\n         ((draginfo.clientY+draginfo.offsetY-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastrow-editor.lastnonscrollingrow)\r\n         + editor.lastnonscrollingrow + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingrow) first = editor.lastnonscrollingrow + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastrow) first = editor.context.sheetobj.attribs.lastrow;\r\n\r\n      editor.context.SetRowPaneFirstLast(editor.context.rowpanes.length-1, first, first+1);\r\n      }\r\n   else {\r\n      first =\r\n         ((draginfo.clientX+draginfo.offsetX-control.scrollareastart+1)/(control.scrollareasize-control.thumbthickness))\r\n         * (editor.context.sheetobj.attribs.lastcol-editor.lastnonscrollingcol)\r\n         + editor.lastnonscrollingcol + 1;\r\n      first = Math.floor(first);\r\n      if (first <= editor.lastnonscrollingcol) first = editor.lastnonscrollingcol + 1;\r\n      if (first > editor.context.sheetobj.attribs.lastcol) first = editor.context.sheetobj.attribs.lastcol;\r\n\r\n      editor.context.SetColPaneFirstLast(editor.context.colpanes.length-1, first, first+1);\r\n      }\r\n\r\n   editor.FitToEditTable();\r\n\r\n   if (draginfo.thumbstatus.rowmsgele) draginfo.thumbstatus.rowmsgele = null;\r\n   if (draginfo.thumbstatus.rowpreviewele) draginfo.thumbstatus.rowpreviewele = null;\r\n   editor.toplevel.removeChild(draginfo.thumbstatus);\r\n   draginfo.thumbstatus = null;\r\n\r\n   editor.ScheduleRender();\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Dragging functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.DragInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // Only one dragging operation can be active at a time.\r\n   // The registeredElements array is used to decide which item to drag.\r\n \r\n   // One item for each draggable thing, each an object with:\r\n   //    .element, .vertical, .horizontal, .functionobj, .parent\r\n\r\n   registeredElements: [],\r\n\r\n   // Items used during a drag\r\n\r\n   draggingElement: null, // item being processed (.element is the actual element)\r\n   startX: 0,\r\n   startY: 0,\r\n   startZ: 0,\r\n   clientX: 0, // modifyable version to restrict movement\r\n   clientY: 0,\r\n   offsetX: 0,\r\n   offsetY: 0,\r\n   relativeOffset: {left:0,top:0} // retrieved at drag start\r\n\r\n   }\r\n\r\n//\r\n// DragRegister(element, vertical, horizontal, functionobj, parent) - make element draggable\r\n//\r\n// The functionobj defaults to moving the element contrained only by vertical and horizontal settings.\r\n//\r\n\r\nSocialCalc.DragRegister = function(element, vertical, horizontal, functionobj, parent) {\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n\r\n   if (!functionobj) {\r\n      functionobj = {MouseDown: SocialCalc.DragFunctionStart, MouseMove: SocialCalc.DragFunctionPosition,\r\n                     MouseUp: SocialCalc.DragFunctionPosition,\r\n                     Disabled: null};\r\n      }\r\n\r\n   draginfo.registeredElements.push(\r\n      {element: element, vertical: vertical, horizontal: horizontal, functionobj: functionobj, parent: parent}\r\n      );\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// DragUnregister(element) - remove object from list\r\n//\r\n\r\nSocialCalc.DragUnregister = function(element) {\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n\r\n   var i;\r\n\r\n   if (!element) return;\r\n\r\n   for (i=0; i<draginfo.registeredElements.length; i++) {\r\n      if (draginfo.registeredElements[i].element == element) {\r\n         draginfo.registeredElements.splice(i,1);\r\n         if (element.removeEventListener) { // DOM Level 2 -- Firefox, et al\r\n            element.removeEventListener(\"mousedown\", SocialCalc.DragMouseDown, false);\r\n            }\r\n         else { // IE 5+\r\n            element.detachEvent(\"onmousedown\", SocialCalc.DragMouseDown);\r\n            }\r\n         return;\r\n         }\r\n      }\r\n\r\n   return; // ignore if not in list\r\n\r\n   }\r\n\r\n//\r\n// DragMouseDown(event)\r\n//\r\n\r\nSocialCalc.DragMouseDown = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n\r\n   var dobj = SocialCalc.LookupElement(e.target || e.srcElement, draginfo.registeredElements);\r\n   if (!dobj) return;\r\n\r\n   if (dobj && dobj.functionobj && dobj.functionobj.Disabled) {\r\n      if (dobj.functionobj.Disabled(e, draginfo, dobj)) {\r\n         return;\r\n         }\r\n      }\r\n\r\n   draginfo.draggingElement = dobj;\r\n   if (dobj.parent) {\r\n      draginfo.relativeOffset = SocialCalc.GetElementPositionWithScroll(dobj.parent);\r\n      }\r\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\r\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\r\n   draginfo.startX = draginfo.clientX;\r\n   draginfo.startY = draginfo.clientY;\r\n   draginfo.startZ = dobj.element.style.zIndex;\r\n   draginfo.offsetX = 0;\r\n   draginfo.offsetY = 0;\r\n\r\n   dobj.element.style.zIndex = \"100\";\r\n   SocialCalc.SetMouseMoveUp(SocialCalc.DragMouseMove,\r\n\t\t\t     SocialCalc.DragMouseUp,\r\n\t\t\t     dobj.element,\r\n\t\t\t     e);\r\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseDown) dobj.functionobj.MouseDown(e, draginfo, dobj);\r\n\r\n   return false;\r\n\r\n   }\r\n\r\n//\r\n// DragMouseMove(event)\r\n//\r\n\r\nSocialCalc.DragMouseMove = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n   var dobj = draginfo.draggingElement;\r\n\r\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\r\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\r\n   SocialCalc.StopPropagation(e);\r\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseMove) dobj.functionobj.MouseMove(e, draginfo, dobj);\r\n   return false;\r\n   }\r\n\r\n//\r\n// DragMouseUp(event)\r\n//\r\n\r\nSocialCalc.DragMouseUp = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var draginfo = SocialCalc.DragInfo;\r\n   var dobj = draginfo.draggingElement;\r\n\r\n   draginfo.clientX = e.clientX - draginfo.relativeOffset.left;\r\n   draginfo.clientY = e.clientY - draginfo.relativeOffset.top;\r\n\r\n   dobj.element.style.zIndex = draginfo.startZ;\r\n\r\n   if (dobj && dobj.functionobj && dobj.functionobj.MouseUp) dobj.functionobj.MouseUp(e, draginfo, dobj);\r\n   SocialCalc.RemoveMouseMoveUp(SocialCalc.DragMouseMove,\r\n\t\t\t\tSocialCalc.DragMouseUp,\r\n\t\t\t\tdobj.element, e);\r\n   draginfo.draggingElement = null;\r\n   return false;\r\n   }\r\n\r\n//\r\n// DragFunctionStart(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.DragFunctionStart = function(event, draginfo, dobj) {\r\n\r\n   var element = dobj.functionobj.positionobj || dobj.element;\r\n\r\n   draginfo.offsetY = parseInt(element.style.top) - draginfo.clientY;\r\n   draginfo.offsetX = parseInt(element.style.left) - draginfo.clientX;\r\n\r\n   }\r\n\r\n//\r\n// DragFunctionPosition(event, draginfo, dobj)\r\n//\r\n\r\nSocialCalc.DragFunctionPosition = function(event, draginfo, dobj) {\r\n\r\n   var element = dobj.functionobj.positionobj || dobj.element;\r\n\r\n   if (dobj.vertical) element.style.top = (draginfo.clientY + draginfo.offsetY)+\"px\";\r\n   if (dobj.horizontal) element.style.left = (draginfo.clientX + draginfo.offsetX)+\"px\";\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Tooltip functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.TooltipInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // Only one tooltip operation can be active at a time.\r\n   // The registeredElements array is used to identify items.\r\n\r\n   // One item for each element with a tooltip, each an object with:\r\n   //    .element, .tiptext, .functionobj, .parent\r\n   // Currently .functionobj can only contain .offsetx and .offsety.\r\n   // If present they are used instead of the default ones.\r\n\r\n   registeredElements: [],\r\n\r\n   registered: false, // if true, an event handler has been registered for this functionality\r\n\r\n   // Items used during hover over an element\r\n\r\n   tooltipElement: null, // item being processed (.element is the actual element)\r\n   timer: null, // timer object waiting to see if holding over element\r\n   popupElement: null, // tooltip element being displayed\r\n   clientX: 0, // modifyable version to restrict movement\r\n   clientY: 0,\r\n   offsetX: SocialCalc.Constants.TooltipOffsetX, // modifyable version to allow positioning\r\n   offsetY: SocialCalc.Constants.TooltipOffsetY\r\n\r\n   }\r\n\r\n//\r\n// TooltipRegister(element, tiptext, functionobj, parent) - make element have a tooltip\r\n//\r\n\r\nSocialCalc.TooltipRegister = function(element, tiptext, functionobj, parent) {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n   tooltipinfo.registeredElements.push(\r\n      {element: element, tiptext: tiptext, functionobj: functionobj, parent: parent}\r\n      );\r\n\r\n   if (tooltipinfo.registered) return; // only need to add event listener once\r\n\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mousemove\", SocialCalc.TooltipMouseMove, false);\r\n      }\r\n   else if (document.attachEvent) { // IE 5+\r\n      document.attachEvent(\"onmousemove\", SocialCalc.TooltipMouseMove);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   tooltipinfo.registered = true; // remember\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// TooltipMouseMove(event)\r\n//\r\n\r\nSocialCalc.TooltipMouseMove = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   tooltipinfo.clientX = e.clientX;\r\n   tooltipinfo.clientY = e.clientY;\r\n\r\n   var tobj = SocialCalc.LookupElement(e.target || e.srcElement, tooltipinfo.registeredElements);\r\n\r\n   if (tooltipinfo.timer) { // waiting to see if holding still: didn't hold still\r\n      window.clearTimeout(tooltipinfo.timer); // cancel timer\r\n      tooltipinfo.timer = null;\r\n      }\r\n\r\n   if (tooltipinfo.popupElement) { // currently displaying a tip: hide it\r\n      SocialCalc.TooltipHide();\r\n      }\r\n\r\n   tooltipinfo.tooltipElement = tobj || null;\r\n\r\n   if (!tobj || SocialCalc.ButtonInfo.buttonDown) return; // if not an object with a tip or a \"button\" is down, ignore\r\n\r\n   tooltipinfo.timer = window.setTimeout(SocialCalc.TooltipWaitDone, 700);\r\n\r\n   if (tooltipinfo.tooltipElement.element.addEventListener) { // Register event for mouse down which cancels tooltip stuff\r\n      tooltipinfo.tooltipElement.element.addEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\r\n      }\r\n   else if (tooltipinfo.tooltipElement.element.attachEvent) { // IE\r\n      tooltipinfo.tooltipElement.element.attachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// TooltipMouseDown(event)\r\n//\r\n\r\nSocialCalc.TooltipMouseDown = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   if (tooltipinfo.timer) {\r\n      window.clearTimeout(tooltipinfo.timer); // cancel timer\r\n      tooltipinfo.timer = null;\r\n      }\r\n\r\n   if (tooltipinfo.popupElement) { // currently displaying a tip: hide it\r\n      SocialCalc.TooltipHide();\r\n      }\r\n\r\n   if (tooltipinfo.tooltipElement) {\r\n      if (tooltipinfo.tooltipElement.element.removeEventListener) { // DOM Level 2 -- Firefox, et al\r\n         tooltipinfo.tooltipElement.element.removeEventListener(\"mousedown\", SocialCalc.TooltipMouseDown, false);\r\n         }\r\n      else if (tooltipinfo.tooltipElement.element.attachEvent) { // IE 5+\r\n         tooltipinfo.tooltipElement.element.detachEvent(\"onmousedown\", SocialCalc.TooltipMouseDown);\r\n         }\r\n      tooltipinfo.tooltipElement = null;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// TooltipDisplay(tobj)\r\n//\r\n\r\nSocialCalc.TooltipDisplay = function(tobj) {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n   var scc = SocialCalc.Constants;\r\n   var offsetX = (tobj.functionobj && ((typeof tobj.functionobj.offsetx) == \"number\")) ? \r\n      tobj.functionobj.offsetx : tooltipinfo.offsetX;\r\n   var offsetY = (tobj.functionobj && ((typeof tobj.functionobj.offsety) == \"number\")) ? \r\n      tobj.functionobj.offsety : tooltipinfo.offsetY;\r\n   var viewport = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(tobj.parent);\r\n\r\n   tooltipinfo.popupElement = document.createElement(\"div\");\r\n   if (scc.TDpopupElementClass) tooltipinfo.popupElement.className = scc.TDpopupElementClass;\r\n   SocialCalc.setStyles(tooltipinfo.popupElement, scc.TDpopupElementStyle);\r\n\r\n   tooltipinfo.popupElement.innerHTML = tobj.tiptext;\r\n\r\n   if (tooltipinfo.clientX > viewport.width/2) { // on right side of screen\r\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY + pos.top)+\"px\";\r\n      tooltipinfo.popupElement.style.right = (pos.width - tooltipinfo.clientX + offsetX + pos.left)+\"px\";\r\n      }\r\n   else { // on left side of screen\r\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY + pos.top)+\"px\";\r\n      tooltipinfo.popupElement.style.left = (tooltipinfo.clientX + offsetX - pos.left)+\"px\";\r\n      }\r\n\r\n   if (tooltipinfo.clientY < 50) { // make sure fits on screen if nothing above grid\r\n      tooltipinfo.popupElement.style.bottom = (pos.height - tooltipinfo.clientY + offsetY - 50 + pos.top)+\"px\";\r\n      }\r\n\r\n   tobj.parent.appendChild(tooltipinfo.popupElement);\r\n\r\n   }\r\n\r\n//\r\n// TooltipHide()\r\n//\r\n\r\nSocialCalc.TooltipHide = function() {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   if (tooltipinfo.popupElement) {\r\n      tooltipinfo.popupElement.parentNode.removeChild(tooltipinfo.popupElement);\r\n      tooltipinfo.popupElement = null;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// TooltipWaitDone()\r\n//\r\n\r\nSocialCalc.TooltipWaitDone = function() {\r\n\r\n   var tooltipinfo = SocialCalc.TooltipInfo;\r\n\r\n   tooltipinfo.timer = null;\r\n\r\n   SocialCalc.TooltipDisplay(tooltipinfo.tooltipElement);\r\n\r\n   }\r\n\r\n\r\n// *************************************\r\n//\r\n// Button functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.ButtonInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // Only one button operation can be active at a time.\r\n   // The registeredElements array is used to identify items.\r\n\r\n   // One item for each clickable element, each an object with:\r\n   //    .element, .normalstyle, .hoverstyle, .downstyle, .repeatinterval, .functionobj, .editor\r\n   //\r\n   // .functionobj is an object with optional function objects for:\r\n   //    mouseover, mouseout, mousedown, repeatinterval, mouseup, disabled\r\n\r\n   registeredElements: [],\r\n\r\n   // Items used during hover over an element, clicking, repeating, etc.\r\n\r\n   buttonElement: null, // item being processed, hover or down (.element is the actual element)\r\n   doingHover: false, // true if mouse is over one of our elements\r\n   buttonDown: false, // true if button down and buttonElement not null\r\n   timer: null, // timer object for repeating\r\n\r\n   // Used while processing an event\r\n\r\n   relativeOffset: null,\r\n   clientX: 0,\r\n   clientY: 0\r\n\r\n   }\r\n\r\n//\r\n// ButtonRegister(editor, element, paramobj, functionobj) - make element clickable\r\n//\r\n// The arguments (other than editor and element) may be null (meaning no change for style and no repeat)\r\n// The paramobj has the optional normalstyle, hoverstyle, downstyle, repeatwait, repeatinterval settings\r\n\r\nSocialCalc.ButtonRegister = function(editor, element, paramobj, functionobj) {\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   if (!paramobj) paramobj = {};\r\n\r\n   buttoninfo.registeredElements.push(\r\n      {name: paramobj.name, element: element, editor: editor,\r\n       normalstyle: paramobj.normalstyle, hoverstyle: paramobj.hoverstyle, downstyle: paramobj.downstyle,\r\n       repeatwait: paramobj.repeatwait, repeatinterval: paramobj.repeatinterval, functionobj: functionobj}\r\n      );\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"mousedown\", SocialCalc.ButtonMouseDown, false);\r\n      element.addEventListener(\"mouseover\", SocialCalc.ButtonMouseOver, false);\r\n      element.addEventListener(\"mouseout\", SocialCalc.ButtonMouseOut, false);\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousedown\", SocialCalc.ButtonMouseDown);\r\n      element.attachEvent(\"onmouseover\", SocialCalc.ButtonMouseOver);\r\n      element.attachEvent(\"onmouseout\", SocialCalc.ButtonMouseOut);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   return;\r\n   }\r\n\r\n//\r\n// ButtonMouseOver(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseOver = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\r\n\r\n   if (!bobj) return;\r\n\r\n   if (buttoninfo.buttonDown) {\r\n      if (buttoninfo.buttonElement==bobj) {\r\n         buttoninfo.doingHover = true; // keep track whether we are on the pressed button or not\r\n         }\r\n      return;\r\n      }\r\n\r\n   if (buttoninfo.buttonElement &&\r\n          buttoninfo.buttonElement!=bobj && buttoninfo.doingHover) { // moved to a new one, undo hover there\r\n      SocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\r\n      }\r\n\r\n   buttoninfo.buttonElement = bobj; // remember this one is hovering\r\n   buttoninfo.doingHover = true;\r\n\r\n   SocialCalc.setStyles(bobj.element, bobj.hoverstyle); // set style (if provided)\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseOver) bobj.functionobj.MouseOver(e, buttoninfo, bobj);\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// ButtonMouseOut(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseOut = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   if (buttoninfo.buttonDown) {\r\n      buttoninfo.doingHover = false; // keep track of overs and outs\r\n      return;\r\n      }\r\n\r\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\r\n\r\n   if (buttoninfo.doingHover) { // if there was a hover, undo it\r\n      if (buttoninfo.buttonElement)\r\n         SocialCalc.setStyles(buttoninfo.buttonElement.element, buttoninfo.buttonElement.normalstyle);\r\n      buttoninfo.buttonElement = null;\r\n      buttoninfo.doingHover = false;\r\n      }\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseOut) bobj.functionobj.MouseOut(e, buttoninfo, bobj);\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// ButtonMouseDown(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseDown = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n\r\n   var viewportinfo = SocialCalc.GetViewportInfo();\r\n\r\n   var bobj = SocialCalc.LookupElement(e.target || e.srcElement, buttoninfo.registeredElements);\r\n\r\n   if (!bobj) return; // not one of our elements\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.Disabled) {\r\n      if (bobj.functionobj.Disabled(e, buttoninfo, bobj)) {\r\n         return;\r\n         }\r\n      }\r\n\r\n   buttoninfo.buttonElement = bobj;\r\n   buttoninfo.buttonDown = true;\r\n\r\n   SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.downstyle);\r\n\r\n   // Register event handler for mouse up\r\n\r\n   // Event code from JavaScript, Flanagan, 5th Edition, pg. 422\r\n   if (document.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      document.addEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true); // capture everywhere\r\n      }\r\n   else if (bobj.element.attachEvent) { // IE 5+\r\n      bobj.element.setCapture();\r\n      bobj.element.attachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\r\n      bobj.element.attachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\r\n      }\r\n   SocialCalc.StopPropagation(e);\r\n   buttoninfo.relativeOffset = SocialCalc.GetElementPositionWithScroll(bobj.editor.toplevel);\r\n   buttoninfo.clientX = e.clientX - buttoninfo.relativeOffset.left;\r\n   buttoninfo.clientY = e.clientY - buttoninfo.relativeOffset.top;\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseDown) bobj.functionobj.MouseDown(e, buttoninfo, bobj);\r\n\r\n   if (bobj.repeatwait) { // if a repeat wait is set, then starting waiting for first repetition\r\n      buttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatwait);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// ButtonMouseUp(event)\r\n//\r\n\r\nSocialCalc.ButtonMouseUp = function(event) {\r\n\r\n   var e = event || window.event;\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n   var bobj = buttoninfo.buttonElement;\r\n\r\n   if (buttoninfo.timer) { // if repeating, cancel it\r\n      window.clearTimeout(buttoninfo.timer); // cancel timer\r\n      buttoninfo.timer = null;\r\n      }\r\n\r\n   if (!buttoninfo.buttonDown) return; // already did this (e.g., in IE, releaseCapture fires losecapture)\r\n   SocialCalc.StopPropagation(e);\r\n   if (document.removeEventListener) { // DOM Level 2\r\n      document.removeEventListener(\"mouseup\", SocialCalc.ButtonMouseUp, true);\r\n      }\r\n   else if (document.detachEvent) { // IE\r\n      bobj.element.detachEvent(\"onlosecapture\", SocialCalc.ButtonMouseUp);\r\n      bobj.element.detachEvent(\"onmouseup\", SocialCalc.ButtonMouseUp);\r\n      bobj.element.releaseCapture();\r\n      }\r\n\r\n   if (buttoninfo.buttonElement.downstyle) {\r\n      if (buttoninfo.doingHover)\r\n         SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.hoverstyle);\r\n      else\r\n         SocialCalc.setStyles(bobj.element, buttoninfo.buttonElement.normalstyle);\r\n      }\r\n\r\n   buttoninfo.buttonDown = false;\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.MouseUp) bobj.functionobj.MouseUp(e, buttoninfo, bobj);\r\n\r\n   }\r\n\r\n//\r\n// ButtonRepeat()\r\n//\r\n\r\nSocialCalc.ButtonRepeat = function() {\r\n\r\n   var buttoninfo = SocialCalc.ButtonInfo;\r\n   var bobj = buttoninfo.buttonElement;\r\n\r\n   if (!bobj) return;\r\n\r\n   if (bobj && bobj.functionobj && bobj.functionobj.Repeat) bobj.functionobj.Repeat(null, buttoninfo, bobj);\r\n\r\n   buttoninfo.timer = window.setTimeout(SocialCalc.ButtonRepeat, bobj.repeatinterval || 100);\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// MouseWheel functions:\r\n//\r\n// *************************************\r\n\r\nSocialCalc.MouseWheelInfo = {\r\n\r\n   // There is only one of these -- no \"new\" is done.\r\n   // The mousewheel only affects the one area the mouse pointer is over\r\n   // The registeredElements array is used to identify items.\r\n\r\n   // One item for each element to respond to the mousewheel, each an object with:\r\n   //    .element, .functionobj\r\n\r\n   registeredElements: []\r\n\r\n   }\r\n\r\n//\r\n// MouseWheelRegister(element, functionobj) - make element respond to mousewheel\r\n//\r\n\r\nSocialCalc.MouseWheelRegister = function(element, functionobj) {\r\n\r\n   var mousewheelinfo = SocialCalc.MouseWheelInfo;\r\n\r\n   mousewheelinfo.registeredElements.push(\r\n      {element: element, functionobj: functionobj}\r\n      );\r\n\r\n   if (element.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      element.addEventListener(\"DOMMouseScroll\", SocialCalc.ProcessMouseWheel, false);\r\n      element.addEventListener(\"mousewheel\", SocialCalc.ProcessMouseWheel, false); // Opera needs this\r\n      }\r\n   else if (element.attachEvent) { // IE 5+\r\n      element.attachEvent(\"onmousewheel\", SocialCalc.ProcessMouseWheel);\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.ProcessMouseWheel = function(e) {\r\n\r\n   var event = e || window.event;\r\n   var delta;\r\n\r\n   if (SocialCalc.Keyboard.passThru) return; // ignore\r\n\r\n   var mousewheelinfo = SocialCalc.MouseWheelInfo;\r\n   var ele = event.target || event.srcElement; // source object is often within what we want\r\n   var wobj;\r\n\r\n   for (wobj=null; !wobj && ele; ele=ele.parentNode) { // go up tree looking for one of our elements\r\n      wobj = SocialCalc.LookupElement(ele, mousewheelinfo.registeredElements);\r\n      }\r\n   if (!wobj) return; // not one of our elements\r\n\r\n   if (event.wheelDelta) {\r\n      delta = event.wheelDelta/120;\r\n      }\r\n   else delta = -event.detail/3;\r\n   if (!delta) delta = 0;\r\n\r\n   if (wobj.functionobj && wobj.functionobj.WheelMove) wobj.functionobj.WheelMove(event, delta, mousewheelinfo, wobj);\r\n\r\n   if (event.preventDefault) event.preventDefault();\r\n   event.returnValue = false;\r\n\r\n   }\r\n\r\n// *************************************\r\n//\r\n// Keyboard functions:\r\n//\r\n// For more information about keyboard handling, see: http://unixpapa.com/js/key.html\r\n//\r\n// *************************************\r\n\r\nSocialCalc.keyboardTables = {\r\n\r\n   specialKeysCommon: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n      46: \"[del]\", 113: \"[f2]\"\r\n      },\r\n\r\n   specialKeysIE: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n      46: \"[del]\", 113: \"[f2]\"\r\n      },\r\n\r\n   controlKeysIE: {\r\n      67: \"[ctrl-c]\",\r\n      83: \"[ctrl-s]\",\r\n      86: \"[ctrl-v]\",\r\n      88: \"[ctrl-x]\",\r\n      90: \"[ctrl-z]\"\r\n      },\r\n\r\n   specialKeysOpera: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\",\r\n      45: \"[ins]\", // issues with releases before 9.5 - same as \"-\" (\"-\" changed in 9.5)\r\n      46: \"[del]\", // issues with releases before 9.5 - same as \".\" (\".\" changed in 9.5)\r\n      113: \"[f2]\"\r\n      },\r\n\r\n   controlKeysOpera: {\r\n      67: \"[ctrl-c]\",\r\n      83: \"[ctrl-s]\",\r\n      86: \"[ctrl-v]\",\r\n      88: \"[ctrl-x]\",\r\n      90: \"[ctrl-z]\"\r\n      },\r\n\r\n   specialKeysSafari: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 63232: \"[aup]\", 63233: \"[adown]\",\r\n      63234: \"[aleft]\", 63235: \"[aright]\", 63272: \"[del]\", 63273: \"[home]\", 63275: \"[end]\", 63276: \"[pgup]\",\r\n      63277: \"[pgdn]\", 63237: \"[f2]\"\r\n      },\r\n\r\n   controlKeysSafari: {\r\n      99: \"[ctrl-c]\",\r\n      115: \"[ctrl-s]\",\r\n      118: \"[ctrl-v]\",\r\n      120: \"[ctrl-x]\",\r\n      122: \"[ctrl-z]\"\r\n      },\r\n\r\n   ignoreKeysSafari: {\r\n      63236: \"[f1]\", 63238: \"[f3]\", 63239: \"[f4]\", 63240: \"[f5]\", 63241: \"[f6]\", 63242: \"[f7]\",\r\n      63243: \"[f8]\", 63244: \"[f9]\", 63245: \"[f10]\", 63246: \"[f11]\", 63247: \"[f12]\", 63289: \"[numlock]\"\r\n      },\r\n\r\n   specialKeysFirefox: {\r\n      8: \"[backspace]\", 9: \"[tab]\", 13: \"[enter]\", 25: \"[tab]\", 27: \"[esc]\", 33: \"[pgup]\", 34: \"[pgdn]\",\r\n      35: \"[end]\", 36: \"[home]\", 37: \"[aleft]\", 38: \"[aup]\", 39: \"[aright]\", 40: \"[adown]\", 45: \"[ins]\",\r\n      46: \"[del]\", 113: \"[f2]\"\r\n      },\r\n\r\n   controlKeysFirefox: {\r\n      99: \"[ctrl-c]\",\r\n      115: \"[ctrl-s]\",\r\n      118: \"[ctrl-v]\",\r\n      120: \"[ctrl-x]\",\r\n      122: \"[ctrl-z]\"\r\n      },\r\n\r\n   ignoreKeysFirefox: {\r\n      16: \"[shift]\", 17: \"[ctrl]\", 18: \"[alt]\", 20: \"[capslock]\", 19: \"[pause]\", 44: \"[printscreen]\",\r\n      91: \"[windows]\", 92: \"[windows]\", 112: \"[f1]\", 114: \"[f3]\", 115: \"[f4]\", 116: \"[f5]\",\r\n      117: \"[f6]\", 118: \"[f7]\", 119: \"[f8]\", 120: \"[f9]\", 121: \"[f10]\", 122: \"[f11]\", 123: \"[f12]\",\r\n      144: \"[numlock]\", 145: \"[scrolllock]\", 224: \"[cmd]\"\r\n      }\r\n   }\r\n\r\nSocialCalc.Keyboard = {\r\n   areListener: false, // if true, we have been installed as a listener for keyboard events\r\n   focusTable: null, // the table editor object that gets keystrokes or null\r\n   passThru: null, // if not null, control element with focus to pass keyboard events to (has blur method), or \"true\"\r\n   didProcessKey: false, // did SocialCalc.ProcessKey in keydown\r\n   statusFromProcessKey: false, // the status from the keydown SocialCalc.ProcessKey\r\n   repeatingKeyPress: false, // some browsers (Opera, Gecko Mac) repeat special keys as KeyPress not KeyDown\r\n   chForProcessKey: \"\" // remember so can do repeat in those cases\r\n   };\r\n\r\nSocialCalc.KeyboardSetFocus = function(editor) {\r\n\r\n   SocialCalc.Keyboard.focusTable = editor;\r\n\r\n   if (!SocialCalc.Keyboard.areListener) {\r\n      document.onkeydown = SocialCalc.ProcessKeyDown;\r\n      document.onkeypress = SocialCalc.ProcessKeyPress;\r\n      SocialCalc.Keyboard.areListener = true;\r\n      }\r\n   if (SocialCalc.Keyboard.passThru) {\r\n      if (SocialCalc.Keyboard.passThru.blur) {\r\n         SocialCalc.Keyboard.passThru.blur();\r\n         }\r\n      SocialCalc.Keyboard.passThru = null;\r\n      }\r\n   window.focus();\r\n   }\r\n\r\nSocialCalc.KeyboardFocus = function() {\r\n\r\n   SocialCalc.Keyboard.passThru = null;\r\n   window.focus();\r\n\r\n   }\r\n\r\nSocialCalc.ProcessKeyDown = function(e) {\r\n\r\n   var kt = SocialCalc.keyboardTables;\r\n   kt.didProcessKey = false; // always start false\r\n   kt.statusFromProcessKey = false;\r\n   kt.repeatingKeyPress = false;\r\n\r\n   var ch=\"\";\r\n   var status=true;\r\n\r\n   if (SocialCalc._app) return; // // ignore in app - widgets need control\r\n   if (SocialCalc.Keyboard.passThru) return; // ignore\r\n\r\n   e = e || window.event;\r\n\r\n   if (e.which==undefined) { // IE\r\n      ch = kt.specialKeysCommon[e.keyCode];\r\n      if (!ch) {\r\n         if (e.ctrlKey) {\r\n            ch=kt.controlKeysIE[e.keyCode];\r\n            }\r\n         if (!ch)\r\n            return true;\r\n         }\r\n      status = SocialCalc.ProcessKey(ch, e);\r\n\r\n      if (!status) {\r\n         if (e.preventDefault) e.preventDefault();\r\n            e.returnValue = false;\r\n         }\r\n      }\r\n\r\n   else { \r\n      ch = kt.specialKeysCommon[e.keyCode];\r\n      if (!ch) {\r\n//         return true;\r\n         if (e.ctrlKey || e.metaKey) {\r\n            ch=kt.controlKeysIE[e.keyCode]; // this works here\r\n            }\r\n         if (!ch)\r\n            return true;\r\n         }\r\n\r\n      status = SocialCalc.ProcessKey(ch, e); // process the key\r\n      kt.didProcessKey = true; // remember what happened\r\n      kt.statusFromProcessKey = status;\r\n      kt.chForProcessKey = ch;\r\n      }\r\n\r\n   return status;\r\n\r\n   }\r\n\r\nSocialCalc.ProcessKeyPress = function(e) {\r\n\r\n   var kt = SocialCalc.keyboardTables;\r\n\r\n   var ch=\"\";\r\n\r\n   e = e || window.event;\r\n   if (SocialCalc._app) return; // // ignore in app - widgets need control\r\n   \r\n   if (SocialCalc.Keyboard.passThru) return; // ignore\r\n   if (kt.didProcessKey) { // already processed this key\r\n      if (kt.repeatingKeyPress) {\r\n         return SocialCalc.ProcessKey(kt.chForProcessKey, e); // process the same key as on KeyDown\r\n         }\r\n      else {\r\n         kt.repeatingKeyPress = true; // see if get another KeyPress before KeyDown\r\n         return kt.statusFromProcessKey; // do what it said to do\r\n         }\r\n      }\r\n\r\n   if (e.which==undefined) { // IE\r\n      // Note: Esc and Enter will come through here, too, if not stopped at KeyDown\r\n      ch=String.fromCharCode(e.keyCode); // convert to a character (special chars handled at ev1)\r\n      }\r\n\r\n   else { // not IE\r\n      if (!e.which)\r\n         return false; // ignore - special key\r\n      if (e.charCode==undefined) { // Opera\r\n         if (e.which!=0) { // character\r\n            if (e.which<32 || e.which==144) { // special char (144 is numlock)\r\n               ch = kt.specialKeysOpera[e.which];\r\n               if (ch) {\r\n                  return true;\r\n                  }\r\n               }\r\n            else {\r\n               if (e.ctrlKey) {\r\n                  ch=kt.controlKeysOpera[e.keyCode];\r\n                  }\r\n               else {\r\n                  ch = String.fromCharCode(e.which);\r\n                  }\r\n               }\r\n            }\r\n         else { // special char\r\n            return true;\r\n            }\r\n         }\r\n\r\n      else if (e.keyCode==0 && e.charCode==0) { // OLPC Fn key or something\r\n         return; // ignore\r\n         }\r\n\r\n      else if (e.keyCode==e.charCode) { // Safari\r\n         ch = kt.specialKeysSafari[e.keyCode];\r\n         if (!ch) {\r\n            if (kt.ignoreKeysSafari[e.keyCode]) // pass this through\r\n               return true;\r\n            if (e.metaKey) {\r\n               ch=kt.controlKeysSafari[e.keyCode];\r\n               }\r\n            else {\r\n               ch = String.fromCharCode(e.which);\r\n               }\r\n            }\r\n         }\r\n\r\n      else { // Firefox\r\n         if (kt.specialKeysFirefox[e.keyCode]) {\r\n            return true;\r\n            }\r\n         ch = String.fromCharCode(e.which);\r\n         if (e.ctrlKey || e.metaKey) {\r\n            ch = kt.controlKeysFirefox[e.which];\r\n            }\r\n         }\r\n      }\r\n\r\n   var status = SocialCalc.ProcessKey(ch, e);\r\n\r\n   if (!status) {\r\n      if (e.preventDefault) e.preventDefault();\r\n      e.returnValue = false;\r\n      }\r\n\r\n   return status;\r\n\r\n   }\r\n\r\n//\r\n// status = SocialCalc.ProcessKey(ch, e)\r\n//\r\n// Take a key representation as a character string and dispatch to appropriate routine\r\n//\r\n\r\nSocialCalc.ProcessKey = function (ch, e) {\r\n   var ft = SocialCalc.Keyboard.focusTable;\r\n   if (!ft) return true; // we're not handling it -- let browser do default\r\n   return ft.EditorProcessKey(ch, e);\r\n   }\r\n\r\n\r\n","//\r\n/*\r\n// SocialCalc Number Formatting Library\r\n//\r\n// Part of the SocialCalc package.\r\n//\r\n// (c) Copyright 2008 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\r\n\r\nSocialCalc.FormatNumber = {};\r\n\r\nSocialCalc.FormatNumber.format_definitions = {}; // Parsed formats are stored here globally\r\n\r\n// Most constants that are often customized for localization are in the SocialCalc.Constants module.\r\n// If you use this module standalone, provide at least the \"FormatNumber\" values.\r\n//\r\n\r\n// The following values may be customized externally for further localization of the format definitions themselves,\r\n// but that would make them incompatible with other uses and is discouraged.\r\n//\r\n\r\nSocialCalc.FormatNumber.separatorchar = \",\";\r\nSocialCalc.FormatNumber.decimalchar = \".\";\r\nSocialCalc.FormatNumber.daynames = [\"Sunday\", \"Monday\", \"Tuesday\", \"Wednesday\", \"Thursday\", \"Friday\", \"Saturday\"];\r\nSocialCalc.FormatNumber.daynames3 = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\nSocialCalc.FormatNumber.monthnames3 = [\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"];\r\nSocialCalc.FormatNumber.monthnames = [\"January\", \"February\", \"March\", \"April\", \"May\", \"June\", \"July\", \"August\", \"September\",\r\n                                      \"October\", \"November\", \"December\"];\r\n\r\nSocialCalc.FormatNumber.allowedcolors =\r\n   {BLACK: \"#000000\", BLUE: \"#0000FF\", CYAN: \"#00FFFF\", GREEN: \"#00FF00\", MAGENTA: \"#FF00FF\",\r\n    RED: \"#FF0000\", WHITE: \"#FFFFFF\", YELLOW: \"#FFFF00\"};\r\n\r\nSocialCalc.FormatNumber.alloweddates =\r\n   {H: \"h]\", M: \"m]\", MM: \"mm]\", S: \"s]\", SS: \"ss]\"};\r\n\r\n// Other constants\r\n\r\nSocialCalc.FormatNumber.commands =\r\n   {copy: 1, color: 2, integer_placeholder: 3, fraction_placeholder: 4, decimal: 5,\r\n    currency: 6, general:7, separator: 8, date: 9, comparison: 10, section: 11, style: 12};\r\n\r\nSocialCalc.FormatNumber.datevalues = {julian_offset: 2415019, seconds_in_a_day: 24 * 60 * 60, seconds_in_an_hour: 60 * 60};\r\n\r\n/* *******************\r\n\r\n result = SocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char)\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.formatNumberWithFormat = function(rawvalue, format_string, currency_char) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var scfn = SocialCalc.FormatNumber;\r\n\r\n   var op, operandstr, fromend, cval, operandstrlc;\r\n   var startval, estartval;\r\n   var hrs, mins, secs, ehrs, emins, esecs, ampmstr, ymd;\r\n   var minOK, mpos;\r\n   var result=\"\";\r\n   var thisformat;\r\n   var section, gotcomparison, compop, compval, cpos, oppos;\r\n   var sectioninfo;\r\n   var i, decimalscale, scaledvalue, strvalue, strparts, integervalue, fractionvalue;\r\n   var integerdigits2, integerpos, fractionpos, textcolor, textstyle, separatorchar, decimalchar;\r\n   var value; // working copy to change sign, etc.\r\n\r\n   if (typeof(rawvalue) == \"string\" && !rawvalue.length) return \"\";\r\n\r\n   value = rawvalue-0; // make sure a number\r\n   if (!isFinite(value)) {\r\n      if (typeof(rawvalue) == \"string\") { // if original was a string, try to format it\r\n         return scfn.formatTextWithFormat(rawvalue, format_string);\r\n         }\r\n      else {\r\n         return \"NaN\";\r\n         }\r\n      }\r\n   rawvalue = value;\r\n\r\n   var negativevalue = value < 0 ? 1 : 0; // determine sign, etc.\r\n   if (negativevalue) value = -value;\r\n   var zerovalue = value == 0 ? 1 : 0;\r\n\r\n   currency_char = currency_char || scc.FormatNumber_DefaultCurrency;\r\n\r\n   scfn.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed\r\n   thisformat = scfn.format_definitions[format_string]; // Get format structure\r\n\r\n   if (!thisformat) throw \"Format not parsed error!\";\r\n\r\n   section = thisformat.sectioninfo.length - 1; // get number of sections - 1\r\n\r\n   if (thisformat.hascomparison) { // has comparisons - determine which section\r\n      section = 0; // set to which section we will use\r\n      gotcomparison = 0; // this section has no comparison\r\n      for (cpos=0; ;cpos++) { // scan for comparisons\r\n         op = thisformat.operators[cpos];\r\n         operandstr = thisformat.operands[cpos]; // get next operator and operand\r\n         if (!op) { // at end with no match\r\n            if (gotcomparison) { // if comparison but no match\r\n               format_string = \"General\"; // use default of General\r\n               scfn.parse_format_string(scfn.format_definitions, format_string);\r\n               thisformat = scfn.format_definitions[format_string];\r\n               section = 0;\r\n               }\r\n            break; // if no comparision, matches on this section\r\n            }\r\n         if (op == scfn.commands.section) { // end of section\r\n            if (!gotcomparison) { // no comparison, so it's a match\r\n               break;\r\n               }\r\n            gotcomparison = 0;\r\n            section++; // check out next one\r\n            continue;\r\n            }\r\n         if (op == scfn.commands.comparison) { // found a comparison - do we meet it?\r\n            i=operandstr.indexOf(\":\");\r\n            compop=operandstr.substring(0,i);\r\n            compval=operandstr.substring(i+1)-0;\r\n            if ((compop == \"<\" && rawvalue < compval) ||\r\n                (compop == \"<=\" && rawvalue <= compval) ||\r\n                (compop == \"=\" && rawvalue == compval) ||\r\n                (compop == \"<>\" && rawvalue != compval) ||\r\n                (compop == \">=\" && rawvalue >= compval) ||\r\n                (compop == \">\" && rawvalue > compval)) { // a match\r\n               break;\r\n               }\r\n            gotcomparison = 1;\r\n            }\r\n         }\r\n      }\r\n   else if (section > 0) { // more than one section (separated by \";\")\r\n      if (section == 1) { // two sections\r\n         if (negativevalue) {\r\n            negativevalue = 0; // sign will provided by section, not automatically\r\n            section = 1; // use second section for negative values\r\n            }\r\n         else {\r\n            section = 0; // use first for all others\r\n            }\r\n         }\r\n      else if (section == 2 || section == 3) { // three or four sections\r\n         if (negativevalue) {\r\n            negativevalue = 0; // sign will provided by section, not automatically\r\n            section = 1; // use second section for negative values\r\n            }\r\n         else if (zerovalue) {\r\n            section = 2; // use third section for zero values\r\n            }\r\n         else {\r\n            section = 0; // use first for positive\r\n            }\r\n         }\r\n      }\r\n\r\n   sectioninfo = thisformat.sectioninfo[section]; // look at values for our section\r\n\r\n   if (sectioninfo.commas > 0) { // scale by thousands\r\n      for (i=0; i<sectioninfo.commas; i++) {\r\n         value /= 1000;\r\n         }\r\n      }\r\n   if (sectioninfo.percent > 0) { // do percent scaling\r\n      for (i=0; i<sectioninfo.percent; i++) {\r\n         value *= 100;\r\n         }\r\n      }\r\n\r\n   decimalscale = 1; // cut down to required number of decimal digits\r\n   for (i=0; i<sectioninfo.fractiondigits; i++) {\r\n      decimalscale *= 10;\r\n      }\r\n   scaledvalue = Math.floor(value * decimalscale + 0.5);\r\n   scaledvalue = scaledvalue / decimalscale;\r\n\r\n   if (typeof scaledvalue != \"number\") return \"NaN\";\r\n   if (!isFinite(scaledvalue)) return \"NaN\";\r\n\r\n   strvalue = scaledvalue+\"\"; // convert to string (Number.toFixed doesn't do all we need)\r\n\r\n//   strvalue = value.toFixed(sectioninfo.fractiondigits); // cut down to required number of decimal digits\r\n                                                         // and convert to string\r\n\r\n   if (scaledvalue == 0 && (sectioninfo.fractiondigits || sectioninfo.integerdigits)) {\r\n      negativevalue = 0; // no \"-0\" unless using multiple sections or General\r\n      }\r\n\r\n   if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\r\n      return rawvalue+\"\"; // Just return plain converted raw value\r\n      }\r\n\r\n   strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\r\n   if (!strparts) return \"NaN\"; // if not a number\r\n   integervalue = strparts[1];\r\n   if (!integervalue || integervalue==\"0\") integervalue=\"\";\r\n   fractionvalue = strparts[2];\r\n   if (!fractionvalue) fractionvalue = \"\";\r\n\r\n   if (sectioninfo.hasdate) { // there are date placeholders\r\n      if (rawvalue < 0) { // bad date\r\n         return \"??-???-??&nbsp;??:??:??\";\r\n         }\r\n      startval = (rawvalue-Math.floor(rawvalue)) * scfn.datevalues.seconds_in_a_day; // get date/time parts\r\n      estartval = rawvalue * scfn.datevalues.seconds_in_a_day; // do elapsed time version, too\r\n      hrs = Math.floor(startval / scfn.datevalues.seconds_in_an_hour);\r\n      ehrs = Math.floor(estartval / scfn.datevalues.seconds_in_an_hour);\r\n      startval = startval - hrs * scfn.datevalues.seconds_in_an_hour;\r\n      mins = Math.floor(startval / 60);\r\n      emins = Math.floor(estartval / 60);\r\n      secs = startval - mins * 60;\r\n      decimalscale = 1; // round appropriately depending if there is ss.0\r\n      for (i=0; i<sectioninfo.fractiondigits; i++) {\r\n         decimalscale *= 10;\r\n         }\r\n      secs = Math.floor(secs * decimalscale + 0.5);\r\n      secs = secs / decimalscale;\r\n      esecs = Math.floor(estartval * decimalscale + 0.5);\r\n      esecs = esecs / decimalscale;\r\n      if (secs >= 60) { // handle round up into next second, minute, etc.\r\n         secs = 0;\r\n         mins++; emins++;\r\n         if (mins >= 60) {\r\n            mins = 0;\r\n            hrs++; ehrs++;\r\n            if (hrs >= 24) {\r\n               hrs = 0;\r\n               rawvalue++;\r\n               }\r\n            }\r\n         }\r\n      fractionvalue = (secs-Math.floor(secs))+\"\"; // for \"hh:mm:ss.000\"\r\n      fractionvalue = fractionvalue.substring(2); // skip \"0.\"\r\n\r\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(rawvalue+scfn.datevalues.julian_offset));\r\n\r\n      minOK = 0; // says \"m\" can be minutes if true\r\n      mspos = sectioninfo.sectionstart; // m scan position in ops\r\n      for ( ; ; mspos++) { // scan for \"m\" and \"mm\" to see if any minutes fields, and am/pm\r\n         op = thisformat.operators[mspos];\r\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\r\n         if (!op) break; // don't go past end\r\n         if (op==scfn.commands.section) break;\r\n         if (op==scfn.commands.date) {\r\n            if ((operandstr.toLowerCase()==\"am/pm\" || operandstr.toLowerCase()==\"a/p\") && !ampmstr) {\r\n               if (hrs >= 12) {\r\n                  hrs -= 12;\r\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_pm1 : scc.s_FormatNumber_pm; // \"P\" : \"PM\";\r\n                  }\r\n               else {\r\n                  ampmstr = operandstr.toLowerCase()==\"a/p\" ? scc.s_FormatNumber_am1 : scc.s_FormatNumber_am; // \"A\" : \"AM\";\r\n                  }\r\n               if (operandstr.indexOf(ampmstr)<0)\r\n                  ampmstr = ampmstr.toLowerCase(); // have case match case in format\r\n               }\r\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\r\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\r\n               }\r\n            if (operandstr.charAt(0)==\"h\") {\r\n               minOK = 1; // m following h or hh or [h] is minutes not months\r\n               }\r\n            else {\r\n               minOK = 0;\r\n               }\r\n            }\r\n         else if (op!=scfn.commands.copy) { // copying chars can be between h and m\r\n            minOK = 0;\r\n            }\r\n         }\r\n      minOK = 0;\r\n      for (--mspos; ; mspos--) { // scan other way for s after m\r\n         op = thisformat.operators[mspos];\r\n         operandstr = thisformat.operands[mspos]; // get next operator and operand\r\n         if (!op) break; // don't go past end\r\n         if (op==scfn.commands.section) break;\r\n         if (op==scfn.commands.date) {\r\n            if (minOK && (operandstr==\"m\" || operandstr==\"mm\")) {\r\n               thisformat.operands[mspos] += \"in\"; // turn into \"min\" or \"mmin\"\r\n               }\r\n            if (operandstr==\"ss\") {\r\n               minOK = 1; // m before ss is minutes not months\r\n               }\r\n            else {\r\n               minOK = 0;\r\n               }\r\n            }\r\n         else if (op!=scfn.commands.copy) { // copying chars can be between ss and m\r\n            minOK = 0;\r\n            }\r\n         }\r\n      }\r\n\r\n   integerdigits2 = 0; // init counters, etc.\r\n   integerpos = 0;\r\n   fractionpos = 0;\r\n   textcolor = \"\";\r\n   textstyle = \"\";\r\n   separatorchar = scc.FormatNumber_separatorchar;\r\n   if (separatorchar.indexOf(\" \")>=0) separatorchar = separatorchar.replace(/ /g, \"&nbsp;\");\r\n   decimalchar = scc.FormatNumber_decimalchar;\r\n   if (decimalchar.indexOf(\" \")>=0) decimalchar = decimalchar.replace(/ /g, \"&nbsp;\");\r\n\r\n   oppos = sectioninfo.sectionstart;\r\n\r\n   while (op = thisformat.operators[oppos]) { // execute format\r\n      operandstr = thisformat.operands[oppos++]; // get next operator and operand\r\n\r\n      if (op == scfn.commands.copy) { // put char in result\r\n         result += operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.color) { // set color\r\n         textcolor = operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.style) { // set style\r\n         textstyle = operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.integer_placeholder) { // insert number part\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            negativevalue = 0;\r\n            }\r\n         integerdigits2++;\r\n         if (integerdigits2 == 1) { // first one\r\n            if (integervalue.length > sectioninfo.integerdigits) { // see if integer wider than field\r\n               for (;integerpos < (integervalue.length - sectioninfo.integerdigits); integerpos++) {\r\n                  result += integervalue.charAt(integerpos);\r\n                  if (sectioninfo.thousandssep) { // see if this is a separator position\r\n                     fromend = integervalue.length - integerpos - 1;\r\n                     if (fromend > 2 && fromend % 3 == 0) {\r\n                        result += separatorchar;\r\n                        }\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n         if (integervalue.length < sectioninfo.integerdigits\r\n             && integerdigits2 <= sectioninfo.integerdigits - integervalue.length) { // field is wider than value\r\n            if (operandstr == \"0\" || operandstr == \"?\") { // fill with appropriate characters\r\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\r\n               if (sectioninfo.thousandssep) { // see if this is a separator position\r\n                  fromend = sectioninfo.integerdigits - integerdigits2;\r\n                  if (fromend > 2 && fromend % 3 == 0) {\r\n                     result += separatorchar;\r\n                     }\r\n                  }\r\n               }\r\n            }\r\n         else { // normal integer digit - add it\r\n            result += integervalue.charAt(integerpos);\r\n            if (sectioninfo.thousandssep) { // see if this is a separator position\r\n               fromend = integervalue.length - integerpos - 1;\r\n               if (fromend > 2 && fromend % 3 == 0) {\r\n                  result += separatorchar;\r\n                  }\r\n               }\r\n            integerpos++;\r\n            }\r\n         }\r\n      else if (op == scfn.commands.fraction_placeholder) { // add fraction part of number\r\n         if (fractionpos >= fractionvalue.length) {\r\n            if (operandstr == \"0\" || operandstr == \"?\") {\r\n               result += operandstr == \"0\" ? \"0\" : \"&nbsp;\";\r\n               }\r\n            }\r\n         else {\r\n            result += fractionvalue.charAt(fractionpos);\r\n            }\r\n         fractionpos++;\r\n         }\r\n\r\n      else if (op == scfn.commands.decimal) { // decimal point\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            negativevalue = 0;\r\n            }\r\n         result += decimalchar;\r\n         }\r\n\r\n      else if (op == scfn.commands.currency) { // currency symbol\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            negativevalue = 0;\r\n            }\r\n         result += operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.general) { // insert \"General\" conversion\r\n\r\n         // *** Cut down number of significant digits to avoid floating point artifacts:\r\n\r\n         if (value!=0) { // only if non-zero\r\n            var factor = Math.floor(Math.LOG10E * Math.log(value)); // get integer magnitude as a power of 10\r\n            factor = Math.pow(10, 13-factor); // turn into scaling factor\r\n            value = Math.floor(factor * value + 0.5)/factor; // scale positive value, round, undo scaling\r\n            if (!isFinite(value)) return \"NaN\";\r\n            }\r\n         if (negativevalue) {\r\n            result += \"-\";\r\n            }\r\n         strvalue = value+\"\"; // convert original value to string\r\n         if (strvalue.indexOf(\"e\")>=0) { // converted to scientific notation\r\n            result += strvalue;\r\n            continue;\r\n            }\r\n         strparts=strvalue.match(/^\\+{0,1}(\\d*)(?:\\.(\\d*)){0,1}$/); // get integer and fraction parts\r\n         integervalue = strparts[1];\r\n         if (!integervalue || integervalue==\"0\") integervalue=\"\";\r\n         fractionvalue = strparts[2];\r\n         if (!fractionvalue) fractionvalue = \"\";\r\n         integerpos = 0;\r\n         fractionpos = 0;\r\n         if (integervalue.length) {\r\n            for (;integerpos < integervalue.length; integerpos++) {\r\n               result += integervalue.charAt(integerpos);\r\n               if (sectioninfo.thousandssep) { // see if this is a separator position\r\n                  fromend = integervalue.length - integerpos - 1;\r\n                  if (fromend > 2 && fromend % 3 == 0) {\r\n                     result += separatorchar;\r\n                     }\r\n                  }\r\n               }\r\n             }\r\n         else {\r\n            result += \"0\";\r\n            }\r\n         if (fractionvalue.length) {\r\n            result += decimalchar;\r\n            for (;fractionpos < fractionvalue.length; fractionpos++) {\r\n               result += fractionvalue.charAt(fractionpos);\r\n               }\r\n            }\r\n         }\r\n      else if (op==scfn.commands.date) { // date placeholder\r\n         operandstrlc = operandstr.toLowerCase();\r\n         if (operandstrlc==\"y\" || operandstrlc==\"yy\") {\r\n            result += (ymd.year+\"\").substring(2);\r\n            }\r\n         else if (operandstrlc==\"yyyy\") {\r\n            result += ymd.year+\"\";\r\n            }\r\n         else if (operandstrlc==\"d\") {\r\n            result += ymd.day+\"\";\r\n            }\r\n         else if (operandstrlc==\"dd\") {\r\n            cval = 1000 + ymd.day;\r\n            result += (cval+\"\").substr(2);\r\n            }\r\n         else if (operandstrlc==\"ddd\") {\r\n            cval = Math.floor(rawvalue+6) % 7;\r\n            result += scc.s_FormatNumber_daynames3[cval];\r\n            }\r\n         else if (operandstrlc==\"dddd\") {\r\n            cval = Math.floor(rawvalue+6) % 7;\r\n            result += scc.s_FormatNumber_daynames[cval];\r\n            }\r\n         else if (operandstrlc==\"m\") {\r\n            result += ymd.month+\"\";\r\n            }\r\n         else if (operandstrlc==\"mm\") {\r\n            cval = 1000 + ymd.month;\r\n            result += (cval+\"\").substr(2);\r\n            }\r\n         else if (operandstrlc==\"mmm\") {\r\n            result += scc.s_FormatNumber_monthnames3[ymd.month-1];\r\n            }\r\n         else if (operandstrlc==\"mmmm\") {\r\n            result += scc.s_FormatNumber_monthnames[ymd.month-1];\r\n            }\r\n         else if (operandstrlc==\"mmmmm\") {\r\n            result += scc.s_FormatNumber_monthnames[ymd.month-1].charAt(0);\r\n            }\r\n         else if (operandstrlc==\"h\") {\r\n            result += hrs+\"\";\r\n            }\r\n         else if (operandstrlc==\"h]\") {\r\n            result += ehrs+\"\";\r\n            }\r\n         else if (operandstrlc==\"mmin\") {\r\n            cval = (1000 + mins)+\"\";\r\n            result += cval.substr(2);\r\n            }\r\n         else if (operandstrlc==\"mm]\") {\r\n            if (emins < 100) {\r\n               cval = (1000 + emins)+\"\";\r\n               result += cval.substr(2);\r\n               }\r\n            else {\r\n               result += emins+\"\";\r\n               }\r\n            }\r\n         else if (operandstrlc==\"min\") {\r\n            result += mins+\"\";\r\n            }\r\n         else if (operandstrlc==\"m]\") {\r\n            result += emins+\"\";\r\n            }\r\n         else if (operandstrlc==\"hh\") {\r\n            cval = (1000 + hrs)+\"\";\r\n            result += cval.substr(2);\r\n            }\r\n         else if (operandstrlc==\"s\") {\r\n            cval = Math.floor(secs);\r\n            result += cval+\"\";\r\n            }\r\n         else if (operandstrlc==\"ss\") {\r\n            cval = (1000 + Math.floor(secs))+\"\";\r\n            result += cval.substr(2);\r\n            }\r\n         else if (operandstrlc==\"am/pm\" || operandstrlc==\"a/p\") {\r\n            result += ampmstr;\r\n            }\r\n         else if (operandstrlc==\"ss]\") {\r\n            if (esecs < 100) {\r\n               cval = (1000 + Math.floor(esecs))+\"\";\r\n               result += cval.substr(2);\r\n               }\r\n            else {\r\n               cval = Math.floor(esecs);\r\n               result += cval+\"\";\r\n               }\r\n            }\r\n         }\r\n      else if (op == scfn.commands.section) { // end of section\r\n         break;\r\n         }\r\n\r\n      else if (op == scfn.commands.comparison) { // ignore\r\n         continue;\r\n         }\r\n\r\n      else {\r\n         result += \"!! Parse error !!\";\r\n         }\r\n      }\r\n\r\n   if (textcolor) {\r\n      result = '<span style=\"color:'+textcolor+';\">'+result+'</span>';\r\n      }\r\n   if (textstyle) {\r\n      result = '<span style=\"'+textstyle+';\">'+result+'</span>';\r\n      }\r\n\r\n   return result;\r\n\r\n   };\r\n\r\n/* *******************\r\n\r\n result = SocialCalc.FormatNumber.formatTextWithFormat = function(rawvalue, format_string)\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.formatTextWithFormat = function(rawvalue, format_string) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var scfn = SocialCalc.FormatNumber;\r\n   var value = rawvalue+\"\";\r\n   var result = \"\";\r\n   var section;\r\n   var sectioninfo;\r\n   var oppos;\r\n   var operandstr;\r\n   var textcolor = \"\";\r\n   var textstyle = \"\";\r\n\r\n   scfn.parse_format_string(scfn.format_definitions, format_string); // make sure format is parsed\r\n   thisformat = scfn.format_definitions[format_string]; // Get format structure\r\n\r\n   if (!thisformat) throw \"Format not parsed error!\";\r\n\r\n   section = thisformat.sectioninfo.length - 1; // get number of sections - 1\r\n   if (section == 0) {\r\n      section = 0;\r\n      }\r\n   else if (section == 3) {\r\n      section = 3;\r\n      }\r\n   else {\r\n      return value;\r\n      }\r\n\r\n   sectioninfo = thisformat.sectioninfo[section]; // look at values for our section\r\n   oppos = sectioninfo.sectionstart;\r\n\r\n   while (op = thisformat.operators[oppos]) { // execute format\r\n      operandstr = thisformat.operands[oppos++]; // get next operator and operand\r\n\r\n      if (op == scfn.commands.copy) { // put char in result\r\n         if (operandstr == \"@\") {\r\n            result += value;\r\n            }\r\n         else {\r\n            result += operandstr.replace(/ /g, \"&nbsp;\");\r\n            }\r\n         }\r\n\r\n      else if (op == scfn.commands.color) { // set color\r\n         textcolor = operandstr;\r\n         }\r\n\r\n      else if (op == scfn.commands.style) { // set style\r\n         textstyle = operandstr;\r\n         }\r\n      }\r\n\r\n   if (textcolor) {\r\n      result = '<span style=\"color:'+textcolor+';\">'+result+'</span>';\r\n      }\r\n   if (textstyle) {\r\n      result = '<span style=\"'+textstyle+';\">'+result+'</span>';\r\n      }\r\n\r\n   return result;\r\n\r\n   };\r\n\r\n/* *******************\r\n\r\n SocialCalc.FormatNumber.parse_format_string(format_defs, format_string)\r\n\r\n Takes a format string (e.g., \"#,##0.00_);(#,##0.00)\") and fills in format_defs with the parsed info\r\n\r\n format_defs\r\n    [\"#,##0.0\"]->{} - elements in the hash are one hash for each format\r\n       .operators->[] - array of operators from parsing the format string (each a number)\r\n       .operands->[] - array of corresponding operators (each usually a string)\r\n       .sectioninfo->[] - one hash for each section of the format\r\n          .start\r\n          .integerdigits\r\n          .fractiondigits\r\n          .commas\r\n          .percent\r\n          .thousandssep\r\n          .hasdates\r\n       .hascomparison - true if any section has [<100], etc.\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.parse_format_string = function(format_defs, format_string) {\r\n\r\n   var scfn = SocialCalc.FormatNumber;\r\n\r\n   var thisformat, section, sectionfinfo;\r\n   var integerpart = 1; // start out in integer part\r\n   var lastwasinteger; // last char was an integer placeholder\r\n   var lastwasslash; // last char was a backslash - escaping following character\r\n   var lastwasasterisk; // repeat next char\r\n   var lastwasunderscore; // last char was _ which picks up following char for width\r\n   var inquote, quotestr; // processing a quoted string\r\n   var inbracket, bracketstr, bracketdata; // processing a bracketed string\r\n   var ingeneral, gpos; // checks for characters \"General\"\r\n   var ampmstr, part; // checks for characters \"A/P\" and \"AM/PM\"\r\n   var indate; // keeps track of date/time placeholders\r\n   var chpos; // character position being looked at\r\n   var ch; // character being looked at\r\n\r\n   if (format_defs[format_string]) return; // already defined - nothing to do\r\n\r\n   thisformat = {operators: [], operands: [], sectioninfo: [{}]}; // create info structure for this format\r\n   format_defs[format_string] = thisformat; // add to other format definitions\r\n\r\n   section = 0; // start with section 0\r\n   sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\r\n   sectioninfo.sectionstart = 0; // position in operands that starts this section\r\n   sectioninfo.integerdigits = 0; // number of integer-part placeholders\r\n   sectioninfo.fractiondigits = 0; // fraction placeholders\r\n   sectioninfo.commas = 0; // commas encountered, to handle scaling\r\n   sectioninfo.percent = 0; // times to scale by 100\r\n\r\n   for (chpos=0; chpos<format_string.length; chpos++) { // parse\r\n      ch = format_string.charAt(chpos); // get next char to examine\r\n      if (inquote) {\r\n         if (ch == '\"') {\r\n            inquote = 0;\r\n            thisformat.operators.push(scfn.commands.copy);\r\n            thisformat.operands.push(quotestr);\r\n            continue;\r\n            }\r\n         quotestr += ch;\r\n         continue;\r\n         }\r\n      if (inbracket) {\r\n         if (ch==']') {\r\n            inbracket = 0;\r\n            bracketdata=SocialCalc.FormatNumber.parse_format_bracket(bracketstr);\r\n            if (bracketdata.operator==scfn.commands.separator) {\r\n               sectioninfo.thousandssep = 1; // explicit [,]\r\n               continue;\r\n               }\r\n            if (bracketdata.operator==scfn.commands.date) {\r\n               sectioninfo.hasdate = 1;\r\n               }\r\n            if (bracketdata.operator==scfn.commands.comparison) {\r\n               thisformat.hascomparison = 1;\r\n               }\r\n            thisformat.operators.push(bracketdata.operator);\r\n            thisformat.operands.push(bracketdata.operand);\r\n            continue;\r\n            }\r\n         bracketstr += ch;\r\n         continue;\r\n         }\r\n      if (lastwasslash) {\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch);\r\n         lastwasslash=false;\r\n         continue;\r\n         }\r\n      if (lastwasasterisk) {\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch+ch+ch+ch+ch); // do 5 of them since no real tabs\r\n         lastwasasterisk=false;\r\n         continue;\r\n         }\r\n      if (lastwasunderscore) {\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(\"&nbsp;\");\r\n         lastwasunderscore=false;\r\n         continue;\r\n         }\r\n      if (ingeneral) {\r\n         if (\"general\".charAt(ingeneral)==ch.toLowerCase()) {\r\n            ingeneral++;\r\n            if (ingeneral == 7) {\r\n               thisformat.operators.push(scfn.commands.general);\r\n               thisformat.operands.push(ch);\r\n               ingeneral=0;\r\n               }\r\n            continue;\r\n            }\r\n         ingeneral = 0;\r\n         }\r\n      if (indate) { // last char was part of a date placeholder\r\n         if (indate.charAt(0)==ch) { // another of the same char\r\n            indate += ch; // accumulate it\r\n            continue;\r\n            }\r\n         thisformat.operators.push(scfn.commands.date); // something else, save date info\r\n         thisformat.operands.push(indate);\r\n         sectioninfo.hasdate=1;\r\n         indate = \"\";\r\n         }\r\n      if (ampmstr) {\r\n         ampmstr += ch;\r\n         part=ampmstr.toLowerCase();\r\n         if (part!=\"am/pm\".substring(0,part.length) && part!=\"a/p\".substring(0,part.length)) {\r\n            ampstr=\"\";\r\n            }\r\n         else if (part==\"am/pm\" || part==\"a/p\") {\r\n            thisformat.operators.push(scfn.commands.date);\r\n            thisformat.operands.push(ampmstr);\r\n            ampmstr = \"\";\r\n            }\r\n         continue;\r\n         }\r\n      if (ch==\"#\" || ch==\"0\" || ch==\"?\") { // placeholder\r\n         if (integerpart) {\r\n            sectioninfo.integerdigits++;\r\n            if (sectioninfo.commas) { // comma inside of integer placeholders\r\n               sectioninfo.thousandssep = 1; // any number is thousands separator\r\n               sectioninfo.commas = 0; // reset count of \"thousand\" factors\r\n               }\r\n            lastwasinteger = 1;\r\n            thisformat.operators.push(scfn.commands.integer_placeholder);\r\n            thisformat.operands.push(ch);\r\n            }\r\n         else {\r\n            sectioninfo.fractiondigits++;\r\n            lastwasinteger = 1;\r\n            thisformat.operators.push(scfn.commands.fraction_placeholder);\r\n            thisformat.operands.push(ch);\r\n            }\r\n         }\r\n      else if (ch==\".\") { // decimal point\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.decimal);\r\n         thisformat.operands.push(ch);\r\n         integerpart = 0;\r\n         }\r\n      else if (ch=='$') { // currency char\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.currency);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      else if (ch==\",\") {\r\n         if (lastwasinteger) {\r\n            sectioninfo.commas++;\r\n            }\r\n         else {\r\n            thisformat.operators.push(scfn.commands.copy);\r\n            thisformat.operands.push(ch);\r\n            }\r\n         }\r\n      else if (ch==\"%\") {\r\n         lastwasinteger = 0;\r\n         sectioninfo.percent++;\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      else if (ch=='\"') {\r\n         lastwasinteger = 0;\r\n         inquote = 1;\r\n         quotestr = \"\";\r\n         }\r\n      else if (ch=='[') {\r\n         lastwasinteger = 0;\r\n         inbracket = 1;\r\n         bracketstr = \"\";\r\n         }\r\n      else if (ch=='\\\\') {\r\n         lastwasslash = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch=='*') {\r\n         lastwasasterisk = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch=='_') {\r\n         lastwasunderscore = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch==\";\") {\r\n         section++; // start next section\r\n         thisformat.sectioninfo[section] = {}; // create a new section\r\n         sectioninfo = thisformat.sectioninfo[section]; // get reference to info for current section\r\n         sectioninfo.sectionstart = 1 + thisformat.operators.length; // remember where it starts\r\n         sectioninfo.integerdigits = 0; // number of integer-part placeholders\r\n         sectioninfo.fractiondigits = 0; // fraction placeholders\r\n         sectioninfo.commas = 0; // commas encountered, to handle scaling\r\n         sectioninfo.percent = 0; // times to scale by 100\r\n         integerpart = 1; // reset for new section\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.section);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      else if (ch.toLowerCase()==\"g\") {\r\n         ingeneral = 1;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (ch.toLowerCase()==\"a\") {\r\n         ampmstr = ch;\r\n         lastwasinteger = 0;\r\n         }\r\n      else if (\"dmyhHs\".indexOf(ch)>=0) {\r\n         indate = ch;\r\n         }\r\n      else {\r\n         lastwasinteger = 0;\r\n         thisformat.operators.push(scfn.commands.copy);\r\n         thisformat.operands.push(ch);\r\n         }\r\n      }\r\n\r\n   if (indate) { // last char was part of unsaved date placeholder\r\n      thisformat.operators.push(scfn.commands.date);\r\n      thisformat.operands.push(indate);\r\n      sectioninfo.hasdate = 1;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n/* *******************\r\n\r\n bracketdata = SocialCalc.FormatNumber.parse_format_bracket(bracketstr)\r\n\r\n Takes a bracket contents (e.g., \"RED\", \">10\") and returns an operator and operand\r\n\r\n bracketdata->{}\r\n    .operator\r\n    .operand\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.parse_format_bracket = function(bracketstr) {\r\n\r\n   var scfn = SocialCalc.FormatNumber;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var bracketdata={};\r\n   var parts;\r\n\r\n   if (bracketstr.charAt(0)=='$') { // currency\r\n      bracketdata.operator = scfn.commands.currency;\r\n      parts=bracketstr.match(/^\\$(.+?)(\\-.+?){0,1}$/);\r\n      if (parts) {\r\n         bracketdata.operand = parts[1] || scc.FormatNumber_defaultCurrency || '$';\r\n         }\r\n      else {\r\n         bracketdata.operand = bracketstr.substring(1) || scc.FormatNumber_defaultCurrency || '$';\r\n         }\r\n      }\r\n   else if (bracketstr=='?$') {\r\n      bracketdata.operator = scfn.commands.currency;\r\n      bracketdata.operand = '[?$]';\r\n      }\r\n   else if (scfn.allowedcolors[bracketstr.toUpperCase()]) {\r\n      bracketdata.operator = scfn.commands.color;\r\n      bracketdata.operand = scfn.allowedcolors[bracketstr.toUpperCase()];\r\n      }\r\n   else if (parts=bracketstr.match(/^style=([^\"]*)$/)) { // [style=...]\r\n      bracketdata.operator = scfn.commands.style;\r\n      bracketdata.operand = parts[1];\r\n      }\r\n   else if (bracketstr==\",\") {\r\n      bracketdata.operator = scfn.commands.separator;\r\n      bracketdata.operand = bracketstr;\r\n      }\r\n   else if (scfn.alloweddates[bracketstr.toUpperCase()]) {\r\n      bracketdata.operator = scfn.commands.date;\r\n      bracketdata.operand = scfn.alloweddates[bracketstr.toUpperCase()];\r\n      }\r\n   else if (parts=bracketstr.match(/^[<>=]/)) { // comparison operator\r\n      parts=bracketstr.match(/^([<>=]+)(.+)$/); // split operator and value\r\n      bracketdata.operator = scfn.commands.comparison;\r\n      bracketdata.operand = parts[1]+\":\"+parts[2];\r\n      }\r\n   else { // unknown bracket\r\n      bracketdata.operator = scfn.commands.copy;\r\n      bracketdata.operand = \"[\"+bracketstr+\"]\";\r\n      }\r\n\r\n   return bracketdata;\r\n\r\n   }\r\n\r\n/* *******************\r\n\r\n juliandate = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(year, month, day)\r\n\r\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\r\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\r\n Translated from the FORTRAN\r\n\r\n      I= YEAR\r\n      J= MONTH\r\n      K= DAY\r\nC\r\n      JD= K-32075+1461*(I+4800+(J-14)/12)/4+367*(J-2-(J-14)/12*12)\r\n     2    /12-3*((I+4900+(J-14)/12)/100)/4\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.convert_date_gregorian_to_julian = function(year, month, day) {\r\n\r\n   var juliandate;\r\n\r\n   juliandate = day-32075+SocialCalc.intFunc(1461*(year+4800+SocialCalc.intFunc((month-14)/12))/4);\r\n   juliandate += SocialCalc.intFunc(367*(month-2-SocialCalc.intFunc((month-14)/12)*12)/12);\r\n   juliandate = juliandate - SocialCalc.intFunc(3*SocialCalc.intFunc((year+4900+SocialCalc.intFunc((month-14)/12))/100)/4);\r\n\r\n   return juliandate;\r\n\r\n   }\r\n\r\n\r\n/* *******************\r\n\r\n ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(juliandate)\r\n\r\n ymd->{}\r\n    .year\r\n    .month\r\n    .day\r\n\r\n From: http://aa.usno.navy.mil/faq/docs/JD_Formula.html\r\n Uses: Fliegel, H. F. and van Flandern, T. C. (1968). Communications of the ACM, Vol. 11, No. 10 (October, 1968).\r\n Translated from the FORTRAN\r\n\r\n************************* */\r\n\r\nSocialCalc.FormatNumber.convert_date_julian_to_gregorian = function(juliandate) {\r\n\r\n   var L, N, I, J, K;\r\n\r\n   L = juliandate+68569;\r\n   N = Math.floor(4*L/146097);\r\n   L = L-Math.floor((146097*N+3)/4);\r\n   I = Math.floor(4000*(L+1)/1461001);\r\n   L = L-Math.floor(1461*I/4)+31;\r\n   J = Math.floor(80*L/2447);\r\n   K = L-Math.floor(2447*J/80);\r\n   L = Math.floor(J/11);\r\n   J = J+2-12*L;\r\n   I = 100*(N-49)+I+L;\r\n\r\n   return {year:I, month:J, day:K};\r\n\r\n   }\r\n\r\nSocialCalc.intFunc = function(n) {\r\n   if (n < 0) {\r\n      return -Math.floor(-n);\r\n      }\r\n   else {\r\n      return Math.floor(n);\r\n      }\r\n   }\r\n\r\n","//\r\n//\r\n/*\r\n// SocialCalc Spreadsheet Formula Library\r\n//\r\n// Part of the SocialCalc package\r\n//\r\n// (c) Copyright 2008 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Based in part on the SocialCalc 1.1.0 code written in Perl.\r\n// The SocialCalc 1.1.0 code was:\r\n//    Portions (c) Copyright 2005, 2006, 2007 Software Garden, Inc.\r\n//    All Rights Reserved.\r\n//    Portions (c) Copyright 2007 Socialtext, Inc.\r\n//    All Rights Reserved.\r\n// The Perl SocialCalc started as modifications to the wikiCalc(R) program, version 1.0.\r\n// wikiCalc 1.0 was written by Software Garden, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) SocialCalc = {}; // May be used with other SocialCalc libraries or standalone\r\n                                     // In any case, requires SocialCalc.Constants.\r\n\r\nSocialCalc.Formula = {};\r\nSocialCalc.TriggerIoAction = {}; // eddy\r\n\r\n//\r\n// Formula constants for parsing:\r\n//\r\n\r\n   SocialCalc.Formula.ParseState = {num: 1, alpha: 2, coord: 3, string: 4, stringquote: 5, numexp1: 6, numexp2: 7, alphanumeric: 8, specialvalue:9};\r\n\r\n   SocialCalc.Formula.TokenType = {num: 1, coord: 2, op: 3, name: 4, error: 5, string: 6, space: 7};\r\n\r\n   SocialCalc.Formula.CharClass = {num: 1, numstart: 2, op: 3, eof: 4, alpha: 5, incoord: 6, error: 7, quote: 8, space: 9, specialstart: 10};\r\n \r\n   SocialCalc.Formula.CharClassTable = {\r\n      \" \": 9, \"!\": 3, '\"': 8, \"'\": 8, \"#\": 10, \"$\":6, \"%\":3, \"&\":3, \"(\": 3, \")\": 3, \"*\": 3, \"+\": 3, \",\": 3, \"-\": 3, \".\": 2, \"/\": 3,\r\n       \"0\": 1, \"1\": 1, \"2\": 1, \"3\": 1, \"4\": 1, \"5\": 1, \"6\": 1, \"7\": 1, \"8\": 1, \"9\": 1,\r\n       \":\": 3, \"<\": 3, \"=\": 3, \">\": 3,\r\n       \"A\": 5, \"B\": 5, \"C\": 5, \"D\": 5, \"E\": 5, \"F\": 5, \"G\": 5, \"H\": 5, \"I\": 5, \"J\": 5, \"K\": 5, \"L\": 5, \"M\": 5, \"N\": 5,\r\n       \"O\": 5, \"P\": 5, \"Q\": 5, \"R\": 5, \"S\": 5, \"T\": 5, \"U\": 5, \"V\": 5, \"W\": 5, \"X\": 5, \"Y\": 5, \"Z\": 5,\r\n       \"^\": 3, \"_\": 5,\r\n       \"a\": 5, \"b\": 5, \"c\": 5, \"d\": 5, \"e\": 5, \"f\": 5, \"g\": 5, \"h\": 5, \"i\": 5, \"j\": 5, \"k\": 5, \"l\": 5, \"m\": 5, \"n\": 5,\r\n       \"o\": 5, \"p\": 5, \"q\": 5, \"r\": 5, \"s\": 5, \"t\": 5, \"u\": 5, \"v\": 5, \"w\": 5, \"x\": 5, \"y\": 5, \"z\": 5\r\n       };\r\n\r\n   SocialCalc.Formula.UpperCaseTable = {\r\n       \"a\": \"A\", \"b\": \"B\", \"c\": \"C\", \"d\": \"D\", \"e\": \"E\", \"f\": \"F\", \"g\": \"G\", \"h\": \"H\", \"i\": \"I\", \"j\": \"J\", \"k\": \"K\", \"l\": \"L\", \"m\": \"M\",\r\n       \"n\": \"N\", \"o\": \"O\", \"p\": \"P\", \"q\": \"Q\", \"r\": \"R\", \"s\": \"S\", \"t\": \"T\", \"u\": \"U\", \"v\": \"V\", \"w\": \"W\", \"x\": \"X\", \"y\": \"Y\", \"z\": \"Z\",\r\n       \"A\": \"A\", \"B\": \"B\", \"C\": \"C\", \"D\": \"D\", \"E\": \"E\", \"F\": \"F\", \"G\": \"G\", \"H\": \"H\", \"I\": \"I\", \"J\": \"J\", \"K\": \"K\", \"L\": \"L\", \"M\": \"M\",\r\n       \"N\": \"N\", \"O\": \"O\", \"P\": \"P\", \"Q\": \"Q\", \"R\": \"R\", \"S\": \"S\", \"T\": \"T\", \"U\": \"U\", \"V\": \"V\", \"W\": \"W\", \"X\": \"X\", \"Y\": \"Y\", \"Z\": \"Z\"\r\n       }\r\n\r\n   SocialCalc.Formula.SpecialConstants = { // names that turn into constants for name lookup\r\n      \"#NULL!\": \"0,e#NULL!\", \"#NUM!\": \"0,e#NUM!\", \"#DIV/0!\": \"0,e#DIV/0!\", \"#VALUE!\": \"0,e#VALUE!\",\r\n      \"#REF!\": \"0,e#REF!\", \"#NAME?\": \"0,e#NAME?\"};\r\n\r\n\r\n   // Operator Precedence table\r\n   //\r\n   // 1- !, 2- : ,, 3- M P, 4- %, 5- ^, 6- * /, 7- + -, 8- &, 9- < > = G(>=) L(<=) N(<>),\r\n   // Negative value means Right Associative\r\n\r\n   SocialCalc.Formula.TokenPrecedence = {\r\n      \"!\": 1,\r\n      \":\": 2, \",\": 2,\r\n      \"M\": -3, \"P\": -3,\r\n      \"%\": 4,\r\n      \"^\": 5,\r\n      \"*\": 6, \"/\": 6,\r\n      \"+\": 7, \"-\": 7,\r\n      \"&\": 8,\r\n      \"<\": 9, \">\": 9, \"G\": 9, \"L\": 9, \"N\": 9\r\n      };\r\n\r\n   // Convert one-char token text to input text:\r\n\r\n   SocialCalc.Formula.TokenOpExpansion = {'G': '>=', 'L': '<=', 'M': '-', 'N': '<>', 'P': '+'};\r\n\r\n   //\r\n   // Information about the resulting value types when doing operations on values (used by LookupResultType)\r\n   //\r\n   // Each object entry is an object with specific types with result type info as follows:\r\n   //\r\n   //    'type1a': '|type2a:resulta|type2b:resultb|...\r\n   //    Type of t* or n* matches any of those types not listed\r\n   //    Results may be a type or the numbers 1 or 2 specifying to return type1 or type2\r\n   \r\n\r\n   SocialCalc.Formula.TypeLookupTable = {\r\n       unaryminus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       unaryplus: { 'n*': '|n*:1|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       unarypercent: { 'n*': '|n:n%|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       plus: {\r\n                'n%': '|n%:n%|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'nd': '|n%:n|nd:nd|nt:ndt|ndt:ndt|n$:n|n:nd|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'nt': '|n%:n|nd:ndt|nt:nt|ndt:ndt|n$:n|n:nt|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'ndt': '|n%:n|nd:ndt|nt:ndt|ndt:ndt|n$:n|n:ndt|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'n$': '|n%:n|nd:n|nt:n|ndt:n|n$:n$|n:n$|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'nl': '|n%:n|nd:n|nt:n|ndt:n|n$:n|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'n': '|n%:n|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                'b': '|n%:n%|nd:nd|nt:nt|ndt:ndt|n$:n$|n:n|n*:n|b:n|e*:2|t*:e#VALUE!|',\r\n                't*': '|ni:1|n*:e#VALUE!|t*:e#VALUE!|b:e#VALUE!|e*:2|',\r\n                'n*': '|ni:1|e*:2|',\r\n                'e*': '|e*:1|n*:1|t*:1|b:1|'\r\n               },\r\n       concat: {\r\n                't': '|t:t|th:th|tw:tw|tl:t|tr:tr|t*:2|e*:2|',\r\n                'th': '|t:th|th:th|tw:t|tl:th|tr:t|t*:t|e*:2|',\r\n                'tw': '|t:tw|th:t|tw:tw|tl:tw|tr:tw|t*:t|e*:2|',\r\n                'tl': '|t:tl|th:th|tw:tw|tl:tl|tr:tr|t*:t|e*:2|',\r\n                't*': '|t*:t|e*:2|',\r\n                'e*': '|e*:1|n*:1|t*:1|'\r\n               },\r\n       oneargnumeric: { 'n*': '|n*:n|', 'e*': '|e*:1|', 't*': '|t*:e#VALUE!|', 'b': '|b:n|'},\r\n       twoargnumeric: { 'n*': '|n*:n|t*:e#VALUE!|e*:2|', 'e*': '|e*:1|n*:1|t*:1|', 't*': '|t*:e#VALUE!|n*:e#VALUE!|e*:2|'},\r\n       propagateerror: { 'n*': '|n*:2|e*:2|', 'e*': '|e*:2|', 't*': '|t*:2|e*:2|', 'b': '|b:2|e*:2|'}\r\n      };\r\n\r\n/* *******************\r\n\r\n parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(line)\r\n\r\n Parses a text string as if it was a spreadsheet formula\r\n\r\n This uses a simple state machine run on each character in turn.\r\n States remember whether a number is being gathered, etc.\r\n The result is parseinfo which is an array with one entry for each token:\r\n   parseinfo[i] = {\r\n     text: \"the characters making up the parsed token\",\r\n     type: the type of the token (a number),\r\n     opcode: a single character version of an operator suitable for use in the\r\n                  precedence table and distinguishing between unary and binary + and -.\r\n\r\n************************* */\r\n\r\nSocialCalc.Formula.ParseFormulaIntoTokens = function(line) {\r\n\r\n   var i, ch, cclass, haddecimal, last_token, last_token_type, last_token_text, t;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var parsestate = scf.ParseState;\r\n   var tokentype = scf.TokenType;\r\n   var charclass = scf.CharClass;\r\n   var charclasstable = scf.CharClassTable;\r\n   var uppercasetable = scf.UpperCaseTable; // much faster than toUpperCase function\r\n   var pushtoken = scf.ParsePushToken;\r\n   var coordregex = /^\\$?[A-Z]{1,2}\\$?[1-9]\\d*$/i;\r\n\r\n   var parseinfo = [];\r\n   var str = \"\";\r\n   var state = 0;\r\n   var haddecimal = false;\r\n\r\n  for (i=0; i<=line.length; i++) {\r\n      if (i<line.length) {\r\n         ch = line.charAt(i);\r\n         cclass = charclasstable[ch];\r\n         }\r\n      else {\r\n         ch = \"\";\r\n         cclass = charclass.eof;\r\n         }\r\n\r\n      if (state == parsestate.num) {\r\n         if (cclass == charclass.num) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.numstart && !haddecimal) {\r\n            haddecimal = true;\r\n            str += ch;\r\n            }\r\n         else if (ch == \"E\" || ch == \"e\") {\r\n            str += ch;\r\n            haddecimal = false;\r\n            state = parsestate.numexp1;\r\n            }\r\n         else { // end of number - save it\r\n            pushtoken(parseinfo, str, tokentype.num, 0);\r\n            haddecimal = false;\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.numexp1) {\r\n         if (cclass == parsestate.num) {\r\n            state = parsestate.numexp2;\r\n            }\r\n         else if ((ch == '+' || ch == '-') && (uppercasetable[str.charAt(str.length-1)] == 'E')) {\r\n            str += ch;\r\n            }\r\n         else if (ch == 'E' || ch == 'e') {\r\n            ;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrexponent, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.numexp2) {\r\n         if (cclass == charclass.num) {\r\n            str += ch;\r\n            }\r\n         else { // end of number - save it\r\n            pushtoken(parseinfo, str, tokentype.num, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.alpha) {\r\n         if (cclass == charclass.num) {\r\n            state = parsestate.coord;\r\n            }\r\n         else if (cclass == charclass.alpha || ch == \".\") { // alpha may be letters, numbers, \"_\", or \".\"\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.incoord) {\r\n            state = parsestate.coord;\r\n            }\r\n         else if (cclass == charclass.op || cclass == charclass.numstart\r\n                || cclass == charclass.space || cclass == charclass.eof) {\r\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.coord) {\r\n         if (cclass == charclass.num) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.incoord) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.alpha) {\r\n            state = parsestate.alphanumeric;\r\n            }\r\n         else if (cclass == charclass.op || cclass == charclass.numstart ||\r\n                  cclass == charclass.eof || cclass == charclass.space) {\r\n            if (coordregex.test(str)) {\r\n               t = tokentype.coord;\r\n               }\r\n            else {\r\n               t = tokentype.name;\r\n               }\r\n            pushtoken(parseinfo, str.toUpperCase(), t, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            state = 0;\r\n           }\r\n         }\r\n\r\n\r\n      if (state == parsestate.alphanumeric) {\r\n         if (cclass == charclass.num || cclass == charclass.alpha) {\r\n            str += ch;\r\n            }\r\n         else if (cclass == charclass.op || cclass == charclass.numstart\r\n                || cclass == charclass.space || cclass == charclass.eof) {\r\n            pushtoken(parseinfo, str.toUpperCase(), tokentype.name, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         }\r\n\r\n      if (state == parsestate.string) {\r\n         if (cclass == charclass.quote) {\r\n            state = parsestate.stringquote; // got quote in string: is it doubled (quote in string) or by itself (end of string)?\r\n            }\r\n         else if (cclass == charclass.eof) {\r\n            pushtoken(parseinfo, scc.s_parseerrstring, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            str += ch;\r\n            }\r\n         }\r\n      else if (state == parsestate.stringquote) { // note else if here\r\n         if (cclass == charclass.quote) {\r\n            str += ch;\r\n            state = parsestate.string; // double quote: add one then continue getting string\r\n            }\r\n         else { // something else -- end of string\r\n            pushtoken(parseinfo, str, tokentype.string, 0);\r\n            state = 0; // drop through to process\r\n            }\r\n         }\r\n\r\n      else if (state == parsestate.specialvalue) { // special values like #REF!\r\n         if (str.charAt(str.length-1) == \"!\") { // done - save value as a name\r\n            pushtoken(parseinfo, str, tokentype.name, 0);\r\n            state = 0; // drop through to process\r\n            }\r\n         else if (cclass == charclass.eof) {\r\n            pushtoken(parseinfo, scc.s_parseerrspecialvalue, tokentype.error, 0);\r\n            state = 0;\r\n            }\r\n         else {\r\n            str += ch;\r\n            }\r\n         }\r\n\r\n      if (state == 0) {\r\n         if (cclass == charclass.num) {\r\n            str = ch;\r\n            state = parsestate.num;\r\n            }\r\n         else if (cclass == charclass.numstart) {\r\n            str = ch;\r\n            haddecimal = true;\r\n            state = parsestate.num;\r\n            }\r\n         else if (cclass == charclass.alpha || cclass == charclass.incoord) {\r\n            str = ch;\r\n            state = parsestate.alpha;\r\n            }\r\n         else if (cclass == charclass.specialstart) {\r\n            str = ch;\r\n            state = parsestate.specialvalue;\r\n            }\r\n         else if (cclass == charclass.op) {\r\n            str = ch;\r\n            if (parseinfo.length>0) {\r\n               last_token = parseinfo[parseinfo.length-1];\r\n               last_token_type = last_token.type;\r\n               last_token_text = last_token.text;\r\n               if (last_token_type == charclass.op) {\r\n                  if (last_token_text == '<' || last_token_text == \">\") {\r\n                     str = last_token_text + str;\r\n                     parseinfo.pop();\r\n                     if (parseinfo.length>0) {\r\n                        last_token = parseinfo[parseinfo.length-1];\r\n                        last_token_type = last_token.type;\r\n                        last_token_text = last_token.text;\r\n                        }\r\n                     else {\r\n                        last_token_type = charclass.eof;\r\n                        last_token_text = \"EOF\";\r\n                        }\r\n                     }\r\n                  }\r\n               }\r\n            else {\r\n               last_token_type = charclass.eof;\r\n               last_token_text = \"EOF\";\r\n               }\r\n            t = tokentype.op;\r\n            if ((parseinfo.length == 0)\r\n                || (last_token_type == charclass.op && last_token_text != ')' && last_token_text != '%')) { // Unary operator\r\n               if (str == '-') { // M is unary minus\r\n                  str = \"M\";\r\n                  ch = \"M\";\r\n                  }\r\n               else if (str == '+') { // P is unary plus\r\n                  str = \"P\";\r\n                  ch = \"P\";\r\n                  }\r\n               else if (str == ')' && last_token_text == '(') { // null arg list OK\r\n                  ;\r\n                  }\r\n               else if (str != '(') { // binary-op open-paren OK, others no\r\n                  t = tokentype.error;\r\n                  str = scc.s_parseerrtwoops;\r\n                  }\r\n               }\r\n            else if (str.length > 1) {\r\n               if (str == '>=') { // G is >=\r\n                  str = \"G\";\r\n                  ch = \"G\";\r\n                  }\r\n               else if (str == '<=') { // L is <=\r\n                  str = \"L\";\r\n                  ch = \"L\";\r\n                  }\r\n               else if (str == '<>') { // N is <>\r\n                  str = \"N\";\r\n                  ch = \"N\";\r\n                  }\r\n               else {\r\n                  t = tokentype.error;\r\n                  str = scc.s_parseerrtwoops;\r\n                  }\r\n               }\r\n            pushtoken(parseinfo, str, t, ch);\r\n            state = 0;\r\n            }\r\n         else if (cclass == charclass.quote) { // starting a string\r\n            str = \"\";\r\n            state = parsestate.string;\r\n            }\r\n         else if (cclass == charclass.space) { // store so can reconstruct spacing\r\n            //pushtoken(parseinfo, \" \", tokentype.space, 0);\r\n            }\r\n         else if (cclass == charclass.eof) { // ignore -- needed to have extra loop to close out other things\r\n            }\r\n         else { // unknown class - such as unknown char\r\n            pushtoken(parseinfo, scc.s_parseerrchar, tokentype.error, 0);\r\n            }\r\n         }\r\n      }\r\n\r\n   return parseinfo;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.ParsePushToken = function(parseinfo, ttext, ttype, topcode) {\r\n\r\n   parseinfo.push({text: ttext, type: ttype, opcode: topcode});\r\n\r\n   }\r\n\r\n/* *******************\r\n\r\n result = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, allowrangereturn)\r\n\r\n Does the calculation expressed in a parsed formula, returning a value, its type, and error info\r\n returns: {value: value, type: valuetype, error: errortext}.\r\n\r\n If allowrangereturn is present and true, can return a range (e.g., \"A1:A10\" - translated from \"A1|A10|\")\r\n\r\n************************* */\r\n\r\nSocialCalc.Formula.evaluate_parsed_formula = function(parseinfo, sheet, allowrangereturn) {\r\n\r\n   var result;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var tokentype = scf.TokenType;\r\n\r\n   var revpolish;\r\n   var parsestack = [];\r\n\r\n   var errortext = \"\";\r\n\r\n   revpolish = scf.ConvertInfixToPolish(parseinfo); // result is either an array or a string with error text\r\n\r\n   result = scf.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn);\r\n\r\n   return result;\r\n\r\n}\r\n\r\n//\r\n// revpolish = SocialCalc.Formula.ConvertInfixToPolish(parseinfo)\r\n//\r\n// Convert infix to reverse polish notation\r\n//\r\n// Returns revpolish array with a sequence of references to tokens by number if successful.\r\n// Errors return a string with the error.\r\n//\r\n// Based upon the algorithm shown in Wikipedia \"Reverse Polish notation\" article\r\n// and then enhanced for additional spreadsheet things\r\n//\r\n\r\nSocialCalc.Formula.ConvertInfixToPolish = function(parseinfo) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var tokentype = scf.TokenType;\r\n   var token_precedence = scf.TokenPrecedence;\r\n\r\n   var revpolish = [];\r\n   var parsestack = [];\r\n\r\n   var errortext = \"\";\r\n\r\n   var function_start = -1;\r\n\r\n   var i, pii, ttype, ttext, tprecedence, tstackprecedence;\r\n\r\n   for (i=0; i<parseinfo.length; i++) {\r\n      pii = parseinfo[i];\r\n      ttype = pii.type;\r\n      ttext = pii.text;\r\n      if (ttype == tokentype.num || ttype == tokentype.coord || ttype == tokentype.string) {\r\n         revpolish.push(i);\r\n         }\r\n      else if (ttype == tokentype.name) {\r\n         parsestack.push(i);\r\n         revpolish.push(function_start);\r\n         }\r\n      else if (ttype == tokentype.space) { // ignore\r\n         continue;\r\n         }\r\n      else if (ttext == ',') {\r\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         if (parsestack.length == 0) { // no ( -- error\r\n            errortext = scc.s_parseerrmissingopenparen;\r\n            break;\r\n            }\r\n         }\r\n      else if (ttext == '(') {\r\n         parsestack.push(i);\r\n         }\r\n      else if (ttext == ')') {\r\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].text != \"(\") {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         if (parsestack.length == 0) { // no ( -- error\r\n            errortext = scc.s_parseerrcloseparennoopen;\r\n            break;\r\n            }\r\n         parsestack.pop();\r\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         }\r\n      else if (ttype == tokentype.op) {\r\n         if (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.name) {\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         while (parsestack.length && parseinfo[parsestack[parsestack.length-1]].type == tokentype.op\r\n                && parseinfo[parsestack[parsestack.length-1]].text != '(') {\r\n            tprecedence = token_precedence[pii.opcode];\r\n            tstackprecedence = token_precedence[parseinfo[parsestack[parsestack.length-1]].opcode];\r\n            if (tprecedence >= 0 && tprecedence < tstackprecedence) {\r\n               break;\r\n               }\r\n            else if (tprecedence < 0) {\r\n               tprecedence = -tprecedence;\r\n               if (tstackprecedence < 0) tstackprecedence = -tstackprecedence;\r\n               if (tprecedence <= tstackprecedence) {\r\n                  break;\r\n                  }\r\n               }\r\n            revpolish.push(parsestack.pop());\r\n            }\r\n         parsestack.push(i);\r\n         }\r\n      else if (ttype == tokentype.error) {\r\n         errortext = ttext;\r\n         break;\r\n         }\r\n      else {\r\n         errortext = \"Internal error while processing parsed formula. \";\r\n         break;\r\n         }\r\n      }\r\n   while (parsestack.length>0) {\r\n      if (parseinfo[parsestack[parsestack.length-1]].text == '(') {\r\n         errortext = scc.s_parseerrmissingcloseparen;\r\n         break;\r\n         }\r\n      revpolish.push(parsestack.pop());\r\n      }\r\n\r\n   if (errortext) {\r\n      return errortext;\r\n      }\r\n\r\n   return revpolish;\r\n\r\n   }\r\n\r\n\r\n// DebugLog\r\n// display logged objects in the audit tab of the spreadsheet control\r\nif(typeof SocialCalc.debug_log === 'undefined') SocialCalc.debug_log = [];\r\n\r\nSocialCalc.DebugLog = function(logObject) {\t\r\n//\tSocialCalc.debug_log.push(logObject);\r\n}\r\n\r\n\r\n//\r\n// result = SocialCalc.Formula.EvaluatePolish(parseinfo, revpolish, sheet, allowrangereturn)\r\n//\r\n// Execute reverse polish representation of formula\r\n//\r\n// Operand values are objects in the operand array with a \"type\" and an optional \"value\".\r\n// Type can have these values (many are type and sub-type as two or more letters):\r\n//    \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"start\", \"eErrorType\", \"b\" (blank)\r\n// The value of a coord is in the form A57 or A57!sheetname\r\n// The value of a range is coord|coord|number where number starts at 0 and is\r\n// the offset of the next item to fetch if you are going through the range one by one\r\n// The number starts as a null string (\"A1|B3|\")\r\n//\r\n\r\nSocialCalc.Formula.EvaluatePolish = function(parseinfo, revpolish, sheet, allowrangereturn) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var tokentype = scf.TokenType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookup = scf.TypeLookupTable;\r\n   var operand_as_number = scf.OperandAsNumber;\r\n   var operand_as_text = scf.OperandAsText;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var operands_as_coord_on_sheet = scf.OperandsAsCoordOnSheet;\r\n   var format_number_for_display = SocialCalc.format_number_for_display || function(v, t, f) {return v+\"\";};\r\n\r\n   var errortext = \"\";\r\n   var function_start = -1;\r\n   var missingOperandError = {value: \"\", type: \"e#VALUE!\", error: scc.s_parseerrmissingoperand};\r\n\r\n   var operand = [];\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   var i, rii, prii, ttype, ttext, value1, value2, tostype, tostype2, resulttype, valuetype, cond, vmatch, smatch;\r\n\r\n   if (!parseinfo.length || (! (revpolish instanceof Array))) {\r\n      return ({value: \"\", type: \"e#VALUE!\", error: (typeof revpolish == \"string\" ? revpolish : \"\")});\r\n      }\r\n\r\n\t  \r\n\t  // eddy EvaluatePolish { \r\n    //    SocialCalc.DebugLog({ revpolish: revpolish});\r\n    //    SocialCalc.DebugLog({ revpolish: revpolish});\r\n\t  // }\r\n\r\n\t// eddy EvaluatePolish {\r\n\t\r\n\t// e.g parameterInfo: [ {'text':'E1','type':2,'opcode':0}, ... ] \r\n    var parameterInfo = [];\r\n    // }\t\r\n\t  \r\n\t  \r\n   for (i=0; i<revpolish.length; i++) {\r\n      rii = revpolish[i];\r\n      if (rii == function_start) { // Remember the start of a function argument list\r\n         PushOperand(\"start\", 0);\r\n         continue;\r\n         }\r\n\r\n      prii = parseinfo[rii];\r\n      ttype = prii.type;\r\n      ttext = prii.text;\r\n\t  // eddy EvaluatePolish {\r\n\t  parameterInfo.push(prii);\r\n\t  // }\r\n\t  \r\n      if (ttype == tokentype.num) {\r\n         PushOperand(\"n\", ttext-0);\r\n         }\r\n\r\n      else if (ttype == tokentype.coord) {\r\n         PushOperand(\"coord\", ttext);\r\n\t\t \r\n         }\r\n\r\n      else if (ttype == tokentype.string) {\r\n         PushOperand(\"t\", ttext);\r\n         }\r\n\r\n      else if (ttype == tokentype.op) {\r\n         if (operand.length <= 0) { // Nothing on the stack...\r\n            return missingOperandError;\r\n            break; // done\r\n            }\r\n\r\n         // Unary minus\r\n\r\n         if (ttext == 'M') {\r\n            value1 = operand_as_number(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryminus);\r\n            PushOperand(resulttype, -value1.value);\r\n            }\r\n\r\n         // Unary plus\r\n\r\n         else if (ttext == 'P') {\r\n            value1 = operand_as_number(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unaryplus);\r\n            PushOperand(resulttype, value1.value);\r\n            }\r\n\r\n         // Unary % - percent, left associative\r\n\r\n         else if (ttext == '%') {\r\n            value1 = operand_as_number(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.unarypercent);\r\n            PushOperand(resulttype, 0.01*value1.value);\r\n            }\r\n\r\n         // & - string concatenate\r\n\r\n         else if (ttext == '&') {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               return missingOperandError;\r\n               }\r\n            value2 = operand_as_text(sheet, operand);\r\n            value1 = operand_as_text(sheet, operand);\r\n            resulttype = lookup_result_type(value1.type, value1.type, typelookup.concat);\r\n            PushOperand(resulttype, value1.value + value2.value);\r\n            }\r\n\r\n         // : - Range constructor\r\n\r\n         else if (ttext == ':') {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               return missingOperandError;\r\n               }\r\n            value1 = scf.OperandsAsRangeOnSheet(sheet, operand); // get coords even if use name on other sheet\r\n            if (value1.error) { // not available\r\n               errortext = errortext || value1.error;\r\n               }\r\n            PushOperand(value1.type, value1.value); // push sheetname with range on that sheet\r\n            }\r\n\r\n         // ! - sheetname!coord\r\n\r\n         else if (ttext == '!') {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               return missingOperandError;\r\n               }\r\n            value1 = operands_as_coord_on_sheet(sheet, operand); // get coord even if name on other sheet\r\n            if (value1.error) { // not available\r\n               errortext = errortext || value1.error;\r\n               }\r\n            PushOperand(value1.type, value1.value); // push sheetname with coord or range on that sheet\r\n            }\r\n\r\n         // Comparison operators: < L = G > N (< <= = >= > <>)\r\n\r\n         else if (ttext == \"<\" || ttext == \"L\" || ttext == \"=\" || ttext == \"G\" || ttext == \">\" || ttext == \"N\") {\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               errortext = scc.s_parseerrmissingoperand; // remember error\r\n               break;\r\n               }\r\n            value2 = operand_value_and_type(sheet, operand);\r\n            value1 = operand_value_and_type(sheet, operand);\r\n            if (value1.type.charAt(0) == \"n\" && value2.type.charAt(0) == \"n\") { // compare two numbers\r\n               cond = 0;\r\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\r\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\r\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\r\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\r\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\r\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\r\n               PushOperand(\"nl\", cond);\r\n               }\r\n            else if (value1.type.charAt(0) == \"e\") { // error on left\r\n               PushOperand(value1.type, 0);\r\n               }               \r\n            else if (value2.type.charAt(0) == \"e\") { // error on right\r\n               PushOperand(value2.type, 0);\r\n               }               \r\n            else { // text maybe mixed with numbers or blank\r\n               tostype = value1.type.charAt(0);\r\n               tostype2 = value2.type.charAt(0);\r\n               if (tostype == \"n\") {\r\n                  value1.value = format_number_for_display(value1.value, \"n\", \"\");\r\n                  }\r\n               else if (tostype == \"b\") {\r\n                  value1.value = \"\";\r\n                  }\r\n               if (tostype2 == \"n\") {\r\n                  value2.value = format_number_for_display(value2.value, \"n\", \"\");\r\n                  }\r\n               else if (tostype2 == \"b\") {\r\n                  value2.value = \"\";\r\n                  }\r\n               cond = 0;\r\n               value1.value = value1.value.toLowerCase(); // ignore case\r\n               value2.value = value2.value.toLowerCase();\r\n               if (ttext == \"<\") { cond = value1.value < value2.value ? 1 : 0; }\r\n               else if (ttext == \"L\") { cond = value1.value <= value2.value ? 1 : 0; }\r\n               else if (ttext == \"=\") { cond = value1.value == value2.value ? 1 : 0; }\r\n               else if (ttext == \"G\") { cond = value1.value >= value2.value ? 1 : 0; }\r\n               else if (ttext == \">\") { cond = value1.value > value2.value ? 1 : 0; }\r\n               else if (ttext == \"N\") { cond = value1.value != value2.value ? 1 : 0; }\r\n               PushOperand(\"nl\", cond);\r\n               }\r\n            }\r\n\r\n         // Normal infix arithmethic operators: +, -. *, /, ^\r\n\r\n         else { // what's left are the normal infix arithmetic operators\r\n            if (operand.length <= 1) { // Need at least two things on the stack...\r\n               errortext = scc.s_parseerrmissingoperand; // remember error\r\n               break;\r\n               }\r\n            if (ttext == '+') {\r\n               value2 = operand_value_and_type(sheet, operand);\r\n               value1 = operand_value_and_type(sheet, operand); // allow + to append style formula to widget\r\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\r\n               PushOperand(resulttype, value1.value + value2.value);\r\n               } \r\n            else {\r\n              value2 = operand_as_number(sheet, operand);\r\n              value1 = operand_as_number(sheet, operand);              \r\n              }\r\n              \r\n            if (ttext == '-') {\r\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\r\n               PushOperand(resulttype, value1.value - value2.value);\r\n               }\r\n            else if (ttext == '*') {\r\n               resulttype = lookup_result_type(value1.type, value2.type, typelookup.plus);\r\n               PushOperand(resulttype, value1.value * value2.value);\r\n               }\r\n            else if (ttext == '/') {\r\n               if (value2.value != 0) {\r\n                  PushOperand(\"n\", value1.value / value2.value); // gives plain numeric result type\r\n                  }\r\n               else {\r\n                  PushOperand(\"e#DIV/0!\", 0);\r\n                  }\r\n               }\r\n            else if (ttext == '^') {\r\n               value1.value = Math.pow(value1.value, value2.value);\r\n               value1.type = \"n\"; // gives plain numeric result type\r\n               if (isNaN(value1.value)) {\r\n                  value1.value = 0;\r\n                  value1.type = \"e#NUM!\";\r\n                  }\r\n               PushOperand(value1.type, value1.value);\r\n               }\r\n            }\r\n         }\r\n\r\n      // function or name\r\n\r\n      else if (ttype == tokentype.name) {\r\n\t  \r\n//         errortext = scf.CalculateFunction(ttext, operand, sheet);\r\n         errortext = scf.CalculateFunction(ttext, operand, sheet, parseinfo.coord); // eddy also pass the cell id\r\n\t\t \r\n         if (errortext) break;\r\n\t\t \r\n\t\t \r\n         }\r\n\r\n\t\t \r\n      else {\r\n         errortext = scc.s_InternalError+\"Unknown token \"+ttype+\" (\"+ttext+\"). \";\r\n         break;\r\n         }\r\n      }\r\n\r\n   // look at final value and handle special cases\r\n\r\n   value = operand[0] ? operand[0].value : \"\";\r\n   tostype = operand[0] ? operand[0].type : \"\";\r\n\r\n   if (tostype == \"name\") { // name - expand it\r\n      value1 = SocialCalc.Formula.LookupName(sheet, value);\r\n      value = value1.value;\r\n      tostype = value1.type;\r\n      errortext = errortext || value1.error;\r\n      }\r\n\r\n   if (tostype == \"coord\") { // the value is a coord reference, get its value and type\r\n      value1 = operand_value_and_type(sheet, operand);\r\n      value = value1.value;\r\n      tostype = value1.type;\r\n      if (tostype == \"b\") {\r\n         tostype = \"n\";\r\n         value = 0;\r\n         }\r\n      }\r\n\r\n   if (operand.length > 1 && !errortext) { // something left - error\r\n      errortext += scc.s_parseerrerrorinformula;\r\n      }\r\n\r\n   // set return type\r\n\r\n   valuetype = tostype;\r\n\r\n   if (tostype.charAt(0) == \"e\") { // error value\r\n      errortext = errortext || tostype.substring(1) || scc.s_calcerrerrorvalueinformula;\r\n      }\r\n   else if (tostype == \"range\") {\r\n      vmatch = value.match(/^(.*)\\|(.*)\\|/);\r\n      smatch = vmatch[1].indexOf(\"!\");\r\n      if (smatch>=0) { // swap sheetname\r\n         vmatch[1] = vmatch[1].substring(smatch+1) + \"!\" + vmatch[1].substring(0, smatch).toUpperCase();\r\n         }\r\n      else {\r\n         vmatch[1] = vmatch[1].toUpperCase();\r\n         }\r\n      value = vmatch[1] + \":\" + vmatch[2].toUpperCase();\r\n      if (!allowrangereturn) {\r\n         errortext = scc.s_formularangeresult+\" \"+value;\r\n         }\r\n      }\r\n\r\n   if (errortext && valuetype.charAt(0) != \"e\") {\r\n      value = errortext;\r\n      valuetype = \"e\";\r\n     }\r\n\r\n   // look for overflow\r\n\r\n   if (valuetype.charAt(0) == \"n\" && (isNaN(value) || !isFinite(value))) {\r\n      value = 0;\r\n      valuetype = \"e#NUM!\";\r\n      errortext = isNaN(value) ? scc.s_calcerrnumericnan: scc.s_calcerrnumericoverflow;\r\n      }\r\n\r\n   return ({value: value, type: valuetype, error: errortext});\r\n\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# resulttype = SocialCalc.Formula.LookupResultType(type1, type2, typelookup);\r\n#\r\n# typelookup has values of the following form:\r\n#\r\n#    typelookup{\"typespec1\"} = \"|typespec2A:resultA|typespec2B:resultB|...\"\r\n#\r\n# First type1 is looked up. If no match, then the first letter (major type) of type1 plus \"*\" is looked up\r\n# resulttype is type1 if result is \"1\", type2 if result is \"2\", otherwise the value of result.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.LookupResultType = function(type1, type2, typelookup) {\r\n\r\n   var pos1, pos2, result;\r\n\r\n   var table1 = typelookup[type1];\r\n\r\n   if (!table1) {\r\n      table1 = typelookup[type1.charAt(0)+'*'];\r\n      if (!table1) {\r\n         return \"e#VALUE! (internal error, missing LookupResultType \"+type1.charAt(0)+\"*)\"; // missing from table -- please add it\r\n         }\r\n      }\r\n   pos1 = table1.indexOf(\"|\"+type2+\":\");\r\n   if (pos1 >= 0) {\r\n      pos2 = table1.indexOf(\"|\", pos1+1);\r\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\r\n      result = table1.substring(pos1+type2.length+2, pos2);\r\n      if (result == \"1\") return type1;\r\n      if (result == \"2\") return type2;\r\n      return result;\r\n      }\r\n   pos1 = table1.indexOf(\"|\"+type2.charAt(0)+\"*:\");\r\n   if (pos1 >= 0) {\r\n      pos2 = table1.indexOf(\"|\", pos1+1);\r\n      if (pos2<0) return \"e#VALUE! (internal error, incorrect LookupResultType \"+table1+\")\";\r\n      result = table1.substring(pos1+4, pos2);\r\n      if (result == \"1\") return type1;\r\n      if (result == \"2\") return type2;\r\n      return result;\r\n      }\r\n   return \"e#VALUE!\";\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.TopOfStackValueAndType(sheet, operand)\r\n#\r\n# Returns top of stack value and type and then pops the stack.\r\n# The result is {value: value, type: type, error: \"only if bad error\"}\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.TopOfStackValueAndType = function(sheet, operand) {\r\n\r\n   var cellvtype, cell, pos, coordsheet;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   if (!stacklen) { // make sure something is there\r\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\r\n      return result;\r\n      }\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   if (result.type == \"name\") {\r\n      result = scf.LookupName(sheet, result.value);\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# operandinfo = OperandAsNumber(sheet, operand)\r\n#\r\n# Uses operand_value_and_type to get top of stack and pops it.\r\n# Returns numeric value and type.\r\n# Text values are treated as 0 if they can't be converted somehow.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsNumber = function(sheet, operand) {\r\n\r\n   var t, valueinfo;\r\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\r\n\r\n   t = operandinfo.type.charAt(0);\r\n\r\n   if (t == \"n\") {\r\n      operandinfo.value = operandinfo.value-0;\r\n      }\r\n   else if (t == \"b\") { // blank cell\r\n      operandinfo.type = \"n\";\r\n      operandinfo.value = 0;\r\n      }\r\n   else if (t == \"e\") { // error\r\n      operandinfo.value = 0;\r\n      }\r\n   else {\r\n      valueinfo = SocialCalc.DetermineValueType ? SocialCalc.DetermineValueType(operandinfo.value) :\r\n                                                    {value: operandinfo.value-0, type: \"n\"}; // if without rest of SocialCalc\r\n      if (valueinfo.type.charAt(0) == \"n\") {\r\n         operandinfo.value = valueinfo.value-0;\r\n         operandinfo.type = valueinfo.type;\r\n         }\r\n      else {\r\n         operandinfo.value = 0;\r\n         operandinfo.type = valueinfo.type;\r\n         }\r\n      }\r\n\r\n   return operandinfo;\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# operandinfo = OperandAsText(sheet, operand)\r\n#\r\n# Uses operand_value_and_type to get top of stack and pops it.\r\n# Returns text value, preserving sub-type.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsText = function(sheet, operand) {\r\n\r\n   var t, valueinfo;\r\n   var operandinfo = SocialCalc.Formula.OperandValueAndType(sheet, operand);\r\n\r\n   t = operandinfo.type.charAt(0);\r\n\r\n   if (t ==  \"t\") { // any flavor of text returns as is\r\n      ;\r\n      }\r\n   else if (t == \"n\") {\r\n      operandinfo.value = SocialCalc.format_number_for_display ?\r\n                             SocialCalc.format_number_for_display(operandinfo.value, operandinfo.type, \"\") :\r\n                             operandinfo.value = operandinfo.value+\"\";\r\n      operandinfo.type = \"t\";\r\n      }\r\n   else if (t == \"b\") { // blank\r\n      operandinfo.value = \"\";\r\n      operandinfo.type = \"t\";\r\n      }\r\n   else if (t == \"e\") { // error\r\n      operandinfo.value = \"\";\r\n      }\r\n   else {\r\n      operand.value = operandinfo.value + \"\";\r\n      operand.type = \"t\";\r\n      }\r\n\r\n   return operandinfo;\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandValueAndType(sheet, operand)\r\n#\r\n# Pops the top of stack and returns it, following a coord reference if necessary.\r\n# The result is {value: value, type: type, error: \"only if bad error\"}\r\n# Ranges are returned as if they were pushed onto the stack first coord first\r\n# Also sets type with \"t\", \"n\", \"th\", etc., as appropriate\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandValueAndType = function(sheet, operand) {\r\n\r\n   var cellvtype, cell, pos, coordsheet;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   if (!stacklen) { // make sure something is there\r\n      result.error = SocialCalc.Constants.s_InternalError+\"no operand on stack\";\r\n      return result;\r\n      }\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   if (result.type == \"name\") {\r\n      result = scf.LookupName(sheet, result.value);\r\n      }\r\n\r\n   if (result.type == \"range\") {\r\n      result = scf.StepThroughRangeDown(operand, result.value);\r\n      }\r\n\r\n   if (result.type == \"coord\") { // value is a coord reference\r\n      coordsheet = sheet;\r\n      pos = result.value.indexOf(\"!\");\r\n      if (pos != -1) { // sheet reference\r\n         coordsheet = scf.FindInSheetCache(result.value.substring(pos+1)); // get other sheet\r\n         if (coordsheet == null) { // unavailable\r\n            result.type = \"e#REF!\";\r\n            result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+result.value.substring(pos+1);\r\n            result.value = 0;\r\n            return result;\r\n            }\r\n         result.value = result.value.substring(0, pos); // get coord part\r\n         }\r\n\r\n      if (coordsheet) {\r\n         cell = coordsheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\r\n         if (cell) {\r\n            cellvtype = cell.valuetype; // get type of value in the cell it points to\r\n            result.value = cell.datavalue;\r\n            }\r\n         else {\r\n            cellvtype = \"b\";\r\n            }\r\n         }\r\n      else {\r\n         cellvtype = \"e#N/A\";\r\n         result.value = 0;\r\n         }\r\n      result.type = cellvtype || \"b\";\r\n      if (result.type == \"b\") { // blank\r\n         result.value = 0;\r\n         }\r\n      }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.OperandAsCoord(sheet, operand)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns coord value. All others are treated as an error.\r\n#\r\n*/\r\n\r\n\r\nSocialCalc.Formula.OperandAsCoord = function(sheet, operand) {\r\n\treturn SocialCalc.Formula.OperandAsType(sheet, operand, \"coord\");\r\n}\r\n\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.OperandAsRange(sheet, operand)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns coord value. All others are treated as an error.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsRange = function(sheet, operand) {\r\n\treturn SocialCalc.Formula.OperandAsType(sheet, operand, \"range\");\r\n}\r\n\r\n/*\r\n#\r\n# operandinfo = SocialCalc.Formula.OperandAsType(sheet, operand, operandtype)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns operandtype value. All others are treated as an error.\r\n#\r\n*/\r\nSocialCalc.Formula.OperandAsType = function(sheet, operand, operandtype) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n   if (result.type == \"name\") {\r\n      result = SocialCalc.Formula.LookupName(sheet, result.value);\r\n      }\r\n   if (result.type == operandtype) { // value is a coord reference\r\n      return result;\r\n      }\r\n   else {\r\n      result.value = SocialCalc.Constants.s_calcerrcellrefmissing;\r\n      result.type = \"e#REF!\";\r\n      return result;\r\n      }\r\n}\r\n\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandsAsCoordOnSheet(sheet, operand)\r\n#\r\n# Gets 2 at top of stack and pops them, treating them as sheetname!coord-or-name.\r\n# Returns stack-style coord value (coord!sheetname, or coord!sheetname|coord|) with\r\n# a type of coord or range. All others are treated as an error.\r\n# If sheetname not available, sets result.error.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandsAsCoordOnSheet = function(sheet, operand) {\r\n\r\n   var sheetname, othersheet, pos1, pos2;\r\n   var value1 = {};\r\n   var result = {};\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var stacklen = operand.length;\r\n   value1.value = operand[stacklen-1].value; // get top of stack - coord or name\r\n   value1.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   sheetname = scf.OperandAsSheetName(sheet, operand); // get sheetname as text\r\n   othersheet = scf.FindInSheetCache(sheetname.value);\r\n   if (othersheet == null) { // unavailable\r\n      result.type = \"e#REF!\";\r\n      result.value = 0;\r\n      result.error = SocialCalc.Constants.s_sheetunavailable+\" \"+sheetname.value;\r\n      return result;\r\n      }\r\n\r\n   if (value1.type == \"name\") {\r\n      value1 = scf.LookupName(othersheet, value1.value);\r\n      }\r\n   result.type = value1.type;\r\n   if (value1.type == \"coord\") { // value is a coord reference\r\n      result.value = value1.value + \"!\" + sheetname.value; // return in the format as used on stack\r\n      }\r\n   else if (value1.type == \"range\") { // value is a range reference\r\n      pos1 = value1.value.indexOf(\"|\");\r\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\r\n      result.value = value1.value.substring(0, pos1) + \"!\" + sheetname.value +\r\n                    \"|\" + value1.value.substring(pos1+1, pos2) + \"|\";\r\n      }\r\n   else if (value1.type.charAt(0)==\"e\") {\r\n      result.value = value1.value;\r\n      }\r\n   else {\r\n      result.error = SocialCalc.Constants.s_calcerrcellrefmissing;\r\n      result.type = \"e#REF!\";\r\n      result.value = 0;\r\n      }\r\n   return result;\r\n   \r\n   }\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandsAsRangeOnSheet(sheet, operand)\r\n#\r\n# Gets 2 at top of stack and pops them, treating them as coord2-or-name:coord1.\r\n# Name is evaluated on sheet of coord1.\r\n# Returns result with \"value\" of stack-style range value (coord!sheetname|coord|) and\r\n# \"type\" of \"range\". All others are treated as an error.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandsAsRangeOnSheet = function(sheet, operand) {\r\n\r\n   var value1, othersheet, pos1, pos2;\r\n   var value2 = {};\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var stacklen = operand.length;\r\n   value2.value = operand[stacklen-1].value; // get top of stack - coord or name for \"right\" side\r\n   value2.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n\r\n   value1 = scf.OperandAsCoord(sheet, operand); // get \"left\" coord\r\n   if (value1.type != \"coord\") { // not a coord, which it must be\r\n      return {value: 0, type: \"e#REF!\"};\r\n      }\r\n\r\n   othersheet = sheet;\r\n   pos1 = value1.value.indexOf(\"!\");\r\n   if (pos1 != -1) { // sheet reference\r\n      pos2 = value1.value.indexOf(\"|\", pos1+1);\r\n      if (pos2 < 0) pos2 = value1.value.length;\r\n      othersheet = scf.FindInSheetCache(value1.value.substring(pos1+1,pos2)); // get other sheet\r\n      if (othersheet == null) { // unavailable\r\n         return {value: 0, type: \"e#REF!\", errortext: scc.s_sheetunavailable+\" \"+value1.value.substring(pos1+1,pos2)};\r\n         }\r\n      }\r\n\r\n   if (value2.type == \"name\") { // coord:name is allowed, if name is just one cell\r\n      value2 = scf.LookupName(othersheet, value2.value, \"end\");\r\n      }\r\n\r\n   if (value2.type == \"coord\") { // value is a coord reference, so return the combined range\r\n      return {value: value1.value+\"|\"+value2.value+\"|\", type: \"range\"}; // return range in the format as used on stack\r\n      }\r\n   else { // bad form\r\n      return {value: scc.s_calcerrcellrefmissing, type: \"e#REF!\"};\r\n      }\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.OperandAsSheetName(sheet, operand)\r\n#\r\n# Gets top of stack and pops it.\r\n# Returns sheetname value. All others are treated as an error.\r\n# Accepts text, cell reference, and named value which is one of those two.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.OperandAsSheetName = function(sheet, operand) {\r\n\r\n   var nvalue, cell;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var result = {type: \"\", value: \"\"};\r\n\r\n   var stacklen = operand.length;\r\n\r\n   result.value = operand[stacklen-1].value; // get top of stack\r\n   result.type = operand[stacklen-1].type;\r\n   operand.pop(); // we have data - pop stack\r\n   if (result.type == \"name\") {\r\n      nvalue = SocialCalc.Formula.LookupName(sheet, result.value);\r\n      if (!nvalue.value) { // not a known name - return bare name as the name value\r\n         return result;\r\n         }\r\n      result.value = nvalue.value;\r\n      result.type = nvalue.type;\r\n      }\r\n   if (result.type == \"coord\") { // value is a coord reference, follow it to find sheet name\r\n      cell = sheet.cells[SocialCalc.Formula.PlainCoord(result.value)];\r\n      if (cell) {\r\n         result.value = cell.datavalue;\r\n         result.type = cell.valuetype;\r\n         }\r\n      else {\r\n         result.value = \"\";\r\n         result.type = \"b\";\r\n         }\r\n      }\r\n   if (result.type.charAt(0) == \"t\") { // value is a string which could be a sheet name\r\n      return result;\r\n      }\r\n   else {\r\n      result.value = \"\";\r\n      result.error = SocialCalc.Constants.s_calcerrsheetnamemissing;\r\n      return result;\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// value = SocialCalc.Formula.LookupName(sheet, name)\r\n//\r\n// Returns value and type of a named value\r\n// Names are case insensitive\r\n// Names may have a definition which is a coord (A1), a range (A1:B7), or a formula (=OFFSET(A1,0,0,5,1))\r\n// Note: The range must not have sheet names (\"!\") in them.\r\n//\r\n\r\nSocialCalc.Formula.LookupName = function(sheet, name, isEnd) {\r\n\r\n   var pos, specialc, parseinfo;\r\n   var names = sheet.names;\r\n   var value = {};\r\n   var startedwalk = false;\r\n\r\n   if (names[name.toUpperCase()]) { // is name defined?\r\n\r\n      value.value = names[name.toUpperCase()].definition; // yes\r\n\r\n      if (value.value.charAt(0) == \"=\") { // formula\r\n         if (!sheet.checknamecirc) { // are we possibly walking the name tree?\r\n            sheet.checknamecirc = {}; // not yet\r\n            startedwalk = true; // remember we are the reference that started it\r\n            }\r\n         else {\r\n            if (sheet.checknamecirc[name]) { // circular reference\r\n               value.type = \"e#NAME?\";\r\n               value.error = SocialCalc.Constants.s_circularnameref+' \"' + name + '\".';\r\n               return value;\r\n               }\r\n            }\r\n         sheet.checknamecirc[name] = true;\r\n\r\n         parseinfo = SocialCalc.Formula.ParseFormulaIntoTokens(value.value.substring(1));\r\n         value = SocialCalc.Formula.evaluate_parsed_formula(parseinfo, sheet, 1); // parse formula, allowing range return\r\n\r\n         delete sheet.checknamecirc[name]; // done with us\r\n         if (startedwalk) {\r\n            delete sheet.checknamecirc; // done with walk\r\n            }\r\n\r\n         if (value.type != \"range\") {\r\n            return value;\r\n            }\r\n         }\r\n\r\n      pos = value.value.indexOf(\":\");\r\n      if (pos != -1) { // range\r\n         value.type = \"range\";\r\n         value.value = value.value.substring(0, pos) + \"|\" + value.value.substring(pos+1)+\"|\";\r\n         value.value = value.value.toUpperCase();\r\n         }\r\n      else {\r\n         value.type = \"coord\";\r\n         value.value = value.value.toUpperCase();\r\n         }\r\n      return value;\r\n      }\r\n   else if (specialc=SocialCalc.Formula.SpecialConstants[name.toUpperCase()]) { // special constant, like #REF!\r\n      pos = specialc.indexOf(\",\");\r\n      value.value = specialc.substring(0,pos)-0;\r\n      value.type = specialc.substring(pos+1);\r\n      return value;\r\n      }\r\n   else if (/^[a-zA-Z][a-zA-Z]?$/.test(name)) {\r\n      value.type = \"coord\";\r\n      value.value = name.toUpperCase() + (isEnd ? sheet.attribs.lastrow : 1);\r\n      return value;\r\n   }\r\n   else {\r\n      value.value = \"\";\r\n      value.type = \"e#NAME?\";\r\n      value.error = SocialCalc.Constants.s_calcerrunknownname+' \"'+name+'\"';\r\n      return value;\r\n      }\r\n   }\r\n\r\n/*\r\n#\r\n# coord = SocialCalc.Formula.StepThroughRangeDown(operand, rangevalue)\r\n#\r\n# Returns next coord in a range, keeping track on the operand stack\r\n# Goes from upper left across and down to bottom right.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.StepThroughRangeDown = function(operand, rangevalue) {\r\n\r\n   var value1, value2, sequence, pos1, pos2, sheet1, rp, c, r, count;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   pos1 = rangevalue.indexOf(\"|\");\r\n   pos2 = rangevalue.indexOf(\"|\", pos1+1);\r\n   value1 = rangevalue.substring(0, pos1);\r\n   value2 = rangevalue.substring(pos1+1, pos2);\r\n   sequence = rangevalue.substring(pos2+1) - 0;\r\n\r\n   pos1 = value1.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      sheet1 = value1.substring(pos1);\r\n      value1 = value1.substring(0, pos1);\r\n      }\r\n   else {\r\n      sheet1 = \"\";\r\n      }\r\n   pos1 = value2.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      value2 = value2.substring(0, pos1);\r\n      }\r\n\r\n   rp = scf.OrderRangeParts(value1, value2);\r\n   \r\n   count = 0;\r\n   for (r=rp.r1; r<=rp.r2; r++) {\r\n      for (c=rp.c1; c<=rp.c2; c++) {\r\n         count++;\r\n         if (count > sequence) {\r\n            if (r!=rp.r2 || c!=rp.c2) { // keep on stack until done\r\n               scf.PushOperand(operand, \"range\", value1+sheet1+\"|\"+value2+\"|\"+count);\r\n               }\r\n            return {value: SocialCalc.crToCoord(c, r)+sheet1, type: \"coord\"};\r\n            }\r\n         }\r\n      }\r\n   }\r\n\r\n/*\r\n#\r\n# result = SocialCalc.Formula.DecodeRangeParts(sheetdata, range)\r\n#\r\n# Returns sheetdata for the sheet where the range is, as well as\r\n# the number of the first column in the range, the number of columns,\r\n# and equivalent row information:\r\n#\r\n# {sheetdata: sheet, sheetname: name-or-\"\", col1num: n, ncols: n, row1num: n, nrows: n}\r\n#\r\n# If any errors, a null result is returned.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DecodeRangeParts = function(sheetdata, range) {\r\n\r\n   var value1, value2, pos1, pos2, sheet1, coordsheetdata, rp;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   pos1 = range.indexOf(\"|\");\r\n   pos2 = range.indexOf(\"|\", pos1+1);\r\n   value1 = range.substring(0, pos1);\r\n   value2 = range.substring(pos1+1, pos2);\r\n\r\n   pos1 = value1.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      sheet1 = value1.substring(pos1+1);\r\n      value1 = value1.substring(0, pos1);\r\n      }\r\n   else {\r\n      sheet1 = \"\";\r\n      }\r\n   pos1 = value2.indexOf(\"!\");\r\n   if (pos1 != -1) {\r\n      value2 = value2.substring(0, pos1);\r\n      }\r\n\r\n   coordsheetdata = sheetdata;\r\n   if (sheet1) { // sheet reference\r\n      coordsheetdata = scf.FindInSheetCache(sheet1);\r\n      if (coordsheetdata == null) { // unavailable\r\n         return null;\r\n         }\r\n      }\r\n\r\n   rp = scf.OrderRangeParts(value1, value2);\r\n\r\n   return {sheetdata: coordsheetdata, sheetname: sheet1, col1num: rp.c1, ncols: rp.c2-rp.c1+1, row1num: rp.r1, nrows: rp.r2-rp.r1+1}\r\n\r\n   }\r\n\r\n\r\n\r\n//*********************\r\n//\r\n// Function Handling\r\n//\r\n//*********************\r\n\r\n// List of functions -- Define after functions are defined\r\n//\r\n// SocialCalc.Formula.FunctionList[\"function_name\"] = [function_subroutine, number_of_arguments, arg_def, func_def, func_class, cell_html, io_parameters]\r\n//   function_subroutine takes arguments (fname, operand, foperand, sheet), returns\r\n//      errortext or null, pushing result on operand stack.\r\n//   number_of_arguments is:\r\n//      0 = no arguments\r\n//      >0 = exactly that many arguments\r\n//      <0 = that many arguments (abs value) or more\r\n//      100 = don't check\r\n//\r\n//   arg_def, if present, is the name of the element in SocialCalc.Formula.FunctionArgDefs.\r\n//   func_def, if present, is a string explaining the function. If not, looked up in SocialCalc.Constants.\r\n//   func_class, if present, is the comma-separated names of the elements in SocialCalc.Formula.FunctionClasses.\r\n//   cell_html, if present, is the HTML to display in the cell. will find and replace these <%=cell_reference%>, <%=displayvalue%> see SocialCalc.FormatValueForDisplay\r\n//   io_parameters, if present, \r\n//        \"ParameterList\" is used with =CopyValue() etc, used to collect parameters of the formula, for use trigger/action formulas, \r\n//        \"EventTree\" is used with =Button() etc, used to store trigger cell lookup table\r\n//        \"Input\" store copy of value in formdata sheet -- for input style GUI widgets - textbox/radio buttons etc - \r\n//        \"TimeTrigger\" like button, but triggers an action at a time,  rather than on click\r\n//\r\n// To add a function, just add it to this object.\r\n\r\n   if (!SocialCalc.Formula.FunctionList) { // make sure it is defined (could have been in another module)\r\n      SocialCalc.Formula.FunctionList = {};\r\n      }\r\n\r\n   // FunctionClasses[classname] = {name: full-name-string, items: [sorted list of function names]};\r\n   // filled in by SocialCalc.Formula.FillFunctionInfo\r\n\r\n   SocialCalc.Formula.FunctionClasses = null; // start null to say needs filling in\r\n\r\n   // FunctionArgDef[argname] = explicit-string-for-arg-list;\r\n   // filled in by SocialCalc.Formula.FillFunctionInfo\r\n\r\n   SocialCalc.Formula.FunctionArgDefs = {};\r\n\r\n\r\n   \r\n\r\n/*\r\n#\r\n# SocialCalc.Formula.StoreIoEventFormula(function_name, coord, operand_reverse, sheet, io_parameters)\r\n# \r\n# store forumla parameters of io event formulas\r\n#\r\n# enable lookup of ioForumalas when a trigger formula is activated \r\n# store formula details in sheet.ioEventTree  and sheet.ioParameterList \r\n#\r\n*/\r\n// eddy StoreIoEventFormula\r\nSocialCalc.Formula.StoreIoEventFormula = function(function_name, coord, operand_reverse, sheet, io_parameters) {\r\n\tvar operand = [];\r\n\tSocialCalc.Formula.Clone(operand,operand_reverse);\r\n    operand.reverse(); // normal parameter order\r\n    if(operand.length == 0) return;\r\n\t\r\n\t\r\n\r\n  if(typeof sheet.ioEventTree === 'undefined') sheet.ioEventTree = {};\t// action formulas - e.g. COPYVALUE, COPYFORMULA  - these action formulas are triggered by a trigger formula \r\n  if(typeof sheet.ioParameterList === 'undefined') sheet.ioParameterList = {}; // widget parameters - e.g. BUTTON, TEXTBOX - this is updated when the widget state changes\r\n  if(typeof sheet.ioTimeTriggerList === 'undefined') sheet.ioTimeTriggerList = {}; // \r\n  if(typeof sheet.radioGroupList === 'undefined') sheet.radioGroupList = {}; // \r\n\r\n  // store parameters of each action formulas \r\n  if(typeof sheet.ioParameterList[coord] === 'undefined') sheet.ioParameterList[coord] = {};\r\n  sheet.ioParameterList[coord] = operand;\r\n  sheet.ioParameterList[coord].function_name = function_name;\r\n  \r\n  // add radio buttons to list - so radio group can be updated\r\n//  if(function_name == \"RADIOBUTTON\") {\r\n//    \r\n//    if(operand.length > 1) {\r\n//      if (sheet.radioGroupList[]) {\r\n//        sheet.radioGroup.push()\r\n//      } else {\r\n//        \r\n//      } \r\n//    }\r\n//  }\r\n\r\n  \r\n  // send trigger times to server if changed\r\n  if(io_parameters == \"TimeTrigger\") { // timer trigger formula exists   \r\n    // function to push cell time into array\r\n    var PushTriggerTime = function(list, coordA1, sheetData) {\r\n      var cell = sheetData.cells[coordA1];   \r\n      if (typeof cell !== 'undefined' && cell.valuetype.charAt(0) == \"n\") { // if not blank and is number\r\n        list.push(cell.datavalue);\r\n      }\r\n    };\r\n\r\n    var triggerTimeCellId = SocialCalc.Formula.PlainCoord(operand[0].value); // strip dollar signs\r\n    \r\n    var currentTriggerTimeList = [];\r\n    \r\n    if(operand[0].type == \"range\" )  {      \r\n      var rangeinfo = SocialCalc.Formula.DecodeRangeParts(sheet, triggerTimeCellId);\r\n      for (var i=0; i<rangeinfo.ncols; i++) {\r\n        for (var j=0; j<rangeinfo.nrows; j++) {\r\n          var cellCoord = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n          PushTriggerTime(currentTriggerTimeList, cellCoord, sheet);\r\n        }\r\n      }\r\n    }\r\n    \r\n    if(operand[0].type == \"coord\" ) {      \r\n      PushTriggerTime(currentTriggerTimeList, triggerTimeCellId, sheet);\r\n    }\r\n    \r\n    if (operand[0].type.charAt(0) == \"n\") {\r\n      currentTriggerTimeList.push(operand[0].value);      \r\n    }\r\n\r\n    // if time triggers changed then set changed times in ioTimeTrigger and schedule      \r\n    if(typeof sheet.ioTimeTriggerList[coord] === 'undefined' || SocialCalc.Formula.ArrayValuesEqual(sheet.ioTimeTriggerList[coord], currentTriggerTimeList) == false) {\r\n      // set the time+cell in ioTimeTrigger\r\n      sheet.ioTimeTriggerList[coord] = currentTriggerTimeList;\r\n      // schedule the set Time Trigger // sheet.ScheduleSheetCommands('...    \r\n      var timeZoneOffsetMins = (new Date()).getTimezoneOffset();\r\n      var start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1      \r\n      var triggerUTCTimeList = []; /// EPOCH in Mins - Mins since 1/1/1970 GMT\r\n      for(var index = 0; index < currentTriggerTimeList.length; ++index) triggerUTCTimeList[index] = Math.floor(((currentTriggerTimeList[index] - start_1_1_1970 ) *24 * 60) + timeZoneOffsetMins);\r\n      sheet.ScheduleSheetCommands('settimetrigger '+coord+' '+triggerUTCTimeList.toString());       \r\n    }\r\n  }\r\n  \r\n\t// store trigger lookup table\r\n  if(io_parameters == \"EventTree\"\t&& (operand[0].type == \"coord\" || operand[0].type == \"range\")) { // trigger cell exists   \r\n  \t// create a list of action formulas for each trigger cell  \r\n    var triggerCellId = operand[0].value.replace(/\\$/g,''); // strip dollar signs\r\n    var PushTriggerCord = function(list, index, v) {\r\n        if(typeof list[index] === 'undefined') list[index] = {};\r\n        list[index][v] = v;\r\n    };\r\n\r\n\r\n    if(operand[0].type == \"range\" )  {      \r\n\t      var rangeinfo = SocialCalc.Formula.DecodeRangeParts(sheet, triggerCellId);\r\n      for (var i=0; i<rangeinfo.ncols; i++) {\r\n         for (var j=0; j<rangeinfo.nrows; j++) {\r\n            var cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n                          PushTriggerCord(sheet.ioEventTree, cellcr, coord); \r\n                          \r\n         }\r\n      }\r\n    }\r\n    if(operand[0].type == \"coord\" ) {\r\n        PushTriggerCord(sheet.ioEventTree, triggerCellId, coord); \r\n    }                \r\n  }\r\n\r\n  \r\n  //IF GUI widget is \"Input\"\r\n  if(io_parameters == \"Input\" ) {\r\n    var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n          ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n          : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\r\n    \r\n    if(formDataViewer != null && formDataViewer.loaded == true) {\r\n      \r\n      // IF formFields  not loaded - load formFields  \r\n      if( formDataViewer.formFields == null) SocialCalc.Formula.LoadFormFields();\r\n      //  get formFieldName\r\n      var formFieldName = (function_name+coord).toLowerCase();\r\n      //  if formFieldName not in formFields  \r\n      var sheetCmd = null;\r\n      if(formDataViewer.formFields[formFieldName] == null) {\r\n        //    store formFieldName of gui input widget \r\n        //    add formFieldName  to formFields  \r\n        var col = formDataViewer.formFields[formFieldName] = formDataViewer.formFieldsLength++ + 2;\r\n        //    add formFieldName to next empty cell (starting with B1)\r\n        var headerCoord = SocialCalc.crToCoord(col, 1);\r\n        sheetCmd = \"set \"+headerCoord+\" text t \"+SocialCalc.encodeForSave(function_name.toLowerCase()+coord);\r\n      }\r\n      if(operand[0].type.charAt(0) == \"t\" || operand[0].type.charAt(0) == \"n\") {       \r\n        var valueCoord = SocialCalc.crToCoord(formDataViewer.formFields[formFieldName], 2);\r\n        if(formDataViewer.sheet.cells[valueCoord] == null ||  formDataViewer.sheet.cells[valueCoord].datavalue != operand[0].value) {\r\n          var sheetCmdTwo = \"set \"+valueCoord+\" text t \"+SocialCalc.encodeForSave(operand[0].value);\r\n          if (sheetCmd != null) sheetCmd = sheetCmd + \"\\n\" + sheetCmdTwo; else sheetCmd = sheetCmdTwo;        \r\n        }\r\n  \r\n      }\r\n      if (sheetCmd != null) formDataViewer.sheet.ScheduleSheetCommands(sheetCmd, false);    \r\n    }    \r\n  }    \r\n        \r\n\r\n\t//SocialCalc.DebugLog({ ioEventTree: sheet.ioEventTree});\r\n\t//SocialCalc.DebugLog({ ioParameterList: sheet.ioParameterList});\r\n}   \r\n   \r\n\r\n/**\r\n * ArrayValuesEqual\r\n * \r\n * Warning - nested vales are NOT tested.\r\n * returns true if both arrays contain the same values\r\n */    \r\nSocialCalc.Formula.ArrayValuesEqual = function(a, b) {\r\n  var i = a.length;\r\n  if (i != b.length) return false;\r\n  while (i--) {\r\n      if (a[i] !== b[i]) return false;\r\n  }\r\n  return true;\r\n};\r\n\r\nSocialCalc.Formula.Clone =   function(destination, source) {\r\n        for (var property in source) {\r\n            if (typeof source[property] === \"object\" && source[property] !== null && destination[property]) { \r\n                SocialCalc.Formula.Clone(destination[property], source[property]);\r\n            } else {\r\n                destination[property] = source[property];\r\n            }\r\n        }\r\n    };   \r\n\r\n/**\r\n * LoadFormFields\r\n * \r\n * Load the fieldNames of the form \r\n *  Cell A1 contains \"FieldName:\" and cells B1 to n contain field names\r\n *  Cell A2 contains \"Pending\" - pending data row. The pending row is moved to row 3 by inseting a new row 2 onSubmit \r\n *  Put the fieldNames into an array for fast lookup and position information\r\n */    \r\n    \r\nSocialCalc.Formula.LoadFormFields =   function() {\r\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n    ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n    : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\r\n\r\n  formDataViewer.formFields = {};\r\n\r\n  \r\n  //IF cell A1 is blank - Adds \"FieldName:\" to A1\r\n  if(formDataViewer.sheet.cells.A1 == null ) {\r\n    formDataViewer.sheet.ScheduleSheetCommands(\"set A1 text t \"+SocialCalc.encodeForSave(\"FieldName:\"), false);       \r\n  }\r\n  \r\n  if(formDataViewer.sheet.cells.A2 == null ) {\r\n    formDataViewer.sheet.ScheduleSheetCommands(\"set A2 text t \"+SocialCalc.encodeForSave(\"Pending:\"), false);       \r\n  }\r\n\r\n  \r\n  //  For each cell in row 1, from B1 to 1st blank cell\r\n  var col = 2;\r\n  while(true) {\r\n    var coord = SocialCalc.crToCoord(col, 1);\r\n    var cell=formDataViewer.sheet.cells[coord];\r\n    if (!cell) break;\r\n    //    Put cell value into formFields  \r\n    formDataViewer.formFields[cell.datavalue.toLowerCase()] = col;\r\n    col ++;\r\n  }\r\n  formDataViewer.formFieldsLength = col -2;\r\n\r\n}    \r\n   \r\n/*\r\n#\r\n# errortext = SocialCalc.Formula.CalculateFunction(fname, operand, sheet)\r\n#\r\n# Dispatches for function fname.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.CalculateFunction = function(fname, operand, sheet, coord) {\r\n\r\n   var fobj, foperand, ffunc, argnum, ttext;\r\n   var scf = SocialCalc.Formula;\r\n   var ok = 1;\r\n   var errortext = \"\";\r\n\r\n   fobj = scf.FunctionList[fname];\r\n\r\n   if (fobj) {\r\n   \r\n\r\n      foperand = [];\r\n      ffunc = fobj[0];\r\n      argnum = fobj[1];\r\n      scf.CopyFunctionArgs(operand, foperand);\r\n\r\n\t  // eddy CalculateFunction {\r\n   if(fobj[6] && fobj[6] != \"\") {\t  \r\n\t   SocialCalc.DebugLog(\"action:\"+fname);\t\t\r\n\t\t scf.StoreIoEventFormula(fname, coord, foperand, sheet, fobj[6]);\r\n\t\t\r\n\t  }\r\n\t  // }\r\n\t  \r\n      if (argnum != 100) {\r\n         if (argnum < 0) {\r\n            if (foperand.length < -argnum) {\r\n               errortext = scf.FunctionArgsError(fname, operand);\r\n               return errortext;\r\n               }\r\n            }\r\n         else {\r\n            if (foperand.length != argnum) {\r\n               errortext = scf.FunctionArgsError(fname, operand);\r\n               return errortext;\r\n               }\r\n            }\r\n         }\r\n\r\n\t\t \r\n\t  \r\n      errortext = ffunc(fname, operand, foperand, sheet, coord);\r\n      }\r\n\r\n   else {\r\n         ttext = fname;\r\n\r\n         if (operand.length && operand[operand.length-1].type == \"start\") { // no arguments - name or zero arg function\r\n            operand.pop();\r\n            scf.PushOperand(operand, \"name\", ttext);\r\n            }\r\n\r\n         else {\r\n            errortext = SocialCalc.Constants.s_sheetfuncunknownfunction+\" \" + ttext +\". \";\r\n            }\r\n      }\r\n\r\n   return errortext;\r\n\r\n}\r\n\r\n//\r\n// SocialCalc.Formula.PushOperand(operand, t, v)\r\n//\r\n// Pushes the type and value onto the operand stack\r\n//\r\n\r\nSocialCalc.Formula.PushOperand = function(operand, t, v) {\r\n\r\n   operand.push({type: t, value: v});\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.Formula.CopyFunctionArgs(operand, foperand)\r\n//\r\n// Pops operands from operand and pushes on foperand up to function start\r\n// reversing order in the process.\r\n//\r\n\r\nSocialCalc.Formula.CopyFunctionArgs = function(operand, foperand) {\r\n\r\n   var fobj, foperand, ffunc, argnum;\r\n   var scf = SocialCalc.Formula;\r\n   var ok = 1;\r\n   var errortext = null;\r\n\r\n   while (operand.length>0 && operand[operand.length-1].type != \"start\") { // get each arg\r\n      foperand.push(operand.pop()); // copy it\r\n      }\r\n   operand.pop(); // get rid of \"start\"\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// errortext = SocialCalc.Formula.FunctionArgsError(fname, operand)\r\n//\r\n// Pushes appropriate error on operand stack and returns errortext, including fname\r\n//\r\n\r\nSocialCalc.Formula.FunctionArgsError = function(fname, operand) {\r\n\r\n   var errortext = SocialCalc.Constants.s_calcerrincorrectargstofunction+\" \" + fname + \". \";\r\n   SocialCalc.Formula.PushOperand(operand, \"e#VALUE!\", errortext);\r\n\r\n   return errortext;\r\n\r\n   }\r\n\r\n\r\n//\r\n// errortext = SocialCalc.Formula.FunctionSpecificError(fname, operand, errortype, errortext)\r\n//\r\n// Pushes specified error and text on operand stack.\r\n//\r\n\r\nSocialCalc.Formula.FunctionSpecificError = function(fname, operand, errortype, errortext) {\r\n\r\n   SocialCalc.Formula.PushOperand(operand, errortype, errortext);\r\n\r\n   return errortext;\r\n\r\n   }\r\n\r\n//\r\n// haserror = SocialCalc.Formula.CheckForErrorValue(operand, v)\r\n//\r\n// If v.type is an error, push it on operand stack and return true, otherwise return false.\r\n//\r\n\r\nSocialCalc.Formula.CheckForErrorValue = function(operand, v) {\r\n\r\n   if (v.type.charAt(0) == \"e\") {\r\n      operand.push(v);\r\n      return true;\r\n      }\r\n   else {\r\n      return false;\r\n      }\r\n\r\n   }\r\n\r\n/////////////////////////\r\n//\r\n// FUNCTION INFORMATION ROUTINES\r\n//\r\n\r\n//\r\n// SocialCalc.Formula.FillFunctionInfo()\r\n//\r\n// Goes through function definitions and fills out FunctionArgDefs and FunctionClasses.\r\n// Execute this after any changes to SocialCalc.Constants but before UI is used.\r\n//\r\n\r\nSocialCalc.Formula.FillFunctionInfo = function() {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n\r\n   var fname, f, classes, cname, i;\r\n\r\n   if (scf.FunctionClasses) { // only do once\r\n      return;\r\n      }\r\n\r\n   for (fname in scf.FunctionList) {\r\n      f = scf.FunctionList[fname];\r\n      if (f[2]) { // has an arg def\r\n         scf.FunctionArgDefs[f[2]] = scc[\"s_farg_\"+f[2]] || \"\"; // get it from constants\r\n         }\r\n      if (!f[3]) { // no text def, see if in constants\r\n         if (scc[\"s_fdef_\"+fname]) {\r\n            scf.FunctionList[fname][3] = scc[\"s_fdef_\"+fname];\r\n            }\r\n         }\r\n      }\r\n\r\n   scf.FunctionClasses = {};\r\n \r\n   for (i=0; i<scc.function_classlist.length; i++) {\r\n      cname = scc.function_classlist[i];\r\n      scf.FunctionClasses[cname] = {name: scc[\"s_fclass_\"+cname], items: []};\r\n      }\r\n\r\n   for (fname in scf.FunctionList) {\r\n      f = scf.FunctionList[fname];\r\n      classes = f[4] ? f[4].split(\",\") : []; // get classes\r\n      classes.push(\"all\");\r\n      for (i=0; i<classes.length; i++) {\r\n         cname = classes[i];\r\n         scf.FunctionClasses[cname].items.push(fname);\r\n         }\r\n      }\r\n   for (cname in scf.FunctionClasses) {\r\n      scf.FunctionClasses[cname].items.sort();\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// str = SocialCalc.Formula.FunctionArgString(fname)\r\n//\r\n// Returns a string representing the arguments to function fname.\r\n//\r\n\r\nSocialCalc.Formula.FunctionArgString = function(fname) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var fdata = scf.FunctionList[fname];\r\n   var nargs, i, str;\r\n\r\n   var adef = fdata[2];\r\n\r\n   if (!adef) {\r\n      nargs = fdata[1];\r\n      if (nargs == 0) {\r\n         adef = \" \";\r\n         }\r\n      else if (nargs > 0) {\r\n         str = \"v1\";\r\n         for (i=2; i<=nargs; i++) {\r\n            str += \", v\"+i;\r\n            }\r\n         return str;\r\n         }\r\n      else if (nargs < 0) {\r\n         str = \"v1\";\r\n         for (i=2; i<-nargs; i++) {\r\n            str += \", v\"+i;\r\n            }\r\n         return str+\", ...\";\r\n         }\r\n      else {\r\n         return \"nargs: \"+nargs;\r\n         }\r\n      }\r\n\r\n   str = scf.FunctionArgDefs[adef] || adef;\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\n/////////////////////////\r\n//\r\n// FUNCTION DEFINITIONS\r\n//\r\n// The standard function definitions follow.\r\n//\r\n// Note that some need SocialCalc.DetermineValueType to be defined.\r\n//\r\n\r\n/*\r\n#\r\n# AVERAGE(v1,c1:c2,...)\r\n# COUNT(v1,c1:c2,...)\r\n# COUNTA(v1,c1:c2,...)\r\n# COUNTBLANK(v1,c1:c2,...)\r\n# MAX(v1,c1:c2,...)\r\n# MIN(v1,c1:c2,...)\r\n# PRODUCT(v1,c1:c2,...)\r\n# STDEV(v1,c1:c2,...)\r\n# STDEVP(v1,c1:c2,...)\r\n# SUM(v1,c1:c2,...)\r\n# VAR(v1,c1:c2,...)\r\n# VARP(v1,c1:c2,...)\r\n#\r\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\r\n# If this routine is changed, check the dseries_functions, too.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SeriesFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, t, v1;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   var sum = 0;\r\n   var resulttypesum = \"\";\r\n   var count = 0;\r\n   var counta = 0;\r\n   var countblank = 0;\r\n   var product = 1;\r\n   var maxval;\r\n   var minval;\r\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\r\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\r\n\r\n   while (foperand.length > 0) {\r\n      value1 = operand_value_and_type(sheet, foperand);\r\n      t = value1.type.charAt(0);\r\n      if (t == \"n\") count += 1;\r\n      if (t != \"b\") counta += 1;\r\n      if (t == \"b\") countblank += 1;\r\n\r\n      if (t == \"n\") {\r\n         v1 = value1.value-0; // get it as a number\r\n         sum += v1;\r\n         product *= v1;\r\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\r\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\r\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\r\n            mk1 = v1;\r\n            sk1 = 0;\r\n            }\r\n         else { // Accumulate S sub 1 through n as per Knuth noted above\r\n            mk = mk1 + (v1 - mk1) / count;\r\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\r\n            sk1 = sk;\r\n            mk1 = mk;\r\n            }\r\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\r\n         }\r\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\r\n         resulttypesum = value1.type;\r\n         }\r\n      }\r\n\r\n   resulttypesum = resulttypesum || \"n\";\r\n\r\n   switch (fname) {\r\n      case \"SUM\":\r\n         PushOperand(resulttypesum, sum);\r\n         break;\r\n\r\n      case \"PRODUCT\": // may handle cases with text differently than some other spreadsheets\r\n         PushOperand(resulttypesum, product);\r\n         break;\r\n\r\n      case \"MIN\":\r\n         PushOperand(resulttypesum, minval || 0);\r\n         break;\r\n\r\n      case \"MAX\":\r\n         PushOperand(resulttypesum, maxval || 0);\r\n         break;\r\n\r\n      case \"COUNT\":\r\n         PushOperand(\"n\", count);\r\n         break;\r\n\r\n      case \"COUNTA\":\r\n         PushOperand(\"n\", counta);\r\n         break;\r\n\r\n      case \"COUNTBLANK\":\r\n         PushOperand(\"n\", countblank);\r\n         break;\r\n\r\n      case \"AVERAGE\":\r\n         if (count > 0) {\r\n            PushOperand(resulttypesum, sum/count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"STDEV\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"STDEVP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"VAR\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / (count - 1));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"VARP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n      }\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n//*********************\r\n//\r\n// Docs see - Function Handling - ~line 1560\r\n// \r\n//*********************\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"AVERAGE\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"COUNT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"COUNTA\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"COUNTBLANK\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"MAX\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"MIN\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"PRODUCT\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"STDEV\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"STDEVP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"SUM\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"VAR\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"VARP\"] = [SocialCalc.Formula.SeriesFunctions, -1, \"vn\", null, \"stat\"];\r\n\r\n/*\r\n#\r\n# SUMPRODUCT(range1, range2, ...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SumProductFunction = function(fname, operand, foperand, sheet) {\r\n  \r\n   var range, products = [], sum = 0;\r\n   var scf = SocialCalc.Formula;\r\n   var ncols = 0, nrows = 0;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   while (foperand.length > 0) {\r\n      range = scf.TopOfStackValueAndType(sheet, foperand);\r\n      if (range.type != \"range\") {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      rangeinfo = scf.DecodeRangeParts(sheet, range.value);\r\n      if (!ncols) ncols = rangeinfo.ncols;\r\n      else if (ncols != rangeinfo.ncols) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      if (!nrows) nrows = rangeinfo.nrows;\r\n      else if (nrows != rangeinfo.nrows) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      for (i=0; i<rangeinfo.ncols; i++) {\r\n         for (j=0; j<rangeinfo.nrows; j++) {\r\n            k = i * rangeinfo.nrows + j;\r\n            cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n            cell = rangeinfo.sheetdata.GetAssuredCell(cellcr);\r\n            value = cell.valuetype == \"n\" ? cell.datavalue : 0;\r\n            products[k] = ((typeof products[k] !== 'undefined')? products[k] : 1) * value;\r\n            }\r\n         }\r\n      }\r\n   for (i=0; i<products.length; i++) {\r\n      sum += products[i];\r\n      }\r\n   PushOperand(\"n\", sum);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"SUMPRODUCT\"] = [SocialCalc.Formula.SumProductFunction, -1, \"rangen\", \"\", \"stat\"];\r\n\r\n/*\r\n#\r\n# DAVERAGE(databaserange, fieldname, criteriarange)\r\n# DCOUNT(databaserange, fieldname, criteriarange)\r\n# DCOUNTA(databaserange, fieldname, criteriarange)\r\n# DGET(databaserange, fieldname, criteriarange)\r\n# DMAX(databaserange, fieldname, criteriarange)\r\n# DMIN(databaserange, fieldname, criteriarange)\r\n# DPRODUCT(databaserange, fieldname, criteriarange)\r\n# DSTDEV(databaserange, fieldname, criteriarange)\r\n# DSTDEVP(databaserange, fieldname, criteriarange)\r\n# DSUM(databaserange, fieldname, criteriarange)\r\n# DVAR(databaserange, fieldname, criteriarange)\r\n# DVARP(databaserange, fieldname, criteriarange)\r\n#\r\n# Calculate all of these and then return the desired one (overhead is in accessing not calculating)\r\n# If this routine is changed, check the series_functions, too.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DSeriesFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, tostype, cr, dbrange, fieldname, criteriarange, dbinfo, criteriainfo;\r\n   var fieldasnum, targetcol, i, j, k, cell, criteriafieldnums;\r\n   var testok, criteriacr, criteria, testcol, testcr;\r\n   var t;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   var value1 = {};\r\n\r\n   var sum = 0;\r\n   var resulttypesum = \"\";\r\n   var count = 0;\r\n   var counta = 0;\r\n   var countblank = 0;\r\n   var countmatches = 0;   \r\n   var product = 1;\r\n   var maxval;\r\n   var minval;\r\n   var mk, sk, mk1, sk1; // For variance, etc.: M sub k, k-1, and S sub k-1\r\n                         // as per Knuth \"The Art of Computer Programming\" Vol. 2 3rd edition, page 232\r\n\r\n   dbrange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\r\n   fieldname = scf.OperandValueAndType(sheet, foperand); // get a value\r\n   criteriarange = scf.TopOfStackValueAndType(sheet, foperand); // get a range\r\n\r\n   if (dbrange.type != \"range\" || criteriarange.type != \"range\") {\r\n      return scf.FunctionArgsError(fname, operand);\r\n      }\r\n\r\n   dbinfo = scf.DecodeRangeParts(sheet, dbrange.value);\r\n   criteriainfo = scf.DecodeRangeParts(sheet, criteriarange.value);\r\n\r\n   fieldasnum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, fieldname.value, fieldname.type);\r\n   if (fieldasnum <= 0) {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return;\r\n      }\r\n\r\n   targetcol = dbinfo.col1num + fieldasnum - 1;\r\n   criteriafieldnums = [];\r\n\r\n   for (i=0; i<criteriainfo.ncols; i++) { // get criteria field colnums\r\n      cell = criteriainfo.sheetdata.GetAssuredCell(SocialCalc.crToCoord(criteriainfo.col1num + i, criteriainfo.row1num));\r\n      criterianum = scf.FieldToColnum(dbinfo.sheetdata, dbinfo.col1num, dbinfo.ncols, dbinfo.row1num, cell.datavalue, cell.valuetype);\r\n      if (criterianum <= 0) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      criteriafieldnums.push(dbinfo.col1num + criterianum - 1);\r\n      }\r\n\r\n   for (i=1; i<dbinfo.nrows; i++) { // go through each row of the database\r\n      testok = false;\r\nCRITERIAROW:\r\n      for (j=1; j<criteriainfo.nrows; j++) { // go through each criteria row\r\n         for (k=0; k<criteriainfo.ncols; k++) { // look at each column\r\n            criteriacr = SocialCalc.crToCoord(criteriainfo.col1num + k, criteriainfo.row1num + j); // where criteria is\r\n            cell = criteriainfo.sheetdata.GetAssuredCell(criteriacr);\r\n            criteria = cell.datavalue;\r\n            if (typeof criteria == \"string\" && criteria.length == 0) continue; // blank items are OK\r\n            testcol = criteriafieldnums[k];\r\n            testcr = SocialCalc.crToCoord(testcol, dbinfo.row1num + i); // cell to check\r\n            cell = dbinfo.sheetdata.GetAssuredCell(testcr); // get cell to check from dbinfo sheet\r\n            if (!scf.TestCriteria(cell.datavalue, cell.valuetype || \"b\", criteria)) {\r\n               continue CRITERIAROW; // does not meet criteria - check next row\r\n               }\r\n            }\r\n         testok = true; // met all the criteria\r\n         break CRITERIAROW;\r\n         }\r\n      if (!testok) {\r\n         continue;\r\n         }\r\n\r\n      cr = SocialCalc.crToCoord(targetcol, dbinfo.row1num + i); // get cell of this row to do the function on\r\n      cell = dbinfo.sheetdata.GetAssuredCell(cr);\r\n\r\n      value1.value = cell.datavalue;\r\n      value1.type = cell.valuetype;\r\n      t = value1.type.charAt(0);\r\n      countmatches += 1;\r\n      if (t == \"n\") count += 1;\r\n      if (t != \"b\") counta += 1;\r\n      if (t == \"b\") countblank += 1;\r\n\r\n      if (t == \"n\") {\r\n         v1 = value1.value-0; // get it as a number\r\n         sum += v1;\r\n         product *= v1;\r\n         maxval = (maxval!=undefined) ? (v1 > maxval ? v1 : maxval) : v1;\r\n         minval = (minval!=undefined) ? (v1 < minval ? v1 : minval) : v1;\r\n         if (count == 1) { // initialize with first values for variance used in STDEV, VAR, etc.\r\n            mk1 = v1;\r\n            sk1 = 0;\r\n            }\r\n         else { // Accumulate S sub 1 through n as per Knuth noted above\r\n            mk = mk1 + (v1 - mk1) / count;\r\n            sk = sk1 + (v1 - mk1) * (v1 - mk);\r\n            sk1 = sk;\r\n            mk1 = mk;\r\n            }\r\n         resulttypesum = lookup_result_type(value1.type, resulttypesum || value1.type, typelookupplus);\r\n         }\r\n      else if (t == \"e\" && resulttypesum.charAt(0) != \"e\") {\r\n         resulttypesum = value1.type;\r\n         }\r\n      }\r\n\r\n   resulttypesum = resulttypesum || \"n\";\r\n\r\n   switch (fname) {\r\n      case \"DSUM\":\r\n         PushOperand(resulttypesum, sum);\r\n         break;\r\n\r\n      case \"DPRODUCT\": // may handle cases with text differently than some other spreadsheets\r\n         PushOperand(resulttypesum, product);\r\n         break;\r\n\r\n      case \"DMIN\":\r\n         PushOperand(resulttypesum, minval || 0);\r\n         break;\r\n\r\n      case \"DMAX\":\r\n         PushOperand(resulttypesum, maxval || 0);\r\n         break;\r\n\r\n      case \"DCOUNT\":\r\n         PushOperand(\"n\", count);\r\n         break;\r\n\r\n      case \"DCOUNTA\":\r\n         PushOperand(\"n\", counta);\r\n         break;\r\n\r\n      case \"DAVERAGE\":\r\n         if (count > 0) {\r\n            PushOperand(resulttypesum, sum/count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DSTDEV\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / (count - 1))); // sk is never negative according to Knuth\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DSTDEVP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, Math.sqrt(sk / count));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DVAR\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / (count - 1));\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DVARP\":\r\n         if (count > 1) {\r\n            PushOperand(resulttypesum, sk / count);\r\n            }\r\n         else {\r\n            PushOperand(\"e#DIV/0!\", 0);\r\n            }\r\n         break;\r\n\r\n      case \"DGET\":\r\n         if (countmatches == 1) {\r\n            PushOperand(value1.type, value1.value);\r\n            }\r\n         else if (countmatches == 0) {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            }\r\n         else {\r\n            PushOperand(\"e#NUM!\", 0);\r\n            }\r\n         break;\r\n\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//*********************\r\n//\r\n// Docs see - Function Handling - ~line 1560\r\n// \r\n//*********************\r\n\r\nSocialCalc.Formula.FunctionList[\"DAVERAGE\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DCOUNT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DCOUNTA\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DGET\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DMAX\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DMIN\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DPRODUCT\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DSTDEV\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DSTDEVP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DSUM\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DVAR\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"DVARP\"] = [SocialCalc.Formula.DSeriesFunctions, 3, \"dfunc\", \"\", \"stat\"];\r\n\r\n/*\r\n#\r\n# colnum = SocialCalc.Formula.FieldToColnum(sheet, col1num, ncols, row1num, fieldname, fieldtype)\r\n#\r\n# If fieldname is a number, uses it, otherwise looks up string in cells in row to find field number\r\n#\r\n# If not found, returns 0.\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.FieldToColnum = function(sheet, col1num, ncols, row1num, fieldname, fieldtype) {\r\n\r\n   var colnum, cell, value;\r\n\r\n   if (fieldtype.charAt(0) == \"n\") { // number - return it if legal\r\n      colnum = fieldname - 0; // make sure a number\r\n      if (colnum <= 0 || colnum > ncols) {\r\n         return 0;\r\n         }\r\n      return Math.floor(colnum);\r\n      }\r\n\r\n   if (fieldtype.charAt(0) != \"t\") { // must be text otherwise\r\n      return 0;\r\n      }\r\n\r\n   fieldname = fieldname ? fieldname.toLowerCase() : \"\";\r\n\r\n   for (colnum=0; colnum < ncols; colnum++) { // look through column headers for a match\r\n      cell = sheet.GetAssuredCell(SocialCalc.crToCoord(col1num+colnum, row1num));\r\n      value = cell.datavalue;\r\n      value = (value+\"\").toLowerCase(); // ignore case\r\n      if (value == fieldname) { // match\r\n         return colnum+1;\r\n         }         \r\n      }\r\n   return 0; // looked at all and no match\r\n\r\n   }\r\n\r\n\r\n/*\r\n#\r\n# HLOOKUP(value, range, row, [rangelookup])\r\n# VLOOKUP(value, range, col, [rangelookup])\r\n# MATCH(value, range, [rangelookup])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.LookupFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var lookupvalue, range, offset, rangelookup, offsetvalue, rangeinfo;\r\n   var c, r, cincr, rincr, previousOK, csave, rsave, cell, value, valuetype, cr, lookupvalue;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   lookupvalue = operand_value_and_type(sheet, foperand);\r\n   if (typeof lookupvalue.value == \"string\") {\r\n      lookupvalue.value = lookupvalue.value.toLowerCase();\r\n      }\r\n\r\n   range = scf.TopOfStackValueAndType(sheet, foperand);\r\n\r\n   rangelookup = 1; // default to true or 1\r\n   if (fname == \"MATCH\") {\r\n      if (foperand.length) {\r\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\r\n         if (rangelookup.type.charAt(0) != \"n\") {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            return;\r\n            }\r\n         if (foperand.length) {\r\n            scf.FunctionArgsError(fname, operand);\r\n            return 0;\r\n            }\r\n         rangelookup = rangelookup.value - 0;\r\n         }\r\n      }\r\n   else {\r\n      offsetvalue = scf.OperandAsNumber(sheet, foperand);\r\n      if (offsetvalue.type.charAt(0) != \"n\") {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      offsetvalue = Math.floor(offsetvalue.value);\r\n      if (foperand.length) {\r\n         rangelookup = scf.OperandAsNumber(sheet, foperand);\r\n         if (rangelookup.type.charAt(0) != \"n\") {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            return;\r\n            }\r\n         if (foperand.length) {\r\n            scf.FunctionArgsError(fname, operand);\r\n            return 0;\r\n            }\r\n         rangelookup = rangelookup.value ? 1 : 0; // convert to 1 or 0\r\n         }\r\n      }\r\n   lookupvalue.type = lookupvalue.type.charAt(0); // only deal with general type\r\n   if (lookupvalue.type == \"n\") { // if number, make sure a number\r\n      lookupvalue.value = lookupvalue.value - 0;\r\n      }\r\n\r\n   if (range.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n\r\n   rangeinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\r\n   if (!rangeinfo) {\r\n      PushOperand(\"e#REF!\", 0);\r\n      return;\r\n      }\r\n\r\n   c = 0;\r\n   r = 0;\r\n   cincr = 0;\r\n   rincr = 0;\r\n   if (fname == \"HLOOKUP\") {\r\n      cincr = 1;\r\n      if (offsetvalue > rangeinfo.nrows) {\r\n         PushOperand(\"e#REF!\", 0);\r\n         return;\r\n         }\r\n      }\r\n   else if (fname == \"VLOOKUP\") {\r\n      rincr = 1;\r\n      if (offsetvalue > rangeinfo.ncols) {\r\n         PushOperand(\"e#REF!\", 0);\r\n         return;\r\n         }\r\n      }\r\n   else if (fname == \"MATCH\") {\r\n      if (rangeinfo.ncols > 1) {\r\n         if (rangeinfo.nrows > 1) {\r\n            PushOperand(\"e#N/A\", 0);\r\n            return;\r\n            }\r\n         cincr = 1;\r\n         }\r\n      else {\r\n         rincr = 1;\r\n         }\r\n      }\r\n   else {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   if (offsetvalue < 1 && fname != \"MATCH\") {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return 0;\r\n      }\r\n\r\n   previousOK; // if 1, previous test was <. If 2, also this one wasn't\r\n\r\n   while (1) {\r\n      cr = SocialCalc.crToCoord(rangeinfo.col1num + c, rangeinfo.row1num + r);\r\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\r\n      value = cell.datavalue;\r\n      valuetype = cell.valuetype ? cell.valuetype.charAt(0) : \"b\"; // only deal with general types\r\n      if (valuetype == \"n\") {\r\n         value = value - 0; // make sure number\r\n         }\r\n      if (rangelookup) { // rangelookup type 1 or -1: look for within brackets for matches\r\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            if ((rangelookup > 0 && lookupvalue.value > value)\r\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\r\n               previousOK = 1;\r\n               csave = c; // remember col and row of last OK\r\n               rsave = r;\r\n               }\r\n            else if (previousOK) { // last one was OK, this one isn't\r\n               previousOK = 2;\r\n               break;\r\n               }\r\n            }\r\n\r\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\r\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            if ((rangelookup > 0 && lookupvalue.value > value)\r\n                || (rangelookup < 0 && lookupvalue.value < value)) { // possible match: wait and see\r\n               previousOK = 1;\r\n               csave = c;\r\n               rsave = r;\r\n               }\r\n            else if (previousOK) { // last one was OK, this one isn't\r\n               previousOK = 2;\r\n               break;\r\n               }\r\n            }\r\n         }\r\n      else { // exact value matches\r\n         if (lookupvalue.type == \"n\" && valuetype == \"n\") {\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            }\r\n         else if (lookupvalue.type == \"t\" && valuetype == \"t\") {\r\n            value = typeof value == \"string\" ? value.toLowerCase() : \"\";\r\n            if (lookupvalue.value == value) { // match\r\n               break;\r\n               }\r\n            }\r\n         }\r\n\r\n      r += rincr;\r\n      c += cincr;\r\n      if (r >= rangeinfo.nrows || c >= rangeinfo.ncols) { // end of range to check, no exact match\r\n         if (previousOK) { // at least one could have been OK\r\n            previousOK = 2;\r\n            break;\r\n            }\r\n         PushOperand(\"e#N/A\", 0);\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (previousOK == 2) { // back to last OK\r\n      r = rsave;\r\n      c = csave;\r\n      }\r\n\r\n   if (fname == \"MATCH\") {\r\n      value = c + r + 1; // only one may be <> 0\r\n      valuetype = \"n\";\r\n      }\r\n   else {\r\n      cr = SocialCalc.crToCoord(rangeinfo.col1num+c+(fname == \"VLOOKUP\" ? offsetvalue-1 : 0), rangeinfo.row1num+r+(fname == \"HLOOKUP\" ? offsetvalue-1 : 0));\r\n      cell = rangeinfo.sheetdata.GetAssuredCell(cr);\r\n      value = cell.datavalue;\r\n      valuetype = cell.valuetype;\r\n      }\r\n   PushOperand(valuetype, value);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"HLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"hlookup\", \"\", \"lookup\"];\r\nSocialCalc.Formula.FunctionList[\"MATCH\"] = [SocialCalc.Formula.LookupFunctions, -2, \"match\", \"\", \"lookup\"];\r\nSocialCalc.Formula.FunctionList[\"VLOOKUP\"] = [SocialCalc.Formula.LookupFunctions, -3, \"vlookup\", \"\", \"lookup\"];\r\n\r\n/*\r\n#\r\n# INDEX(range, rownum, colnum)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IndexFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var range, sheetname, indexinfo, rowindex, colindex, result, resulttype;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range\r\n   if (range.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   indexinfo = scf.DecodeRangeParts(sheet, range.value, range.type);\r\n   if (indexinfo.sheetname) {\r\n      sheetname = \"!\" + indexinfo.sheetname;\r\n      }\r\n   else {\r\n      sheetname = \"\";\r\n      }\r\n\r\n   rowindex = {value:0};\r\n   colindex = {value:0};\r\n\r\n   if (foperand.length) { // look for row number\r\n      rowindex = scf.OperandAsNumber(sheet, foperand);\r\n      if (rowindex.type.charAt(0) != \"n\" || rowindex.value < 0) {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      if (foperand.length) { // look for col number\r\n         colindex = scf.OperandAsNumber(sheet, foperand);\r\n         if (colindex.type.charAt(0) != \"n\" || colindex.value < 0) {\r\n            PushOperand(\"e#VALUE!\", 0);\r\n            return;\r\n            }\r\n         if (foperand.length) {\r\n            scf.FunctionArgsError(fname, operand);\r\n            return 0;\r\n            }\r\n         }\r\n      else { // col number missing\r\n         if (indexinfo.nrows == 1) { // if only one row, then rowindex is really colindex\r\n            colindex.value = rowindex.value;\r\n            rowindex.value = 0;\r\n            }\r\n         }\r\n      }\r\n\r\n   if (rowindex.value > indexinfo.nrows || colindex.value > indexinfo.ncols) {\r\n      PushOperand(\"e#REF!\", 0);\r\n      return;\r\n      }\r\n\r\n   if (rowindex.value == 0) {\r\n      if (colindex.value == 0) {\r\n         if (indexinfo.nrows == 1 && indexinfo.ncols == 1) {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname;\r\n            resulttype = \"coord\";\r\n            }\r\n         else {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num) + sheetname + \"|\" +\r\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+indexinfo.nrows-1) + \r\n                     \"|\";\r\n            resulttype = \"range\";\r\n            }\r\n         }\r\n      else {\r\n         if (indexinfo.nrows == 1) {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname;\r\n            resulttype = \"coord\";\r\n            }\r\n         else {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num) + sheetname + \"|\" +\r\n                     SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+indexinfo.nrows-1) +\r\n                     \"|\";\r\n            resulttype = \"range\";\r\n            }\r\n         }\r\n      }\r\n   else {\r\n      if (colindex.value == 0) {\r\n         if (indexinfo.ncols == 1) {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname;\r\n            resulttype = \"coord\";\r\n            }\r\n         else {\r\n            result = SocialCalc.crToCoord(indexinfo.col1num, indexinfo.row1num+rowindex.value-1) + sheetname + \"|\" +\r\n                     SocialCalc.crToCoord(indexinfo.col1num+indexinfo.ncols-1, indexinfo.row1num+rowindex.value-1) +\r\n                     \"|\";\r\n            resulttype = \"range\";\r\n            }\r\n         }\r\n      else {\r\n         result = SocialCalc.crToCoord(indexinfo.col1num+colindex.value-1, indexinfo.row1num+rowindex.value-1) + sheetname;\r\n         resulttype = \"coord\";\r\n         }\r\n      }\r\n\r\n   PushOperand(resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"INDEX\"] = [SocialCalc.Formula.IndexFunction, -1, \"index\", \"\", \"lookup\"];\r\n\r\n/*\r\n#\r\n# COUNTIF(c1:c2,\"criteria\")\r\n# SUMIF(c1:c2,\"criteria\",[range2])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.CountifSumifFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var range, criteria, sumrange, f2operand, result, resulttype, value1, value2;\r\n   var sum = 0;\r\n   var resulttypesum = \"\";\r\n   var count = 0;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var operand_value_and_type = scf.OperandValueAndType;\r\n   var lookup_result_type = scf.LookupResultType;\r\n   var typelookupplus = scf.TypeLookupTable.plus;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   range = scf.TopOfStackValueAndType(sheet, foperand); // get range or coord\r\n   criteria = scf.OperandAsText(sheet, foperand); // get criteria\r\n   if (fname == \"SUMIF\") {\r\n      if (foperand.length == 1) { // three arg form of SUMIF\r\n         sumrange = scf.TopOfStackValueAndType(sheet, foperand);\r\n         }\r\n      else if (foperand.length == 0) { // two arg form\r\n         sumrange = {value: range.value, type: range.type};\r\n         }\r\n      else {\r\n         scf.FunctionArgsError(fname, operand);\r\n         return 0;\r\n         }\r\n      }\r\n   else {\r\n      sumrange = {value: range.value, type: range.type};\r\n      }\r\n\r\n   if (criteria.type.charAt(0) == \"n\") {\r\n      criteria.value = criteria.value + \"\"; // make text\r\n      }\r\n   else if (criteria.type.charAt(0) == \"e\") { // error\r\n      criteria.value = null;\r\n      }\r\n   else if (criteria.type.charAt(0) == \"b\") { // blank here is undefined\r\n      criteria.value = null;\r\n      }\r\n\r\n   if (range.type != \"coord\" && range.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n\r\n   if (fname == \"SUMIF\" && sumrange.type != \"coord\" && sumrange.type != \"range\") {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n\r\n   foperand.push(range);\r\n   f2operand = []; // to allow for 3 arg form\r\n   f2operand.push(sumrange);\r\n\r\n   while (foperand.length) {\r\n      value1 = operand_value_and_type(sheet, foperand);\r\n      value2 = operand_value_and_type(sheet, f2operand);\r\n      if (!scf.TestCriteria(value1.value, value1.type, criteria.value)) {\r\n         continue;\r\n         }\r\n\r\n      count += 1;\r\n\r\n      if (value2.type.charAt(0) == \"n\") {\r\n         sum += value2.value-0;\r\n         resulttypesum = lookup_result_type(value2.type, resulttypesum || value2.type, typelookupplus);\r\n         }\r\n      else if (value2.type.charAt(0) == \"e\" && resulttypesum.charAt(0) != \"e\") {\r\n         resulttypesum = value2.type;\r\n         }\r\n      }\r\n\r\n   resulttypesum = resulttypesum || \"n\";\r\n\r\n   if (fname == \"SUMIF\") {\r\n      PushOperand(resulttypesum, sum);\r\n      }\r\n   else if (fname == \"COUNTIF\") {\r\n      PushOperand(\"n\", count);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"COUNTIF\"] = [SocialCalc.Formula.CountifSumifFunctions, 2, \"rangec\", \"\", \"stat\"];\r\nSocialCalc.Formula.FunctionList[\"SUMIF\"] = [SocialCalc.Formula.CountifSumifFunctions, -2, \"sumif\", \"\", \"stat\"];\r\n\r\n/*\r\n#\r\n# IF(cond,truevalue,falsevalue)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IfFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var cond, t;\r\n\r\n   cond = SocialCalc.Formula.OperandValueAndType(sheet, foperand);\r\n   t = cond.type.charAt(0);\r\n   if (t != \"n\" && t != \"b\") {\r\n      operand.push({type: \"e#VALUE!\", value: 0});\r\n      return;\r\n      }\r\n\r\n   var op1, op2;\r\n\r\n   op1 = foperand.pop();\r\n   if (foperand.length == 1) {\r\n      op2 = foperand.pop();\r\n      }\r\n   else if (foperand.length == 0) {\r\n      op2 = {type: \"n\", value: 0};\r\n      }\r\n   else {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return;\r\n   }\r\n\r\n   operand.push(cond.value ? op1 : op2);\r\n\r\n   }\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"IF\"] = [SocialCalc.Formula.IfFunction, -2, \"iffunc\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# DATE(year,month,day)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DateFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var year = scf.OperandAsNumber(sheet, foperand);\r\n   var month = scf.OperandAsNumber(sheet, foperand);\r\n   var day = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(year.type, month.type, scf.TypeLookupTable.twoargnumeric);\r\n   resulttype = scf.LookupResultType(resulttype, day.type, scf.TypeLookupTable.twoargnumeric);\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      result = SocialCalc.FormatNumber.convert_date_gregorian_to_julian(\r\n                  Math.floor(year.value), Math.floor(month.value), Math.floor(day.value)\r\n                  ) - SocialCalc.FormatNumber.datevalues.julian_offset;\r\n      resulttype = \"nd\";\r\n      }\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"DATE\"] = [SocialCalc.Formula.DateFunction, 3, \"date\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# TIME(hour,minute,second)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.TimeFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var hours = scf.OperandAsNumber(sheet, foperand);\r\n   var minutes = scf.OperandAsNumber(sheet, foperand);\r\n   var seconds = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(hours.type, minutes.type, scf.TypeLookupTable.twoargnumeric);\r\n   resulttype = scf.LookupResultType(resulttype, seconds.type, scf.TypeLookupTable.twoargnumeric);\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      result = ((hours.value * 60 * 60) + (minutes.value * 60) + seconds.value) / (24*60*60);\r\n      resulttype = \"nt\";\r\n      }\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"TIME\"] = [SocialCalc.Formula.TimeFunction, 3, \"hms\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# DAY(date)\r\n# MONTH(date)\r\n# YEAR(date)\r\n# WEEKDAY(date, [type])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DMYFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var ymd, dtype, doffset;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n\r\n   var datevalue = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(datevalue.type, datevalue.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      ymd = SocialCalc.FormatNumber.convert_date_julian_to_gregorian(\r\n               Math.floor(datevalue.value + SocialCalc.FormatNumber.datevalues.julian_offset));\r\n      switch (fname) {\r\n         case \"DAY\":\r\n            result = ymd.day;\r\n            break;\r\n\r\n         case \"MONTH\":\r\n            result = ymd.month;\r\n            break;\r\n\r\n         case \"YEAR\":\r\n            result = ymd.year;\r\n            break;\r\n\r\n         case \"WEEKDAY\":\r\n            dtype = {value: 1};\r\n            if (foperand.length) { // get type if present\r\n               dtype = scf.OperandAsNumber(sheet, foperand);\r\n               if (dtype.type.charAt(0) != \"n\" || dtype.value < 1 || dtype.value > 3) {\r\n                  scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n                  return;\r\n                  }\r\n               if (foperand.length) { // extra args\r\n                  scf.FunctionArgsError(fname, operand);\r\n                  return;\r\n                  }\r\n               }\r\n            doffset = 6;\r\n            if (dtype.value > 1) {\r\n               doffset -= 1;\r\n               }\r\n            result = Math.floor(datevalue.value+doffset) % 7 + (dtype.value < 3 ? 1 : 0);\r\n            break;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"DAY\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"MONTH\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"YEAR\"] = [SocialCalc.Formula.DMYFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"WEEKDAY\"] = [SocialCalc.Formula.DMYFunctions, -1, \"weekday\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# HOUR(datetime)\r\n# MINUTE(datetime)\r\n# SECOND(datetime)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.HMSFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var hours, minutes, seconds, fraction;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n\r\n   var datetime = scf.OperandAsNumber(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(datetime.type, datetime.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (resulttype.charAt(0) == \"n\") {\r\n      if (datetime.value < 0) {\r\n         scf.PushOperand(operand, \"e#NUM!\", 0); // must be non-negative\r\n         return;\r\n         }\r\n      fraction = datetime.value - Math.floor(datetime.value); // fraction of a day\r\n      fraction *= 24;\r\n      hours = Math.floor(fraction);\r\n      fraction -= Math.floor(fraction);\r\n      fraction *= 60;\r\n      minutes = Math.floor(fraction);\r\n      fraction -= Math.floor(fraction);\r\n      fraction *= 60;\r\n      seconds = Math.floor(fraction + (datetime.value >= 0 ? 0.5: -0.5));\r\n      if (fname == \"HOUR\") {\r\n         result = hours;\r\n         }\r\n      else if (fname == \"MINUTE\") {\r\n         result = minutes;\r\n         }\r\n      else if (fname == \"SECOND\") {\r\n         result = seconds;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"HOUR\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"MINUTE\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"SECOND\"] = [SocialCalc.Formula.HMSFunctions, 1, \"v\", \"\", \"datetime\"];\r\n\r\n/*\r\n#\r\n# EXACT(v1,v2)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ExactFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"nl\";\r\n\r\n   var value1 = scf.OperandValueAndType(sheet, foperand);\r\n   var v1type = value1.type.charAt(0);\r\n   var value2 = scf.OperandValueAndType(sheet, foperand);\r\n   var v2type = value2.type.charAt(0);\r\n\r\n   if (v1type == \"t\") {\r\n      if (v2type == \"t\") {\r\n         result = value1.value == value2.value ? 1 : 0;\r\n         }\r\n      else if (v2type == \"b\") {\r\n         result = value1.value.length ? 0 : 1;\r\n         }\r\n      else if (v2type == \"n\") {\r\n         result = value1.value == value2.value+\"\" ? 1 : 0;\r\n         }\r\n      else if (v2type == \"e\") {\r\n         result = value2.value;\r\n         resulttype = value2.type;\r\n         }\r\n      else {\r\n         result = 0;\r\n         }\r\n      }\r\n   else if (v1type == \"n\") {\r\n      if (v2type == \"n\") {\r\n         result = value1.value-0 == value2.value-0 ? 1 : 0;\r\n         }\r\n      else if (v2type == \"b\") {\r\n         result = 0;\r\n         }\r\n      else if (v2type == \"t\") {\r\n         result = value1.value+\"\" == value2.value ? 1 : 0;\r\n         }\r\n      else if (v2type == \"e\") {\r\n         result = value2.value;\r\n         resulttype = value2.type;\r\n         }\r\n      else {\r\n         result = 0;\r\n         }\r\n      }\r\n   else if (v1type == \"b\") {\r\n      if (v2type == \"t\") {\r\n         result = value2.value.length ? 0 : 1;\r\n         }\r\n      else if (v2type == \"b\") {\r\n         result = 1;\r\n         }\r\n      else if (v2type == \"n\") {\r\n         result = 0;\r\n         }\r\n      else if (v2type == \"e\") {\r\n         result = value2.value;\r\n         resulttype = value2.type;\r\n         }\r\n      else {\r\n         result = 0;\r\n         }\r\n      }\r\n   else if (v1type == \"e\") {\r\n      result = value1.value;\r\n      resulttype = value1.type;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"EXACT\"] = [SocialCalc.Formula.ExactFunction, 2, \"\", \"\", \"text\"];\r\n\r\n/*\r\n#\r\n# FIND(key,string,[start])\r\n# LEFT(string,[length])\r\n# LEN(string)\r\n# LOWER(string)\r\n# MID(string,start,length)\r\n# PROPER(string)\r\n# REPLACE(string,start,length,new)\r\n# REPT(string,count)\r\n# RIGHT(string,[length])\r\n# SUBSTITUTE(string,old,new,[which])\r\n# TRIM(string)\r\n# HEXCODE(string)\r\n# UPPER(string)\r\n#\r\n*/\r\n\r\n// SocialCalc.Formula.ArgList has an array for each function, one entry for each possible arg (up to max).\r\n// Min args are specified in SocialCalc.Formula.FunctionList.\r\n// If array element is 1 then it's a text argument, if it's 0 then it's numeric, if -1 then just get whatever's there\r\n// Text values are manipulated as UTF-8, converting from and back to byte strings\r\n\r\nSocialCalc.Formula.ArgList = {\r\n                FIND: [1, 1, 0],\r\n                LEFT: [1, 0],\r\n                LEN: [1],\r\n                LOWER: [1],\r\n                MID: [1, 0, 0],\r\n                PROPER: [1],\r\n                REPLACE: [1, 0, 0, 1],\r\n                REPT: [1, 0],\r\n                RIGHT: [1, 0],\r\n                SUBSTITUTE: [1, 1, 1, 0],\r\n                TRIM: [1],\r\n                HEXCODE: [1],\r\n                UPPER: [1]\r\n               };\r\n\r\nSocialCalc.Formula.StringFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var i, value, offset, len, start, count;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var numargs = foperand.length;\r\n   var argdef = scf.ArgList[fname];\r\n   var operand_value = [];\r\n   var operand_type = [];\r\n\r\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\r\n      if (i > argdef.length) { // too many args\r\n         scf.FunctionArgsError(fname, operand);\r\n         return;\r\n         }\r\n      if (argdef[i-1] == 0) {\r\n         value = scf.OperandAsNumber(sheet, foperand);\r\n         }\r\n      else if (argdef[i-1] == 1) {\r\n         value = scf.OperandAsText(sheet, foperand);\r\n         }\r\n      else if (argdef[i-1] == -1) {\r\n         value = scf.OperandValueAndType(sheet, foperand);\r\n         }\r\n      operand_value[i] = value.value;\r\n      operand_type[i] = value.type;\r\n      if (value.type.charAt(0) == \"e\") {\r\n         scf.PushOperand(operand, value.type, result);\r\n         return;\r\n         }\r\n      }\r\n\r\n   switch (fname) {\r\n      case \"FIND\":\r\n         offset = operand_type[3] ? operand_value[3]-1 : 0;\r\n         if (offset < 0) {\r\n            result = \"Start is before string\"; // !! not displayed, no need to translate\r\n            }\r\n         else {\r\n            result = operand_value[2].indexOf(operand_value[1], offset); // (null string matches first char)\r\n            if (result >= 0) {\r\n               result += 1;\r\n               resulttype = \"n\";\r\n               }\r\n            else {\r\n               result = \"Not found\"; // !! not displayed, error is e#VALUE!\r\n               }\r\n            }\r\n         break;\r\n\r\n      case \"LEFT\":\r\n         len = operand_type[2] ? operand_value[2]-0 : 1;\r\n         if (len < 0) {\r\n            result = \"Negative length\";\r\n            }\r\n         else {\r\n            result = operand_value[1].substring(0, len);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"LEN\":\r\n         result = operand_value[1].length;\r\n         resulttype = \"n\";\r\n         break;\r\n\r\n      case \"LOWER\":\r\n         result = operand_value[1].toLowerCase();\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"MID\":\r\n         start = operand_value[2]-0;\r\n         len = operand_value[3]-0;\r\n         if (len < 1 || start < 1) {\r\n            result = \"Bad arguments\";\r\n            }\r\n         else {\r\n            result = operand_value[1].substring(start-1, start+len-1);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"PROPER\":\r\n         result = operand_value[1].replace(/\\b\\w+\\b/g, function(word) {\r\n                     return word.substring(0,1).toUpperCase() + \r\n                        word.substring(1);\r\n                     }); // uppercase first character of words (see JavaScript, Flanagan, 5th edition, page 704)\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"REPLACE\":\r\n         start = operand_value[2]-0;\r\n         len = operand_value[3]-0;\r\n         if (len < 0 || start < 1) {\r\n            result = \"Bad arguments\";\r\n            }\r\n         else {\r\n            result = operand_value[1].substring(0, start-1) + operand_value[4] + \r\n               operand_value[1].substring(start-1+len);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"REPT\":\r\n         count = operand_value[2]-0;\r\n         if (count < 0) {\r\n            result = \"Negative count\";\r\n            }\r\n         else {\r\n            result = \"\";\r\n            for (; count > 0; count--) {\r\n               result += operand_value[1];\r\n               }\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"RIGHT\":\r\n         len = operand_type[2] ? operand_value[2]-0 : 1;\r\n         if (len < 0) {\r\n            result = \"Negative length\";\r\n            }\r\n         else {\r\n            result = operand_value[1].slice(-len);\r\n            resulttype = \"t\";\r\n            }\r\n         break;\r\n\r\n      case \"SUBSTITUTE\":\r\n         fulltext = operand_value[1];\r\n         oldtext = operand_value[2];\r\n         newtext = operand_value[3];\r\n         if (operand_value[4] != null) {\r\n            which = operand_value[4]-0;\r\n            if (which <= 0) {\r\n               result = \"Non-positive instance number\";\r\n               break;\r\n               }\r\n            }\r\n         else {\r\n            which = 0;\r\n            }\r\n         count = 0;\r\n         oldpos = 0;\r\n         result = \"\";\r\n         while (true) {\r\n            pos = fulltext.indexOf(oldtext, oldpos);\r\n            if (pos >= 0) {\r\n               count++; //!!!!!! old test just in case: if (count>1000) {alert(pos); break;}\r\n               result += fulltext.substring(oldpos, pos);\r\n               if (which==0) {\r\n                  result += newtext; // substitute\r\n                  }\r\n               else if (which==count) {\r\n                  result += newtext + fulltext.substring(pos+oldtext.length);\r\n                  break;\r\n                  }\r\n               else {\r\n                  result += oldtext; // leave as was\r\n                  }\r\n               oldpos = pos + oldtext.length;\r\n               }\r\n            else { // no more\r\n               result += fulltext.substring(oldpos);\r\n               break;\r\n               }\r\n            }\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"TRIM\":\r\n         result = operand_value[1];\r\n         result = result.replace(/^ */, \"\");\r\n         result = result.replace(/ *$/, \"\");\r\n         result = result.replace(/ +/g, \" \");\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"HEXCODE\":\r\n         result = String(operand_value[1]);\r\n         var code = result.charCodeAt(0);\r\n         if (0xD800 <= code && code <= 0xDBFF) {\r\n             var next = result.charCodeAt(1);\r\n             if (0xDC00 <= next && next <= 0xDFFF) {\r\n                 code = ((code - 0xD800) * 0x400) + (next - 0xDC00) + 0x10000;\r\n             }\r\n         }\r\n         result = code.toString(16).toUpperCase();\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"UPPER\":\r\n         result = operand_value[1].toUpperCase();\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"FIND\"] = [SocialCalc.Formula.StringFunctions, -2, \"find\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"LEFT\"] = [SocialCalc.Formula.StringFunctions, -2, \"tc\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"LEN\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"LOWER\"] = [SocialCalc.Formula.StringFunctions, 1, \"txt\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"MID\"] = [SocialCalc.Formula.StringFunctions, 3, \"mid\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"PROPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"REPLACE\"] = [SocialCalc.Formula.StringFunctions, 4, \"replace\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"REPT\"] = [SocialCalc.Formula.StringFunctions, 2, \"tc\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"RIGHT\"] = [SocialCalc.Formula.StringFunctions, -1, \"tc\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"SUBSTITUTE\"] = [SocialCalc.Formula.StringFunctions, -3, \"subs\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"TRIM\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"HEXCODE\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"UPPER\"] = [SocialCalc.Formula.StringFunctions, 1, \"v\", \"\", \"text\"];\r\n\r\n/*\r\n#\r\n# is_functions:\r\n#\r\n# ISBLANK(value)\r\n# ISERR(value)\r\n# ISERROR(value)\r\n# ISLOGICAL(value)\r\n# ISNA(value)\r\n# ISNONTEXT(value)\r\n# ISNUMBER(value)\r\n# ISTEXT(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IsFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"nl\";\r\n\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var t = value.type.charAt(0);\r\n\r\n   switch (fname) {\r\n\r\n      case \"ISBLANK\":\r\n         result = value.type == \"b\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISERR\":\r\n         result = t == \"e\" ? (value.type == \"e#N/A\" ? 0 : 1) : 0;\r\n         break;\r\n\r\n      case \"ISERROR\":\r\n         result = t == \"e\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISLOGICAL\":\r\n         result = value.type == \"nl\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISNA\":\r\n         result = value.type == \"e#N/A\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISNONTEXT\":\r\n         result = t == \"t\" ? 0 : 1;\r\n         break;\r\n\r\n      case \"ISNUMBER\":\r\n         result = t == \"n\" ? 1 : 0;\r\n         break;\r\n\r\n      case \"ISTEXT\":\r\n         result = t == \"t\" ? 1 : 0;\r\n         break;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"ISBLANK\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISERR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISERROR\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISLOGICAL\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISNA\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISNONTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISNUMBER\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"ISTEXT\"] = [SocialCalc.Formula.IsFunctions, 1, \"v\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# ntv_functions:\r\n#\r\n# N(value)\r\n# T(value)\r\n# VALUE(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.NTVFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var t = value.type.charAt(0);\r\n\r\n   switch (fname) {\r\n\r\n      case \"N\":\r\n         result = t == \"n\" ? value.value-0 : 0;\r\n         resulttype = \"n\";\r\n         break;\r\n\r\n      case \"T\":\r\n         result = t == \"t\" ? value.value+\"\" : \"\";\r\n         resulttype = \"t\";\r\n         break;\r\n\r\n      case \"VALUE\":\r\n         if (t == \"n\" || t == \"b\") {\r\n            result = value.value || 0;\r\n            resulttype = \"n\";\r\n            }\r\n         else if (t == \"t\") {\r\n            value = SocialCalc.DetermineValueType(value.value);\r\n            if (value.type.charAt(0) != \"n\") {\r\n               result = 0;\r\n               resulttype = \"e#VALUE!\";\r\n               }\r\n            else {\r\n               result = value.value-0;\r\n               resulttype = \"n\";\r\n               }\r\n            }\r\n         break;\r\n      }\r\n\r\n   if (t == \"e\") { // error trumps\r\n      resulttype = value.type;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"N\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"T\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\r\nSocialCalc.Formula.FunctionList[\"VALUE\"] = [SocialCalc.Formula.NTVFunctions, 1, \"v\", \"\", \"text\"];\r\n\r\n/*\r\n#\r\n# ABS(value)\r\n# ACOS(value)\r\n# ASIN(value)\r\n# ATAN(value)\r\n# COS(value)\r\n# DEGREES(value)\r\n# EVEN(value)\r\n# EXP(value)\r\n# FACT(value)\r\n# INT(value)\r\n# LN(value)\r\n# LOG10(value)\r\n# ODD(value)\r\n# RADIANS(value)\r\n# SIN(value)\r\n# SQRT(value)\r\n# TAN(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.Math1Functions = function(fname, operand, foperand, sheet) {\r\n\r\n   var v1, value, f;\r\n   var result = {};\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   v1 = scf.OperandAsNumber(sheet, foperand);\r\n   value = v1.value;\r\n   result.type = scf.LookupResultType(v1.type, v1.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (result.type == \"n\") {\r\n      switch (fname) {\r\n         case \"ABS\":\r\n            value = Math.abs(value);\r\n            break;\r\n\r\n         case \"ACOS\":\r\n            if (value >= -1 && value <= 1) {\r\n               value = Math.acos(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"ASIN\":\r\n            if (value >= -1 && value <= 1) {\r\n               value = Math.asin(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"ATAN\":\r\n            value = Math.atan(value);\r\n            break;\r\n\r\n         case \"COS\":\r\n            value = Math.cos(value);\r\n            break;\r\n\r\n         case \"DEGREES\":\r\n            value = value * 180/Math.PI;\r\n            break;\r\n\r\n         case \"EVEN\":\r\n            value = value < 0 ? -value : value;\r\n            if (value != Math.floor(value)) {\r\n               value = Math.floor(value + 1) + (Math.floor(value + 1) % 2);\r\n               }\r\n            else { // integer\r\n               value = value + (value % 2);\r\n               }\r\n            if (v1.value < 0) value = -value;\r\n            break;\r\n\r\n         case \"EXP\":\r\n            value = Math.exp(value);\r\n            break;\r\n\r\n         case \"FACT\":\r\n            f = 1;\r\n            value = Math.floor(value);\r\n            for (;value>0;value--) {\r\n               f *= value;\r\n               }\r\n            value = f;\r\n            break;\r\n\r\n         case \"INT\":\r\n            value = Math.floor(value); // spreadsheet INT is floor(), not int()\r\n            break;\r\n\r\n         case \"LN\":\r\n            if (value <= 0) {\r\n               result.type = \"e#NUM!\";\r\n               result.error = SocialCalc.Constants.s_sheetfunclnarg;\r\n               }\r\n            value = Math.log(value);\r\n            break;\r\n\r\n         case \"LOG10\":\r\n            if (value <= 0) {\r\n               result.type = \"e#NUM!\";\r\n               result.error = SocialCalc.Constants.s_sheetfunclog10arg;\r\n               }\r\n            value = Math.log(value)/Math.log(10);\r\n            break;\r\n\r\n         case \"ODD\":\r\n            value = value < 0 ? -value : value;\r\n            if (value != Math.floor(value)) {\r\n               value = Math.floor(value + 1) + (1 - (Math.floor(value + 1) % 2));\r\n               }\r\n            else { // integer\r\n               value = value + (1 - (value % 2));\r\n               }\r\n            if (v1.value < 0) value = -value;\r\n            break;\r\n\r\n         case \"RADIANS\":\r\n            value = value * Math.PI/180;\r\n            break;\r\n\r\n         case \"SIN\":\r\n            value = Math.sin(value);\r\n            break;\r\n\r\n         case \"SQRT\":\r\n            if (value >= 0) {\r\n               value = Math.sqrt(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"TAN\":\r\n            if (Math.cos(value) != 0) {\r\n               value = Math.tan(value);\r\n               }\r\n            else {\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n         }\r\n      }\r\n\r\n   result.value = value;\r\n   operand.push(result);\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"ABS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ACOS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ASIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ATAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"COS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"DEGREES\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"EVEN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"EXP\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"FACT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"INT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"LN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"LOG10\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"ODD\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"RADIANS\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"SIN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"SQRT\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"TAN\"] = [SocialCalc.Formula.Math1Functions, 1, \"v\", \"\", \"math\"];\r\n\r\n\r\n/*\r\n#\r\n# ATAN2(x, y)\r\n# MOD(a, b)\r\n# POWER(a, b)\r\n# TRUNC(value, precision)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.Math2Functions = function(fname, operand, foperand, sheet) {\r\n\r\n   var xval, yval, value, quotient, decimalscale, i;\r\n   var result = {};\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   xval = scf.OperandAsNumber(sheet, foperand);\r\n   yval = scf.OperandAsNumber(sheet, foperand);\r\n   value = 0;\r\n   result.type = scf.LookupResultType(xval.type, yval.type, scf.TypeLookupTable.twoargnumeric);\r\n\r\n   if (result.type == \"n\") {\r\n      switch (fname) {\r\n         case \"ATAN2\":\r\n            if (xval.value == 0 && yval.value == 0) {\r\n               result.type = \"e#DIV/0!\";\r\n               }\r\n            else {\r\n               result.value = Math.atan2(yval.value, xval.value);\r\n               }\r\n            break;\r\n\r\n         case \"POWER\":\r\n            result.value = Math.pow(xval.value, yval.value);\r\n            if (isNaN(result.value)) {\r\n               result.value = 0;\r\n               result.type = \"e#NUM!\";\r\n               }\r\n            break;\r\n\r\n         case \"MOD\": // en.wikipedia.org/wiki/Modulo_operation, etc.\r\n            if (yval.value == 0) {\r\n               result.type = \"e#DIV/0!\";\r\n               }\r\n            else {\r\n               quotient = xval.value/yval.value;\r\n               quotient = Math.floor(quotient);\r\n               result.value = xval.value - (quotient * yval.value);\r\n               }\r\n            break;\r\n\r\n         case \"TRUNC\":\r\n            decimalscale = 1; // cut down to required number of decimal digits\r\n            if (yval.value >= 0) {\r\n               yval.value = Math.floor(yval.value);\r\n               for (i=0; i<yval.value; i++) {\r\n                  decimalscale *= 10;\r\n                  }\r\n               result.value = Math.floor(Math.abs(xval.value) * decimalscale) / decimalscale;\r\n               }\r\n            else if (yval.value < 0) {\r\n               yval.value = Math.floor(-yval.value);\r\n               for (i=0; i<yval.value; i++) {\r\n                  decimalscale *= 10;\r\n                  }\r\n               result.value = Math.floor(Math.abs(xval.value) / decimalscale) * decimalscale;\r\n               }\r\n            if (xval.value < 0) {\r\n               result.value = -result.value;\r\n               }\r\n            }\r\n         }\r\n \r\n   operand.push(result);\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"ATAN2\"] = [SocialCalc.Formula.Math2Functions, 2, \"xy\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"MOD\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"POWER\"] = [SocialCalc.Formula.Math2Functions, 2, \"\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"TRUNC\"] = [SocialCalc.Formula.Math2Functions, 2, \"valpre\", \"\", \"math\"];\r\n\r\n/*\r\n#\r\n# LOG(value,[base])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.LogFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var value, value2;\r\n   var result = {};\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   result.value = 0;\r\n\r\n   value = scf.OperandAsNumber(sheet, foperand);\r\n   result.type = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\r\n   if (foperand.length == 1) {\r\n      value2 = scf.OperandAsNumber(sheet, foperand);\r\n      if (value2.type.charAt(0) != \"n\" || value2.value <= 0) {\r\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogsecondarg);\r\n         return 0;\r\n         }\r\n      }\r\n   else if (foperand.length != 0) {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   else {\r\n      value2 = {value: Math.E, type: \"n\"};\r\n      }\r\n\r\n   if (result.type == \"n\") {\r\n      if (value.value <= 0) {\r\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfunclogfirstarg);\r\n         return 0;\r\n         }\r\n      result.value = Math.log(value.value)/Math.log(value2.value);\r\n      }\r\n\r\n   operand.push(result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"LOG\"] = [SocialCalc.Formula.LogFunction, -1, \"log\", \"\", \"math\"];\r\n\r\n\r\n/*\r\n#\r\n# ROUND(value,[precision])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.RoundFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var value2, decimalscale, scaledvalue, i;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.oneargnumeric);\r\n\r\n   if (foperand.length == 1) {\r\n      value2 = scf.OperandValueAndType(sheet, foperand);\r\n      if (value2.type.charAt(0) != \"n\") {\r\n         scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncroundsecondarg);\r\n         return 0;\r\n         }\r\n      }\r\n   else if (foperand.length != 0) {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   else {\r\n      value2 = {value: 0, type: \"n\"}; // if no second arg, assume 0 for simple round\r\n      }\r\n\r\n   if (resulttype == \"n\") {\r\n      value2.value = value2.value-0;\r\n      if (value2.value == 0) {\r\n         result = Math.round(value.value);\r\n         }\r\n      else if (value2.value > 0) {\r\n         decimalscale = 1; // cut down to required number of decimal digits\r\n         value2.value = Math.floor(value2.value);\r\n         for (i=0; i<value2.value; i++) {\r\n            decimalscale *= 10;\r\n            }\r\n         scaledvalue = Math.round(value.value * decimalscale);\r\n         result = scaledvalue / decimalscale;\r\n         }\r\n      else if (value2.value < 0) {\r\n         decimalscale = 1; // cut down to required number of decimal digits\r\n         value2.value = Math.floor(-value2.value);\r\n         for (i=0; i<value2.value; i++) {\r\n            decimalscale *= 10;\r\n            }\r\n         scaledvalue = Math.round(value.value / decimalscale);\r\n         result = scaledvalue * decimalscale;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"ROUND\"] = [SocialCalc.Formula.RoundFunction, -1, \"vp\", \"\", \"math\"];\r\n\r\n/*\r\n#\r\n# CEILING(value, [significance])\r\n# FLOOR(value, [significance])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.CeilingFloorFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var val, sig, t;\r\n\r\n   var PushOperand = function(t, v) {operand.push({type: t, value: v});};\r\n\r\n   val = scf.OperandValueAndType(sheet, foperand);\r\n   t = val.type.charAt(0);\r\n   if (t != \"n\") {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return;\r\n      }\r\n   if (val.value == 0) {\r\n      PushOperand(\"n\", 0);\r\n      return;\r\n      }\r\n\r\n   if (foperand.length == 1) {\r\n      sig = scf.OperandValueAndType(sheet, foperand);\r\n      t = val.type.charAt(0);\r\n      if (t != \"n\") {\r\n         PushOperand(\"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      }\r\n   else if (foperand.length == 0) {\r\n      sig = {type: \"n\", value: val.value > 0 ? 1 : -1};\r\n      }\r\n   else {\r\n      PushOperand(\"e#VALUE!\", 0);\r\n      return;\r\n      }\r\n   if (sig.value == 0) {\r\n      PushOperand(\"n\", 0);\r\n      return;\r\n      }\r\n   if (sig.value * val.value < 0) {\r\n      PushOperand(\"e#NUM!\", 0);\r\n      return;\r\n      }\r\n\r\n   switch (fname) {\r\n      case \"CEILING\":\r\n         PushOperand(\"n\", Math.ceil(val.value / sig.value) * sig.value);\r\n         break;\r\n      case \"FLOOR\":\r\n         PushOperand(\"n\", Math.floor(val.value / sig.value) * sig.value);\r\n         break;\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"CEILING\"] = [SocialCalc.Formula.CeilingFloorFunctions, -1, \"vsig\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"FLOOR\"] = [SocialCalc.Formula.CeilingFloorFunctions, -1, \"vsig\", \"\", \"math\"];\r\n\r\n/*\r\n#\r\n# AND(v1,c1:c2,...)\r\n# OR(v1,c1:c2,...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.AndOrFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, result;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var resulttype = \"\";\r\n\r\n   if (fname == \"AND\") {\r\n      result = 1;\r\n      }\r\n   else if (fname == \"OR\") {\r\n      result = 0;\r\n      }\r\n\r\n   while (foperand.length) {\r\n      value1 = scf.OperandValueAndType(sheet, foperand);\r\n      if (value1.type.charAt(0) == \"n\") {\r\n         value1.value = value1.value-0;\r\n         if (fname == \"AND\") {\r\n            result = value1.value != 0 ? result : 0;\r\n            }\r\n         else if (fname == \"OR\") {\r\n            result = value1.value != 0 ? 1 : result;\r\n            }\r\n         resulttype = scf.LookupResultType(value1.type, resulttype || \"nl\", scf.TypeLookupTable.propagateerror);\r\n         }\r\n      else if (value1.type.charAt(0) == \"e\" && resulttype.charAt(0) != \"e\") {\r\n         resulttype = value1.type;\r\n         }\r\n      }\r\n   if (resulttype.length < 1) {\r\n      resulttype = \"e#VALUE!\";\r\n      result = 0;\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"AND\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"OR\"] = [SocialCalc.Formula.AndOrFunctions, -1, \"vn\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# NOT(value)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.NotFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var result = 0;\r\n   var scf = SocialCalc.Formula;\r\n   var value = scf.OperandValueAndType(sheet, foperand);\r\n   var resulttype = scf.LookupResultType(value.type, value.type, scf.TypeLookupTable.propagateerror);\r\n\r\n   if (value.type.charAt(0) == \"n\" || value.type == \"b\") {\r\n      result = value.value-0 != 0 ? 0 : 1; // do the \"not\" operation\r\n      resulttype = \"nl\";\r\n      }\r\n   else if (value.type.charAt(0) == \"t\") {\r\n      resulttype = \"e#VALUE!\";\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"NOT\"] = [SocialCalc.Formula.NotFunction, 1, \"v\", \"\", \"test\"];\r\n\r\n/*\r\n#\r\n# CHOOSE(index,value1,value2,...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ChooseFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttype, count, value1;\r\n   var result = 0;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cindex = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (cindex.type.charAt(0) != \"n\") {\r\n      cindex.value = 0;\r\n      }\r\n   cindex.value = Math.floor(cindex.value);\r\n\r\n   count = 0;\r\n   while (foperand.length) {\r\n      value1 = scf.TopOfStackValueAndType(sheet, foperand);\r\n      count += 1;\r\n      if (cindex.value == count) {\r\n         result = value1.value;\r\n         resulttype = value1.type;\r\n         break;\r\n         }\r\n      }\r\n   if (resulttype) { // found something\r\n      scf.PushOperand(operand, resulttype, result);\r\n      }\r\n   else {\r\n      scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"CHOOSE\"] = [SocialCalc.Formula.ChooseFunction, -2, \"choose\", \"\", \"lookup\"];\r\n\r\n/*\r\n#\r\n# COLUMNS(c1:c2)\r\n# ROWS(c1:c2)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ColumnsRowsFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttype, rangeinfo;\r\n   var result = 0;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var value1 = scf.TopOfStackValueAndType(sheet, foperand);\r\n\r\n   if (value1.type == \"coord\") {\r\n      result = 1;\r\n      resulttype = \"n\";\r\n      }\r\n\r\n   else if (value1.type == \"range\") {\r\n      rangeinfo = scf.DecodeRangeParts(sheet, value1.value);\r\n      if (fname == \"COLUMNS\") {\r\n         result = rangeinfo.ncols;\r\n         }\r\n      else if (fname == \"ROWS\") {\r\n         result = rangeinfo.nrows;\r\n         }\r\n      resulttype = \"n\";\r\n      }\r\n   else {\r\n      result = 0;\r\n      resulttype = \"e#VALUE!\";\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"COLUMNS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\r\nSocialCalc.Formula.FunctionList[\"ROWS\"] = [SocialCalc.Formula.ColumnsRowsFunctions, 1, \"range\", \"\", \"lookup\"];\r\n\r\n\r\n/*\r\n#\r\n# FALSE()\r\n# NA()\r\n# NOW()\r\n# PI()\r\n# TODAY()\r\n# TRUE()\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.ZeroArgFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var startval, tzoffset, start_1_1_1970, seconds_in_a_day, nowdays;\r\n   var result = {value: 0};\r\n   \r\n   switch (fname) {\r\n      case \"FALSE\":\r\n         result.type = \"nl\";\r\n         result.value = 0;\r\n         break;\r\n\r\n      case \"NA\":\r\n         result.type = \"e#N/A\";\r\n         break;\r\n\r\n      case \"NOW\":\r\n         startval = new Date();\r\n         tzoffset = startval.getTimezoneOffset();\r\n         startval = startval.getTime() / 1000; // convert to seconds\r\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\r\n         seconds_in_a_day = 24 * 60 * 60;\r\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\r\n         result.value = nowdays;\r\n         result.type = \"ndt\";\r\n         SocialCalc.Formula.FreshnessInfo.volatile.NOW = true; // remember\r\n         break;\r\n\r\n      case \"PI\":\r\n         result.type = \"n\";\r\n         result.value = Math.PI;\r\n         break;\r\n\r\n      case \"TODAY\":\r\n         startval = new Date();\r\n         tzoffset = startval.getTimezoneOffset();\r\n         startval = startval.getTime() / 1000; // convert to seconds\r\n         start_1_1_1970 = 25569; // Day number of 1/1/1970 starting with 1/1/1900 as 1\r\n         seconds_in_a_day = 24 * 60 * 60;\r\n         nowdays = start_1_1_1970 + startval / seconds_in_a_day - tzoffset/(24*60);\r\n         result.value = Math.floor(nowdays);\r\n         result.type = \"nd\";\r\n         SocialCalc.Formula.FreshnessInfo.volatile.TODAY = true; // remember\r\n         break;\r\n\r\n      case \"TRUE\":\r\n         result.type = \"nl\";\r\n         result.value = 1;\r\n         break;\r\n\r\n      }\r\n\r\n   operand.push(result);\r\n\r\n   return null;\r\n\r\n}\r\n\r\n// Add to function list\r\nSocialCalc.Formula.FunctionList[\"FALSE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"NA\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\r\nSocialCalc.Formula.FunctionList[\"NOW\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"PI\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"math\"];\r\nSocialCalc.Formula.FunctionList[\"TODAY\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"datetime\"];\r\nSocialCalc.Formula.FunctionList[\"TRUE\"] = [SocialCalc.Formula.ZeroArgFunctions, 0, \"\", \"\", \"test\"];\r\n\r\n//\r\n// * * * * * FINANCIAL FUNCTIONS * * * * *\r\n//\r\n\r\n/*\r\n#\r\n# DDB(cost,salvage,lifetime,period,[method])\r\n#\r\n# Depreciation, method defaults to 2 for double-declining balance\r\n# See: http://en.wikipedia.org/wiki/Depreciation\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.DDBFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var method, depreciation, accumulateddepreciation, i;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cost = scf.OperandAsNumber(sheet, foperand);\r\n   var salvage = scf.OperandAsNumber(sheet, foperand);\r\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\r\n   var period = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (scf.CheckForErrorValue(operand, cost)) return;\r\n   if (scf.CheckForErrorValue(operand, salvage)) return;\r\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\r\n   if (scf.CheckForErrorValue(operand, period)) return;\r\n\r\n   if (lifetime.value < 1) {\r\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncddblife);\r\n      return 0;\r\n      }\r\n\r\n   method = {value: 2, type: \"n\"};\r\n   if (foperand.length > 0 ) {\r\n      method = scf.OperandAsNumber(sheet, foperand);\r\n      }\r\n   if (foperand.length != 0) {\r\n      scf.FunctionArgsError(fname, operand);\r\n      return 0;\r\n      }\r\n   if (scf.CheckForErrorValue(operand, method)) return;\r\n\r\n   depreciation = 0; // calculated for each period\r\n   accumulateddepreciation = 0; // accumulated by adding each period's\r\n\r\n   for (i=1; i<=period.value-0 && i<=lifetime.value; i++) { // calculate for each period based on net from previous\r\n      depreciation = (cost.value - accumulateddepreciation) * (method.value / lifetime.value);\r\n      if (cost.value - accumulateddepreciation - depreciation < salvage.value) { // don't go lower than salvage value\r\n         depreciation = cost.value - accumulateddepreciation - salvage.value;\r\n         }\r\n      accumulateddepreciation += depreciation;\r\n      }\r\n\r\n   scf.PushOperand(operand, 'n$', depreciation);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"DDB\"] = [SocialCalc.Formula.DDBFunction, -4, \"ddb\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# SLN(cost,salvage,lifetime)\r\n#\r\n# Depreciation for each period by straight-line method\r\n# See: http://en.wikipedia.org/wiki/Depreciation\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SLNFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var depreciation;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cost = scf.OperandAsNumber(sheet, foperand);\r\n   var salvage = scf.OperandAsNumber(sheet, foperand);\r\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (scf.CheckForErrorValue(operand, cost)) return;\r\n   if (scf.CheckForErrorValue(operand, salvage)) return;\r\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\r\n\r\n   if (lifetime.value < 1) {\r\n      scf.FunctionSpecificError(fname, operand, \"e#NUM!\", SocialCalc.Constants.s_sheetfuncslnlife);\r\n      return 0;\r\n      }\r\n\r\n   depreciation = (cost.value - salvage.value) / lifetime.value;\r\n\r\n   scf.PushOperand(operand, 'n$', depreciation);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"SLN\"] = [SocialCalc.Formula.SLNFunction, 3, \"csl\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# SYD(cost,salvage,lifetime,period)\r\n#\r\n# Depreciation by Sum of Year's Digits method\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.SYDFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var depreciation, sumperiods;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var cost = scf.OperandAsNumber(sheet, foperand);\r\n   var salvage = scf.OperandAsNumber(sheet, foperand);\r\n   var lifetime = scf.OperandAsNumber(sheet, foperand);\r\n   var period = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   if (scf.CheckForErrorValue(operand, cost)) return;\r\n   if (scf.CheckForErrorValue(operand, salvage)) return;\r\n   if (scf.CheckForErrorValue(operand, lifetime)) return;\r\n   if (scf.CheckForErrorValue(operand, period)) return;\r\n\r\n   if (lifetime.value < 1 || period.value <= 0) {\r\n      scf.PushOperand(operand, \"e#NUM!\", 0);\r\n      return 0;\r\n      }\r\n\r\n   sumperiods = ((lifetime.value + 1) * lifetime.value)/2; // add up 1 through lifetime\r\n   depreciation = (cost.value - salvage.value) * (lifetime.value - period.value + 1) / sumperiods; // calc depreciation\r\n\r\n   scf.PushOperand(operand, 'n$', depreciation);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"SYD\"] = [SocialCalc.Formula.SYDFunction, 4, \"cslp\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# FV(rate, n, payment, [pv, [paytype]])\r\n# NPER(rate, payment, pv, [fv, [paytype]])\r\n# PMT(rate, n, pv, [fv, [paytype]])\r\n# PV(rate, n, payment, [fv, [paytype]])\r\n# RATE(n, payment, pv, [fv, [paytype, [guess]]])\r\n#\r\n# Following the Open Document Format formula specification:\r\n#\r\n#    PV = - Fv - (Payment * Nper) [if rate equals 0]\r\n#    Pv*(1+Rate)^Nper + Payment * (1 + Rate*PaymentType) * ( (1+Rate)^nper -1)/Rate + Fv = 0\r\n#\r\n# For each function, the formulas are solved for the appropriate value (transformed using\r\n# basic algebra).\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.InterestFunctions = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttype, result, dval, eval, fval;\r\n   var pv, fv, rate, n, payment, paytype, guess, part1, part2, part3, part4, part5;\r\n   var olddelta, maxloop, tries, deltaepsilon, rate, oldrate, m;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var aval = scf.OperandAsNumber(sheet, foperand);\r\n   var bval = scf.OperandAsNumber(sheet, foperand);\r\n   var cval = scf.OperandAsNumber(sheet, foperand);\r\n\r\n   resulttype = scf.LookupResultType(aval.type, bval.type, scf.TypeLookupTable.twoargnumeric);\r\n   resulttype = scf.LookupResultType(resulttype, cval.type, scf.TypeLookupTable.twoargnumeric);\r\n   if (foperand.length) { // optional arguments\r\n      dval = scf.OperandAsNumber(sheet, foperand);\r\n      resulttype = scf.LookupResultType(resulttype, dval.type, scf.TypeLookupTable.twoargnumeric);\r\n      if (foperand.length) { // optional arguments\r\n         eval = scf.OperandAsNumber(sheet, foperand);\r\n         resulttype = scf.LookupResultType(resulttype, eval.type, scf.TypeLookupTable.twoargnumeric);\r\n         if (foperand.length) { // optional arguments\r\n            if (fname != \"RATE\") { // only rate has 6 possible args\r\n               scf.FunctionArgsError(fname, operand);\r\n               return 0;\r\n               }\r\n            fval = scf.OperandAsNumber(sheet, foperand);\r\n            resulttype = scf.LookupResultType(resulttype, fval.type, scf.TypeLookupTable.twoargnumeric);\r\n            }\r\n         }\r\n      }\r\n\r\n   if (resulttype == \"n\") {\r\n      switch (fname) {\r\n         case \"FV\": // FV(rate, n, payment, [pv, [paytype]])\r\n            rate = aval.value;\r\n            n = bval.value;\r\n            payment = cval.value;\r\n            pv = dval!=null ? dval.value : 0; // get value if present, or use default\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (rate == 0) { // simple calculation if no interest\r\n               fv = -pv - (payment * n);\r\n               }\r\n            else {\r\n               fv = -(pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\r\n               }\r\n            result = fv;\r\n            resulttype = 'n$';\r\n            break;\r\n\r\n         case \"NPER\": // NPER(rate, payment, pv, [fv, [paytype]])\r\n            rate = aval.value;\r\n            payment = bval.value;\r\n            pv = cval.value;\r\n            fv = dval!=null ? dval.value : 0;\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (rate == 0) { // simple calculation if no interest\r\n               if (payment == 0) {\r\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                  return;\r\n                  }\r\n               n = (pv + fv)/(-payment);\r\n               }\r\n            else {\r\n               part1 = payment * (1 + rate * paytype) / rate;\r\n               part2 = pv + part1;\r\n               if (part2 == 0 || rate <= -1) {\r\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                  return;\r\n                  }\r\n               part3 = (part1 - fv) / part2;\r\n               if (part3 <= 0) {\r\n                  scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                  return;\r\n                  }\r\n               part4 = Math.log(part3);\r\n               part5 = Math.log(1 + rate); // rate > -1\r\n               n = part4/part5;\r\n               }\r\n            result = n;\r\n            resulttype = 'n';\r\n            break;\r\n\r\n         case \"PMT\": // PMT(rate, n, pv, [fv, [paytype]])\r\n            rate = aval.value;\r\n            n = bval.value;\r\n            pv = cval.value;\r\n            fv = dval!=null ? dval.value : 0;\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (n == 0) {\r\n               scf.PushOperand(operand, \"e#NUM!\", 0);\r\n               return;\r\n               }\r\n            else if (rate == 0) { // simple calculation if no interest\r\n               payment = (fv - pv)/n;\r\n               }\r\n            else {\r\n               payment = (0 - fv - pv*Math.pow(1+rate,n))/((1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate);\r\n               }\r\n            result = payment;\r\n            resulttype = 'n$';\r\n            break;\r\n\r\n         case \"PV\": // PV(rate, n, payment, [fv, [paytype]])\r\n            rate = aval.value;\r\n            n = bval.value;\r\n            payment = cval.value;\r\n            fv = dval!=null ? dval.value : 0;\r\n            paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n            if (rate == -1) {\r\n               scf.PushOperand(operand, \"e#DIV/0!\", 0);\r\n               return;\r\n               }\r\n            else if (rate == 0) { // simple calculation if no interest\r\n               pv = -fv - (payment * n);\r\n               }\r\n            else {\r\n               pv = (-fv - payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate)/(Math.pow(1+rate,n));\r\n               }\r\n            result = pv;\r\n            resulttype = 'n$';\r\n            break;\r\n\r\n            case \"RATE\": // RATE(n, payment, pv, [fv, [paytype, [guess]]])\r\n               n = aval.value;\r\n               payment = bval.value;\r\n               pv = cval.value;\r\n               fv = dval!=null ? dval.value : 0;\r\n               paytype = eval!=null ? (eval.value ? 1 : 0) : 0;\r\n               guess = fval!=null ? fval.value : 0.1;\r\n\r\n               // rate is calculated by repeated approximations\r\n               // The deltas are used to calculate new guesses\r\n\r\n               maxloop = 100;\r\n               tries = 0;\r\n               delta = 1;\r\n               epsilon = 0.0000001; // this is close enough\r\n               rate = guess || 0.00000001; // zero is not allowed\r\n               while ((delta >= 0 ? delta : -delta) > epsilon && (rate != oldrate)) {\r\n                  delta = fv + pv*Math.pow(1+rate,n) + payment * (1 + rate*paytype) * ( Math.pow(1+rate,n) -1)/rate;\r\n                  if (olddelta!=null) {\r\n                     m = (delta - olddelta)/(rate - oldrate) || .001; // get slope (not zero)\r\n                     oldrate = rate;\r\n                     rate = rate - delta / m; // look for zero crossing\r\n                     olddelta = delta;\r\n                     }\r\n                  else { // first time - no old values\r\n                     oldrate = rate;\r\n                     rate = 1.1 * rate;\r\n                     olddelta = delta;\r\n                     }\r\n                  tries++;\r\n                  if (tries >= maxloop) { // didn't converge yet\r\n                     scf.PushOperand(operand, \"e#NUM!\", 0);\r\n                     return;\r\n                     }\r\n                  }\r\n               result = rate;\r\n               resulttype = 'n%';\r\n               break;\r\n         }\r\n      }\r\n \r\n   scf.PushOperand(operand, resulttype, result);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"FV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"fv\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"NPER\"] = [SocialCalc.Formula.InterestFunctions, -3, \"nper\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"PMT\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pmt\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"PV\"] = [SocialCalc.Formula.InterestFunctions, -3, \"pv\", \"\", \"financial\"];\r\nSocialCalc.Formula.FunctionList[\"RATE\"] = [SocialCalc.Formula.InterestFunctions, -3, \"rate\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# NPV(rate,v1,v2,c1:c2,...)\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.NPVFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var resulttypenpv, rate, sum, factor, value1;\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   var rate = scf.OperandAsNumber(sheet, foperand);\r\n   if (scf.CheckForErrorValue(operand, rate)) return;\r\n\r\n   sum = 0;\r\n   resulttypenpv = \"n\";\r\n   factor = 1;\r\n\r\n   while (foperand.length) {\r\n      value1 = scf.OperandValueAndType(sheet, foperand);\r\n      if (value1.type.charAt(0) == \"n\") {\r\n         factor *= (1 + rate.value);\r\n         if (factor == 0) {\r\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\r\n            return;\r\n            }\r\n         sum += value1.value / factor;\r\n         resulttypenpv = scf.LookupResultType(value1.type, resulttypenpv || value1.type, scf.TypeLookupTable.plus);\r\n         }\r\n      else if (value1.type.charAt(0) == \"e\" && resulttypenpv.charAt(0) != \"e\") {\r\n         resulttypenpv = value1.type;\r\n         break;\r\n         }\r\n      }\r\n\r\n   if (resulttypenpv.charAt(0) == \"n\") {\r\n      resulttypenpv = 'n$';\r\n      }\r\n\r\n   scf.PushOperand(operand, resulttypenpv, sum);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"NPV\"] = [SocialCalc.Formula.NPVFunction, -2, \"npv\", \"\", \"financial\"];\r\n\r\n/*\r\n#\r\n# IRR(c1:c2,[guess])\r\n#\r\n*/\r\n\r\nSocialCalc.Formula.IRRFunction = function(fname, operand, foperand, sheet) {\r\n\r\n   var value1, guess, oldsum, maxloop, tries, epsilon, rate, oldrate, m, sum, factor, i;\r\n   var rangeoperand = [];\r\n   var cashflows = [];\r\n\r\n   var scf = SocialCalc.Formula;\r\n\r\n   rangeoperand.push(foperand.pop()); // first operand is a range\r\n\r\n   while (rangeoperand.length) { // get values from range so we can do iterative approximations\r\n      value1 = scf.OperandValueAndType(sheet, rangeoperand);\r\n      if (value1.type.charAt(0) == \"n\") {\r\n         cashflows.push(value1.value);\r\n         }\r\n      else if (value1.type.charAt(0) == \"e\") {\r\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (!cashflows.length) {\r\n      scf.PushOperand(operand, \"e#NUM!\", 0);\r\n      return;\r\n      }\r\n\r\n   guess = {value: 0};\r\n\r\n   if (foperand.length) { // guess is provided\r\n      guess = scf.OperandAsNumber(sheet, foperand);\r\n      if (guess.type.charAt(0) != \"n\" && guess.type.charAt(0) != \"b\") {\r\n         scf.PushOperand(operand, \"e#VALUE!\", 0);\r\n         return;\r\n         }\r\n      if (foperand.length) { // should be no more args\r\n         scf.FunctionArgsError(fname, operand);\r\n         return;\r\n         }\r\n      }\r\n\r\n   guess.value = guess.value || 0.1;\r\n\r\n   // rate is calculated by repeated approximations\r\n   // The deltas are used to calculate new guesses\r\n\r\n   maxloop = 20;\r\n   tries = 0;\r\n   epsilon = 0.0000001; // this is close enough\r\n   rate = guess.value;\r\n   sum = 1;\r\n\r\n   while ((sum >= 0 ? sum : -sum) > epsilon && (rate != oldrate)) {\r\n      sum = 0;\r\n      factor = 1;\r\n      for (i=0; i<cashflows.length; i++) {\r\n         factor *= (1 + rate);\r\n         if (factor == 0) {\r\n            scf.PushOperand(operand, \"e#DIV/0!\", 0);\r\n            return;\r\n            }\r\n         sum += cashflows[i] / factor;\r\n         }\r\n\r\n      if (oldsum!=null) {\r\n         m = (sum - oldsum)/(rate - oldrate); // get slope\r\n         oldrate = rate;\r\n         rate = rate - sum / m; // look for zero crossing\r\n         oldsum = sum;\r\n         }\r\n      else { // first time - no old values\r\n         oldrate = rate;\r\n         rate = 1.1 * rate;\r\n         oldsum = sum;\r\n         }\r\n      tries++;\r\n      if (tries >= maxloop) { // didn't converge yet\r\n         scf.PushOperand(operand, \"e#NUM!\", 0);\r\n         return;\r\n         }\r\n      }\r\n\r\n   scf.PushOperand(operand, 'n%', rate);\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.Formula.FunctionList[\"IRR\"] = [SocialCalc.Formula.IRRFunction, -1, \"irr\", \"\", \"financial\"];\r\n\r\n\r\n\r\n// -----------------------------------------\r\n// eddy  BUTTON COPYVALUE COPYFORMULA {\r\n// -----------------------------------------\r\n\r\n/*\r\n#\r\n# BUTTON(string) // \r\n# IMAGEBUTTON(string) \r\n# TEXTBOX(string) // \r\n# AUTOCOMPLETE(string, range)\r\n# SELECT(string, range [,size [,multiple]])\r\n# CHECKBOX(string) // \r\n# RADIOBUTTON(string,groupname)\r\n# COPYVALUE(range, destinationCell, value_or_range) // \r\n# COPYFORMULA(range, destinationCell, formula_range)) // \r\n# INSERT(trigger_cell, destination_range [,formula_range,value_range,formula_range, ...])\r\n# DELETEIF(trigger_cell, criteria , test_range) \r\n# COMMAND(trigger_cell, commands)\r\n# COMMANDIF(trigger_cell, condition, commands) \r\n# PANEL(indices_or_csv, panel1_range [, panel2_range , ...])  \r\n# SPLASH(splash_panel_range)  // shows splash screen (range) - shows while loading dependant sheets from server  \r\n# STYLE(css)  \r\n#\r\n*/\r\n\r\n\r\nSocialCalc.Formula.IoFunctions = function(fname, operand, foperand, sheet, coord) {\r\n\r\n  \r\n// ArgList has an array for each function, one entry for each possible arg (up to max).\r\n// Min args are specified in SocialCalc.Formula.FunctionList.\r\n// Minus values are repeated parameters\r\n//  -1 to -15  - repeated parameters\r\n//  -1 - [number, ...]  - e.g. [2,-1,-2]  means (text, [number, text, number, text, ... ] - repeated parameters\r\n//  1 - number \r\n//  2 - text \r\n//  3 - text | number \r\n//  4 - coord \r\n//  5 - coord | number \r\n//  6 - coord | text \r\n//  7 - coord | text | number \r\n//  8 - range \r\n//  9 - range | number \r\n//  10 - range | text 11 - range | text | number \r\n//  12 - range | coord \r\n//  13 - range | coord | number \r\n//  14 - range | coord | text \r\n//  15 - range | coord | text | number \r\n\r\n\r\n\r\n   var argList = {\r\n\t\t\t\t BUTTON: [2]\r\n        ,ONEDITDO: [12, 14]\r\n        ,IMAGEBUTTON: [2]\r\n   \t\t\t,EMAIL: [14, 14, 14, 14]\r\n\t\t\t\t,EMAILIF: [13, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILONEDIT: [14, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILAT: [13, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILONEDITIF: [14, 13, 14, 14, 14, 14]\r\n\t\t\t\t,EMAILATIF: [13, 13, 14, 14, 14, 14]\r\n        ,SUBMIT: [2]\r\n        ,TEXTBOX: [2]\r\n        ,AUTOCOMPLETE: [2, 14]\r\n        ,SELECT: [2, 14, 1, 1]   // # SELECT(string, range [,size [,multiple]])\r\n        ,CHECKBOX: [3]\r\n        ,RADIOBUTTON: [2, 2]\r\n\t\t\t\t,COPYVALUE: [4, 12, 15]\r\n\t\t\t\t,COPYFORMULA: [4, 12, 12]\r\n        ,INSERT: [4, 8, -12, -15]  // change code to allow unlimited \r\n        ,DELETEIF: [4,7,8]\r\n        ,COMMAND: [4, 14]\r\n        ,COMMANDIF: [4, 13, 14]\r\n        ,PANEL:[15, -12] // # PANEL(indices_or_csv, panel1_range [, panel2_range , ...])  \r\n        ,SPLASH:[12]  // SPLASH(splash_panel_range)  // shows splash screen (range)\r\n        ,STYLE:[6] // # STYLE(css)  \r\n   };\r\n   \r\n   var i, parameter, offset, len, start, count;\r\n   var scf = SocialCalc.Formula;\r\n   var result = 0;\r\n   var resulttype = \"e#VALUE!\";\r\n\r\n   var numargs = foperand.length;\r\n   var argdef = argList[fname];\r\n   var operand_value = [];\r\n   var operand_type = [];\r\n\r\n   var repeatCount = -1;  // number of repeated parameters\r\n   var repeatIndex;  // index of begining of repeated parameters\r\n   var wantedType;\r\n   \r\n   for (i=1; i <= numargs; i++) { // go through each arg, get value and type, and check for errors\r\n      //   IF started repeat parameters section \r\n      if(repeatCount != -1) {\r\n        //     SET typeWanted = get type - adjust for repeted parameters\r\n        wantedType = Math.abs(argdef[ repeatIndex + (( (i-1) - repeatIndex) % repeatCount) ]);\r\n      } else {\r\n        \r\n        if (i > argdef.length) { // too many args\r\n          scf.FunctionArgsError(fname, operand);\r\n          return;\r\n          }\r\n        \r\n        //     typeWanted = type wanted list [ parameterIndex ]\r\n        wantedType = argdef[i-1];\r\n        \r\n        //     IF typeWanted < 0 && repeatCount == -1\r\n        if(wantedType < 0 ) {\r\n          //       SET repeatCount = wanted list length - parameterIndex\r\n          repeatCount = argdef.length - (i-1);\r\n          //       SET repeatIndex =  parameterIndex\r\n          repeatIndex = (i-1);\r\n          //       wantedType = Math.abs(wantedType )          \r\n          wantedType = Math.abs(wantedType );\r\n        }  //     END IF\r\n      \r\n      } //   END IF\r\n\r\n      if(wantedType == 1) { // 1 - number \r\n        parameter = scf.OperandAsNumber(sheet, foperand);\r\n        \r\n      } else if(wantedType == 2) { // 2 - text \r\n        parameter = scf.OperandAsText(sheet, foperand);\r\n      } else if(wantedType == 3) { // 3 - text | number \r\n        parameter = scf.OperandValueAndType(sheet, foperand);\r\n      } else { //  typeWanted > 3  && < 16  - else invalid        \r\n        //        SET parameterType = type\r\n        var parameterType = foperand[foperand.length -1].type; // param is end of stack\r\n        \r\n        //        SET validType = false  \r\n        var validParameterType = false;\r\n        \r\n        //        IF type = number && wanted type == number || type = text && wanted type == text THEN\r\n        //                  1 - number   2 - text \r\n        if( (parameterType.charAt(0) == \"n\" && (wantedType & 1) != 0) || (parameterType.charAt(0) == \"t\" && (wantedType & 2) != 0)) {\r\n          //           valid\r\n          validParameterType = true;\r\n          //           get number type and value \r\n          parameter = scf.OperandValueAndType(sheet, foperand);\r\n        }  //        END IF\r\n        \r\n        //        IF type = coord && wanted type == coord THEN\r\n        if( parameterType == \"coord\" && (wantedType & 4) != 0) {  //  4 - coord \r\n          //          valid\r\n          validParameterType = true;\r\n          parameter = scf.OperandAsCoord(sheet, foperand);\r\n          parameter.value = SocialCalc.Formula.PlainCoord(parameter.value); // remove absolute reference\r\n        } //        END IF\r\n        //        IF type = range && wanted type == range THEN\r\n        if( parameterType == \"range\" && (wantedType & 8) != 0) { // 8 - range \r\n          //           valid\r\n          validParameterType = true;\r\n          // get range\r\n          parameter = scf.OperandAsRange(sheet, foperand);          \r\n          parameter.value = SocialCalc.Formula.PlainCoord(parameter.value);  // remove absolute reference\r\n        } //        END IF\r\n        \r\n        //        IF invalid param type\r\n        if(validParameterType == false) {\r\n          scf.FunctionArgsError(fname, operand);\r\n          return;          \r\n        }  //        END IF\r\n        \r\n      }\r\n      \r\n      \r\n      // value or range, e.g. \"C9|C11\"\r\n      operand_value[i] = parameter.value;\r\n      // type e.g. \"t\", \"range\"\r\n      operand_type[i] = parameter.type;\r\n      if (parameter.type.charAt(0) == \"e\") {\r\n         scf.PushOperand(operand, parameter.type, result);\r\n         return;\r\n      }\r\n   }\r\n\r\n   \r\n   switch (fname) {\r\n     case \"STYLE\":  \r\n       var parameters = sheet.ioParameterList[coord];\r\n       if(parameters) {\r\n         var css = SocialCalc.Formula.getStandardizedList(sheet, {value: operand_value[1], type: operand_type[1]});\r\n         if(css.length > 0 ) {\r\n           parameters.css = css[0];\r\n           parameters.cssParameter = (operand_type[1] == \"t\") ? '\"'+operand_value[1]+'\"' : operand_value[1];\r\n         }\r\n         result = \"\"; // ensure return value does not get changed by style - will add this empty string to number or string\r\n         resulttype = \"ni\"; // important - allows widgets to keep type - use: TEXTBOX(\"\")+STYLE(css)  - must add style to widget \r\n       }\r\n       break;\r\n     case \"SELECT\":  // # SELECT(string, range [,size [,multiple]])\r\n         var parameters = sheet.ioParameterList[coord];\r\n         var optionSource = SocialCalc.Formula.getStandardizedList(sheet, parameters[1]);\r\n         \r\n         parameters.html = [];        \r\n         parameters.html[0] = (operand_value[4] == true) ? \"multiple\" : \"\"\r\n         parameters.html[1] = (operand_value[3]) ? \"\"+operand_value[3] : \"1\"\r\n         if(optionSource.length > 0 ) {\r\n           var options = \"<option>\" + optionSource.join(\"</option><option>\") + \"</option>\";\r\n           var optionRegExp = new RegExp(\"<option>\"+operand_value[1],'');\r\n           parameters.html[2] = options.replace(optionRegExp, \"<option selected>\"+operand_value[1] ); // select default, if any\r\n         }\r\n         result = operand_value[1];\r\n         resulttype = \"ti\"+fname;\r\n         break;\r\n     case \"SUBMIT\":\r\n       result = \"Submit\";\r\n     case \"BUTTON\":\r\n     case \"IMAGEBUTTON\":\r\n     case \"TEXTBOX\":\r\n     case \"AUTOCOMPLETE\":\r\n         if (numargs>0) result = operand_value[1];\r\n         resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (BUTTON,IMAGEBUTTON,TEXTBOX,AUTOCOMPLETE, SELECT) \r\n         break;\r\n\r\n      case \"EMAIL\":\r\n      case \"EMAILIF\":\r\n          resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (,) \r\n          result = \"Send\";\r\n          break;\r\n      case \"EMAILONEDIT\":\r\n      case \"EMAILONEDITIF\":\r\n//    \t  sheet.editEventCells === 'undefined') return;\t\r\n//    \t  if(typeof sheet.ioParameterList === 'undefined') return;\r\n\r\n    \t  \r\n      case \"EMAILAT\":\r\n      case \"EMAILATIF\":\r\n          resulttype = \"ti\"+fname; // (t)ext value with (i)nterface (,) \r\n          result = \"Send Now\";\r\n          break;\r\n\t\t  \r\n      case \"ONEDITDO\":\r\n          resulttype = \"ti\"+fname;\r\n          // if 2nd arg is a text, display it; else display blank\r\n          result = operand_type[2] == 't' ? operand_value[2] : '';\r\n          break;\r\n\r\n      case \"CHECKBOX\":\r\n      case \"RADIOBUTTON\":\r\n\t     if(operand_type[1].charAt(0) == 't') {\r\n\t\t\tresult = (operand_value[1].toUpperCase() == 'TRUE') ? 1 : 0;\r\n\t\t\t} else {\r\n\t\t\tresult = (operand_value[1] == 0) ? 0 : 1;\r\n\t\t\t}\r\n\t\t//result = \"true\"; \r\n         resulttype = \"ni\"+fname; // (n)umber value with (i)nterface (CHECKBOX, RADIOBUTTON)\r\n\r\n         break;\r\n\t\t \r\n\t\t \r\n      case \"COPYVALUE\":\r\n      case \"COPYFORMULA\":\r\n      case \"INSERT\":\r\n      case \"DELETEIF\":\r\n      case \"COMMAND\":\r\n      case \"COMMANDIF\":\r\n         var cell = sheet.cells[operand_value[1]];\r\n         if(typeof cell === 'undefined') break; // invalid trigger cell, return error\r\n         result = cell.datavalue; // get trigger cell value\r\n         \r\n         result = String(result).split(\"/\");  // Clean up - if image button trigger then show only image name \r\n         result = result[result.length-1]; \r\n         resulttype = \"t\";\r\n         break;\r\n      case \"PANEL\":\r\n      case \"SPLASH\":\r\n        \r\n        //  - code to show/hide panel\r\n        //  --- get list of panels to show - \"showindex_or_csv\" \r\n        //  --- get param details \r\n        var showindices;\r\n        var firstPanelIndex = 2;\r\n        if(fname == \"SPLASH\") {\r\n          result = \"SPLASH:\"+ operand_value[1]; \r\n          resulttype = \"t\";\r\n          if (sheet.splashdone == true) break; // show splash scree onload, then skip\r\n          sheet.splashdone = true;\r\n          firstPanelIndex = 1;\r\n          showindices = [0]; // show panel at param 0 of splash formula\r\n          \r\n        } else {\r\n          // panel formula\r\n          showindices = SocialCalc.Formula.getStandardizedList(sheet, {value: operand_value[1], type: operand_type[1]});\r\n          result = fname+\":\"+ showindices; \r\n        }\r\n        //  --- SET list of showrows TO empty\r\n        //  --- SET list of showcols TO empty\r\n        resulttype = \"t\";\r\n        if(SocialCalc._app) { // panel only works in live app\r\n          var showrows = [], showcols = [];\r\n          //  --- FOR each panel to show\r\n          for (var parameterIndex = firstPanelIndex; parameterIndex < operand_value.length; ++parameterIndex) { \r\n            // show panel if its index is in the showindices list \r\n            var showPanelFound = false;\r\n            for(var showIndex in showindices ) { \r\n              if (showindices[showIndex] == parameterIndex-1) {\r\n                showPanelFound = true;\r\n                break;\r\n              }\r\n            }\r\n            if(showPanelFound === false) continue;\r\n            \r\n          \r\n            //  ----- get panel range rows & cols only\r\n            var panelCoordData = SocialCalc.Formula.getStandardizedCoords(sheet, {value: operand_value[parameterIndex], type: operand_type[parameterIndex]});\r\n            //  ----- FOR each row/col -- create function to do the loop\r\n            for (var i=0; i<panelCoordData.ncols; i++) {\r\n              //  ------- set showrows/col row/col to true\r\n              showcols[panelCoordData.col1num + i] = true;\r\n            }  //  ----- END FOR                        \r\n            for (var j=0; j<panelCoordData.nrows; j++) {\r\n              //  ------- set showrows/col row/col to true\r\n              showrows[panelCoordData.row1num + j] = true;\r\n            }\r\n          }   //  --- END FOR\r\n          \r\n          var spreadsheet =  window.spreadsheet;\r\n          if (spreadsheet == null) spreadsheet = window.ss\r\n\r\n          var forceRender = false;\r\n          var lastShowDimension = 0;\r\n          var showGridDimension =  function(sheet, lastIndex, sheetHideList, showList, getIndexOf) {\r\n            //  --- hide all rows/col    up to sheet.attribs.lastrow/col         \r\n            //  --- FOR each row/col -- create function to do the loop          \r\n            for(var arrayIndex = 1; arrayIndex <= lastIndex; arrayIndex ++ ) { // start at col/row 1\r\n              //  ----- IF row hide/show state need updating\r\n              var sheetHideIndex = getIndexOf(arrayIndex); // gets col name if col\r\n              if(typeof sheetHideList[sheetHideIndex] == 'undefined') { \r\n                // row/col is visible\r\n                if(showList[arrayIndex] !== true) { // if hide\r\n                  //  ------- SET the row state  \r\n                  sheetHideList[sheetHideIndex] =\"yes\";                \r\n                  //  ------- SET repaint flag\r\n                  forceRender = true;\r\n                } else {lastShowDimension = arrayIndex;}\r\n              } else {\r\n                // row/col is hidden \r\n                if(showList[arrayIndex] === true) { // if show \r\n                  //  ------- SET the row state  \r\n                  delete sheetHideList[sheetHideIndex];                \r\n                  //  ------- SET repaint flag\r\n                  forceRender = true;\r\n                  lastShowDimension = arrayIndex;\r\n                }\r\n              }              \r\n              \r\n            }            \r\n          };\r\n\r\n          \r\n          var getRowIndex = function(row) { return row };\r\n          showGridDimension(sheet,  sheet.attribs.lastrow,  sheet.rowattribs.hide, showrows, getRowIndex);\r\n          lastShowDimension = 0;\r\n          showGridDimension(sheet,  sheet.attribs.lastcol,  sheet.colattribs.hide, showcols, SocialCalc.rcColname );\r\n          // control width of html - for mobile app - as better to use native scroll rather than SocialCalc scroll bar - colpanes[length].last = usermaxcol - see FitToEditTable\r\n          sheet.attribs.usermaxcol = lastShowDimension;\r\n          \r\n          if(forceRender) {\r\n            sheet.renderneeded = true;\r\n            sheet.widgetsClean = false; //  force widgets to repaint - update cell reference in widget HTML    \r\n            spreadsheet.editor.context.rowpanes[0].first = 1; // reset scroll bar to first row  \r\n            spreadsheet.editor.context.CalculateColWidthData();\r\n            \r\n            spreadsheet.width = spreadsheet.editor.context.totalwidth;\r\n            spreadsheet.height = 2500;\r\n            spreadsheet.editor.ResizeTableEditor(spreadsheet.editor.context.totalwidth,2500);  // 2500 is page height constant - fix issue with mobile device - Used constant because could not see an easy way to pre-calculate height \r\n          }\r\n          \r\n        }\r\n         \r\n      }\r\n\r\n   scf.PushOperand(operand, resulttype, result);\r\n   return;\r\n\r\n   }\r\n\r\n//*********************\r\n//\r\n// Docs see - Function Handling - ~line 1560\r\n// \r\n//*********************\r\n\r\n\r\n\r\nSocialCalc.Formula.FunctionList[\"BUTTON\"] = [SocialCalc.Formula.IoFunctions, 1, \"label\", \"\", \"gui\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\\\"><%=formated_value%></button>\" , \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"IMAGEBUTTON\"] = [SocialCalc.Formula.IoFunctions, 1, \"imageurl\", \"\", \"gui\", \"<input type='image' src='<%=display_value%>' alt='Submit' onclick=\\\"SocialCalc.TriggerIoAction.Button('<%=cell_reference%>');\\\">\", \"ParameterList\"  ];\r\nSocialCalc.Formula.FunctionList[\"EMAIL\"] = [SocialCalc.Formula.IoFunctions, -3, \"to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILIF\"] = [SocialCalc.Formula.IoFunctions, -4, \"condition_range, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILONEDIT\"] = [SocialCalc.Formula.IoFunctions, -4, \"editRange, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"ONEDITDO\"] = [SocialCalc.Formula.IoFunctions, -2, \"trigger_range, name_range_or_text, id\", \"\", \"action\", \"<%=formated_value%>\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"EMAILAT\"] = [SocialCalc.Formula.IoFunctions, -4, \"datetime_value, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"TimeTrigger\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILONEDITIF\"] = [SocialCalc.Formula.IoFunctions, -5, \"editRange, condition, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"EventTree\" ];\r\nSocialCalc.Formula.FunctionList[\"EMAILATIF\"] = [SocialCalc.Formula.IoFunctions, -5, \"datetime_value, condition, to_range subject_range, body_range\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Email('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"TimeTrigger\" ];\r\nSocialCalc.Formula.FunctionList[\"SUBMIT\"] = [SocialCalc.Formula.IoFunctions, 100, \"[label]\", \"\", \"action\", \"<button type='button' onclick=\\\"SocialCalc.TriggerIoAction.Submit('<%=cell_reference%>');\\\"><%=formated_value%></button>\", \"ParameterList\" ];\r\nSocialCalc.Formula.FunctionList[\"TEXTBOX\"] = [SocialCalc.Formula.IoFunctions, 1, \"value\", \"\", \"gui\", \"<input type='text' id='TEXTBOX_<%=cell_reference%>' onblur='SocialCalc.CmdGotFocus(null);' oninput=\\\"SocialCalc.TriggerIoAction.TextBox('<%=cell_reference%>')\\\" value='<%=display_value%>' >\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"AUTOCOMPLETE\"] = [SocialCalc.Formula.IoFunctions, 2, \"value, range or csv_text\", \"\", \"gui\", \"<input type='text' id='AUTOCOMPLETE_<%=cell_reference%>' onfocus=\\\"SocialCalc.TriggerIoAction.AddAutocomplete('<%=cell_reference%>');\\\" onblur='SocialCalc.CmdGotFocus(null);' value='<%=display_value%>' >\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"SELECT\"] = [SocialCalc.Formula.IoFunctions, -2, \"value, range or csv_text [,size]\", \"\", \"gui\", \"<select size='<%=html1_value%>' id='SELECT_<%=cell_reference%>' onchange=\\\"SocialCalc.TriggerIoAction.SelectList('<%=cell_reference%>')\\\" <%=html0_value%>><%=html2_value%></select>\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"CHECKBOX\"] = [SocialCalc.Formula.IoFunctions, 1, \"value\", \"\", \"gui\", \"<input type='checkbox' id='CHECKBOX_<%=cell_reference%>' <%=checked%> onblur='SocialCalc.CmdGotFocus(null);' onchange=\\\"SocialCalc.TriggerIoAction.CheckBox('<%=cell_reference%>')\\\" >\", \"Input\" ];\r\nSocialCalc.Formula.FunctionList[\"RADIOBUTTON\"] = [SocialCalc.Formula.IoFunctions, 2, \"value, groupname\", \"\", \"gui\", \"<input type='radio' value='<%=cell_reference%>' id='RADIOBUTTON_<%=cell_reference%>' <%=checked%> name='<%=parameter1_value%>' onblur=\\\"SocialCalc.CmdGotFocus(null);\\\" onclick=\\\"SocialCalc.TriggerIoAction.RadioButton('<%=parameter1_value%>');\\\" >\", \"Input\" ];\r\n\r\nSocialCalc.Formula.FunctionList[\"COPYVALUE\"] = [SocialCalc.Formula.IoFunctions, 3, \"trigger_cell, destinationCell, value_or_range\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"COPYFORMULA\"] = [SocialCalc.Formula.IoFunctions, 3, \"trigger_cell, destinationCell, formula_range\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"INSERT\"] = [SocialCalc.Formula.IoFunctions, -2, \"trigger_cell, destination_range [,formula_range,value_or_range,formula_range, ...]\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"DELETEIF\"] = [SocialCalc.Formula.IoFunctions, -1, \"trigger_cell, criteria , test_range\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"COMMAND\"] = [SocialCalc.Formula.IoFunctions, -1, \"trigger_cell, commands\", \"\", \"action\", \"\", \"EventTree\"];\r\nSocialCalc.Formula.FunctionList[\"COMMANDIF\"] = [SocialCalc.Formula.IoFunctions, -1, \"trigger_cell, conditions, commands\", \"\", \"action\", \"\", \"EventTree\"];\r\n\r\nSocialCalc.Formula.FunctionList[\"PANEL\"] = [SocialCalc.Formula.IoFunctions, -1, \"showindices_range_or_csv, panel1_range [, panel2_range , ...]\", \"\", \"gui\", \"\"];\r\nSocialCalc.Formula.FunctionList[\"SPLASH\"] = [SocialCalc.Formula.IoFunctions, -1, \"splash_panel_range\", \"\", \"gui\", \"\"];\r\n\r\nSocialCalc.Formula.FunctionList[\"STYLE\"] = [SocialCalc.Formula.IoFunctions, -1, \"css\", \"\", \"gui\", \"\"];\r\n\r\n// on enter input box refresh the auto complete list\r\nSocialCalc.TriggerIoAction.AddAutocomplete = function(triggerCellId) {\r\n  var spreadsheet =  window.spreadsheet;\r\n  if (spreadsheet == null) spreadsheet = window.ss\r\n  var sheet = spreadsheet.sheet;\r\n  var scf = SocialCalc.Formula; \r\n  \r\n  var parameters = sheet.ioParameterList[triggerCellId];\r\n  if(typeof parameters === 'undefined') return;\r\n  \r\n  var autocompleteSource = SocialCalc.Formula.getStandardizedList(sheet, parameters[1])\r\n\r\n  //Overrides the default autocomplete filter function to search only from the beginning of the string\r\n  $.ui.autocomplete.filter = function (array, term) {\r\n    // * RegEx Unit Test - https://regex101.com/r/kO6eC4/1\r\n    var matcher = new RegExp(\"\\\\b\" + $.ui.autocomplete.escapeRegex(term), \"i\");\r\n    return $.grep(array, function (value) {\r\n        return matcher.test(value.label || value.value || value);\r\n    });\r\n  };\r\n\r\n  \r\n  $(\"#AUTOCOMPLETE_\"+triggerCellId).autocomplete({\r\n    source: autocompleteSource,\r\n    minLength: 1,\r\n    autoFocus: true,\r\n    select: function(event, ui) {\r\n      $(this).val(ui.item.label);\r\n      SocialCalc.TriggerIoAction.AutoComplete(triggerCellId);\r\n    },\r\n    change: function (event, ui) {\r\n      if (ui.item === null) {\r\n          $(this).val('');\r\n      }\r\n      SocialCalc.TriggerIoAction.AutoComplete(triggerCellId);\r\n    }\r\n  });  \r\n}\r\n// Event triggered, e.g. button/imagebutton clicked. - call linked action formulas \r\n// eddy TriggerIoAction {\r\nSocialCalc.TriggerIoAction.Button = function(triggerCellId) {\r\n var spreadsheet =  window.spreadsheet;\r\n if (spreadsheet == null) spreadsheet = window.ss\r\n var sheet = spreadsheet.sheet;\r\n var scf = SocialCalc.Formula; \r\n //spreadsheet.editor.EditorScheduleSheetCommands('set A2 value n 10',  true, false);\r\n \r\n //spreadsheet.editor.EditorScheduleSheetCommands('sendemail to eddy.nihon',  false, false); \r\n \r\n if(typeof sheet.ioEventTree === 'undefined') return;\t\r\n if(typeof sheet.ioParameterList === 'undefined') return;\r\n if( sheet.ioEventTree[triggerCellId] === 'undefined' ) return;\r\n \r\n for(var actionCellId in sheet.ioEventTree[triggerCellId]) {\r\n \r\n\tvar parameters = sheet.ioParameterList[actionCellId];\r\n\tvar conditionsParameter = null;\r\n\t\r\n\tswitch(parameters.function_name) {\r\n\t  \r\n\t  case \"COPYVALUE\" :\t    \r\n\t    var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]);\r\n\r\n      // get row and col of dest cell\r\n   \t  var destcr = SocialCalc.coordToCr(parameters[1].value);\r\n   \t  \r\n   \t  var sheetCommandList = SocialCalc.TriggerIoAction.CopyValueToRange(parameterdata, destcr);\r\n   \t  spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);   \t  \r\n   \t \r\n\t    break;\r\n\t  case \"COPYFORMULA\" : \r\n      var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]);\r\n\r\n      // get row and col of dest cell\r\n      var destcr = SocialCalc.coordToCr(parameters[1].value);\r\n      \r\n      var sheetCommandList = SocialCalc.TriggerIoAction.CopyFormulaToRange(parameterdata, destcr);\r\n        \r\n      spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);\r\n      break;\r\n    case \"INSERT\" :  \r\n      //       # INSERT(trigger_cell, destination_range ,formula_range,value_range,formula_range, ...) // \r\n      //       insertrow A1      \r\n      //       insertcol A1\r\n      var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // destination_range\r\n      if(parameterdata.type != \"range\") break; // invalid insert, requires range\r\n      var insertCommand;\r\n      var colOffset, rowOffset;\r\n      if (parameterdata.ncols > 1) {  // insert column\r\n        colOffset = 1;\r\n        rowOffset = 0;\r\n        insertCommand = \"insertcol\";\r\n      }\r\n      if (parameterdata.nrows > 1) {  // insert row\r\n        colOffset = 0;\r\n        rowOffset = 1;\r\n        insertCommand = \"insertrow\";\r\n      }\r\n      var insertcellCoord = parameterdata.cellcoord[colOffset][rowOffset];\r\n      var sheetCommandList = insertCommand + \" \" + insertcellCoord;\r\n      var destcr = SocialCalc.coordToCr(insertcellCoord);\r\n      var sourceDataIndex = 2; \r\n      while(sourceDataIndex < parameters.length ) {\r\n        \r\n        if(parameters[sourceDataIndex].type == \"range\" || parameters[sourceDataIndex].type == \"coord\" || sourceDataIndex % 2 == 1) {\r\n          copyCellRange = SocialCalc.Formula.getStandardizedValues(sheet, parameters[sourceDataIndex]); // formulas to insert\r\n          \r\n          if (sourceDataIndex % 2 == 0) {\r\n            sheetCommandList = sheetCommandList + \"\\n\" + SocialCalc.TriggerIoAction.CopyFormulaToRange(copyCellRange, destcr);\r\n          } else {\r\n            sheetCommandList = sheetCommandList + \"\\n\" + SocialCalc.TriggerIoAction.CopyValueToRange(copyCellRange, destcr);            \r\n          }\r\n          if (parameterdata.nrows > 1) destcr.col += copyCellRange.ncols;\r\n          if (parameterdata.ncols > 1) destcr.row += copyCellRange.nrows;\r\n          \r\n        }        \r\n        sourceDataIndex ++;\r\n        \r\n      }\r\n      spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);        \r\n      \r\n   \t\t break;\r\n    case \"DELETEIF\" :  //     # DELETEIF(trigger_cell, criteria , test_range) // \r\n      var criteriaParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // criteria \r\n      var testRangeParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]); // test_range - ignore first and last, as it would produce ref error\r\n\r\n      // set command list to empty\r\n      var sheetCommandList = \"\";\r\n\r\n      var colOffset, rowOffset, deleteCommand;\r\n      if (testRangeParameter.ncols > 1 && testRangeParameter.nrows > 1) return; // error invalid range, only one cell wide/high\r\n      if (testRangeParameter.ncols > 1) {  // delete column\r\n        colOffset = 1;\r\n        rowOffset = 0;\r\n        deleteCommand = \"deletecol\";\r\n      }\r\n      if (testRangeParameter.nrows > 1) {  // delete row\r\n        colOffset = 0;\r\n        rowOffset = 1;\r\n        deleteCommand = \"deleterow\";\r\n      }\r\n      \r\n      var criteriaValue = criteriaParameter.celldata[0][0].datavalue;\r\n      // FOR each source cell\r\n      for (var i=(testRangeParameter.ncols - colOffset) - 1; i>=colOffset; i--) {  // ignore first and last cell, as it would produce ref error\r\n        for (var j=(testRangeParameter.nrows - rowOffset) -1 ; j>=rowOffset; j--) {\r\n          \r\n          // IF after first source cell THEN  add new line to command list\r\n      \r\n          var cell = testRangeParameter.celldata[i][j];\r\n          if(SocialCalc.Formula.TestCriteria(cell.datavalue, cell.valuetype, criteriaValue) == true) {\r\n            if (sheetCommandList != \"\" ) sheetCommandList = sheetCommandList + \"\\n\";\r\n            sheetCommandList = sheetCommandList + deleteCommand + \" \" + testRangeParameter.cellcoord[i][j]; // Note cell.coord becomes invalid when row/coll are inserted/deleted\r\n          }\r\n        }\r\n      }\r\n      \r\n      if (sheetCommandList != \"\" ) spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);        \r\n      \r\n      break;\r\n    case \"COMMANDIF\" :  //    # COMMANDIF(trigger_cell, condition, commands) \r\n      conditionsParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // commands \r\n\r\n      \r\n    case \"COMMAND\" :  // COMMAND(trigger_cell, commands) \r\n      var commandsParameter;\r\n      // set command list to empty\r\n      var sheetCommandList = \"\";\r\n      if( conditionsParameter != null) {\r\n        var commandsParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[2]); // commands \r\n        if (conditionsParameter.ncols != commandsParameter.ncols || conditionsParameter.nrows != commandsParameter.nrows) break;\r\n      } else {\r\n        commandsParameter = SocialCalc.Formula.getStandardizedValues(sheet, parameters[1]); // commands         \r\n      }\r\n      \r\n      for (var i=0; i<commandsParameter.ncols; i++) {\r\n        for (var j=0; j<commandsParameter.nrows; j++) {\r\n\r\n          if( conditionsParameter != null) {\r\n            var conditionCell = conditionsParameter.celldata[i][j];\r\n            if(conditionCell.datavalue == false) continue;\r\n          }\r\n          if (sheetCommandList != \"\" ) sheetCommandList = sheetCommandList + \"\\n\";\r\n          var cellCommand = commandsParameter.celldata[i][j];  \r\n          sheetCommandList = sheetCommandList + cellCommand.datavalue.toString().trim();\r\n          \r\n        }\r\n      }\r\n      if (sheetCommandList != \"\" ) spreadsheet.editor.EditorScheduleSheetCommands(sheetCommandList,  true, false);        \r\n\r\n      break;\r\n      \r\n  }\r\n\r\n } \r\n\r\n}\r\n\r\n\r\n/******************************\r\n * CopyFormulaToRange\r\n *   copy a range of cells to a destination. Copy the formulas, adjusting any cell references\r\n * \r\n * @destcr col and row - destcr = { col:n, row:n }\r\n * @sourceData  range data - datatype of param must match getStandardizedParameter() return type\r\n * @return commands to execute to do the copy.  - String of sheet commands, \\n between each command -  \r\n *   \r\n ******************************/\r\n\r\n/*\r\n * set B8 text t william              ... coord: \"B8\",  datavalue: \"william\",     datatype: \"t\", formula: \"\",          valuetype: \"t\"\r\n * set B10 constant nd 41307 2013/2/2 ... coord: \"B10\", datavalue: 41307,         datatype: \"c\", formula: \"2013/2/2\",  valuetype: \"nd\"\r\n * set B11 value n 1                  ... coord: \"B11\", datavalue: 1,             datatype: \"v\", formula: \"\",          valuetype: \"n\"\r\n *\r\n * set B7 formula \"test\"&B3   ... coord: \"B7\",  datavalue: \"testwilliam\", datatype: \"f\", formula: \"\"test\"&B3\", valuetype: \"t\"\r\n * set C8 formula B8       ... coord: \"C8\",  datavalue: \"william\",     datatype: \"f\", formula: \"B8\",        valuetype: \"t\"\r\n * set C10 formula B10     ... coord: \"C10\", datavalue: 41307,         datatype: \"f\", formula: \"B10\",       valuetype: \"nd\"\r\n * set C11 formula B11     ... coord: \"C11\", datavalue: 1,             datatype: \"f\", formula: \"B11\",       valuetype: \"n\"\r\n *  set B3  formula TEXTBOX(\"\")             ... coord: \"B3\", datavalue: \"william\", datatype: \"f\", formula: \"TEXTBOX(\"william\")\", valuetype: \"tiTEXTBOX\"\r\n */\r\n\r\nSocialCalc.TriggerIoAction.CopyFormulaToRange = function(formulaData, destcr) {\r\n\r\n  // set command list to empty\r\n  var sheetCommandList = \"\";\r\n  var sheetCommand;\r\n  \r\n  // FOR each source cell\r\n  for (var i=0; i<formulaData.ncols; i++) {\r\n    for (var j=0; j<formulaData.nrows; j++) {\r\n  \r\n      var cell = formulaData.celldata[i][j];\r\n      // destination cell coord\r\n      var destCellCoord = SocialCalc.crToCoord(destcr.col + i, destcr.row + j);\r\n  \r\n  \r\n      // IF after first source cell THEN  add new line to command list\r\n      if (i != 0 || j != 0 ) sheetCommandList = sheetCommandList + \"\\n\";\r\n  \r\n  \r\n      if (typeof cell !== 'undefined' && cell.valuetype != 'b') { // if not blank get cell data\r\n        var cellDataType = cell.datatype;\r\n        var cellValueType = cell.valuetype;     \r\n        var cellDataValue = cell.datavalue;   \r\n        var cellFormula = cell.formula;\r\n        \r\n        if(cellDataType == 'f') {\r\n          cellFormula = SocialCalc.OffsetFormulaCoords(cellFormula, destcr.col -  formulaData.col1num, destcr.row -  formulaData.row1num);\r\n          cellDataValue = \"\";\r\n          cellValueType = \"\";  \r\n        } else { \r\n          if(cellDataType != \"c\") cellFormula = \"\";  // clear text and number types   but not constant type like date/time      \r\n        }\r\n        \r\n        sheetCommand = 'set '+destCellCoord+ ' ' + SocialCalc.Constants.cellDataType[cellDataType] + ' ' +cellValueType + ' '+ SocialCalc.encodeForSave(cellDataValue) + ' ' + cellFormula;            \r\n      } else { \r\n        sheetCommand = 'set '+destCellCoord+ ' empty';        \r\n      }          \r\n      sheetCommandList += sheetCommand.trim();\r\n    }\r\n  }\r\n\r\n  return sheetCommandList;\r\n\r\n}\r\n\r\n/******************************\r\n * CopyValueToRange\r\n *   copy a range of cells to a destination. Copy only the values\r\n * \r\n * @destcr col and row - destcr = { col:n, row:n }\r\n * @sourceData  range data - datatype of param must match getStandardizedParameter() return type\r\n * @return commands to execute to do the copy.  - String of sheet commands, \\n between each command -  \r\n *   \r\n ******************************/\r\nSocialCalc.TriggerIoAction.CopyValueToRange = function(sourceData, destcr) {\r\n\r\n\r\n    //----------------------\r\n    // set command list to empty\r\n    var sheetCommandList = \"\";\r\n    var sheetCommand;\r\n    \r\n    // FOR each source cell\r\n    for (var i=0; i<sourceData.ncols; i++) {\r\n      for (var j=0; j<sourceData.nrows; j++) {\r\n    \r\n        var cell = sourceData.celldata[i][j];\r\n        // destination cell coord\r\n        var destCellCoord = SocialCalc.crToCoord(destcr.col + i, destcr.row + j);\r\n    \r\n    \r\n        // IF after first source cell THEN  add new line to command list\r\n        if (i != 0 || j != 0 ) sheetCommandList = sheetCommandList + \"\\n\";\r\n    \r\n    \r\n        // copyvalue to set command\r\n        // take the cell from copyvalue source and convert it to a set command to set the destination\r\n        // e.g. set D3 text t push me \r\n        // e.g. set D3 value v 10   \r\n        // e.g. set D5 constant n% 0.1 10%\r\n        // e.g. set D6 constant nd 41922 10/10/2014\r\n        if (typeof cell !== 'undefined' && cell.valuetype != 'b') { // if not blank get cell data\r\n          var cellDataType = cell.datatype;\r\n          var cellValueType = cell.valuetype;     \r\n          var cellDataValue = cell.datavalue;   \r\n          var cellFormula = cell.formula;\r\n          \r\n          if(cellDataType == 'f') {\r\n            cellFormula = \"\";\r\n            cellDataType = cellValueType;\r\n            if(cellValueType != \"n\" && cellValueType.charAt(0) != \"t\") {\r\n              cellDataType = \"c\"; // for Date type etc \r\n              cellFormula = cell.displaystring;\r\n            }\r\n            if(cellValueType.charAt(0) == \"t\") cellDataType = \"t\";          \r\n          } else {\r\n            if(cellDataType != \"c\") cellFormula = \"\";  // clear text and number types   but not constant type like date/time      \r\n          }\r\n          \r\n    \r\n          sheetCommand = 'set '+destCellCoord+ ' ' + SocialCalc.Constants.cellDataType[cellDataType] + ' ' +cellValueType + ' '+ SocialCalc.encodeForSave(cellDataValue) + ' ' + cellFormula;\r\n          \r\n      } else { \r\n        sheetCommand = 'set '+destCellCoord+ ' empty';        \r\n      }\r\n      sheetCommandList += sheetCommand.trim();\r\n    }\r\n  }\r\n  \r\n  return sheetCommandList;  \r\n\r\n}\r\n//----------------------\r\n\r\n\r\n// optionalTriggerCellId - edited cell - used by EMAILONEDIT and EMAILONEDITIF\r\n//onClick=EMAIL \r\nSocialCalc.TriggerIoAction.Email = function(emailFormulaCellId, optionalTriggerCellId) {\r\n     optionalTriggerCellId = typeof optionalTriggerCellId !== 'undefined' ? optionalTriggerCellId : null;\r\n\t var scf = SocialCalc.Formula;\t\r\n\t var spreadsheet =  window.spreadsheet;\r\n\t if (spreadsheet == null) spreadsheet = window.ss\r\n\r\n\t var sheet = spreadsheet.sheet;\r\n\t var cell = sheet.cells[emailFormulaCellId];\r\n\t \r\n\t if(typeof sheet.ioParameterList === 'undefined') return;\r\n\t \r\n\t var parameters = sheet.ioParameterList[emailFormulaCellId];\r\n   if(typeof parameters === 'undefined') return;\r\n   //var debugLog = \"debug TriggerIoAction.Email\\n\"; //eddy\r\n\r\n\t //spreadsheet.editor.EditorScheduleSheetCommands('sendemail to eddy.nihon',  false, false); \r\n\t // grab array for TO, SUBJECT and BODY \r\n\t var parameterValues = [];\r\n\t var parameterCellRefs = []; // OnEdit uses to workout what row/col was edited\r\n\t var maxRangeSize = 1;\r\n\t for(var index=0; index < parameters.length; index ++) {\r\n\t\t if(parameters[index].type.charAt(0) == 't') {\r\n\t\t\t parameterValues[index] = [String(parameters[index].value).replace(/ /g, \"%20\")];\r\n\t\t }\r\n\t\t if(parameters[index].type == 'coord') {\r\n\t\t\t parameterValues[index] = [String(sheet.GetAssuredCell(parameters[index].value).datavalue).replace(/ /g, \"%20\")];\r\n\r\n\t\t }\r\n\t\t if(parameters[index].type == 'range') {\r\n\t\t      var rangeinfo = scf.DecodeRangeParts(sheet, parameters[index].value);\r\n\t\t      parameterValues[index] = [];\r\n\t\t      parameterCellRefs[index] = [];\r\n\t\t      var rangeSizeCounter = 0;\r\n\t\t      for (var i=0; i<rangeinfo.ncols; i++) {\r\n\t\t         for (var j=0; j<rangeinfo.nrows; j++) {\r\n\r\n\t\t            var cellcr = SocialCalc.crToCoord(rangeinfo.col1num + i, rangeinfo.row1num + j);\r\n\t\t            var cell = rangeinfo.sheetdata.GetAssuredCell(cellcr);\r\n\t\t            parameterValues[index].push(cell.datavalue.toString().replace(/ /g, \"%20\"));\r\n\t\t            parameterCellRefs[index].push(cellcr);\r\n\t\t            rangeSizeCounter++;\r\n\t\t         }\r\n\t\t      }\r\n\t\t      if(rangeSizeCounter > maxRangeSize) maxRangeSize = rangeSizeCounter;\t\t\t \r\n\t\t }\r\n\t }\r\n\r\n\t \r\n    var conditionIndex = -1; // check if email formula is conditional, -1 = not conditional \r\n    var toAddressParamOffset = 0;\r\n    switch (parameters.function_name) {\r\n\r\n      case \"EMAILIF\":\r\n    \t  conditionIndex = 0;\r\n      case \"EMAILAT\":\r\n      case \"EMAILONEDIT\":\r\n    \t  toAddressParamOffset = 1;\r\n    \t  break;\r\n      case \"EMAILONEDITIF\":\r\n      case \"EMAILATIF\":\r\n       \t  conditionIndex = 1;\r\n    \t  toAddressParamOffset = 2;\r\n    \t  break;\r\n    \t  \r\n      case \"EMAIL\":\r\n    \t  break;\r\n    }\t \r\n\r\n    \r\n    switch (parameters.function_name) {\r\n        case \"ONEDITDO\":\r\n        case \"EMAILONEDIT\":\r\n        case \"EMAILONEDITIF\":\r\n\t       if(optionalTriggerCellId && parameters[0].type == 'coord' && parameters[0].value == optionalTriggerCellId ) optionalTriggerCellId = null;\r\n\t       break;\r\n\t   default :\r\n\t\t   optionalTriggerCellId = null;\r\n    }\r\n\r\n     var setStatusBarMessage = false;\r\n\r\n   var emailContentsList = [];\r\n\r\n   if (parameters.function_name == \"ONEDITDO\") {\r\n    // loop thru each involved cell...\r\n    for (var rangeIndex = maxRangeSize - 1; rangeIndex > -1; rangeIndex--) {\r\n      // skip cells that didn't trigger the edit\r\n      if (optionalTriggerCellId && optionalTriggerCellId != parameterCellRefs[0][rangeIndex]) continue;\r\n\r\n      var valueRangeIndex = (rangeIndex >= parameterValues[0].length) ? 0 : rangeIndex;\r\n      var nameRangeIndex = (rangeIndex >= parameterValues[1].length) ? 0 : rangeIndex;\r\n\r\n      sheet.ScheduleSheetCommands('updateopsettings '+parameterValues[1][nameRangeIndex]+' '+parameterValues[0][valueRangeIndex]+' '+parameters[2].value,  false);\r\n      SocialCalc.EditorSheetStatusCallback(null, \"updateopsettings\", null, spreadsheet.editor);\r\n    }\r\n    return [];\r\n   }\r\n\r\n\t for(var rangeIndex = maxRangeSize -1; rangeIndex > -1; rangeIndex-- ) {\r\n\t\t \r\n\t\t // if email formula is conditional && condition is false then skip \r\n\t\t if(conditionIndex != -1) {\r\n\t\t\t var conditionRangeIndex = (rangeIndex >= parameterValues[conditionIndex].length) ? 0 : rangeIndex;\r\n\t\t\t if(parameterValues[conditionIndex][conditionRangeIndex] == false) continue;\t\t\t \r\n\t\t }\r\n\r\n\t\t if(optionalTriggerCellId && optionalTriggerCellId != parameterCellRefs[0][rangeIndex]) continue;\r\n\t\t // send: to, subject, body to server \t\t \r\n\t\t var toaddressRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset].length) ? 0 : rangeIndex;\r\n\t\t var subjectsRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset+1].length) ? 0 : rangeIndex;\r\n\t\t var bodyRangeIndex = (rangeIndex >= parameterValues[toAddressParamOffset+2].length) ? 0 : rangeIndex;\r\n\t\t \r\n\t\t var emailContents = parameterValues[toAddressParamOffset][toaddressRangeIndex]+' '+parameterValues[toAddressParamOffset+1][subjectsRangeIndex]+' '+parameterValues[toAddressParamOffset+2][bodyRangeIndex];\r\n\t\t setStatusBarMessage = true;\r\n\t\t sheet.ScheduleSheetCommands('sendemail '+emailContents,  false); \r\n\t\t // cron job email - ignores ScheduleSheetCommands so send via return value\r\n\t\t emailContentsList.push([parameterValues[toAddressParamOffset][toaddressRangeIndex], parameterValues[toAddressParamOffset+1][subjectsRangeIndex], parameterValues[toAddressParamOffset+2][bodyRangeIndex]]);\r\n\t\t //debugLog = debugLog + \"emailContents \"+emailContents+\"\\n\"; //eddy\r\n\t\t \r\n\t }\r\n\t //console.log( \"log formula1.js Email\");\r\n\t // update status bar to indicate email is being sent\r\n\t if(setStatusBarMessage) SocialCalc.EditorSheetStatusCallback(null, \"emailing\", null, spreadsheet.editor);\t \r\n   return emailContentsList; // cron job email\r\n\r\n}\r\n\r\n/*\r\n * creates command on form: submitform \\rtimestamp\\rB2value\\rC2value ...\r\n */\r\n\r\nSocialCalc.TriggerIoAction.Submit = function(triggerCellId) {\r\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n  ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n  : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer;\r\n\r\n  if(formDataViewer != null && formDataViewer.loaded == true) {\r\n\r\n    var spreadsheet =  window.spreadsheet;\r\n    if (spreadsheet == null) spreadsheet = window.ss\r\n    var sheet = spreadsheet.sheet;\r\n    \r\n    \r\n    var date = new Date();\r\n    var formDataValues = \"\"+date.getFullYear()  + \"-\" + (date.getMonth() +1 )    + \"-\" +  date.getDate() \r\n       + \" \" +  date.getHours()     + \":\" +  date.getMinutes()     + \":\" +  date.getSeconds();\r\n    \r\n    for(var colIndex = 2; colIndex <= formDataViewer.formFieldsLength +1 ; colIndex++) {\r\n      var valueCoord = SocialCalc.crToCoord(colIndex, 2);\r\n      formDataValues += \"\\r\" + formDataViewer.sheet.cells[valueCoord].datavalue;\r\n    }  \r\n    \r\n    sheet.ScheduleSheetCommands('submitform \\r'+formDataValues,  false);\r\n  }\r\n}\r\n\r\n//onChange=select tag (combobox) \r\nSocialCalc.TriggerIoAction.SelectList = function(selectListCellId) {\r\n  var getHTMLselectListCellValue = function( selectListWidget ) { return selectListWidget.value; };\r\n  var function_name = \"SELECT\";\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, selectListCellId, getHTMLselectListCellValue );\r\n}\r\n\r\n//onKeyUp=AutoComplete\r\nSocialCalc.TriggerIoAction.AutoComplete = function(autoCompleteCellId) {\r\n  var getHTMLAutoCompleteCellValue = function( autoCompleteWidget ) { return autoCompleteWidget.value; };\r\n  var function_name = \"AUTOCOMPLETE\";\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, autoCompleteCellId, getHTMLAutoCompleteCellValue );\r\n}\r\n\r\n// onKeyUp=TextBox \r\nSocialCalc.TriggerIoAction.TextBox = function(textBoxCellId) {\r\n  var getHTMLTextBoxCellValue = function( textBoxWidget ) { return textBoxWidget.value; };\r\n  var function_name = \"TEXTBOX\";\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, textBoxCellId, getHTMLTextBoxCellValue );\r\n}\r\n\r\n//onKeyUp=CheckBox \r\nSocialCalc.TriggerIoAction.CheckBox = function(checkBoxCellId) {\r\n  var getHTMLCheckBoxCellValue = function( checkBoxWidget ) { return (checkBoxWidget.checked ? \"TRUE\" : \"FALSE\") };\r\n  var function_name = \"CHECKBOX\"\r\n  SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name, checkBoxCellId, getHTMLCheckBoxCellValue );\r\n}\r\n\r\n//Radio Button state changed\r\n// onclick when selected\r\n// update true/false in formula param\r\nSocialCalc.TriggerIoAction.RadioButton = function(radioButtonGroupName) {\r\n  var getHTMLRadioButtonValue = function( radioButtonWidget ) { return (radioButtonWidget.checked ? \"TRUE\" : \"FALSE\") };\r\n  var function_name = \"RADIOBUTTON\"\r\n  // for each radio button in group\r\n  $('input[name=\"'+radioButtonGroupName+'\"]').each(function () {\r\n     SocialCalc.TriggerIoAction.updateInputWidgetFormula(function_name,  $(this).attr('id').replace(/RADIOBUTTON_/,''), getHTMLRadioButtonValue );\r\n  });\r\n}\r\n\r\n\r\nSocialCalc.TriggerIoAction.updateInputWidgetFormula = function(function_name, widgetCellId, getHTMLWidgetCellValue ) {\r\n\r\n var spreadsheet =  window.spreadsheet;\r\n if (spreadsheet == null) spreadsheet = window.ss\r\n var sheet = spreadsheet.sheet;\r\n var cell = sheet.cells[widgetCellId];\r\n var parameters = sheet.ioParameterList[widgetCellId];\r\n if(typeof parameters === 'undefined') return;\r\n \r\n var cell_widget=document.getElementById(function_name+'_'+widgetCellId);\r\n var inputValue = getHTMLWidgetCellValue(cell_widget);\r\n inputValue = SocialCalc.encodeForSave(inputValue);\r\n\r\n var sheetCommand = 'set '+widgetCellId+ ' formula '+ function_name+'(\"' +inputValue+'\"';\r\n for(var paramIndex = 1; paramIndex < parameters.length; paramIndex++) {\r\n   if(parameters[paramIndex].type.charAt(0) == 'n') {\r\n     sheetCommand += ',' + parameters[paramIndex].value;\r\n   }\r\n   if(parameters[paramIndex].type.charAt(0) == 't') {\r\n     sheetCommand += ',\"' + parameters[paramIndex].value + '\"';\r\n   }\r\n   if(parameters[paramIndex].type == 'range') {\r\n     // convert:     E5!TO0DB4GSXZJ3|E8|   -> TO0DB4GSXZJ3!E5:E8\r\n     // convert:     E5|E8|   -> E5:E8\r\n     \r\n     // * RegEx Unit Test **  https://regex101.com/r/zF1dA8/1\r\n     sheetCommand += ',' + parameters[paramIndex].value.toString().replace(/(\\$?[A-Z]+\\$?[0-9]+)([!]?)([^|]*)[|](\\$?[A-Z]+\\$?[0-9]+)[|]/i,\"$3$2$1:$4\"); ;\r\n   }\r\n   if(parameters[paramIndex].type == 'coord') {\r\n     sheetCommand += ',' + parameters[paramIndex].value;\r\n   }   \r\n }\r\n\r\n   // for(var parseIndex = 3; parseIndex < cell.parseinfo.length -1; parseIndex++) {\r\n//   if(cell.parseinfo[parseIndex].type == 6)   sheetCommand += '\"' + cell.parseinfo[parseIndex].text + '\"';\r\n//   else sheetCommand +=  cell.parseinfo[parseIndex].text ;\r\n// }\r\n sheetCommand += ')';\r\n // add style formula if css has been added\r\n if(parameters.cssParameter) {\r\n   sheetCommand += \"+style(\"+  parameters.cssParameter+ \")\"; \r\n }\r\n //SocialCalc.CmdGotFocus(cell_widget);\r\n\r\n spreadsheet.editor.EditorScheduleSheetCommands(sheetCommand,  true, false);\r\n \r\n SocialCalc.TriggerIoAction.UpdateFormDataSheet(function_name, widgetCellId, inputValue);\r\n}\r\n\r\n// On edit of Form Input widget - Update form data sheet \r\nSocialCalc.TriggerIoAction.UpdateFormDataSheet = function(function_name, formCellId, inputValue) {\r\n  var formDataViewer = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n       ? SocialCalc.CurrentSpreadsheetControlObject.formDataViewer \r\n       : SocialCalc.CurrentSpreadsheetViewerObject.formDataViewer; \r\n  if (formDataViewer == null) return;\r\n\r\n  var formFieldName = (function_name+formCellId).toLowerCase();\r\n  if(formDataViewer.formFields[formFieldName] != null) {       \r\n    var valueCoord = SocialCalc.crToCoord(formDataViewer.formFields[formFieldName], 2);\r\n    formDataViewer.sheet.ScheduleSheetCommands(\"set \"+valueCoord+\" text t \"+inputValue, false);    \r\n  }\r\n}\r\n\r\n\r\n\r\n//getStandardizedValues(parameterData)  \r\n// gets cell data of range/coord OR param value as cell data - also get coord data as cell.coord is invalid when rows deleted\r\n// CALL getProcessedParameter  with request for values \r\nSocialCalc.Formula.getStandardizedValues = function(sheet, parameterData) {\r\n  return SocialCalc.Formula.getStandardizedParameter(sheet, parameterData, true, true);\r\n}  \r\n\r\n\r\n// getStandardizedCoords(parameterData)  // gets coord(s) of range/coord\r\n// CALL getProcessedParameter  with request for coord info\r\nSocialCalc.Formula.getStandardizedCoords = function(sheet, parameterData) {\r\n  return SocialCalc.Formula.getStandardizedParameter(sheet, parameterData, true, false);\r\n}  \r\n\r\n/***************\r\n * getStandardizedList\r\n * @sheet spreadsheet sheet\r\n * @listParameter csv or array or single value - convert into single array\r\n * @return array of values - one dimension\r\n ****************/\r\nSocialCalc.Formula.getStandardizedList = function(sheet, listParameter) {\r\n  \r\n  var listValues = [];\r\n  var parameterdata = SocialCalc.Formula.getStandardizedValues(sheet, listParameter);\r\n  \r\n  if(parameterdata.ncols == 1 && parameterdata.nrows == 1) {\r\n    listValues = String(parameterdata.celldata[0][0].datavalue).split(',');\r\n  } else {\r\n    for (var i=0; i<parameterdata.ncols; i++) {\r\n      for (var j=0; j<parameterdata.nrows; j++) {\r\n         var cell = parameterdata.celldata[i][j];\r\n         listValues.push(cell.datavalue.toString());\r\n      }\r\n   }    \r\n  }\r\n  return listValues;\r\n}\r\n\r\n/**************************\r\n * getStandardizedParameter(parameterData, includeCellCoord, includeCellData)\r\n *\r\n * Convert formula parameter to standard data structure and return it.\r\n * \r\n * Formula parameters can be value/string/coord/range\r\n * value/string: convert to celldata:  [[coord:A1, datatype:t/c/v/f, valuetype:t/nd/n/b, datavalue:string/value , formula:\"test\"&B3]] \r\n * coord/range: get celldata from cell\r\n * \r\n *  return:\r\n ******  data structure returned\r\n  { \r\n     value:A1:B2/A1/string/value,\r\n     type:range/coord/t/n/b/eErrorType,\r\n     celldata: [][] = {coord:invalid, datatype:t/c/v/f, valuetype:t/nd/n/b, datavalue:string/value , formula:\"sum(A1)\"},  // coord is invalid after insert/delete row/col\r\n     cellcoord: [][] = A1,   // if requested\r\n     ncols:n,\r\n     nrows:n\r\n     col1num:n\r\n     row1num:n\r\n   }\r\n\r\n *\r\n * ------------------- type ----------------- \r\n * From docs for SocialCalc.Formula.EvaluatePolish  \r\n * type: can have these values (many are type and sub-type as two or more letters):\r\n *   \"tw\", \"th\", \"t\", \"n\", \"nt\", \"coord\", \"range\", \"eErrorType\", \"b\" (blank) - removed: \"start\"\r\n * valuetype: is set to type if the parameter is constant and not a cell reference\r\n * ------------------------------------------\r\n *\r\n *\r\n *******************************/\r\nSocialCalc.Formula.getStandardizedParameter = function(sheet, parameterData, includeCellCoord, includeCellData) {\r\n  \r\n  //SET result = {}\r\n  //SET store param values in result (.value .type)\r\n  var result = { type: parameterData.type, value:parameterData.value};\r\n  if(includeCellData) result.celldata = [];\r\n           \r\n  //IF parameter is not a cell reference i.e.  type is: \"tw\", \"th\", \"t\", \"n\", \"nt\"  THEN    \r\n  if(parameterData.type != 'coord' && parameterData.type != 'range') {\r\n    // Setup dummy cell reference information\r\n    // SET rows and cols to 1 cell   \r\n    result.ncols = 1;\r\n    result.nrows = 1;\r\n    result.col1num = 1;\r\n    result.row1num = 1;\r\n    \r\n    // IF requested: cell coord value THEN\r\n    if(includeCellCoord) {\r\n      // SET coord to default empty value - \r\n      result.cellcoord = null; \r\n    } // END IF\r\n    \r\n    // IF requested: cell data  THEN\r\n    if(includeCellData) {\r\n      // SET data values to dummy cell data using parameter \r\n      // result.celldata = [[ \r\n      //   coord to default null value - as illegal request\r\n      //   datatype  - t/v  - const can only have 2 value types\r\n      //   valuetype (n/b/e/t)  - set to same as parameterData.type - check date/time types don't cause issue\r\n      //   datavalue set to parameterData.type \r\n      //   formula set to empty -  because not range/coord\r\n      // ] ] \r\n      result.celldata[0] = [];\r\n      var constantDatatype = (parameterData.type==\"n\") ? \"v\" : ((parameterData.type==\"t\") ? parameterData.type : \"c\");\r\n      result.celldata[0][0] = {coord:null,datatype:constantDatatype,valuetype: parameterData.type,datavalue:parameterData.value };\r\n    } // END IF\r\n    \r\n  } else {\r\n    // param type is \"coord\" or \"range\" \r\n\r\n    var scf = SocialCalc.Formula; \r\n    \r\n    var sourcerangeinfo;\r\n    if(parameterData.type == 'coord') { \r\n      var sourceCoord = SocialCalc.Formula.PlainCoord(parameterData.value);\r\n      sourcerangeinfo = scf.DecodeRangeParts(sheet, sourceCoord + \"|\"+ sourceCoord +\"|\" );\r\n    }\r\n    \r\n    if(parameterData.type == 'range') {\r\n      sourcerangeinfo = scf.DecodeRangeParts(sheet, parameterData.value);\r\n    }\r\n    \r\n    // if coords requested,  init coord array\r\n    if(includeCellCoord) result.cellcoord = []; \r\n    \r\n    for (var i=0; i<sourcerangeinfo.ncols; i++) {\r\n        for (var j=0; j<sourcerangeinfo.nrows; j++) {\r\n          var cellcoord = SocialCalc.crToCoord(sourcerangeinfo.col1num + i, sourcerangeinfo.row1num + j);\r\n           // IF requested: cell coord value THEN\r\n          if(includeCellCoord) {           \r\n             // SET coord in array to coord of cell\r\n            if(typeof result.cellcoord[i] === 'undefined') result.cellcoord[i] = [];            \r\n            result.cellcoord[i][j] = cellcoord;            \r\n          } // END IF\r\n\r\n          // IF requested: cell data  THEN\r\n          if(includeCellData) {\r\n          \r\n            // SET get cell from sheet and store values \r\n            if(typeof result.celldata[i] === 'undefined') result.celldata[i] = [];                        \r\n            var cell = sourcerangeinfo.sheetdata.GetAssuredCell(cellcoord);\r\n            result.celldata[i][j] = cell; \r\n          } // END IF\r\n        }\r\n    }\r\n    // SET rows and cols to range - i.e. sourcerangeinfo -   ncols:n,       nrows:n       col1num:n      row1num:n\r\n    result.ncols = sourcerangeinfo.ncols;\r\n    result.nrows = sourcerangeinfo.nrows;\r\n    result.col1num = sourcerangeinfo.col1num;\r\n    result.row1num = sourcerangeinfo.row1num;\r\n    \r\n  }  //END IF\r\n    \r\n  //RETURN \r\n  return result;\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n// -----------------------------------------\r\n// }\r\n// -----------------------------------------\r\n\r\n\r\n\r\n\r\n//\r\n// SHEET CACHE\r\n//\r\n\r\nSocialCalc.Formula.SheetCache = {\r\n\r\n   // Sheet data: Attributes are each sheet in the cache with values of an object with:\r\n   //\r\n   //    sheet: sheet-obj (or null, meaning not found)\r\n   //    recalcstate: constants.asloaded = as loaded\r\n   //                 constants.recalcing = being recalced now\r\n   //                 constants.recalcdone = recalc done\r\n   //    name: name of sheet (in case just have object and don't know name)\r\n   //\r\n\r\n   sheets: {},\r\n\r\n   // Waiting for loading:\r\n   // If sheet is not in cache, this is set to the sheetname being loaded\r\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\r\n   // Reset to null before restarting.\r\n\r\n   waitingForLoading: null,\r\n\r\n   // Constants to use for setting sheets[*].recalcstate:\r\n\r\n   constants: {asloaded: 0, recalcing: 1, recalcdone: 2},\r\n\r\n   loadsheet: null // (deprecated - use SocialCalc.RecalcInfo.LoadSheet)\r\n\r\n   };\r\n\r\n//\r\n// othersheet = SocialCalc.Formula.FindInSheetCache(sheetname)\r\n//\r\n// Returns a SocialCalc.Sheet object corresponding to string sheetname\r\n// or null if the sheet is not available or in error.\r\n//\r\n// Each sheet is loaded only once and then stored in a cache.\r\n// Loading is handled elsewhere, e.g., in the recalc loop.\r\n//\r\n\r\nSocialCalc.Formula.FindInSheetCache = function(sheetname) {\r\n\r\n   var str;\r\n   var sfsc = SocialCalc.Formula.SheetCache;\r\n\r\n   var nsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname); // normalize different versions\r\n\r\n   if (sfsc.sheets[nsheetname]) { // a sheet by that name is in the cache already\r\n      return sfsc.sheets[nsheetname].sheet; // return it.\r\n      }\r\n\r\n   if (sfsc.waitingForLoading) { // waiting already - only queue up one\r\n      return null; // return not found\r\n      }\r\n\r\n   if (sfsc.loadsheet) { // Deprecated old format synchronous callback\r\nalert(\"Using SocialCalc.Formula.SheetCache.loadsheet - deprecated\");\r\n      return SocialCalc.Formula.AddSheetToCache(nsheetname, sfsc.loadsheet(nsheetname));\r\n      }\r\n\r\n   sfsc.waitingForLoading = nsheetname; // let recalc loop know that we have a sheet to load\r\n\r\n   return null; // return not found\r\n\r\n   }\r\n\r\n//\r\n// newsheet = SocialCalc.Formula.AddSheetToCache(sheetname, str, live)\r\n//\r\n// Adds a new sheet to the sheet cache.\r\n// Returns the sheet object filled out with the str (a saved sheet).\r\n//\r\n\r\nSocialCalc.Formula.AddSheetToCache = function(sheetname, str, live) {\r\n\r\n   var newsheet = null;\r\n   var sfsc = SocialCalc.Formula.SheetCache;\r\n   var sfscc = sfsc.constants;\r\n   var newsheetname = SocialCalc.Formula.NormalizeSheetName(sheetname);\r\n\r\n   if (str) {\r\n      newsheet = new SocialCalc.Sheet();\r\n      newsheet.ParseSheetSave(str);\r\n      }\r\n\r\n   sfsc.sheets[newsheetname] = {sheet: newsheet, recalcstate: sfscc.asloaded, name: newsheetname};\r\n\r\n   SocialCalc.Formula.FreshnessInfo.sheets[newsheetname] = (typeof(live) == \"undefined\" || live === false);\r\n\r\n   return newsheet;\r\n\r\n   }\r\n\r\n//\r\n// nsheet = SocialCalc.Formula.NormalizeSheetName(sheetname)\r\n//\r\n\r\nSocialCalc.Formula.NormalizeSheetName = function(sheetname) {\r\n\r\n   if (SocialCalc.Callbacks.NormalizeSheetName) {\r\n      return SocialCalc.Callbacks.NormalizeSheetName(sheetname);\r\n      }\r\n   else {\r\n      return sheetname.toLowerCase();\r\n      }\r\n   }\r\n\r\n//\r\n// REMOTE FUNCTION INFO\r\n//\r\n\r\nSocialCalc.Formula.RemoteFunctionInfo = {\r\n\r\n   // Waiting for server:\r\n   // If waiting for an XHR response from the server, this is set to some non-blank status text\r\n   // so it can be tested in the recalc loop to start load and then wait until restarted.\r\n   // Reset to null before restarting.\r\n\r\n   waitingForServer: null\r\n\r\n   };\r\n\r\n//\r\n// FRESHNESS INFO\r\n//\r\n// This information is generated during recalc.\r\n// It may be used to help determine when the recalc data in a spreadsheet\r\n// may be out of date.\r\n// For example, it may be used to display a message like:\r\n// \"Dependent on sheet 'FOO' which was updated more recently than this printout\"\r\n\r\nSocialCalc.Formula.FreshnessInfo = {\r\n\r\n   // For each external sheet referenced successfully an attribute of that name with value true to keep the sheet cached.\r\n   // Value false means the sheet is reloaded at each recalc.\r\n\r\n   sheets: {},\r\n\r\n   // For each volatile function that is called an attribute of that name with value true.\r\n\r\n   volatile: {},\r\n\r\n   // Set to false when started and true when recalc completes\r\n\r\n   recalc_completed: false\r\n\r\n   };\r\n\r\nSocialCalc.Formula.FreshnessInfoReset = function() {\r\n\r\n   var scffi = SocialCalc.Formula.FreshnessInfo;\r\n   var scfsc = SocialCalc.Formula.SheetCache;\r\n\r\n   // Loop through sheets freshness, deleting cached sheets that should be reloaded.\r\n\r\n   for (var sheet in scffi.sheets) {\r\n      if (scffi.sheets[sheet] === false) {\r\n         delete scfsc.sheets[sheet];\r\n         }\r\n      }\r\n   \r\n   // Reset freshness info.\r\n\r\n   scffi.sheets = {};\r\n   scffi.volatile = {};\r\n   scffi.recalc_completed = false;\r\n\r\n   }\r\n\r\n//\r\n// MISC ROUTINES\r\n//\r\n\r\n//\r\n// result = SocialCalc.Formula.PlainCoord(coord)\r\n//\r\n// Returns: coord without any $'s\r\n//\r\n\r\nSocialCalc.Formula.PlainCoord = function(coord) {\r\n\r\n   if (coord.indexOf(\"$\") == -1) return coord;\r\n\r\n   return coord.replace(/\\$/g, \"\"); // remove any $'s\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.Formula.OrderRangeParts(coord1, coord2)\r\n//\r\n// Returns: {c1: col, r1: row, c2: col, r2 = row} with c1/r1 upper left\r\n//\r\n\r\nSocialCalc.Formula.OrderRangeParts = function(coord1, coord2) {\r\n\r\n   var cr1, cr2;\r\n   var result = {};\r\n\r\n   cr1 = SocialCalc.coordToCr(coord1);\r\n   cr2 = SocialCalc.coordToCr(coord2);\r\n   if (cr1.col > cr2.col) { result.c1 = cr2.col; result.c2 = cr1.col; }\r\n   else { result.c1 = cr1.col; result.c2 = cr2.col; }\r\n   if (cr1.row > cr2.row) { result.r1 = cr2.row; result.r2 = cr1.row; }\r\n   else { result.r1 = cr1.row; result.r2 = cr2.row; }\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// cond = SocialCalc.Formula.TestCriteria(value, type, criteria)\r\n//\r\n// Determines whether a value/type meets the criteria.\r\n// A criteria can be a numeric value, text beginning with <, <=, =, >=, >, <>, text by itself is start of text to match.\r\n// Used by a variety of functions, including the \"D\" functions (DSUM, etc.).\r\n//\r\n// Returns true or false\r\n//\r\n\r\nSocialCalc.Formula.TestCriteria = function(value, type, criteria) {\r\n\r\n   var comparitor, basestring, basevalue, cond, testvalue;\r\n\r\n   if (criteria == null) { // undefined (e.g., error value) is always false\r\n      return false;\r\n      }\r\n\r\n   criteria = criteria + \"\";\r\n   comparitor = criteria.charAt(0); // look for comparitor\r\n   if (comparitor == \"=\" || comparitor == \"<\" || comparitor == \">\") {\r\n      basestring = criteria.substring(1);\r\n      }\r\n   else {\r\n      // check for '*' or '?' in search string - wildcard\r\n      if (criteria.search(/([^~]\\*|^\\*)/) != -1 || criteria.search(/([^~]\\?|^\\?)/) != -1) {\r\n         comparitor = \"regex\";\r\n         if (criteria == \"*\") {\r\n            // \"*\" means cell contains 'anything'\r\n            basestring = \".+\";\r\n         } else {\r\n             // convert Excel syntax to regex syntax. * -> .*    ? -> .?    ~* -> \\*    ~? -> \\?\r\n             // there are no negative lookbehinds in Javascript. Reverse the string and do negative lookaheads on ~? and ~*\r\n             basestring = criteria.split(\"\").reverse().join(\"\");\r\n             basestring = basestring.replace(/\\?(?=[^~])|\\?$/g, \"?.\").replace(/\\?~/g, \"?\\\\\").replace(/\\*(?=[^~])|\\*$/g, \"*.\").replace(/\\*~/, \"*\\\\\");\r\n             basestring = basestring.split(\"\").reverse().join(\"\");\r\n         }\r\n         basestring = \"^\" + basestring + \"$\";\r\n      } else {\r\n          comparitor = criteria.substring(0,2);\r\n          if (comparitor == \"<=\" || comparitor == \"<>\" || comparitor == \">=\") {\r\n             basestring = criteria.substring(2);\r\n          } else {\r\n             comparitor = \"none\";\r\n             basestring = criteria;\r\n          }\r\n      }\r\n   }\r\n\r\n   basevalue = SocialCalc.DetermineValueType(basestring); // get type of value being compared\r\n   if (!basevalue.type) { // no criteria base value given\r\n      if (comparitor == \"none\") { // blank criteria matches nothing\r\n         return false;\r\n         }\r\n      if (type.charAt(0) == \"b\") { // comparing to empty cell\r\n         if (comparitor == \"=\") { // empty equals empty\r\n            return true;\r\n            }\r\n         }\r\n      else {\r\n         if (comparitor == \"<>\") { // \"something\" does not equal empty\r\n            return true;\r\n            }\r\n         }\r\n      return false; // otherwise false\r\n      }\r\n\r\n   cond = false;\r\n\r\n   if (basevalue.type.charAt(0) == \"n\" && type.charAt(0) == \"t\") { // criteria is number, but value is text\r\n      testvalue = SocialCalc.DetermineValueType(value);\r\n      if (testvalue.type.charAt(0) == \"n\") { // could be number - make it one\r\n         value = testvalue.value;\r\n         type = testvalue.type;\r\n         }\r\n      }\r\n\r\n   if (type.charAt(0) == \"n\" && basevalue.type.charAt(0) == \"n\") { // compare two numbers\r\n      value = value - 0; // make sure numbers\r\n      basevalue.value = basevalue.value - 0;\r\n      switch (comparitor) {\r\n         case \"<\":\r\n            cond = value < basevalue.value;\r\n            break;\r\n\r\n         case \"<=\":\r\n            cond = value <= basevalue.value;\r\n            break;\r\n\r\n         case \"=\":\r\n         case \"none\":\r\n            cond = value == basevalue.value;\r\n            break;\r\n\r\n         case \">=\":\r\n            cond = value >= basevalue.value;\r\n            break;\r\n\r\n         case \">\":\r\n            cond = value > basevalue.value;\r\n            break;\r\n\r\n         case \"<>\":\r\n            cond = value != basevalue.value;\r\n            break;\r\n         }\r\n      }\r\n\r\n   else if (type.charAt(0) == \"e\") { // error on left\r\n      cond = false;\r\n      }\r\n\r\n   else if (basevalue.type.charAt(0) == \"e\") { // error on right\r\n      cond = false;\r\n      }\r\n\r\n   else { // text, maybe mixed with number or blank\r\n      if (type.charAt(0) == \"n\") {\r\n         value = SocialCalc.format_number_for_display(value, \"n\", \"\");\r\n         }\r\n      if (basevalue.type.charAt(0) == \"n\") {\r\n         return false; // if number and didn't match already, isn't a match\r\n         }\r\n\r\n      value = value ? value.toLowerCase() : \"\";\r\n      basevalue.value = basevalue.value ? basevalue.value.toLowerCase() : \"\";\r\n\r\n      switch (comparitor) {\r\n         case \"<\":\r\n            cond = value < basevalue.value;\r\n            break;\r\n\r\n         case \"<=\":\r\n            cond = value <= basevalue.value;\r\n            break;\r\n\r\n         case \"=\":\r\n            cond = value == basevalue.value;\r\n            break;\r\n\r\n         case \"none\":\r\n            cond = value.substring(0, basevalue.value.length) == basevalue.value;\r\n            break;\r\n\r\n         case \">=\":\r\n            cond = value >= basevalue.value;\r\n            break;\r\n\r\n         case \">\":\r\n            cond = value > basevalue.value;\r\n            break;\r\n\r\n         case \"<>\":\r\n            cond = value != basevalue.value;\r\n            break;\r\n\r\n         case \"regex\":\r\n            try {\r\n              cond = value.search(new RegExp(basevalue.value)) != -1;\r\n            } catch(e) {\r\n              cond = false; // regex invalid (e.g., error value) is always false\r\n            }\r\n            break;\r\n         }\r\n      }\r\n\r\n   return cond;\r\n\r\n   }\r\n","//\r\n/*\r\n// The module of the SocialCalc package for the optional popup menus in socialcalcspreadsheetcontrol.js\r\n//\r\n// (c) Copyright 2009 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n// The contents of this file are subject to the Artistic License 2.0; you may not\r\n// use this file except in compliance with the License. You may obtain a copy of \r\n// the License at http://socialcalc.org/licenses/al-20/.\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n//\r\n*/\r\n\r\n   var SocialCalc; // All values are stored in the master SocialCalc object\r\n   if (!SocialCalc) {\r\n      SocialCalc = {};\r\n      }\r\n\r\n   // The main Popup data -- there is only one set\r\n\r\n   SocialCalc.Popup = {};\r\n\r\n   // Routines and values for each type of control, indexed by type name\r\n   // The value for each is an object constructed as follows:\r\n   //\r\n   //    Create = function(type, id, attribs)\r\n   //    Initialize = function(type, id, data)\r\n   //    SetValue = function(type, id, value)\r\n   //    GetValue = function(type, id) returns value\r\n   //    SetDisabled = function(type, id, t/f)\r\n   //    Show = function(type, id)\r\n   //    Hide = function(type, id)\r\n   //    Cancel = function(type, id)\r\n   //    Reset = function(type)\r\n   //\r\n   //    data = object to hold type-specific data\r\n   //\r\n\r\n   SocialCalc.Popup.Types = {};\r\n\r\n   // Definitions for each individual control, indexed by id\r\n   // The value for each is an object constructed as follows:\r\n   //\r\n   //    type: type name of the control\r\n   //    value: current value of the control (usually a string, but can depend on type)\r\n   //    data: object with type-specific items\r\n   //\r\n\r\n   SocialCalc.Popup.Controls = {};\r\n\r\n   // System-wide values of currently active control\r\n   //\r\n   //    id: id of current control or null\r\n   //\r\n\r\n   SocialCalc.Popup.Current = {};\r\n\r\n   // Override this for localization\r\n\r\n   SocialCalc.Popup.LocalizeString = function(str) {return str;};\r\n\r\n\r\n// * * * * * * * * * * * * * * * *\r\n//\r\n// GENERAL ROUTINES\r\n//\r\n// * * * * * * * * * * * * * * * *\r\n\r\n//\r\n// SocialCalc.Popup.Create(type, id, attribs)\r\n//\r\n// Creates a control of type \"type\" as the children of document element \"id\" using \"attribs\"\r\n//\r\n\r\nSocialCalc.Popup.Create = function(type, id, attribs) {\r\n\r\n   var pt = SocialCalc.Popup.Types[type];\r\n   if (pt && pt.Create) {\r\n      pt.Create(type, id, attribs);\r\n      }\r\n\r\n   SocialCalc.Popup.imagePrefix = SocialCalc.Constants.defaultImagePrefix; // image prefix\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.SetValue(id, value)\r\n//\r\n// Sets the value of control.\r\n//\r\n\r\nSocialCalc.Popup.SetValue = function(id, value) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n   var pt = spt[type];\r\n   var spcdata = spc[id].data;\r\n\r\n   if (pt && pt.Create) {\r\n      pt.SetValue(type, id, value);\r\n      if (spcdata.attribs && spcdata.attribs.changedcallback) {\r\n         spcdata.attribs.changedcallback(spcdata.attribs, id, value);\r\n         }\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.SetDisabled(id, disabled)\r\n//\r\n// Sets whether the control is disabled (true) or not (false).\r\n//\r\n\r\nSocialCalc.Popup.SetDisabled = function(id, disabled) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n   if (pt && pt.Create) {\r\n      if (sp.Current.id && id == sp.Current.id) {\r\n         pt.Hide(type, sp.Current.id);\r\n         sp.Current.id = null;\r\n         }\r\n      pt.SetDisabled(type, id, disabled);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.GetValue(id)\r\n//\r\n// Returns the value of control.\r\n//\r\n\r\nSocialCalc.Popup.GetValue = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n   if (pt && pt.Create) {\r\n      return pt.GetValue(type, id);\r\n      }\r\n\r\n   return null;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.Initialize(id, data)\r\n//\r\n// Gives \"data\" to the appropriate initialization code.\r\n//\r\n\r\nSocialCalc.Popup.Initialize = function(id, data) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n   if (pt && pt.Initialize) {\r\n      pt.Initialize(type, id, data);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.Reset(type)\r\n//\r\n// Resets Popup, such as when turning to page.\r\n//\r\n\r\nSocialCalc.Popup.Reset = function(type) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (spt[type].Reset) spt[type].Reset(type);\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.CClick(id)\r\n//\r\n// Should be called when the user clicks on a control to do the popup\r\n//\r\n\r\nSocialCalc.Popup.CClick = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!spc[id]) {alert(\"Unknown control \"+id);return;}\r\n\r\n   if (spc[id].data && spc[id].data.disabled) return;\r\n\r\n   var type = spc[id].type;\r\n\r\n   var pt = spt[type];\r\n\r\n   if (sp.Current.id) {\r\n      spt[spc[sp.Current.id].type].Hide(type, sp.Current.id);\r\n      if (id == sp.Current.id) { // same one - done\r\n         sp.Current.id = null;\r\n         return;\r\n         }\r\n      }\r\n\r\n   if (pt && pt.Show) {\r\n      pt.Show(type, id);\r\n      }\r\n\r\n   sp.Current.id = id;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.Popup.Close()\r\n//\r\n// Used to close any open popup.\r\n//\r\n\r\nSocialCalc.Popup.Close = function() {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!sp.Current.id) return;\r\n\r\n   sp.CClick(sp.Current.id);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.Popup.Cancel()\r\n//\r\n// Closes Popup and restores old value\r\n//\r\n\r\nSocialCalc.Popup.Cancel = function() {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (!sp.Current.id) return;\r\n\r\n   var type = spc[sp.Current.id].type;\r\n\r\n   var pt = spt[type];\r\n\r\n   pt.Cancel(type, sp.Current.id);\r\n\r\n   sp.Current.id = null;\r\n\r\n   }\r\n\r\n//\r\n// ele = SocialCalc.Popup.CreatePopupDiv(id, attribs)\r\n//\r\n// Utility function to create the main popup div of width attribs.width.\r\n// If attribs.title, create one with that text, and optionally attribs.moveable.\r\n//\r\n\r\nSocialCalc.Popup.CreatePopupDiv = function(id, attribs) {\r\n\r\n   var pos, ele;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.style.position = \"absolute\";\r\n\r\n   pos = SocialCalc.GetElementPosition(spcdata.mainele);\r\n\r\n   main.style.top = (pos.top+spcdata.mainele.offsetHeight)+\"px\";\r\n   main.style.left = pos.left+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   if (attribs.width) {\r\n      main.style.width = attribs.width;\r\n      }\r\n\r\n   spcdata.mainele.appendChild(main);\r\n\r\n   if (attribs.title) {\r\n      main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n         '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+attribs.title+'</td>'+\r\n         '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.Popup.Cancel();\">&nbsp;X&nbsp;</td></tr></table>';\r\n\r\n      if (attribs.moveable) {\r\n         spcdata.dragregistered = main.firstChild.firstChild.firstChild.firstChild;\r\n         SocialCalc.DragRegister(spcdata.dragregistered, true, true, \r\n                    {MouseDown: SocialCalc.DragFunctionStart, \r\n                     MouseMove: SocialCalc.DragFunctionPosition,\r\n                     MouseUp: SocialCalc.DragFunctionPosition,\r\n                     Disabled: null, positionobj: main},\r\n                     spcdata.mainele);\r\n         }\r\n      }\r\n\r\n   return main;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.Popup.EnsurePosition(id, container)\r\n//\r\n// Utility function to make sure popup is positioned completely within container (both element objects)\r\n// and appropriate with respect to the main element controlling the popup.\r\n//\r\n\r\nSocialCalc.Popup.EnsurePosition = function(id, container) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var main = spcdata.mainele.firstChild;\r\n   if (!main) {alert(\"No main popup element firstChild.\");return};\r\n   var popup = spcdata.popupele;\r\n\r\n   function GetLayoutValues(ele) {\r\n      var r = SocialCalc.GetElementPosition(ele);\r\n      r.height = ele.offsetHeight;\r\n      r.width = ele.offsetWidth;\r\n      r.bottom = r.top+r.height;\r\n      r.right = r.left+r.width;\r\n      return r;\r\n      }\r\n\r\n   var p = GetLayoutValues(popup);\r\n   var c = GetLayoutValues(container);\r\n   var m = GetLayoutValues(main);\r\n   var t = 0; // type of placement\r\n//addmsg(\"popup t/r/b/l/h/w= \"+p.top+\"/\"+p.right+\"/\"+p.bottom+\"/\"+p.left+\"/\"+p.height+\"/\"+p.width);\r\n//addmsg(\"container t/r/b/l/h/w= \"+c.top+\"/\"+c.right+\"/\"+c.bottom+\"/\"+c.left+\"/\"+c.height+\"/\"+c.width);\r\n//addmsg(\"main t/r/b/l/h/w= \"+m.top+\"/\"+m.right+\"/\"+m.bottom+\"/\"+m.left+\"/\"+m.height+\"/\"+m.width);\r\n\r\n   // Check various layout cases in priority order\r\n\r\n   if (m.bottom+p.height < c.bottom && m.left+p.width < c.right) { // normal case: room on bottom and right\r\n      popup.style.top = m.bottom + \"px\";\r\n      popup.style.left = m.left + \"px\";\r\n      t = 1;\r\n      }\r\n\r\n   else if (m.top-p.height > c.top && m.left+p.width < c.right) { // room on top and right\r\n      popup.style.top = (m.top-p.height) + \"px\";\r\n      popup.style.left = m.left + \"px\";\r\n      t = 2;\r\n      }\r\n\r\n   else if (m.bottom+p.height < c.bottom && m.right-p.width > c.left) { // room on bottom and left\r\n      popup.style.top = m.bottom + \"px\";\r\n      popup.style.left = (m.right-p.width) + \"px\";\r\n      t = 3;\r\n      }\r\n\r\n   else if (m.top-p.height > c.top && m.right-p.width > c.left) { // room on top and left\r\n      popup.style.top = (m.top-p.height) + \"px\";\r\n      popup.style.left = (m.right-p.width) + \"px\";\r\n      t = 4;\r\n      }\r\n\r\n   else if (m.bottom+p.height < c.bottom && p.width < c.width) { // room on bottom and middle\r\n      popup.style.top = m.bottom + \"px\";\r\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\r\n      t = 5;\r\n      }\r\n\r\n   else if (m.top-p.height > c.top && p.width < c.width) { // room on top and middle\r\n      popup.style.top = (m.top-p.height) + \"px\";\r\n      popup.style.left = (c.left+Math.floor((c.width-p.width)/2)) + \"px\";\r\n      t = 6;\r\n      }\r\n\r\n   else if (p.height < c.height && m.right+p.width < c.right) { // room on middle and right\r\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\r\n      popup.style.left = m.right + \"px\";\r\n      t = 7;\r\n      }\r\n\r\n   else if (p.height < c.height && m.left-p.width > c.left) { // room on middle and left\r\n      popup.style.top = (c.top+Math.floor((c.height-p.height)/2)) + \"px\";\r\n      popup.style.left = (m.left-p.width) + \"px\";\r\n      t = 8;\r\n      }\r\n\r\n   else { // nothing works, so leave as it is\r\n      }\r\n//addmsg(\"Popup layout \"+t);\r\n\r\n}\r\n\r\n//\r\n// ele = SocialCalc.Popup.DestroyPopupDiv(ele, dragregistered)\r\n//\r\n// Utility function to get rid of the main popup div.\r\n//\r\n\r\nSocialCalc.Popup.DestroyPopupDiv = function(ele, dragregistered) {\r\n\r\n   if (!ele) return;\r\n\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(dragregistered); // OK to do this even if not registered\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// Color Utility Functions\r\n//\r\n\r\nSocialCalc.Popup.RGBToHex = function(val) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   if (val==\"\") {\r\n      return \"000000\";\r\n      }\r\n   var rgbvals = val.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)/);\r\n   if (rgbvals) {\r\n      return sp.ToHex(rgbvals[1])+sp.ToHex(rgbvals[2])+sp.ToHex(rgbvals[3]);\r\n      }\r\n   else {\r\n      return \"000000\";\r\n      }\r\n   }\r\n\r\nSocialCalc.Popup.HexDigits=\"0123456789ABCDEF\";\r\n\r\nSocialCalc.Popup.ToHex = function(num) {\r\n   var sp = SocialCalc.Popup;\r\n   var first=Math.floor(num / 16);\r\n   var second=num % 16;\r\n   return sp.HexDigits.charAt(first)+sp.HexDigits.charAt(second);\r\n   }\r\n\r\nSocialCalc.Popup.FromHex = function(str) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var first = sp.HexDigits.indexOf(str.charAt(0).toUpperCase());\r\n   var second = sp.HexDigits.indexOf(str.charAt(1).toUpperCase());\r\n   return ((first>=0)?first:0)*16+((second>=0)?second:0);\r\n   }\r\n\r\nSocialCalc.Popup.HexToRGB = function(val) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   return \"rgb(\"+sp.FromHex(val.substring(1,3))+\",\"+sp.FromHex(val.substring(3,5))+\",\"+sp.FromHex(val.substring(5,7))+\")\";\r\n\r\n   }\r\n\r\nSocialCalc.Popup.makeRGB = function(r, g, b) {\r\n   return \"rgb(\"+(r>0?r:0)+\",\"+(g>0?g:0)+\",\"+(b>0?b:0)+\")\";\r\n   }\r\n\r\nSocialCalc.Popup.splitRGB = function(rgb) {\r\n   var parts = rgb.match(/(\\d+)\\D+(\\d+)\\D+(\\d+)\\D/);\r\n   if (!parts) {\r\n      return {r:0, g:0, b:0};\r\n      }\r\n   else {\r\n      return {r: parts[1]-0, g: parts[2]-0, b: parts[3]-0};\r\n      }\r\n   }\r\n\r\n// * * * * * * * * * * * * * * * *\r\n//\r\n// ROUTINES FOR EACH TYPE\r\n//\r\n// * * * * * * * * * * * * * * * *\r\n\r\n//\r\n// List\r\n//\r\n// type: List\r\n// value: value of control,\r\n// display: \"value to display\",\r\n// custom: true if custom value,\r\n// disabled: t/f,\r\n// attribs: {\r\n//    title: \"popup title string\",\r\n//    moveable: t/f,\r\n//    width: optional width, e.g., \"100px\",\r\n//    ensureWithin: optional element object to ensure popup fits within if possible\r\n//    changedcallback: optional function(attribs, id, newvalue),\r\n//    ...\r\n//    }\r\n// data: {\r\n//    ncols: calculated number of columns\r\n//    options: [\r\n//       {o: option-name, v: value-to-return,\r\n//        a: {option attribs} // optional: {skip: true, custom: true, cancel: true, newcol: true}\r\n//       },\r\n//       ...]\r\n//    }\r\n//\r\n// popupele: gets popup element object when created\r\n// contentele: gets element created with all the content\r\n// listdiv: gets div with list of items\r\n// customele: gets input element with custom value\r\n// dragregistered: gets element, if any, registered as draggable\r\n//\r\n\r\nSocialCalc.Popup.Types.List = {};\r\n\r\nSocialCalc.Popup.Types.List.Create = function(type, id, attribs) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\r\n   //if (spc[id]) {alert(\"Already created \"+id); return;}\r\n   spc[id] = spcid;\r\n   var spcdata = spcid.data;\r\n\r\n   spcdata.attribs = attribs || {};\r\n\r\n   var ele = document.getElementById(id);\r\n   if (!ele) {alert(\"Missing element \"+id); return;}\r\n\r\n   spcdata.mainele = ele;\r\n\r\n   ele.innerHTML = '<input style=\"cursor:pointer;width:100px;font-size:smaller;\" onfocus=\"this.blur();\" onclick=\"SocialCalc.Popup.CClick(\\''+id+'\\');\" value=\"\">';\r\n\r\n   spcdata.options = []; // set to nothing - use Initialize to fill\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.List.SetValue = function(type, id, value) {\r\n\r\n   var i;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   spcdata.value = value;\r\n   spcdata.custom = false;\r\n\r\n   for (i=0; i<spcdata.options.length; i++) {\r\n      o = spcdata.options[i];\r\n      if (o.a) {\r\n         if (o.a.skip || o.a.custom || o.a.cancel) {\r\n            continue;\r\n            }\r\n         }\r\n      if (o.v == spcdata.value) { // matches value\r\n         spcdata.display = o.o;\r\n         break;\r\n         }\r\n      }\r\n   if (i==spcdata.options.length) { // none found\r\n      spcdata.display = \"Custom\";\r\n      spcdata.custom = true;\r\n      }\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.value = spcdata.display;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.SetDisabled = function(type, id, disabled) {\r\n\r\n   var i;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   spcdata.disabled = disabled;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.disabled = disabled;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.GetValue = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   return spcdata.value;\r\n\r\n   }\r\n\r\n\r\n// data is: {value: initial value, attribs: {attribs stuff}, options: [{o: option-name, v: value-to-return, a: optional-attribs}, ...]}\r\n\r\nSocialCalc.Popup.Types.List.Initialize = function(type, id, data) {\r\n\r\n   var a;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   for (a in data.attribs) {\r\n      spcdata.attribs[a] = data.attribs[a];\r\n      }\r\n\r\n   spcdata.options = data ? data.options : [];\r\n\r\n   if (data.value) { // if has a value, set to it\r\n      sp.SetValue(id, data.value);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.Reset = function(type) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\r\n      spt[type].Hide(type, sp.Current.id);\r\n      sp.Current.id = null;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.Show = function(type, id) {\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data\r\n\r\n   var str = \"\";\r\n\r\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\r\n\r\n   if (spcdata.custom) {\r\n      str = SocialCalc.Popup.Types.List.MakeCustom(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n\r\n      spcdata.customele = ele.firstChild.firstChild.childNodes[1];\r\n      spcdata.listdiv = null;\r\n      spcdata.contentele = ele;\r\n      }\r\n   else {\r\n      str = SocialCalc.Popup.Types.List.MakeList(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\r\n\r\n      spcdata.customele = null;\r\n      spcdata.listdiv = ele.firstChild;\r\n      spcdata.contentele = ele;\r\n      }\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.disabled = true;\r\n      }\r\n\r\n   spcdata.popupele.appendChild(ele);\r\n\r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.MakeList = function(type, id) {\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data\r\n\r\n   var str = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>';\r\n   var td = '<td style=\"vertical-align:top;\">';\r\n\r\n   str += td;\r\n\r\n   spcdata.ncols = 1;\r\n\r\n   for (i=0; i<spcdata.options.length; i++) {\r\n      o = spcdata.options[i];\r\n      if (o.a) {\r\n         if ( o.a.newcol) {\r\n            str += '</td>'+td+\"&nbsp;&nbsp;&nbsp;&nbsp;\"+'</td>'+td;\r\n            spcdata.ncols += 1;\r\n            continue;\r\n            }\r\n         if (o.a.skip) {\r\n            str += '<div style=\"font-size:x-small;white-space:nowrap;\">'+o.o+'</div>';\r\n            continue;\r\n            }\r\n         }\r\n      if (o.v == spcdata.value && !(o.a && (o.a.custom || o.a.cancel))) { // matches value\r\n         bg = \"background-color:#DDF;\";\r\n         }\r\n      else {\r\n         bg = \"\";\r\n         }\r\n      str += '<div style=\"font-size:x-small;white-space:nowrap;'+bg+'\" onclick=\"SocialCalc.Popup.Types.List.ItemClicked(\\''+id+'\\',\\''+i+'\\');\" onmousemove=\"SocialCalc.Popup.Types.List.MouseMove(\\''+id+'\\',this);\">'+o.o+'</div>';\r\n      }\r\n\r\n   str += \"</td></tr></table>\";\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.MakeCustom = function(type, id) {\r\n\r\n   var SPLoc = SocialCalc.Popup.LocalizeString;\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var style = 'style=\"font-size:smaller;\"';\r\n\r\n   var str = \"\";\r\n\r\n   var val = spcdata.value;\r\n   val = SocialCalc.special_chars(val);\r\n\r\n   str = '<div style=\"white-space:nowrap;\"><br>'+\r\n         '<input id=\"customvalue\" value=\"'+val+'\"><br><br>'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomOK(\\''+id+'\\');return false;\">'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"List\")+'\" onclick=\"SocialCalc.Popup.Types.List.CustomToList(\\''+id+'\\');\">'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Cancel\")+'\" onclick=\"SocialCalc.Popup.Close();\">'+\r\n         '<br></div>';\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.ItemClicked = function(id, num) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var a = spcdata.options[num].a;\r\n\r\n   if (a && a.custom) {\r\n      oele = spcdata.contentele;\r\n      str = SocialCalc.Popup.Types.List.MakeCustom(\"List\", id);\r\n      nele = document.createElement(\"div\");\r\n      nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n      spcdata.customele = nele.firstChild.firstChild.childNodes[1];\r\n      spcdata.listdiv = null;\r\n      spcdata.contentele = nele;\r\n      spcdata.popupele.replaceChild(nele, oele);\r\n      if (spcdata.attribs.ensureWithin) {\r\n         SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n         }\r\n      return;\r\n      }\r\n\r\n   if (a && a.cancel) {\r\n      SocialCalc.Popup.Close();\r\n      return;\r\n      }\r\n\r\n   SocialCalc.Popup.SetValue(id, spcdata.options[num].v);\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.CustomToList = function(id) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   oele = spcdata.contentele;\r\n   str = SocialCalc.Popup.Types.List.MakeList(\"List\", id);\r\n   nele = document.createElement(\"div\");\r\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;\">'+str+'</div>';\r\n   spcdata.customele = null;\r\n   spcdata.listdiv = nele.firstChild;\r\n   spcdata.contentele = nele;\r\n   spcdata.popupele.replaceChild(nele, oele);\r\n   \r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.CustomOK = function(id) {\r\n\r\n   var i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, spcdata.customele.value);\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.List.MouseMove = function(id, ele) {\r\n\r\n   var col, i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var list = spcdata.listdiv;\r\n\r\n   if (!list) return;\r\n\r\n   var rowele = list.firstChild.firstChild.firstChild; // div.table.tbody.tr\r\n\r\n   for (col=0; col<spcdata.ncols; col++) {\r\n      for (i=0; i<rowele.childNodes[col*2].childNodes.length; i++) {\r\n         rowele.childNodes[col*2].childNodes[i].style.backgroundColor = \"#FFF\";\r\n         }\r\n      }\r\n\r\n   ele.style.backgroundColor = \"#DDF\";\r\n   \r\n   }\r\n\r\nSocialCalc.Popup.Types.List.Hide = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\r\n   spcdata.popupele = null;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      spcdata.mainele.firstChild.disabled = false;\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.List.Cancel = function(type, id) {\r\n\r\n   SocialCalc.Popup.Types.List.Hide(type, id);\r\n\r\n   }\r\n\r\n\r\n//\r\n// ColorChooser\r\n//\r\n// type: ColorChooser\r\n// value: value of control as \"rgb(r,g,b)\" or \"\" if default,\r\n// oldvalue: starting value to reset to on close,\r\n// display: \"value to display\" as hex color value,\r\n// custom: true if custom value,\r\n// disabled: t/f,\r\n// attribs: {\r\n//    title: \"popup title string\",\r\n//    moveable: t/f,\r\n//    width: optional width, e.g., \"100px\", of popup chooser\r\n//    ensureWithin: optional element object to ensure popup fits within if possible\r\n//    sampleWidth: optional width, e.g., \"20px\",\r\n//    sampleHeight: optional height, e.g., \"20px\",\r\n//    backgroundImage: optional background image for sample (transparent where want to show current color), e.g., \"colorbg.gif\"\r\n//    backgroundImageDefault: optional background image for sample when default (transparent shows white)\r\n//    backgroundImageDisabled: optional background image for sample when disabled (transparent shows gray)\r\n//    changedcallback: optional function(attribs, id, newvalue),\r\n//    ...\r\n//    }\r\n// data: {\r\n//    }\r\n//\r\n// popupele: gets popup element object when created\r\n// contentele: gets element created with all the content\r\n// customele: gets input element with custom value\r\n//\r\n\r\nSocialCalc.Popup.Types.ColorChooser = {};\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Create = function(type, id, attribs) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   var spcid = {type: type, value: \"\", display: \"\", data: {}};\r\n   //if (spc[id]) {alert(\"Already created \"+id); return;}\r\n   spc[id] = spcid;\r\n   var spcdata = spcid.data;\r\n\r\n   spcdata.attribs = attribs || {};\r\n   var spca = spcdata.attribs;\r\n\r\n   spcdata.value = \"\";\r\n\r\n   var ele = document.getElementById(id);\r\n   if (!ele) {alert(\"Missing element \"+id); return;}\r\n\r\n   spcdata.mainele = ele;\r\n\r\n   ele.innerHTML = '<div style=\"cursor:pointer;border:1px solid black;vertical-align:top;width:'+\r\n                   (spca.sampleWidth || '15px')+';height:'+(spca.sampleHeight || '15px')+\r\n                   ';\" onclick=\"SocialCalc.Popup.Types.ColorChooser.ControlClicked(\\''+id+'\\');\">&nbsp;</div>';\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.SetValue = function(type, id, value) {\r\n\r\n   var i, img, pos;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var spca = spcdata.attribs;\r\n\r\n   spcdata.value = value;\r\n   spcdata.custom = false;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      if (spcdata.value) {\r\n         spcdata.mainele.firstChild.style.backgroundColor = spcdata.value;\r\n         if (spca.backgroundImage) {\r\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImage+\")\";\r\n            }\r\n         else {\r\n            img = \"\";\r\n            }\r\n         pos = \"center center\";\r\n         }\r\n      else {\r\n         spcdata.mainele.firstChild.style.backgroundColor = \"#FFF\";\r\n         if (spca.backgroundImageDefault) {\r\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDefault+\")\";\r\n            pos = \"center center\";\r\n            }\r\n         else {\r\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\r\n            pos = \"left top\";\r\n            }\r\n         }\r\n      spcdata.mainele.firstChild.style.backgroundPosition = pos;\r\n      spcdata.mainele.firstChild.style.backgroundImage = img;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.SetDisabled = function(type, id, disabled) {\r\n\r\n   var i;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var spca = spcdata.attribs;\r\n\r\n   spcdata.disabled = disabled;\r\n\r\n   if (spcdata.mainele && spcdata.mainele.firstChild) {\r\n      if (disabled) {\r\n         spcdata.mainele.firstChild.style.backgroundColor = \"#DDD\";\r\n         if (spca.backgroundImageDisabled) {\r\n            img = \"url(\"+sp.imagePrefix+spca.backgroundImageDisabled+\")\";\r\n            pos = \"center center\";\r\n            }\r\n         else {\r\n            img = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\r\n            pos = \"left top\";\r\n            }\r\n         spcdata.mainele.firstChild.style.backgroundPosition = pos;\r\n         spcdata.mainele.firstChild.style.backgroundImage = img;\r\n         }\r\n      else {\r\n         sp.SetValue(id, spcdata.value);\r\n         }\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.GetValue = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   return spcdata.value;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Initialize = function(type, id, data) {\r\n\r\n   var a;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   for (a in data.attribs) {\r\n      spcdata.attribs[a] = data.attribs[a];\r\n      }\r\n\r\n   if (data.value) { // if has a value, set to it\r\n      sp.SetValue(id, data.value);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Reset = function(type) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n\r\n   if (sp.Current.id && spc[sp.Current.id].type == type) { // we have a popup\r\n      spt[type].Hide(type, sp.Current.id);\r\n      sp.Current.id = null;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Show = function(type, id) {\r\n\r\n   var i, ele, mainele;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data\r\n\r\n   var str = \"\";\r\n\r\n   spcdata.oldvalue = spcdata.value; // remember starting value\r\n\r\n   spcdata.popupele = sp.CreatePopupDiv(id, spcdata.attribs);\r\n\r\n   if (spcdata.custom) {\r\n      str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n\r\n      spcdata.customele = ele.firstChild.firstChild.childNodes[2];\r\n      spcdata.contentele = ele;\r\n      }\r\n   else {\r\n      mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(type, id);\r\n\r\n      ele = document.createElement(\"div\");\r\n      ele.style.padding = \"3px\";\r\n      ele.style.backgroundColor = \"#CCC\";\r\n      ele.appendChild(mainele);\r\n\r\n      spcdata.customele = null;\r\n      spcdata.contentele = ele;\r\n      }\r\n\r\n   spcdata.popupele.appendChild(ele);\r\n\r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.MakeCustom = function(type, id) {\r\n\r\n   var i, ele, o, bg;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   var SPLoc = sp.LocalizeString;\r\n\r\n   var style = 'style=\"font-size:smaller;\"';\r\n\r\n   var str = \"\";\r\n\r\n   str = '<div style=\"white-space:nowrap;\"><br>'+\r\n         '#<input id=\"customvalue\" style=\"width:75px;\" value=\"'+spcdata.value+'\"><br><br>'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"OK\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomOK(\\''+id+'\\');return false;\">'+\r\n         '<input '+style+' type=\"button\" value=\"'+SPLoc(\"Grid\")+'\" onclick=\"SocialCalc.Popup.Types.ColorChooser.CustomToGrid(\\''+id+'\\');\">'+\r\n         '<br></div>';\r\n\r\n   return str;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.ItemClicked = function(id, num) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomToList = function(id) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\r\n\r\n   var i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.SetValue(id, spcdata.customele.value);\r\n\r\n   sp.Close();\r\n   \r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Hide = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.DestroyPopupDiv(spcdata.popupele, spcdata.dragregistered);\r\n   spcdata.popupele = null;\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.Cancel = function(type, id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   sp.SetValue(id, spcdata.oldvalue); // reset to old value\r\n\r\n   SocialCalc.Popup.Types.ColorChooser.Hide(type, id);\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CreateGrid = function (type, id) {\r\n\r\n   var ele, pos, row, rowele, col, g;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var SPLoc = sp.LocalizeString;\r\n   var spcdata = spc[id].data;\r\n   spcdata.grid = {};\r\n   var grid = spcdata.grid;\r\n\r\n   var mainele = document.createElement(\"div\");\r\n\r\n   ele = document.createElement(\"table\");\r\n   ele.cellSpacing = 0;\r\n   ele.cellPadding = 0;\r\n   ele.style.width = \"100px\";\r\n   grid.table = ele;\r\n\r\n   ele = document.createElement(\"tbody\");\r\n   grid.table.appendChild(ele);\r\n   grid.tbody = ele;\r\n\r\n   for (row=0; row<16; row++) {\r\n      rowele = document.createElement(\"tr\");\r\n      for (col=0; col<5; col++) {\r\n         g = {};\r\n         grid[row+\",\"+col] = g;\r\n         ele = document.createElement(\"td\");\r\n         ele.style.fontSize = \"1px\";\r\n         ele.innerHTML = \"&nbsp;\";\r\n         ele.style.height = \"10px\";\r\n         if (col<=1) {\r\n            ele.style.width = \"17px\";\r\n            ele.style.borderRight = \"3px solid white\";\r\n            }\r\n         else {\r\n            ele.style.width = \"20px\";\r\n            ele.style.backgroundRepeat = \"no-repeat\";\r\n            }\r\n         rowele.appendChild(ele);\r\n         g.ele = ele;\r\n         }\r\n      grid.tbody.appendChild(rowele);\r\n      }\r\n   mainele.appendChild(grid.table);\r\n\r\n   ele = document.createElement(\"div\");\r\n   ele.style.marginTop = \"3px\";\r\n   ele.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '<td style=\"width:17px;background-color:#FFF;background-image:url('+sp.imagePrefix+'defaultcolor.gif);height:16px;font-size:10px;cursor:pointer;\" title=\"'+SPLoc(\"Default\")+'\">&nbsp;</td>'+\r\n      '<td style=\"width:23px;height:16px;font-size:10px;text-align:center;cursor:pointer;\" title=\"'+SPLoc(\"Custom\")+'\">#</td>'+\r\n      '<td style=\"width:60px;height:16px;font-size:10px;text-align:center;cursor:pointer;\">'+SPLoc(\"OK\")+'</td>'+\r\n      '</tr></table>';\r\n   grid.defaultbox = ele.firstChild.firstChild.firstChild.childNodes[0];\r\n   grid.defaultbox.onclick = spt.ColorChooser.DefaultClicked;\r\n   grid.custom = ele.firstChild.firstChild.firstChild.childNodes[1];\r\n   grid.custom.onclick = spt.ColorChooser.CustomClicked;\r\n   grid.msg = ele.firstChild.firstChild.firstChild.childNodes[2];\r\n   grid.msg.onclick = spt.ColorChooser.CloseOK;\r\n   mainele.appendChild(ele);\r\n\r\n   grid.table.onmousedown = spt.ColorChooser.GridMouseDown;\r\n\r\n   spt.ColorChooser.DetermineColors(id);\r\n   spt.ColorChooser.SetColors(id);\r\n\r\n   return mainele;\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.gridToG = function(grid, row, col) {\r\n\r\n   return grid[row+\",\"+col];\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.DetermineColors = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var grid = spcdata.grid;\r\n\r\n   var col, row;\r\n   var rgb = sp.splitRGB(spcdata.value);\r\n   var color;\r\n\r\n   col = 2;\r\n   row = 16-Math.floor((rgb.r+16)/16);\r\n   grid[\"selectedrow\"+col] = row;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),0,0);\r\n      }\r\n\r\n   col = 3;\r\n   row = 16-Math.floor((rgb.g+16)/16);\r\n   grid[\"selectedrow\"+col] = row;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,17*(15-row),0);\r\n      }\r\n\r\n   col = 4;\r\n   row = 16-Math.floor((rgb.b+16)/16);\r\n   grid[\"selectedrow\"+col] = row;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(0,0,17*(15-row));\r\n      }\r\n\r\n   col = 1;\r\n   for (row=0; row<16; row++) {\r\n      sptc.gridToG(grid,row,col).rgb = sp.makeRGB(17*(15-row),17*(15-row),17*(15-row));\r\n      }\r\n\r\n   col = 0;\r\n   var steps = [0, 68, 153, 204, 255];\r\n   var commonrgb = [\"400\", \"310\", \"420\", \"440\", \"442\", \"340\", \"040\", \"042\", \"032\", \"044\", \"024\", \"004\", \"204\", \"314\", \"402\", \"414\"];\r\n   var x;\r\n   for (row=0; row<16; row++) {\r\n      x = commonrgb[row];\r\n      sptc.gridToG(grid,row,col).rgb = \"rgb(\"+steps[x.charAt(0)-0]+\",\"+steps[x.charAt(1)-0]+\",\"+steps[x.charAt(2)-0]+\")\";\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.SetColors = function(id) {\r\n\r\n   var row, col, g, ele, rgb;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n   var grid = spcdata.grid;\r\n\r\n   for (row=0; row<16; row++) {\r\n      for (col=0; col<5; col++) {\r\n         g = sptc.gridToG(grid,row, col);\r\n         g.ele.style.backgroundColor = g.rgb;\r\n         g.ele.title = sp.RGBToHex(g.rgb);\r\n         if (grid[\"selectedrow\"+col]==row) {\r\n            g.ele.style.backgroundImage = \"url(\"+sp.imagePrefix+\"chooserarrow.gif)\";\r\n            }\r\n         else {\r\n            g.ele.style.backgroundImage = \"\";\r\n            }\r\n         }\r\n      }\r\n\r\n   sp.SetValue(id, spcdata.value);\r\n\r\n   grid.msg.style.backgroundColor = spcdata.value;\r\n   rgb = sp.splitRGB(spcdata.value || \"rgb(255,255,255)\");\r\n   if (rgb.r+rgb.g+rgb.b < 220) {\r\n      grid.msg.style.color = \"#FFF\";\r\n      }\r\n   else {\r\n      grid.msg.style.color = \"#000\";\r\n      }\r\n   if (!spcdata.value) { // default\r\n      grid.msg.style.backgroundColor = \"#FFF\";\r\n      grid.msg.style.backgroundImage = \"url(\"+sp.imagePrefix+\"defaultcolor.gif)\";\r\n      grid.msg.title = \"Default\";\r\n      }\r\n   else {\r\n      grid.msg.style.backgroundImage = \"\";\r\n      grid.msg.title = sp.RGBToHex(spcdata.value);\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.GridMouseDown = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n   var grid = spcdata.grid;\r\n\r\n   switch (event.type) {\r\n      case \"mousedown\":\r\n         grid.mousedown = true;\r\n         break;\r\n      case \"mouseup\":\r\n         grid.mousedown = false;\r\n         break;\r\n      case \"mousemove\":\r\n         if (!grid.mousedown) {\r\n            return;\r\n            }\r\n         break;\r\n      }\r\n\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spcdata.mainele);\r\n   var clientX = event.clientX - pos.left;\r\n   var clientY = event.clientY - pos.top;\r\n   var gpos = SocialCalc.GetElementPositionWithScroll(grid.table);\r\n   gpos.left -= pos.left;\r\n   gpos.top -= pos.top\r\n   var row = Math.floor((clientY-gpos.top-2)/10); // -2 is to split the diff btw IE & FF\r\n   row = row < 0 ? 0 : row;\r\n   var col = Math.floor((clientX-gpos.left)/20);\r\n   row = row < 0 ? 0 : (row > 15 ? 15 : row);\r\n   col = col < 0 ? 0 : (col > 4 ? 4 : col);\r\n   var color = sptc.gridToG(grid,row,col).ele.style.backgroundColor;\r\n   var newrgb = sp.splitRGB(color);\r\n   var oldrgb = sp.splitRGB(spcdata.value);\r\n\r\n   switch (col) {\r\n      case 2:\r\n         spcdata.value = sp.makeRGB(newrgb.r, oldrgb.g, oldrgb.b);\r\n         break;\r\n      case 3:\r\n         spcdata.value = sp.makeRGB(oldrgb.r, newrgb.g, oldrgb.b);\r\n         break;\r\n      case 4:\r\n         spcdata.value = sp.makeRGB(oldrgb.r, oldrgb.g, newrgb.b);\r\n         break;\r\n      case 0:\r\n      case 1:\r\n         spcdata.value = color;\r\n      }\r\n\r\n   sptc.DetermineColors(id);\r\n   sptc.SetColors(id);\r\n\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.ControlClicked = function(id) {\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var cid = sp.Current.id;\r\n   if (!cid || id != cid) {\r\n      sp.CClick(id);\r\n      return;\r\n      }\r\n\r\n   sptc.CloseOK();\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.DefaultClicked = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n\r\n   spcdata.value = \"\";\r\n   SocialCalc.Popup.SetValue(id, spcdata.value);\r\n\r\n   SocialCalc.Popup.Close();\r\n\r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomClicked = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n\r\n   var oele, str, nele;\r\n\r\n   oele = spcdata.contentele;\r\n   str = SocialCalc.Popup.Types.ColorChooser.MakeCustom(\"ColorChooser\", id);\r\n   nele = document.createElement(\"div\");\r\n   nele.innerHTML = '<div style=\"cursor:default;padding:4px;background-color:#CCC;\">'+str+'</div>';\r\n   spcdata.customele = nele.firstChild.firstChild.childNodes[2];\r\n   spcdata.contentele = nele;\r\n   spcdata.popupele.replaceChild(nele, oele);\r\n\r\n   spcdata.customele.value = sp.RGBToHex(spcdata.value);\r\n\r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n\r\n   }\r\n\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomToGrid = function(id) {\r\n\r\n   var oele, str, nele;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\r\n\r\n   var oele, mainele, nele;\r\n\r\n   oele = spcdata.contentele;\r\n   mainele = SocialCalc.Popup.Types.ColorChooser.CreateGrid(\"ColorChooser\", id);\r\n   nele = document.createElement(\"div\");\r\n   nele.style.padding = \"3px\";\r\n   nele.style.backgroundColor = \"#CCC\";\r\n   nele.appendChild(mainele);\r\n   spcdata.customele = null;\r\n   spcdata.contentele = nele;\r\n   spcdata.popupele.replaceChild(nele, oele);\r\n   \r\n   if (spcdata.attribs.ensureWithin) {\r\n      SocialCalc.Popup.EnsurePosition(id, spcdata.attribs.ensureWithin);\r\n      }\r\n   }\r\n\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CustomOK = function(id) {\r\n\r\n   var i, c;\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var spc = sp.Controls;\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, sp.HexToRGB(\"#\"+spcdata.customele.value));\r\n\r\n   SocialCalc.Popup.Close();\r\n   \r\n   }\r\n\r\nSocialCalc.Popup.Types.ColorChooser.CloseOK = function(e) {\r\n\r\n   var event = e || window.event;\r\n\r\n   var sp = SocialCalc.Popup;\r\n   var spt = sp.Types;\r\n   var sptc = spt.ColorChooser;\r\n   var spc = sp.Controls;\r\n\r\n   var id = sp.Current.id;\r\n   if (!id) return;\r\n\r\n   var spcdata = spc[id].data;\r\n\r\n   SocialCalc.Popup.SetValue(id, spcdata.value);\r\n\r\n   SocialCalc.Popup.Close();\r\n\r\n   }\r\n\r\n","//\r\n// SocialCalcSpreadsheetControl\r\n//\r\n/*\r\n// The code module of the SocialCalc package that lets you embed a spreadsheet\r\n// control with toolbar, etc., into a web page.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n\r\n\r\n/*\r\n\r\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\r\n\r\nEXHIBIT A. Common Public Attribution License Version 1.0.\r\n\r\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \r\n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \r\nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \r\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \r\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \r\nconsistent with Exhibit B.\r\n\r\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \r\nKIND, either express or implied. See the License for the specific language governing rights and \r\nlimitations under the License.\r\n\r\nThe Original Code is SocialCalc JavaScript SpreadsheetControl.\r\n\r\nThe Original Developer is the Initial Developer.\r\n\r\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \r\nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\r\n\r\nContributor: Dan Bricklin.\r\n\r\n\r\nEXHIBIT B. Attribution Information\r\n\r\nWhen the SpreadsheetControl is producing and/or controlling the display the Graphic Image must be\r\ndisplayed on the screen visible to the user in a manner comparable to that in the \r\nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\r\nthat image. The image must be linked to the Attribution URL so as to access that page\r\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\r\nfactual prominent attribution in a form similar to that in the \"about\" display included\r\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\r\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\r\n\r\nAttribution Copyright Notice:\r\n\r\n Copyright (C) 2010 Socialtext, Inc.\r\n All Rights Reserved.\r\n\r\nAttribution Phrase (not exceeding 10 words): SocialCalc\r\n\r\nAttribution URL: http://www.socialcalc.org/\r\n\r\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\r\na suitable replacement from http://www.socialcalc.org/licenses specified as\r\nbeing for SocialCalc.\r\n\r\nDisplay of Attribution Information is required in Larger Works which are defined \r\nin the CPAL as a work which combines Covered Code or portions thereof with code \r\nnot governed by the terms of the CPAL.\r\n\r\n*/\r\n\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n\r\n/*\r\n\r\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\r\n\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) {\r\n      alert(\"Main SocialCalc code module needed\");\r\n      SocialCalc = {};\r\n      }\r\n   if (!SocialCalc.TableEditor) {\r\n      alert(\"SocialCalc TableEditor code module needed\");\r\n      }\r\n\r\n// *************************************\r\n//\r\n// SpreadsheetControl class:\r\n//\r\n// *************************************\r\n\r\n// Global constants:\r\n\r\n   SocialCalc.CurrentSpreadsheetControlObject = null; // right now there can only be one active at a time\r\n\r\n\r\n// Constructor:\r\n\r\nSocialCalc.SpreadsheetControl = function(idPrefix) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // Properties:\r\n\r\n   this.parentNode = null;\r\n   this.spreadsheetDiv = null;\r\n   this.requestedHeight = 0;\r\n   this.requestedWidth = 0;\r\n   this.requestedSpaceBelow = 0;\r\n   this.height = 0;\r\n   this.width = 0;\r\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\r\n\r\n   // Tab definitions: An array where each tab is an object of the form:\r\n   //\r\n   //    name: \"name\",\r\n   //    text: \"text-on-tab\",\r\n   //    html: \"html-to-create div\",\r\n   //       replacements:\r\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext\r\n   //         Other replacements from spreadsheet.tabreplacements:\r\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\r\n   //    view: \"viewname\", // view to show when selected; \"sheet\" or missing/null is spreadsheet\r\n   //    oncreate: function(spreadsheet, tab-name), // called when first created to initialize\r\n   //    onclick: function(spreadsheet, tab-name), missing/null is sheet default\r\n   //    onclickFocus: text, // spreadsheet.idPrefix+text is given the focus if present instead of normal KeyboardFocus\r\n   //       or if text isn't a string, that value (e.g., true) is used for SocialCalc.CmdGotFocus\r\n   //    onunclick: function(spreadsheet, tab-name), missing/null is sheet default\r\n\r\n   this.tabs = [];\r\n   this.tabnums = {}; // when adding tabs, add tab-name: array-index to this object\r\n   this.tabreplacements = {}; // see use above\r\n   this.currentTab = -1; // currently selected tab index in this.tabs or -1 (maintained by SocialCalc.SetTab)\r\n\r\n   // View definitions: An object where each view is an object of the form:\r\n   //\r\n   //    name: \"name\", // localized when first set using SocialCalc.LocalizeString\r\n   //    element: node-in-the-dom, // filled in when initialized\r\n   //    replacements: {}, // see below\r\n   //    html: \"html-to-create div\",\r\n   //       replacements:\r\n   //         \"%s.\": \"SocialCalc\", \"%id.\": spreadsheet.idPrefix, \"%tbt.\": spreadsheet.toolbartext, \"%img.\": spreadsheet.imagePrefix,\r\n   //         SocialCalc.LocalizeSubstring replacements (\"%loc!string!\" and \"%ssc!constant-name!\")\r\n   //         Other replacements from viewobject.replacements:\r\n   //            replacementname: {regex: regular-expression-to-match-with-g, replacement: string}\r\n   //    divStyle: attributes for sheet div (SocialCalc.setStyles format)\r\n   //    oncreate: function(spreadsheet, viewobject), // called when first created to initialize\r\n   //    needsresize: true/false/null, // if true, do resize calc after displaying\r\n   //    onresize: function(spreadsheet, viewobject), // called if needs resize\r\n   //    values: {} // optional values to share with onclick handlers, etc.\r\n   //\r\n   // There is always a \"sheet\" view.\r\n\r\n   this.views = {}; // {viewname: view-object, ...}\r\n\r\n   // Dynamic properties:\r\n\r\n   this.sheet = null;\r\n   this.context = null;\r\n   this.editor = null;\r\n\r\n   this.spreadsheetDiv = null;\r\n   this.editorDiv = null;\r\n\r\n   this.sortrange = \"\"; // remembered range for sort tab\r\n\r\n   this.moverange = \"\"; // remembered range from movefrom used by movepaste/moveinsert\r\n\r\n   // Constants:\r\n\r\n   this.idPrefix = idPrefix || \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\r\n   this.multipartBoundary = \"SocialCalcSpreadsheetControlSave\"; // boundary used by SpreadsheetControlCreateSpreadsheetSave\r\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\r\n\r\n   this.toolbarbackground = scc.SCToolbarbackground;\r\n   this.tabbackground = scc.SCTabbackground; // \"background-color:#CCC;\";\r\n   this.tabselectedCSS = scc.SCTabselectedCSS;\r\n   this.tabplainCSS = scc.SCTabplainCSS;\r\n   this.toolbartext = scc.SCToolbartext;\r\n\r\n   this.formulabarheight = scc.SCFormulabarheight; // in pixels, will contain a text input box\r\n\r\n   this.statuslineheight = scc.SCStatuslineheight; // in pixels\r\n   this.statuslineCSS = scc.SCStatuslineCSS;\r\n\r\n   // Callbacks:\r\n\r\n   this.ExportCallback = null; // a function called for Clipboard Export button: this.ExportCallback(spreadsheet_control_object)\r\n\r\n   // Initialization Code:\r\n\r\n   // eddy Initialization {\r\n   if(typeof SocialCalc.debug_log === 'undefined') SocialCalc.debug_log = [];   \r\n   // }   \r\n   \r\n   this.sheet = new SocialCalc.Sheet();\r\n   this.context = new SocialCalc.RenderContext(this.sheet);\r\n   this.context.showGrid=true;\r\n   this.context.showRCHeaders=true;\r\n   this.editor = new SocialCalc.TableEditor(this.context);\r\n   this.editor.StatusCallback.statusline =\r\n      {func: SocialCalc.SpreadsheetControlStatuslineCallback,\r\n       params: {statuslineid: this.idPrefix+\"statusline\",\r\n                recalcid1: this.idPrefix+\"divider_recalc\",\r\n                recalcid2: this.idPrefix+\"button_recalc\"}};\r\n\r\n   SocialCalc.CurrentSpreadsheetControlObject = this; // remember this for rendezvousing on events\r\n\r\n   this.editor.MoveECellCallback.movefrom = function(editor) {\r\n      var cr;\r\n      var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n      spreadsheet.context.cursorsuffix = \"\";\r\n      if (editor.range2.hasrange && !editor.cellhandles.noCursorSuffix) {\r\n         if (editor.ecell.row==editor.range2.top && (editor.ecell.col<editor.range2.left || editor.ecell.col>editor.range2.right+1)) {\r\n            spreadsheet.context.cursorsuffix = \"insertleft\";\r\n            }\r\n         if (editor.ecell.col==editor.range2.left && (editor.ecell.row<editor.range2.top || editor.ecell.row>editor.range2.bottom+1)) {\r\n            spreadsheet.context.cursorsuffix = \"insertup\";\r\n            }\r\n         }\r\n      };\r\n\r\n   // formula bar buttons\r\n\r\n   this.formulabuttons = {\r\n      formulafunctions: {image: \"insertformula.png\", tooltip: \"Functions\", // tooltips are localized when set below\r\n                         command: SocialCalc.SpreadsheetControl.DoFunctionList},\r\n      multilineinput: {image: \"listbox.png\", tooltip: \"Multi-line Input Box\",\r\n                         command: SocialCalc.SpreadsheetControl.DoMultiline},\r\n      link: {image: \"inserthyperlink.png\", tooltip: \"Link Input Box\",\r\n                         command: SocialCalc.SpreadsheetControl.DoLink},\r\n      sum: {image: \"autosum.png\", tooltip: \"Auto Sum\",\r\n                         command: SocialCalc.SpreadsheetControl.DoSum}\r\n      }\r\n   \r\n   // find buttons\r\n   this.findbuttons = {\r\n       last: {image: 'upsearch.png', tooltip: 'Find Previous',\r\n              command: SocialCalc.SpreadsheetControl.SearchUp},\r\n       next: {image: 'downsearch.png', tooltip: 'Find Next', \r\n              command: SocialCalc.SpreadsheetControl.SearchDown}\r\n   }\r\n\r\n   // Default tabs:\r\n\r\n   // Edit\r\n\r\n   this.tabnums.edit = this.tabs.length;\r\n   this.tabs.push({name: \"edit\", text: \"Edit\", html:\r\n      ' <div id=\"%id.edittools\" style=\"padding:10px 0px 0px 0px;\">'+\r\n'&nbsp;<img id=\"%id.button_undo\" src=\"%img.undo.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_redo\" src=\"%img.redo.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_copy\" src=\"%img.copy.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_cut\" src=\"%img.cut.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_paste\" src=\"%img.paste.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_delete\" src=\"%img.delete.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_pasteformats\" src=\"%img.formatpaintbrush.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n' <span id=\"%id.locktools\"><img id=\"%id.button_lock\" src=\"%img.lock.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_unlock\" src=\"%img.unlock.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp;</span> '+\r\n'<img id=\"%id.button_filldown\" src=\"%img.filldown.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_fillright\" src=\"%img.fillright.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_movefrom\" src=\"%img.movefromoff.gif\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_movepaste\" src=\"%img.movepasteoff.gif\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_moveinsert\" src=\"%img.moveinsertoff.gif\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_alignleft\" src=\"%img.alignleft.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_aligncenter\" src=\"%img.aligncenter.png\" style=\"vertical-align:bottom;\">'+\r\n' <img id=\"%id.button_alignright\" src=\"%img.alignright.png\" style=\"vertical-align:bottom;\">'+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_borderon\" src=\"%img.borderson.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_borderoff\" src=\"%img.bordersoff.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_swapcolors\" src=\"%img.swapcolors.png\" style=\"vertical-align:bottom;\"> '+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_merge\" src=\"%img.mergecells.png\" style=\"vertical-align:bottom;\"> '+\r\n' &nbsp;<img src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_insertrow\" src=\"%img.insertrows.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_insertcol\" src=\"%img.insertcolumns.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_deleterow\" src=\"%img.deleterows.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_deletecol\" src=\"%img.deletecolumns.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_hiderow\" src=\"%img.hiderow.png\" style=\"vertical-align:bottom;\"> '+\r\n' <img id=\"%id.button_hidecol\" src=\"%img.hidecol.png\" style=\"vertical-align:bottom;\"> '+\r\n' &nbsp;<img id=\"%id.divider_recalc\" src=\"%img.divider1.png\" style=\"vertical-align:bottom;\">&nbsp; '+\r\n'<img id=\"%id.button_recalc\" src=\"%img.recalc.png\" style=\"vertical-align:bottom;\"> '+\r\n      ' </div>',\r\n      oncreate: null, //function(spreadsheet, viewobject) {SocialCalc.DoCmd(null, \"fill-rowcolstuff\");},\r\n      onclick: null});\r\n\r\n   // Settings (Format)\r\n\r\n   this.tabnums.settings = this.tabs.length;\r\n   this.tabs.push({name: \"settings\", text: \"Format\", html:\r\n      '<div id=\"%id.settingstools\" style=\"display:none;\">'+\r\n      ' <div id=\"%id.sheetsettingstoolbar\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\r\n      '   <div style=\"%tbt.\">%loc!SHEET SETTINGS!:</div>'+\r\n      '   </td></tr><tr><td>'+\r\n      '   <input id=\"%id.settings-savesheet\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'sheet\\');\">'+\r\n      '   <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\r\n      '   <input type=\"button\" value=\"%loc!Show Cell Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'cell\\');return false;\">'+\r\n      '   </td></tr></table>'+\r\n      ' </div>'+\r\n      ' <div id=\"%id.cellsettingstoolbar\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\r\n      '   <div style=\"%tbt.\">%loc!CELL SETTINGS!: <span id=\"%id.settingsecell\">&nbsp;</span></div>'+\r\n      '   </td></tr><tr><td>'+\r\n      '  <input id=\"%id.settings-savecell\" type=\"button\" value=\"%loc!Save!\" onclick=\"SocialCalc.SettingsControlSave(\\'cell\\');\">'+\r\n      '  <input type=\"button\" value=\"%loc!Cancel!\" onclick=\"SocialCalc.SettingsControlSave(\\'cancel\\');\">'+\r\n      '  <input type=\"button\" value=\"%loc!Show Sheet Settings!\" onclick=\"SocialCalc.SpreadsheetControlSettingsSwitch(\\'sheet\\');return false;\">'+\r\n      '  </td></tr></table>'+\r\n      ' </div>'+\r\n      '</div>',\r\n      view: \"settings\",\r\n      onclick: function(s, t) {\r\n         SocialCalc.SettingsControls.idPrefix = s.idPrefix; // used to get color chooser div\r\n         SocialCalc.SettingControlReset();\r\n         var sheetattribs = s.sheet.EncodeSheetAttributes();\r\n         var cellattribs = s.sheet.EncodeCellAttributes(s.editor.ecell.coord);\r\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.sheetspanel, sheetattribs);\r\n         SocialCalc.SettingsControlLoadPanel(s.views.settings.values.cellspanel, cellattribs);\r\n         document.getElementById(s.idPrefix+\"settingsecell\").innerHTML = s.editor.ecell.coord;\r\n         SocialCalc.SpreadsheetControlSettingsSwitch(\"cell\");\r\n         s.views.settings.element.style.height = s.viewheight+\"px\";\r\n         s.views.settings.element.firstChild.style.height = s.viewheight+\"px\";\r\n\r\n         var range;  // set save message\r\n         if (s.editor.range.hasrange) {\r\n            range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\r\n               SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\r\n            }\r\n         else {\r\n            range = s.editor.ecell.coord;\r\n            }\r\n         document.getElementById(s.idPrefix+\"settings-savecell\").value = SocialCalc.LocalizeString(\"Save to\")+\": \"+range;\r\n         },\r\n      onclickFocus: true\r\n         });\r\n\r\n   this.views[\"settings\"] = {name: \"settings\", values: {},\r\n      oncreate: function(s, viewobj) {\r\n         var scc = SocialCalc.Constants;\r\n\r\n         viewobj.values.sheetspanel = {\r\n//            name: \"sheet\",\r\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\r\n            formatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"formatnumber\",\r\n               initialdata: scc.SCFormatNumberFormats},\r\n            formattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"formattext\",\r\n               initialdata: scc.SCFormatTextFormats},\r\n            fontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"fontfamily\",\r\n               initialdata: scc.SCFormatFontfamilies},\r\n            fontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"fontlook\",\r\n               initialdata: scc.SCFormatFontlook},\r\n            fontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"fontsize\",\r\n               initialdata: scc.SCFormatFontsizes},\r\n            textalignhoriz: {setting: \"textalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"textalignhoriz\",\r\n               initialdata: scc.SCFormatTextAlignhoriz},\r\n            numberalignhoriz: {setting: \"numberalignhoriz\", type: \"PopupList\", id: s.idPrefix+\"numberalignhoriz\",\r\n               initialdata: scc.SCFormatNumberAlignhoriz},\r\n            alignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"alignvert\",\r\n               initialdata: scc.SCFormatAlignVertical},\r\n            textcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"textcolor\"},\r\n            bgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"bgcolor\"},\r\n            padtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"padtop\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            padright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"padright\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            padbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"padbottom\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            padleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"padleft\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            colwidth: {setting: \"colwidth\", type: \"PopupList\", id: s.idPrefix+\"colwidth\",\r\n               initialdata: scc.SCFormatColwidth},\r\n            recalc: {setting: \"recalc\", type: \"PopupList\", id: s.idPrefix+\"recalc\",\r\n               initialdata: scc.SCFormatRecalc},\r\n            usermaxcol: {setting: \"usermaxcol\", type: \"PopupList\", id: s.idPrefix+\"usermaxcol\",\r\n               initialdata: scc.SCFormatUserMaxCol},\r\n            usermaxrow: {setting: \"usermaxrow\", type: \"PopupList\", id: s.idPrefix+\"usermaxrow\",\r\n               initialdata: scc.SCFormatUserMaxRow}\r\n\r\n            };\r\n         viewobj.values.cellspanel = {\r\n            name: \"cell\",\r\n            colorchooser: {id: s.idPrefix+\"scolorchooser\"},\r\n            cformatnumber: {setting: \"numberformat\", type: \"PopupList\", id: s.idPrefix+\"cformatnumber\",\r\n               initialdata: scc.SCFormatNumberFormats},\r\n            cformattext: {setting: \"textformat\", type: \"PopupList\", id: s.idPrefix+\"cformattext\",\r\n               initialdata: scc.SCFormatTextFormats},\r\n            cfontfamily: {setting: \"fontfamily\", type: \"PopupList\", id: s.idPrefix+\"cfontfamily\",\r\n               initialdata: scc.SCFormatFontfamilies},\r\n            cfontlook: {setting: \"fontlook\", type: \"PopupList\", id: s.idPrefix+\"cfontlook\",\r\n               initialdata: scc.SCFormatFontlook},\r\n            cfontsize: {setting: \"fontsize\", type: \"PopupList\", id: s.idPrefix+\"cfontsize\",\r\n               initialdata: scc.SCFormatFontsizes},\r\n            calignhoriz: {setting: \"alignhoriz\", type: \"PopupList\", id: s.idPrefix+\"calignhoriz\",\r\n               initialdata: scc.SCFormatTextAlignhoriz},\r\n            calignvert: {setting: \"alignvert\", type: \"PopupList\", id: s.idPrefix+\"calignvert\",\r\n               initialdata: scc.SCFormatAlignVertical},\r\n            ctextcolor: {setting: \"textcolor\", type: \"ColorChooser\", id: s.idPrefix+\"ctextcolor\"},\r\n            cbgcolor: {setting: \"bgcolor\", type: \"ColorChooser\", id: s.idPrefix+\"cbgcolor\"},\r\n            cbt: {setting: \"bt\", type: \"BorderSide\", id: s.idPrefix+\"cbt\"},\r\n            cbr: {setting: \"br\", type: \"BorderSide\", id: s.idPrefix+\"cbr\"},\r\n            cbb: {setting: \"bb\", type: \"BorderSide\", id: s.idPrefix+\"cbb\"},\r\n            cbl: {setting: \"bl\", type: \"BorderSide\", id: s.idPrefix+\"cbl\"},\r\n            cpadtop: {setting: \"padtop\", type: \"PopupList\", id: s.idPrefix+\"cpadtop\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            cpadright: {setting: \"padright\", type: \"PopupList\", id: s.idPrefix+\"cpadright\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            cpadbottom: {setting: \"padbottom\", type: \"PopupList\", id: s.idPrefix+\"cpadbottom\",\r\n               initialdata: scc.SCFormatPadsizes},\r\n            cpadleft: {setting: \"padleft\", type: \"PopupList\", id: s.idPrefix+\"cpadleft\",\r\n               initialdata: scc.SCFormatPadsizes}\r\n            };\r\n\r\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.sheetspanel);\r\n         SocialCalc.SettingsControlInitializePanel(viewobj.values.cellspanel);\r\n         },\r\n      replacements: {\r\n         itemtitle: {regex: /\\%itemtitle\\./g, replacement: 'style=\"padding:12px 10px 0px 10px;font-weight:bold;text-align:right;vertical-align:top;font-size:small;\"'},\r\n         sectiontitle: {regex: /\\%sectiontitle\\./g, replacement: 'style=\"padding:16px 10px 0px 0px;font-weight:bold;vertical-align:top;font-size:small;color:#C00;\"'},\r\n         parttitle: {regex: /\\%parttitle\\./g, replacement: 'style=\"font-weight:bold;font-size:x-small;padding:0px 0px 3px 0px;\"'},\r\n         itembody: {regex: /\\%itembody\\./g, replacement: 'style=\"padding:12px 0px 0px 0px;vertical-align:top;font-size:small;\"'},\r\n         bodypart: {regex: /\\%bodypart\\./g, replacement: 'style=\"padding:0px 10px 0px 0px;font-size:small;vertical-align:top;\"'}\r\n         },\r\n      divStyle: \"border:1px solid black;overflow:auto;\",\r\n      html:\r\n '<div id=\"%id.scolorchooser\" style=\"display:none;position:absolute;z-index:20;\"></div>'+\r\n'<table cellspacing=\"0\" cellpadding=\"0\">'+\r\n' <tr><td style=\"vertical-align:top;\">'+\r\n'<table id=\"%id.sheetsettingstable\" style=\"display:none;\" cellspacing=\"0\" cellpadding=\"0\">'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Format!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Number!</div>'+\r\n'     <span id=\"%id.formatnumber\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Text!</div>'+\r\n'     <span id=\"%id.formattext\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Alignment!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Text Horizontal!</div>'+\r\n'     <span id=\"%id.textalignhoriz\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Number Horizontal!</div>'+\r\n'     <span id=\"%id.numberalignhoriz\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Vertical!</div>'+\r\n'     <span id=\"%id.alignvert\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Font!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Family!</div>'+\r\n'     <span id=\"%id.fontfamily\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\r\n'     <span id=\"%id.fontlook\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Size!</div>'+\r\n'     <span id=\"%id.fontsize\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Color!</div>'+\r\n'     <div id=\"%id.textcolor\"></div>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Background!</div>'+\r\n'     <div id=\"%id.bgcolor\"></div>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Padding!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Top!</div>'+\r\n'     <span id=\"%id.padtop\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Right!</div>'+\r\n'     <span id=\"%id.padright\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bottom!</div>'+\r\n'     <span id=\"%id.padbottom\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Left!</div>'+\r\n'     <span id=\"%id.padleft\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Default Column Width!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>&nbsp;</div>'+\r\n'     <span id=\"%id.colwidth\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Recalculation!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>&nbsp;</div>'+\r\n'     <span id=\"%id.recalc\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Dimensions!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Columns!</div>'+\r\n'     <span id=\"%id.usermaxcol\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Rows!</div>'+\r\n'     <span id=\"%id.usermaxrow\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'</table>'+\r\n'<table id=\"%id.cellsettingstable\" cellspacing=\"0\" cellpadding=\"0\">'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Format!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Number!</div>'+\r\n'     <span id=\"%id.cformatnumber\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Text!</div>'+\r\n'     <span id=\"%id.cformattext\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Alignment!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Horizontal!</div>'+\r\n'     <span id=\"%id.calignhoriz\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Vertical!</div>'+\r\n'     <span id=\"%id.calignvert\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Font!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Family!</div>'+\r\n'     <span id=\"%id.cfontfamily\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bold &amp; Italics!</div>'+\r\n'     <span id=\"%id.cfontlook\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Size!</div>'+\r\n'     <span id=\"%id.cfontsize\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Color!</div>'+\r\n'     <div id=\"%id.ctextcolor\"></div>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Background!</div>'+\r\n'     <div id=\"%id.cbgcolor\"></div>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Borders!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\">'+\r\n'    <tr><td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Top Border!</div></td>'+\r\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Right Border!</div></td>'+\r\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Bottom Border!</div></td>'+\r\n'     <td %bodypart. colspan=\"3\"><div %parttitle.>%loc!Left Border!</div></td>'+\r\n'    </tr><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbt-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbt-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbr-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbr-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbb-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbb-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'    <td %bodypart.>'+\r\n'     <input id=\"%id.cbl-onoff-bcb\" onclick=\"SocialCalc.SettingsControlOnchangeBorder(this);\" type=\"checkbox\">'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div id=\"%id.cbl-color\"></div>'+\r\n'    </td>'+\r\n'    <td>&nbsp;&nbsp;&nbsp;&nbsp;</td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'<tr>'+\r\n' <td %itemtitle.><br>%loc!Padding!:</td>'+\r\n' <td %itembody.>'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Top!</div>'+\r\n'     <span id=\"%id.cpadtop\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Right!</div>'+\r\n'     <span id=\"%id.cpadright\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Bottom!</div>'+\r\n'     <span id=\"%id.cpadbottom\"></span>'+\r\n'    </td>'+\r\n'    <td %bodypart.>'+\r\n'     <div %parttitle.>%loc!Left!</div>'+\r\n'     <span id=\"%id.cpadleft\"></span>'+\r\n'    </td>'+\r\n'   </tr></table>'+\r\n' </td>'+\r\n'</tr>'+\r\n'</table>'+\r\n' </td><td style=\"vertical-align:top;padding:12px 0px 0px 12px;\">'+\r\n'  <div style=\"width:100px;height:100px;overflow:hidden;border:1px solid black;background-color:#EEE;padding:6px;\">'+\r\n'   <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n'    <td id=\"sample-text\" style=\"height:100px;width:100px;\"><div>%loc!This is a<br>sample!</div><div>-1234.5</div></td>'+\r\n'   </tr></table>'+\r\n'  </div>'+\r\n' </td></tr></table>'+\r\n'<br>'\r\n      };\r\n\r\n   // Sort\r\n\r\n   this.tabnums.sort = this.tabs.length;\r\n   this.tabs.push({name: \"sort\", text: \"Sort\", html:\r\n      ' <div id=\"%id.sorttools\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '   <td style=\"vertical-align:top;padding-right:4px;width:160px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Set Cells To Sort!</div>'+\r\n      '    <select id=\"%id.sortlist\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[select range]</option><option value=\"all\">Sort All</option></select>'+\r\n      '    <input type=\"button\" value=\"%loc!OK!\" onclick=\"%s.DoCmd(this, \\'ok-setsort\\');\" style=\"font-size:x-small;\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:middle;padding-right:16px;width:100px;text-align:right;\">'+\r\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\r\n      '    <input type=\"button\" id=\"%id.sortbutton\" value=\"%loc!Sort Cells! A1:A1\" onclick=\"%s.DoCmd(this, \\'dosort\\');\" style=\"visibility:hidden;\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\r\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '     <td style=\"vertical-align:top;\">'+\r\n      '      <div style=\"%tbt.\">%loc!Major Sort!</div>'+\r\n      '      <select id=\"%id.majorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\r\n      '     </td><td>'+\r\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\r\n      '      <input type=\"radio\" name=\"majorsort\" id=\"%id.majorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\r\n      '     </td>'+\r\n      '    </tr></table>'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\r\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '     <td style=\"vertical-align:top;\">'+\r\n      '      <div style=\"%tbt.\">%loc!Minor Sort!</div>'+\r\n      '      <select id=\"%id.minorsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\r\n      '     </td><td>'+\r\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\r\n      '      <input type=\"radio\" name=\"minorsort\" id=\"%id.minorsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\r\n      '     </td>'+\r\n      '    </tr></table>'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:16px;\">'+\r\n      '    <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '     <td style=\"vertical-align:top;\">'+\r\n      '      <div style=\"%tbt.\">%loc!Last Sort!</div>'+\r\n      '      <select id=\"%id.lastsort\" size=\"1\" onfocus=\"%s.CmdGotFocus(this);\"></select>'+\r\n      '     </td><td>'+\r\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortup\" value=\"up\" checked><span style=\"font-size:x-small;color:#555753;\">%loc!Up!</span><br>'+\r\n      '      <input type=\"radio\" name=\"lastsort\" id=\"%id.lastsortdown\" value=\"down\"><span style=\"font-size:x-small;color:#555753;\">%loc!Down!</span>'+\r\n      '     </td>'+\r\n      '    </tr></table>'+\r\n      '   </td>'+\r\n      '  </tr></table>'+\r\n      ' </div>',\r\n      onclick: SocialCalc.SpreadsheetControlSortOnclick});\r\n   this.editor.SettingsCallbacks.sort = {save: SocialCalc.SpreadsheetControlSortSave, load: SocialCalc.SpreadsheetControlSortLoad};\r\n\r\n   // Audit\r\n\r\n   this.tabnums.audit = this.tabs.length;\r\n   this.tabs.push({name: \"audit\", text: \"Audit\", html:\r\n      '<div id=\"%id.audittools\" style=\"display:none;\">'+\r\n      ' <div style=\"%tbt.\">&nbsp;</div>'+\r\n      '</div>',\r\n      view: \"audit\",\r\n      onclick:\r\n         function(s, t) {\r\n            var SCLoc = SocialCalc.LocalizeString;\r\n            var i, j;\r\n            var str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"margin-bottom:10px;\"><tr><td style=\"font-size:small;padding:6px;\"><b>'+SCLoc(\"Audit Trail This Session\")+':</b><br><br>';\r\n            var stack = s.sheet.changes.stack;\r\n            var tos = s.sheet.changes.tos;\r\n            for (i=0; i<stack.length; i++) {\r\n               if (i==tos+1) str += '<br></td></tr><tr><td style=\"font-size:small;background-color:#EEE;padding:6px;\">'+SCLoc(\"UNDONE STEPS\")+':<br>';\r\n               for (j=0; j<stack[i].command.length; j++) {\r\n                  str += SocialCalc.special_chars(stack[i].command[j]) + \"<br>\";\r\n                  }\r\n               }\r\n\t\t\t// --------------------------------------------   \r\n \t\t    // eddy log {\r\n\r\n\t\t\t// --------------------------------------------   \r\n\t\t\tvar ObjToSource = function(o){\r\n\t\t\t\tif (typeof(o) == \"string\") return o;\r\n\t\t\t\tif (!o) return 'null';\r\n\t\t\t\tif (typeof(o) == \"object\") {\r\n\t\t\t\t\tif (!ObjToSource.check) ObjToSource.check = new Array();\r\n\t\t\t\t\tfor (var i=0, k=ObjToSource.check.length ; i<k ; ++i) {\r\n\t\t\t\t\t\tif (ObjToSource.check[i] == o) {return '{}';}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tObjToSource.check.push(o);\r\n\t\t\t\t}\r\n\t\t\t\tvar k=\"\",na=typeof(o.length)==\"undefined\"?1:0,str=\"\";\r\n\t\t\t\tfor(var p in o){\r\n\t\t\t\t\tif (na) k = \"'\"+p+ \"':\";\r\n\t\t\t\t\tif (typeof o[p] == \"string\") str += k + \"'\" + o[p]+\"',\";\r\n\t\t\t\t\telse if (typeof o[p] == \"object\") str += k + ObjToSource(o[p])+\",\";\r\n\t\t\t\t\telse str += k + o[p] + \",\";\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof(o) == \"object\") ObjToSource.check.pop();\r\n\t\t\t\tif (na) return \"{\"+str.slice(0,-1)+\"}\";\r\n\t\t\t\telse return \"[\"+str.slice(0,-1)+\"]\";\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// --------------------------------------------   \r\n\t\t\t\r\n\t\t    if(typeof SocialCalc.debug_log != 'undefined') {\r\n\t\t\t\tfor(var index in SocialCalc.debug_log) { \r\n\t\t\t\t\tstr += ObjToSource(SocialCalc.debug_log[index]) + \"<br>\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t    // }   \r\n\t\t\t// --------------------------------------------   \r\n\t\t\t   \r\n            s.views.audit.element.innerHTML = str+\"</td></tr></table>\";\r\n            SocialCalc.CmdGotFocus(true);\r\n            },\r\n      onclickFocus: true\r\n         });\r\n\r\n   this.views[\"audit\"] = {name: \"audit\",\r\n      divStyle: \"border:1px solid black;overflow:auto;\",\r\n      html: 'Audit Trail'\r\n      };\r\n\r\n   // Comment\r\n\r\n   this.tabnums.comment = this.tabs.length;\r\n   this.tabs.push({name: \"comment\", text: \"Comment\", html:\r\n      '<div id=\"%id.commenttools\" style=\"display:none;\">'+\r\n      '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td>'+\r\n      '<textarea id=\"%id.commenttext\" style=\"font-size:small;height:32px;width:600px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'+\r\n      '</td><td style=\"vertical-align:top;\">'+\r\n      '&nbsp;<input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlCommentSet();\" style=\"font-size:x-small;\">'+\r\n      '</td></tr></table>'+\r\n      '</div>',\r\n      view: \"sheet\",\r\n      onclick: SocialCalc.SpreadsheetControlCommentOnclick,\r\n      onunclick: SocialCalc.SpreadsheetControlCommentOnunclick\r\n      });\r\n\r\n   // Names\r\n\r\n   this.tabnums.names = this.tabs.length;\r\n   this.tabs.push({name: \"names\", text: \"Names\", html:\r\n      '<div id=\"%id.namestools\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Existing Names!</div>'+\r\n      '    <select id=\"%id.nameslist\" size=\"1\" onchange=\"%s.SpreadsheetControlNamesChangedName();\" onfocus=\"%s.CmdGotFocus(this);\"><option selected>[New]</option></select>'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Name!</div>'+\r\n      '    <input type=\"text\" id=\"%id.namesname\" style=\"font-size:x-small;width:75px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Description!</div>'+\r\n      '    <input type=\"text\" id=\"%id.namesdesc\" style=\"font-size:x-small;width:150px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Value!</div>'+\r\n      '    <input type=\"text\" id=\"%id.namesvalue\" width=\"16\" style=\"font-size:x-small;width:100px;\" onfocus=\"%s.CmdGotFocus(this);\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:12px;width:100px;\">'+\r\n      '    <div style=\"%tbt.\">%loc!Set Value To!</div>'+\r\n      '    <input type=\"button\" id=\"%id.namesrangeproposal\" value=\"A1\" onclick=\"%s.SpreadsheetControlNamesSetValue();\" style=\"font-size:x-small;\">'+\r\n      '   </td>'+\r\n      '   <td style=\"vertical-align:top;padding-right:6px;\">'+\r\n      '    <div style=\"%tbt.\">&nbsp;</div>'+\r\n      '    <input type=\"button\" value=\"%loc!Save!\" onclick=\"%s.SpreadsheetControlNamesSave();\" style=\"font-size:x-small;\">'+\r\n      '    <input type=\"button\" value=\"%loc!Delete!\" onclick=\"%s.SpreadsheetControlNamesDelete()\" style=\"font-size:x-small;\">'+\r\n      '   </td>'+\r\n      '  </tr></table>'+\r\n      '</div>',\r\n      view: \"sheet\",\r\n      onclick: SocialCalc.SpreadsheetControlNamesOnclick,\r\n      onunclick: SocialCalc.SpreadsheetControlNamesOnunclick\r\n      });\r\n\r\n   // Clipboard\r\n\r\n   this.tabnums.clipboard = this.tabs.length;\r\n   this.tabs.push({name: \"clipboard\", text: \"Clipboard\", html:\r\n      '<div id=\"%id.clipboardtools\" style=\"display:none;\">'+\r\n      '  <table cellspacing=\"0\" cellpadding=\"0\"><tr>'+\r\n      '   <td style=\"vertical-align:top;padding-right:24px;\">'+\r\n      '    <div style=\"%tbt.\">'+\r\n      '     &nbsp;'+\r\n      '    </div>'+\r\n      '   </td>'+\r\n      '  </tr></table>'+\r\n      '</div>',\r\n      view: \"clipboard\",\r\n      onclick: SocialCalc.SpreadsheetControlClipboardOnclick,\r\n      onclickFocus: \"clipboardtext\"\r\n      });\r\n\r\n   this.views[\"clipboard\"] = {name: \"clipboard\", divStyle: \"overflow:auto;\", html:\r\n      ' <div style=\"font-size:x-small;padding:5px 0px 10px 0px;\">'+\r\n      '  <b>%loc!Display Clipboard in!:</b>'+\r\n      '  <input type=\"radio\" id=\"%id.clipboardformat-tab\" name=\"%id.clipboardformat\" checked onclick=\"%s.SpreadsheetControlClipboardFormat(\\'tab\\');\"> %loc!Tab-delimited format! &nbsp;'+\r\n      '  <input type=\"radio\" id=\"%id.clipboardformat-csv\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'csv\\');\"> %loc!CSV format! &nbsp;'+\r\n      '  <input type=\"radio\" id=\"%id.clipboardformat-scsave\" name=\"%id.clipboardformat\" onclick=\"%s.SpreadsheetControlClipboardFormat(\\'scsave\\');\"> %loc!SocialCalc-save format!'+\r\n      ' </div>'+\r\n      ' <input type=\"button\" value=\"%loc!Load SocialCalc Clipboard With This!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardLoad();\">&nbsp; '+\r\n      ' <input type=\"button\" value=\"%loc!Clear SocialCalc Clipboard!\" style=\"font-size:x-small;\" onclick=\"%s.SpreadsheetControlClipboardClear();\">&nbsp; '+\r\n      ' <br>'+\r\n      ' <textarea id=\"%id.clipboardtext\" style=\"font-size:small;height:350px;width:800px;overflow:auto;\" onfocus=\"%s.CmdGotFocus(this);\"></textarea>'\r\n      };\r\n\r\n   return;\r\n\r\n   }\r\n\r\n   \r\n// Methods:\r\n\r\nSocialCalc.SpreadsheetControl.prototype.InitializeSpreadsheetControl =\r\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetControl(this, node, height, width, spacebelow);};\r\nSocialCalc.SpreadsheetControl.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\r\nSocialCalc.SpreadsheetControl.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\r\nSocialCalc.SpreadsheetControl.prototype.ExecuteCommand = \r\n   function(combostr, sstr) {return SocialCalc.SpreadsheetControlExecuteCommand(this, combostr, sstr);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateSheetHTML = \r\n   function() {return SocialCalc.SpreadsheetControlCreateSheetHTML(this);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateSpreadsheetSave = \r\n   function(otherparts) {return SocialCalc.SpreadsheetControlCreateSpreadsheetSave(this, otherparts);};\r\nSocialCalc.SpreadsheetControl.prototype.DecodeSpreadsheetSave = \r\n   function(str) {return SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(this, str);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTML = \r\n   function(coord) {return SocialCalc.SpreadsheetControlCreateCellHTML(this, coord);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateCellHTMLSave = \r\n   function(range) {return SocialCalc.SpreadsheetControlCreateCellHTMLSave(this, range);};\r\n\r\n\r\n// Sheet Methods to make things a little easier:\r\n\r\nSocialCalc.SpreadsheetControl.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\r\nSocialCalc.SpreadsheetControl.prototype.CreateSheetSave = function() {return this.sheet.CreateSheetSave();};\r\n\r\n\r\n// Functions:\r\n\r\n//\r\n// InitializeSpreadsheetControl(spreadsheet, node, height, width, spacebelow)\r\n//\r\n// Creates the control elements and makes them the child of node (string or element).\r\n// If present, height and width specify size.\r\n// If either is 0 or null (missing), the maximum that fits on the screen\r\n// (taking spacebelow into account) is used.\r\n//\r\n// Displays the tabs and creates the views (other than \"sheet\").\r\n// The first tab is set as selected, but onclick is not invoked.\r\n//\r\n// You should do a redisplay or recalc (which redisplays) after running this.\r\n//\r\n\r\nSocialCalc.InitializeSpreadsheetControl = function(spreadsheet, node, height, width, spacebelow) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\r\n\r\n   var html, child, i, vname, v, style, button, bele;\r\n   var tabs = spreadsheet.tabs;\r\n   var views = spreadsheet.views;\r\n\r\n   spreadsheet.requestedHeight = height;\r\n   spreadsheet.requestedWidth = width;\r\n   spreadsheet.requestedSpaceBelow = spacebelow;\r\n\r\n   if (typeof node == \"string\") node = document.getElementById(node);\r\n\r\n   if (node == null) {\r\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\r\n      }\r\n\r\n   spreadsheet.parentNode = node;\r\n\r\n   // create node to hold spreadsheet control\r\n\r\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\r\n\r\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\r\n\r\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\r\n      node.removeChild(child);\r\n      }\r\n\r\n   // create the tabbed UI at the top\r\n\r\n   html = '<div><div style=\"'+spreadsheet.toolbarbackground+'padding:12px 10px 10px 4px;height:40px;\">';\r\n\r\n   for (i=0; i<tabs.length; i++) {\r\n      html += tabs[i].html;\r\n      }\r\n\r\n   html += '</div>'+\r\n      '<div style=\"'+spreadsheet.tabbackground+'margin:0px 0px 8px 0px;\">'+\r\n      '<table cellpadding=\"0\" cellspacing=\"0\"><tr>';\r\n\r\n   for (i=0; i<tabs.length; i++) {\r\n      html += '  <td id=\"%id.' + tabs[i].name + 'tab\" style=\"' +\r\n         (i==0 ? spreadsheet.tabselectedCSS : spreadsheet.tabplainCSS) +\r\n         '\" onclick=\"%s.SetTab(this);\">' + SCLoc(tabs[i].text) + '</td>';\r\n      }\r\n\r\n   html += ' </tr></table></div></div>';\r\n\r\n   spreadsheet.currentTab = 0; // this is where we started\r\n\r\n   for (style in spreadsheet.tabreplacements) {\r\n      html = html.replace(spreadsheet.tabreplacements[style].regex, spreadsheet.tabreplacements[style].replacement);\r\n      }\r\n   html = html.replace(/\\%s\\./g, \"SocialCalc.\");\r\n   html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\r\n   html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\r\n   html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\r\n\r\n   html = SCLocSS(html); // localize with %loc!string! and %scc!constant!\r\n\r\n   spreadsheet.spreadsheetDiv.innerHTML = html;\r\n\r\n   node.appendChild(spreadsheet.spreadsheetDiv);\r\n\r\n   // Initialize SocialCalc buttons\r\n\r\nspreadsheet.Buttons = {\r\n   button_undo: {tooltip: \"Undo\", command: \"undo\"},\r\n   button_redo: {tooltip: \"Redo\", command: \"redo\"},\r\n   button_copy: {tooltip: \"Copy\", command: \"copy\"},\r\n   button_cut: {tooltip: \"Cut\", command: \"cut\"},\r\n   button_paste: {tooltip: \"Paste\", command: \"paste\"},\r\n   button_pasteformats: {tooltip: \"Paste Formats\", command: \"pasteformats\"},\r\n   button_lock: {tooltip: \"Lock Cell\", command: \"lock\"},\r\n   button_unlock: {tooltip: \"Unlock Cell\", command: \"unlock\"},\r\n   button_delete: {tooltip: \"Delete Cell Contents\", command: \"delete\"},\r\n   button_filldown: {tooltip: \"Fill Down\", command: \"filldown\"},\r\n   button_fillright: {tooltip: \"Fill Right\", command: \"fillright\"},\r\n   button_movefrom: {tooltip: \"Set/Clear Move From\", command: \"movefrom\"},\r\n   button_movepaste: {tooltip: \"Move Paste\", command: \"movepaste\"},\r\n   button_moveinsert: {tooltip: \"Move Insert\", command: \"moveinsert\"},\r\n   button_alignleft: {tooltip: \"Align Left\", command: \"align-left\"},\r\n   button_aligncenter: {tooltip: \"Align Center\", command: \"align-center\"},\r\n   button_alignright: {tooltip: \"Align Right\", command: \"align-right\"},\r\n   button_borderon: {tooltip: \"Borders On\", command: \"borderon\"},\r\n   button_borderoff: {tooltip: \"Borders Off\", command: \"borderoff\"},\r\n   button_swapcolors: {tooltip: \"Swap Colors\", command: \"swapcolors\"},\r\n   button_merge: {tooltip: \"Merge/Unmerge Cells\", command: \"merge\"},\r\n   button_insertrow: {tooltip: \"Insert Row Before\", command: \"insertrow\"},\r\n   button_insertcol: {tooltip: \"Insert Column Before\", command: \"insertcol\"},\r\n   button_deleterow: {tooltip: \"Delete Row\", command: \"deleterow\"},\r\n   button_deletecol: {tooltip: \"Delete Column\", command: \"deletecol\"},\r\n   button_hiderow: {tooltip: \"Hide Row\", command: \"hiderow\"},\r\n   button_hidecol: {tooltip: \"Hide Column\", command: \"hidecol\"},\r\n   button_recalc: {tooltip: \"Recalculate\", command: \"recalc\"}\r\n   }\r\n\r\n   for (button in spreadsheet.Buttons) {\r\n      bele = document.getElementById(spreadsheet.idPrefix+button);\r\n      if (!bele) {alert(\"Button \"+(spreadsheet.idPrefix+button)+\" missing\"); continue;}\r\n      bele.style.border = \"1px solid \"+scc.ISCButtonBorderNormal;\r\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.Buttons[button].tooltip), {}, spreadsheet.spreadsheetDiv);\r\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\r\n         {normalstyle: \"border:1px solid \"+scc.ISCButtonBorderNormal+\";backgroundColor:\"+scc.ISCButtonBorderNormal+\";\",\r\n          hoverstyle: \"border:1px solid \"+scc.ISCButtonBorderHover+\";backgroundColor:\"+scc.ISCButtonBorderNormal+\";\",\r\n          downstyle: \"border:1px solid \"+scc.ISCButtonBorderDown+\";backgroundColor:\"+scc.ISCButtonDownBackground+\";\"}, \r\n         {MouseDown: SocialCalc.DoButtonCmd, command: spreadsheet.Buttons[button].command});\r\n      }\r\n\r\n   // create formula bar\r\n\r\n   spreadsheet.formulabarDiv = document.createElement(\"div\");\r\n   spreadsheet.formulabarDiv.style.height = spreadsheet.formulabarheight + \"px\";\r\n   spreadsheet.formulabarDiv.innerHTML = '<input type=\"text\" size=\"60\" value=\"\">&nbsp;'; //'<textarea rows=\"4\" cols=\"60\" style=\"z-index:5;background-color:white;position:relative;\"></textarea>&nbsp;';\r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.formulabarDiv);\r\n   var inputbox = new SocialCalc.InputBox(spreadsheet.formulabarDiv.firstChild, spreadsheet.editor);\r\n   \r\n   for (button in spreadsheet.formulabuttons) {\r\n      bele = document.createElement(\"img\");\r\n      bele.id = spreadsheet.idPrefix+button;\r\n      bele.src = (spreadsheet.formulabuttons[button].skipImagePrefix ? \"\" : spreadsheet.imagePrefix)+spreadsheet.formulabuttons[button].image;\r\n      bele.style.verticalAlign = \"middle\";\r\n      bele.style.border = \"1px solid #FFF\";\r\n      bele.style.marginLeft = \"4px\";\r\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.formulabuttons[button].tooltip), {}, spreadsheet.spreadsheetDiv);\r\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\r\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\r\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\r\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \r\n         {MouseDown: spreadsheet.formulabuttons[button].command, Disabled: function() {return spreadsheet.editor.ECellReadonly();}});\r\n   spreadsheet.formulabarDiv.appendChild(bele);\r\n   }\r\n\r\n   var input = $(\"<input id='searchbarinput' value='' placeholder='Search sheet…'>\");\r\n   var searchBar = $(\"<span id='searchbar'></span>\");\r\n   searchBar.append(\"<div id='searchstatus'></div>\");\r\n   searchBar.append(input);\r\n\r\n   // find buttons (right of formula bar)\r\n   for (button in spreadsheet.findbuttons) {\r\n      bele = document.createElement(\"img\");\r\n      bele.id = spreadsheet.idPrefix+button;\r\n      bele.src = (spreadsheet.imagePrefix)+spreadsheet.findbuttons[button].image;\r\n      bele.style.verticalAlign = \"middle\";\r\n      bele.style.border = \"1px solid #FFF\";\r\n      SocialCalc.TooltipRegister(bele, SCLoc(spreadsheet.findbuttons[button].tooltip), {}, spreadsheet.formulabardiv);\r\n      SocialCalc.ButtonRegister(spreadsheet.editor, bele,\r\n         {normalstyle: \"border:1px solid #FFF;backgroundColor:#FFF;\",\r\n          hoverstyle: \"border:1px solid #CCC;backgroundColor:#FFF;\",\r\n          downstyle: \"border:1px solid #000;backgroundColor:#FFF;\"}, \r\n         {MouseDown: spreadsheet.findbuttons[button].command, Disabled: function() {return false;}});\r\n      searchBar[0].appendChild(bele);\r\n   } \r\n   input.on('input', SocialCalc.SpreadsheetControl.FindInSheet);\r\n   input.on('focus', function() {\r\n        SocialCalc.Keyboard.passThru = true;\r\n   });\r\n   input.on('blur', function() {\r\n        SocialCalc.Keyboard.passThru = false;\r\n   });\r\n   input.keyup(function (e) {\r\n        if (e.keyCode == 13) {\r\n           // search down when enter is pressed\r\n           if (e.shiftKey) {\r\n               SocialCalc.SpreadsheetControl.SearchUp();\r\n           } else {\r\n               SocialCalc.SpreadsheetControl.SearchDown();\r\n           }\r\n        }\r\n   });\r\n   spreadsheet.formulabarDiv.appendChild(searchBar[0]);\r\n   \r\n   // initialize tabs that need it\r\n\r\n   for (i=0; i<tabs.length; i++) { // execute any tab-specific initialization code\r\n      if (tabs[i].oncreate) {\r\n         tabs[i].oncreate(spreadsheet, tabs[i].name);\r\n         }\r\n      }\r\n\r\n   // create sheet view and others\r\n\r\n   // InitializeSpreadsheetControl eddy {\r\n   SocialCalc.CalculateSheetNonViewHeight(spreadsheet);\r\n   // } InitializeSpreadsheetControl\r\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\r\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\r\n\r\n// eddy test add input \r\n   var appViewDiv = document.createElement(\"div\");\r\n   appViewDiv.id = \"te_appView\";\r\n   \r\n   appViewDiv.appendChild(spreadsheet.editorDiv)\r\n   spreadsheet.editorDiv = appViewDiv;\r\n\r\n   var formDataDiv = document.createElement(\"div\");\r\n   formDataDiv.id = \"te_formData\";\r\n   //formDataDiv.style.visibility = \"hidden\";\r\n   formDataDiv.style.display = \"none\";\r\n   //formDataDiv.style.display = \"inline\";\r\n   \r\n  // spreadsheet.spreadsheetDiv.appendChild(formDataDiv);   \r\n   spreadsheet.editorDiv.appendChild(formDataDiv);\r\n       \r\n// }\r\n      \r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\r\n\r\n// form data sheet - all input formulas set values in this sheet as well as the loaded sheet\r\n   spreadsheet.formDataViewer = new SocialCalc.SpreadsheetViewer(\"te_FormData-\"); // should end with -\r\n   spreadsheet.formDataViewer.InitializeSpreadsheetViewer(formDataDiv.id, 180, 0, 200);\r\n   spreadsheet.formDataViewer.editor.ignoreRender = true; // formDataViewer is used for ExecuteSheetCommand only - no need to render\r\n// end\r\n   \r\n   for (vname in views) {\r\n      html = views[vname].html;\r\n      for (style in views[vname].replacements) {\r\n         html = html.replace(views[vname].replacements[style].regex, views[vname].replacements[style].replacement);\r\n         }\r\n      html = html.replace(/\\%s\\./g, \"SocialCalc.\");\r\n      html = html.replace(/\\%id\\./g, spreadsheet.idPrefix);\r\n      html = html.replace(/\\%tbt\\./g, spreadsheet.toolbartext);\r\n      html = html.replace(/\\%img\\./g, spreadsheet.imagePrefix);\r\n      v = document.createElement(\"div\");\r\n      SocialCalc.setStyles(v, views[vname].divStyle);\r\n      v.style.display = \"none\";\r\n      v.style.width = spreadsheet.width + \"px\";\r\n      v.style.height = spreadsheet.viewheight + \"px\";\r\n      v.id = spreadsheet.idPrefix + views[vname].name + \"view\";\r\n\r\n      html = SCLocSS(html); // localize with %loc!string!, etc.\r\n\r\n      v.innerHTML = html;\r\n      spreadsheet.spreadsheetDiv.appendChild(v);\r\n      views[vname].element = v;\r\n      if (views[vname].oncreate) {\r\n         views[vname].oncreate(spreadsheet, views[vname]);\r\n         }\r\n      }\r\n\r\n   views.sheet = {name: \"sheet\", element: spreadsheet.editorDiv};\r\n\r\n   // create statusline\r\n\r\n   spreadsheet.statuslineDiv = document.createElement(\"div\");\r\n   spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\r\n   spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\r\n      (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\r\n      (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\r\n   spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\r\n\r\n   // set current control object based on mouseover\r\n\r\n   if (spreadsheet.spreadsheetDiv.addEventListener) { // DOM Level 2 -- Firefox, et al\r\n      spreadsheet.spreadsheetDiv.addEventListener(\"mousedown\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); }, false);\r\n      spreadsheet.spreadsheetDiv.addEventListener(\"mouseover\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); }, false);\r\n      }\r\n   else if (spreadsheet.spreadsheetDiv.attachEvent) { // IE 5+\r\n      spreadsheet.spreadsheetDiv.attachEvent(\"onmousedown\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); });\r\n      spreadsheet.spreadsheetDiv.attachEvent(\"onmouseover\", function() { SocialCalc.SetSpreadsheetControlObject(spreadsheet); });\r\n      }\r\n   else { // don't handle this\r\n      throw SocialCalc.Constants.s_BrowserNotSupported;\r\n      }\r\n\r\n   // done - refresh screen needed\r\n\r\n   return;\r\n\r\n   }\r\n\r\n\r\n// eddy CalculateSheetNonViewHeight {\r\nSocialCalc.CalculateSheetNonViewHeight = function(spreadsheet) {\r\n  spreadsheet.nonviewheight = spreadsheet.statuslineheight;\r\n  for(var nodeIndex = 0;  nodeIndex < spreadsheet.spreadsheetDiv.childNodes.length;  nodeIndex++ ) {\r\n    if(spreadsheet.spreadsheetDiv.childNodes[nodeIndex].id == \"SocialCalc-statusline\") continue;\r\n    spreadsheet.nonviewheight += spreadsheet.spreadsheetDiv.childNodes[nodeIndex].offsetHeight;\r\n  }\r\n  \r\n}\r\n\r\n// }\r\n\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeString(str)\r\n//\r\n// SocialCalc function to make localization easier.\r\n// If str is \"Text to localize\", it returns\r\n// SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n//\r\n\r\nSocialCalc.LocalizeString = function(str) {\r\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\r\n   if (!cstr) { // no - look up\r\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\r\n      SocialCalc.LocalizeStringList[str] = cstr;\r\n      }\r\n   return cstr;\r\n   }\r\n\r\n\r\n\r\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeSubstrings(str)\r\n//\r\n// SocialCalc function to make localization easier using %loc and %scc.\r\n//\r\n// Replaces sections of str with:\r\n//    %loc!Text to localize!\r\n// with SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n// Uses SocialCalc.LocalizeString for this.\r\n//\r\n// Replaces sections of str with:\r\n//    %ssc!constant-name!\r\n// with SocialCalc.Constants.constant-name.\r\n// If the constant doesn't exist, throws and alert.\r\n//\r\n\r\nSocialCalc.LocalizeSubstrings = function(str) {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\r\n      if (t==\"ssc\") {\r\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\r\n         }\r\n      else {\r\n         return SCLoc(c);\r\n         }\r\n      });\r\n\r\n   }\r\n\r\n//\r\n// obj = GetSpreadsheetControlObject()\r\n//\r\n// Returns the current spreadsheet control object\r\n//\r\n\r\nSocialCalc.GetSpreadsheetControlObject = function() {\r\n\r\n  // if in viewer mode return CurrentSpreadsheetViewerObject because CurrentSpreadsheetControlObject is null (bug fix) \r\n   var csco = (SocialCalc.CurrentSpreadsheetControlObject != null) \r\n   ? SocialCalc.CurrentSpreadsheetControlObject : SocialCalc.CurrentSpreadsheetViewerObject;\r\n   if (csco) return csco;\r\n\r\n//   throw (\"No current SpreadsheetControl object.\");\r\n\r\n   }\r\n\r\n//\r\n// SetSpreadsheetControlObject(spreadsheet)\r\n//\r\n\r\nSocialCalc.SetSpreadsheetControlObject = function(spreadsheet) {\r\n\r\n   SocialCalc.CurrentSpreadsheetControlObject = spreadsheet;\r\n\r\n   if (SocialCalc.Keyboard.focusTable && spreadsheet) {\r\n      SocialCalc.Keyboard.focusTable = spreadsheet.editor;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.DoOnResize(spreadsheet)\r\n//\r\n// Processes an onResize event, setting the different views.\r\n//\r\n\r\nSocialCalc.DoOnResize = function(spreadsheet) {\r\n\r\n   var v;\r\n   var views = spreadsheet.views;\r\n\r\n   var needresize = spreadsheet.SizeSSDiv();\r\n   if (!needresize) return;\r\n\r\n   for (vname in views) {\r\n      v = views[vname].element;\r\n      v.style.width = spreadsheet.width + \"px\";\r\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\r\n      }\r\n\r\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\r\n\r\n   }\r\n\r\n\r\n//\r\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\r\n//\r\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\r\n// Sets ssdiv to that.\r\n// Return true if different than existing values.\r\n//\r\n\r\nSocialCalc.SizeSSDiv = function(spreadsheet) {\r\n\r\n   var sizes, pos, resized, nodestyle, newval;\r\n   var fudgefactorX = 10; // for IE\r\n   var fudgefactorY = 10;\r\n\r\n   resized = false;\r\n\r\n   sizes = SocialCalc.GetViewportInfo();\r\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\r\n   pos.bottom = 0;\r\n   pos.right = 0;\r\n\r\n   nodestyle = spreadsheet.parentNode.style;\r\n\r\n   if (nodestyle.marginTop) {\r\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginBottom) {\r\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginLeft) {\r\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginRight) {\r\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\r\n      }\r\n\r\n   newval = spreadsheet.requestedHeight ||\r\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\r\n               (spreadsheet.requestedSpaceBelow || 0);\r\n   if (spreadsheet.height != newval) {\r\n      spreadsheet.height = newval;\r\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\r\n      resized = true;\r\n      }\r\n   newval = spreadsheet.requestedWidth ||\r\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\r\n   if (spreadsheet.width != newval) {\r\n      spreadsheet.width = newval;\r\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\r\n      resized = true;\r\n      }\r\n\r\n   spreadsheet.spreadsheetDiv.style.position = \"relative\";\r\n\r\n   return resized;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SetTab(obj)\r\n//\r\n// The obj argument is either a string with the tab name or a DOM element with an ID\r\n//\r\n\r\nSocialCalc.SetTab = function(obj) {\r\n\r\n   var newtab, tname, newtabnum, newview, i, vname, ele;\r\n   var menutabs = {};\r\n   var tools = {};\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var tabs = spreadsheet.tabs;\r\n   var views = spreadsheet.views;\r\n\r\n   if (typeof obj == \"string\") {\r\n      newtab = obj;\r\n      }\r\n   else {\r\n      newtab = obj.id.slice(spreadsheet.idPrefix.length,-3);\r\n      }\r\n\r\n   if (spreadsheet.editor.busy && // if busy and switching from \"sheet\", ignore\r\n         (!tabs[spreadsheet.currentTab].view || tabs[spreadsheet.currentTab].view==\"sheet\")) {\r\n      for (i=0; i<tabs.length; i++) {\r\n         if(tabs[i].name==newtab && (tabs[i].view && tabs[i].view!=\"sheet\")) {\r\n            return;\r\n            }\r\n         }\r\n      }\r\n\r\n   if (spreadsheet.tabs[spreadsheet.currentTab].onunclick) {\r\n      spreadsheet.tabs[spreadsheet.currentTab].onunclick(spreadsheet, spreadsheet.tabs[spreadsheet.currentTab].name);\r\n      }\r\n\r\n   for (i=0; i<tabs.length; i++) {\r\n      tname = tabs[i].name;\r\n      menutabs[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tab\");\r\n      tools[tname] = document.getElementById(spreadsheet.idPrefix+tname+\"tools\");\r\n      if (tname==newtab) {\r\n         newtabnum = i;\r\n         tools[tname].style.display = \"block\";\r\n         menutabs[tname].style.cssText = spreadsheet.tabselectedCSS;\r\n         }\r\n      else {\r\n         tools[tname].style.display = \"none\";\r\n         menutabs[tname].style.cssText = spreadsheet.tabplainCSS;\r\n         }\r\n      }\r\n\r\n   spreadsheet.currentTab = newtabnum;\r\n\r\n   if (tabs[newtabnum].onclick) {\r\n      tabs[newtabnum].onclick(spreadsheet, newtab);\r\n      }\r\n\r\n   for (vname in views) {\r\n      if ((!tabs[newtabnum].view && vname == \"sheet\") || tabs[newtabnum].view == vname) {\r\n         views[vname].element.style.display = \"block\";\r\n         newview = vname;\r\n         }\r\n      else {\r\n         views[vname].element.style.display = \"none\";\r\n         }\r\n      }\r\n\r\n   if (tabs[newtabnum].onclickFocus) {\r\n      ele = tabs[newtabnum].onclickFocus;\r\n      if (typeof ele == \"string\") {\r\n         ele = document.getElementById(spreadsheet.idPrefix+ele);\r\n         ele.focus();\r\n         }\r\n      SocialCalc.CmdGotFocus(ele);\r\n      }\r\n   else {\r\n      SocialCalc.KeyboardFocus();\r\n      }\r\n\r\n   if (views[newview].needsresize && views[newview].onresize) {\r\n      views[newview].needsresize = false;\r\n      views[newview].onresize(spreadsheet, views[newview]);\r\n      }\r\n\r\n   if (newview == \"sheet\") {\r\n      spreadsheet.statuslineDiv.style.display = \"block\";\r\n      spreadsheet.editor.ScheduleRender();\r\n      }\r\n   else {\r\n      spreadsheet.statuslineDiv.style.display = \"none\";\r\n      }\r\n\r\n   return;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SpreadsheetControlStatuslineCallback\r\n//\r\n\r\nSocialCalc.SpreadsheetControlStatuslineCallback = function(editor, status, arg, params) {\r\n\r\n   var rele1, rele2;\r\n\r\n   var ele = document.getElementById(params.statuslineid);\r\n\r\n   if (ele) {\r\n      ele.innerHTML = editor.GetStatuslineString(status, arg, params);\r\n      }\r\n\r\n   switch (status) {\r\n      case \"cmdendnorender\":\r\n      case \"calcfinished\":\r\n      case \"doneposcalc\":\r\n         rele1 = document.getElementById(params.recalcid1);\r\n         rele2 = document.getElementById(params.recalcid2);\r\n         if (!rele1 || !rele2) break;\r\n         if (editor.context.sheetobj.attribs.needsrecalc==\"yes\") {\r\n            rele1.style.display = \"inline\";\r\n            rele2.style.display = \"inline\";\r\n            }\r\n         else {\r\n            rele1.style.display = \"none\";\r\n            rele2.style.display = \"none\";\r\n            }\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.UpdateSortRangeProposal(editor)\r\n//\r\n// Updates sort range proposed in the UI in element idPrefix+sortlist\r\n//\r\n\r\nSocialCalc.UpdateSortRangeProposal = function(editor) {\r\n\r\n   var ele = document.getElementById(SocialCalc.GetSpreadsheetControlObject().idPrefix+\"sortlist\");\r\n   if (editor.range.hasrange) {\r\n      ele.options[0].text = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      }\r\n   else {\r\n      ele.options[0].text = SocialCalc.LocalizeString(\"[select range]\");\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.LoadColumnChoosers(spreadsheet)\r\n//\r\n// Updates list of columns for choosing which to sort for Major, Minor, and Last sort\r\n//\r\n\r\nSocialCalc.LoadColumnChoosers = function(spreadsheet) {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   var sortrange, nrange, rparts, col, colname, sele, oldindex;\r\n\r\n   if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\r\n      nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\r\n      if (nrange.type == \"range\") {\r\n         rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\r\n         sortrange = rparts[1] + \":\" + rparts[2];\r\n         }\r\n      else {\r\n         sortrange = \"A1:A1\";\r\n         }\r\n      }\r\n   else {\r\n      sortrange = spreadsheet.sortrange;\r\n      }\r\n   var range = SocialCalc.ParseRange(sortrange);\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n   oldindex = sele.selectedIndex;\r\n   sele.options.length = 0;\r\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\r\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\r\n      colname = SocialCalc.rcColname(col);\r\n      sele.options[sele.options.length] = new Option(SCLoc(\"Column \")+colname, colname);\r\n      }\r\n   sele.selectedIndex = oldindex > 1 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 1; // restore what was there if reasonable\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n   oldindex = sele.selectedIndex;\r\n   sele.options.length = 0;\r\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\r\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\r\n      colname = SocialCalc.rcColname(col);\r\n      sele.options[sele.options.length] = new Option(colname, colname);\r\n      }\r\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n   oldindex = sele.selectedIndex;\r\n   sele.options.length = 0;\r\n   sele.options[sele.options.length] = new Option(SCLoc(\"[None]\"), \"\");\r\n   for (var col=range.cr1.col; col<=range.cr2.col; col++) {\r\n      colname = SocialCalc.rcColname(col);\r\n      sele.options[sele.options.length] = new Option(colname, colname);\r\n      }\r\n   sele.selectedIndex = oldindex > 0 && oldindex <= (range.cr2.col-range.cr1.col+1) ? oldindex : 0; // default to [none]\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.CmdGotFocus(obj)\r\n//\r\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\r\n//\r\n\r\nSocialCalc.CmdGotFocus = function(obj) {\r\n\r\n   SocialCalc.Keyboard.passThru = obj;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.DoButtonCmd(e, buttoninfo, bobj)\r\n//\r\n\r\nSocialCalc.DoButtonCmd = function(e, buttoninfo, bobj) {\r\n\r\n   SocialCalc.DoCmd(bobj.element, bobj.functionobj.command);\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.DoCmd(obj, which)\r\n//\r\n// xxx\r\n//\r\n\r\nSocialCalc.DoCmd = function(obj, which) {\r\n\r\n   var combostr, sstr, cl, i, clele, slist, slistele, str, sele, rele, lele, ele, sortrange, nrange, rparts;\r\n   var sheet, cell, color, bgcolor, defaultcolor, defaultbgcolor;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   switch (which) {\r\n      case \"undo\":\r\n         spreadsheet.ExecuteCommand(\"undo\", \"\");\r\n         break;\r\n\r\n      case \"redo\":\r\n         spreadsheet.ExecuteCommand(\"redo\", \"\");\r\n         break;\r\n\r\n      case \"fill-rowcolstuff\":\r\n      case \"fill-text\":\r\n         cl = which.substring(5);\r\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\r\n         clele.length = 0;\r\n         for (i=0; i<SocialCalc.SpreadsheetCmdTable[cl].length; i++) {\r\n            clele.options[i] = new Option(SocialCalc.SpreadsheetCmdTable[cl][i].t);\r\n            }\r\n         which = \"changed-\"+cl; // fall through to changed code\r\n\r\n      case \"changed-rowcolstuff\":\r\n      case \"changed-text\":\r\n         cl = which.substring(8);\r\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\r\n         slist = SocialCalc.SpreadsheetCmdTable.slists[SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].s]; // get sList for this command\r\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\r\n         slistele.length = 0; // reset\r\n         for (i=0; i<(slist.length||0); i++) {\r\n            slistele.options[i] = new Option(slist[i].t, slist[i].s);\r\n            }\r\n         return; // nothing else to do\r\n\r\n      case \"ok-rowcolstuff\":\r\n      case \"ok-text\":\r\n         cl = which.substring(3);\r\n         clele = document.getElementById(spreadsheet.idPrefix+cl+\"list\");\r\n         slistele = document.getElementById(spreadsheet.idPrefix+cl+\"slist\");\r\n         combostr = SocialCalc.SpreadsheetCmdTable[cl][clele.selectedIndex].c;\r\n         sstr = slistele[slistele.selectedIndex].value;\r\n         SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr);\r\n         break;\r\n\r\n      case \"ok-setsort\":\r\n         lele = document.getElementById(spreadsheet.idPrefix+\"sortlist\");\r\n         if (lele.selectedIndex==0) {\r\n            if (editor.range.hasrange) {\r\n               spreadsheet.sortrange = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n                          SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n               }\r\n            else {\r\n               spreadsheet.sortrange = editor.ecell.coord+\":\"+editor.ecell.coord;\r\n               }\r\n            }\r\n         else {\r\n            var val = lele.options[lele.selectedIndex].value;\r\n            if (val == 'all') {\r\n                var cells = spreadsheet.sheet.cells; \r\n                var min_col = -1, max_col = -1, min_row = -1, max_row = -1;\r\n                for (var cell_id in cells) {\r\n                    var cr = SocialCalc.coordToCr(cell_id);\r\n                    if (min_row == -1 || cr.row < min_row) {\r\n                        min_row = cr.row;\r\n                    }\r\n                    if (min_col == -1 || cr.col < min_col) {\r\n                        min_col = cr.col;\r\n                    }\r\n                    if (max_row == -1 || cr.row > max_row) {\r\n                        max_row = cr.row;\r\n                    }\r\n                    if (max_col == -1 || cr.col > max_col) {\r\n                        max_col = cr.col;\r\n                    }\r\n                } \r\n                spreadsheet.sortrange = SocialCalc.crToCoord(min_col, min_row) + \":\" + SocialCalc.crToCoord(max_col, max_row); \r\n                lele.options[lele.selectedIndex].text += \" (\" + spreadsheet.sortrange + \")\";\r\n            } else { \r\n                spreadsheet.sortrange = lele.options[lele.selectedIndex].value;\r\n            }\r\n         }\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\r\n         ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\r\n         ele.style.visibility = \"visible\";\r\n         SocialCalc.LoadColumnChoosers(spreadsheet);\r\n         if (obj && obj.blur) obj.blur();\r\n         SocialCalc.KeyboardFocus();   \r\n         return;\r\n\r\n      case \"dosort\":\r\n         if (spreadsheet.sortrange && spreadsheet.sortrange.indexOf(\":\")==-1) { // sortrange is a named range\r\n            nrange = SocialCalc.Formula.LookupName(spreadsheet.sheet, spreadsheet.sortrange || \"\");\r\n            if (nrange.type != \"range\") return;\r\n            rparts = nrange.value.match(/^(.*)\\|(.*)\\|$/);\r\n            sortrange = rparts[1] + \":\" + rparts[2];\r\n            }\r\n         else {\r\n            sortrange = spreadsheet.sortrange;\r\n            }\r\n         if (sortrange == \"A1:A1\") return;\r\n         str = \"sort \"+sortrange+\" \";\r\n         sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n         rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\r\n         str += sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\r\n         sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n         if (sele.selectedIndex>0) {\r\n           rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\r\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\r\n           }\r\n         sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n         if (sele.selectedIndex>0) {\r\n           rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\r\n           str += \" \"+sele.options[sele.selectedIndex].value + (rele.checked ? \" up\" : \" down\");\r\n           }\r\n         spreadsheet.ExecuteCommand(str, \"\");\r\n         break;\r\n\r\n      case \"merge\":\r\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\r\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\r\n         spreadsheet.ExecuteCommand(combostr, sstr);\r\n         if (editor.range.hasrange) { // set ecell to upper left\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\r\n            editor.RangeRemove();\r\n            }\r\n         break;\r\n\r\n      case \"movefrom\":\r\n         if (editor.range2.hasrange) { // toggle if already there\r\n            spreadsheet.context.cursorsuffix = \"\";\r\n            editor.Range2Remove();\r\n            spreadsheet.ExecuteCommand(\"redisplay\", \"\");\r\n            }\r\n         else if (editor.range.hasrange) { // set range2 to range or one cell\r\n            editor.range2.top = editor.range.top;\r\n            editor.range2.right = editor.range.right;\r\n            editor.range2.bottom = editor.range.bottom;\r\n            editor.range2.left = editor.range.left;\r\n            editor.range2.hasrange = true;\r\n            editor.MoveECell(SocialCalc.crToCoord(editor.range.left, editor.range.top));\r\n            }\r\n         else {\r\n            editor.range2.top = editor.ecell.row;\r\n            editor.range2.right = editor.ecell.col;\r\n            editor.range2.bottom = editor.ecell.row;\r\n            editor.range2.left = editor.ecell.col;\r\n            editor.range2.hasrange = true;\r\n            }\r\n         str = editor.range2.hasrange ? \"\" : \"off\";\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\r\n         ele.src=spreadsheet.imagePrefix+\"movefrom\"+str+\".gif\";\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\r\n         ele.src=spreadsheet.imagePrefix+\"movepaste\"+str+\".gif\";\r\n         ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\r\n         ele.src=spreadsheet.imagePrefix+\"moveinsert\"+str+\".gif\";\r\n         if (editor.range2.hasrange) editor.RangeRemove();\r\n         break;\r\n\r\n      case \"movepaste\":\r\n      case \"moveinsert\":\r\n         if (editor.range2.hasrange) {\r\n            spreadsheet.context.cursorsuffix = \"\";\r\n            combostr = which+\" \"+\r\n               SocialCalc.crToCoord(editor.range2.left, editor.range2.top) + \":\" +\r\n               SocialCalc.crToCoord(editor.range2.right, editor.range2.bottom)\r\n               +\" \"+editor.ecell.coord;\r\n            spreadsheet.ExecuteCommand(combostr, \"\");\r\n            editor.Range2Remove();\r\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movefrom\");\r\n            ele.src=spreadsheet.imagePrefix+\"movefromoff.gif\";\r\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_movepaste\");\r\n            ele.src=spreadsheet.imagePrefix+\"movepasteoff.gif\";\r\n            ele = document.getElementById(spreadsheet.idPrefix+\"button_moveinsert\");\r\n            ele.src=spreadsheet.imagePrefix+\"moveinsertoff.gif\";\r\n            }\r\n         break;\r\n\r\n      case \"swapcolors\":\r\n         sheet = spreadsheet.sheet;\r\n         cell = sheet.GetAssuredCell(editor.ecell.coord);\r\n         defaultcolor = sheet.attribs.defaultcolor ? sheet.colors[sheet.attribs.defaultcolor] : \"rgb(0,0,0)\";\r\n         defaultbgcolor = sheet.attribs.defaultbgcolor ? sheet.colors[sheet.attribs.defaultbgcolor] : \"rgb(255,255,255)\";\r\n         color = cell.color ? sheet.colors[cell.color] : defaultcolor; // get color\r\n         if (color == defaultbgcolor) color = \"\"; // going to swap, so if same as background default, use default\r\n         bgcolor = cell.bgcolor ? sheet.colors[cell.bgcolor] : defaultbgcolor;\r\n         if (bgcolor == defaultcolor) bgcolor = \"\"; // going to swap, so if same as foreground default, use default\r\n         spreadsheet.ExecuteCommand(\"set %C color \"+bgcolor+\"%Nset %C bgcolor \"+color, \"\");\r\n         break;\r\n\r\n      default:\r\n         combostr = SocialCalc.SpreadsheetCmdLookup[which] || \"\";\r\n         sstr = SocialCalc.SpreadsheetCmdSLookup[which] || \"\";\r\n         spreadsheet.ExecuteCommand(combostr, sstr);\r\n         break;\r\n      }\r\n\r\n   if (obj && obj.blur) obj.blur();\r\n   SocialCalc.KeyboardFocus();   \r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetCmdLookup = {\r\n 'copy': 'copy %C all',\r\n 'cut': 'cut %C all',\r\n 'paste': 'paste %C all',\r\n 'pasteformats': 'paste %C formats',\r\n 'lock': 'set %C readonly yes',\r\n 'unlock': 'set %C readonly no',\r\n 'delete': 'erase %C formulas',\r\n 'filldown': 'filldown %C all',\r\n 'fillright': 'fillright %C all',\r\n 'erase': 'erase %C all',\r\n 'borderon': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\r\n 'borderoff': 'set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S',\r\n 'merge': 'merge %C',\r\n 'unmerge': 'unmerge %C',\r\n 'align-left': 'set %C cellformat left',\r\n 'align-center': 'set %C cellformat center',\r\n 'align-right': 'set %C cellformat right',\r\n 'align-default': 'set %C cellformat',\r\n 'insertrow': 'insertrow %C',\r\n 'insertcol': 'insertcol %C',\r\n 'deleterow': 'deleterow %C',\r\n 'deletecol': 'deletecol %C',\r\n 'hiderow': 'set %H hide yes',\r\n 'hidecol': 'set %W hide yes',\r\n 'undo': 'undo',\r\n 'redo': 'redo',\r\n 'recalc': 'recalc'\r\n }\r\n\r\nSocialCalc.SpreadsheetCmdSLookup = {\r\n 'borderon': '1px solid rgb(0,0,0)',\r\n 'borderoff': ''\r\n }\r\n\r\n/******* NO LONGER USED\r\n\r\nSocialCalc.SpreadsheetCmdTable = {\r\n cmd: [\r\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\r\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"},\r\n  {t:\"Copy\", s:\"all\", c:\"copy %C %S\"},\r\n  {t:\"Cut\", s:\"all\", c:\"cut %C %S\"},\r\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\r\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\r\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\r\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\r\n  {t:\"Merge Cells\", s:\"none\", c:\"merge %C\"},\r\n  {t:\"Unmerge\", s:\"none\", c:\"unmerge %C\"},\r\n  {t:\"Sort\", s:\"sortcol\", c:\"sort %R %S\"},\r\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\r\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\r\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\r\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\r\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\r\n  {t:\"Cell Borders\", s:\"borderOnOff\", c:\"set %C bt %S%Nset %C br %S%Nset %C bb %S%Nset %C bl %S\"},\r\n  {t:\"Column Width\", s:\"colWidths\", c:\"set %W width %S\"},\r\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\r\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\r\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\r\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\r\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\r\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"},\r\n  {t:\"Default Column Width\", s:\"colWidths\", c:\"set sheet defaultcolwidth %S\"}\r\n  ],\r\n rowcolstuff: [\r\n  {t:\"Insert\", s:\"rowcol\", c:\"insert%S %C\"},\r\n  {t:\"Delete\", s:\"rowcol\", c:\"delete%S %C\"},\r\n  {t:\"Paste\", s:\"ffal\", c:\"paste %C %S\"},\r\n  {t:\"Erase\", s:\"ffal\", c:\"erase %C %S\"},\r\n  {t:\"Fill Right\", s:\"ffal\", c:\"fillright %C %S\"},\r\n  {t:\"Fill Down\", s:\"ffal\", c:\"filldown %C %S\"}\r\n  ],\r\n text: [\r\n  {t:\"Cell Color\", s:\"colors\", c:\"set %C color %S\"},\r\n  {t:\"Cell Background\", s:\"colors\", c:\"set %C bgcolor %S\"},\r\n  {t:\"Cell Number Format\", s:\"ntvf\", c:\"set %C nontextvalueformat %S\"},\r\n  {t:\"Cell Text Format\", s:\"tvf\", c:\"set %C textvalueformat %S\"},\r\n  {t:\"Cell Font\", s:\"fonts\", c:\"set %C font %S\"},\r\n  {t:\"Cell Align\", s:\"cellformat\", c:\"set %C cellformat %S\"},\r\n  {t:\"Default Color\", s:\"colors\", c:\"set sheet defaultcolor %S\"},\r\n  {t:\"Default Background\", s:\"colors\", c:\"set sheet defaultbgcolor %S\"},\r\n  {t:\"Default Number Format\", s:\"ntvf\", c:\"set sheet defaultnontextvalueformat %S\"},\r\n  {t:\"Default Text Format\", s:\"tvf\", c:\"set sheet defaulttextvalueformat %S\"},\r\n  {t:\"Default Font\", s:\"fonts\", c:\"set sheet defaultfont %S\"},\r\n  {t:\"Default Text Align\", s:\"cellformat\", c:\"set sheet defaulttextformat %S\"},\r\n  {t:\"Default Number Align\", s:\"cellformat\", c:\"set sheet defaultnontextformat %S\"}\r\n  ],\r\n slists: {\r\n  \"colors\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Black\", s:\"rgb(0,0,0)\"},\r\n   {t:\"Dark Gray\", s:\"rgb(102,102,102)\"}, // #666\r\n   {t:\"Gray\", s:\"rgb(204,204,204)\"}, // #CCC\r\n   {t:\"White\", s:\"rgb(255,255,255)\"},\r\n   {t:\"Red\", s:\"rgb(255,0,0)\"},\r\n   {t:\"Dark Red\", s:\"rgb(153,0,0)\"},\r\n   {t:\"Orange\", s:\"rgb(255,153,0)\"},\r\n   {t:\"Yellow\", s:\"rgb(255,255,0)\"},\r\n   {t:\"Light Yellow\", s:\"rgb(255,255,204)\"},\r\n   {t:\"Green\", s:\"rgb(0,255,0)\"},\r\n   {t:\"Dark Green\", s:\"rgb(0,153,0)\"},\r\n   {t:\"Blue\", s:\"rgb(0,0,255)\"},\r\n   {t:\"Dark Blue\", s:\"rgb(0,0,153)\"},\r\n   {t:\"Light Blue\", s:\"rgb(204,204,255)\"}\r\n   ],\r\n  \"fonts\": [ // style weight size family\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Bold\", s:\"normal bold * *\"},\r\n   {t:\"Italic\", s:\"italic normal * *\"},\r\n   {t:\"Small\", s:\"* small *\"},\r\n   {t:\"Medium\", s:\"* medium *\"},\r\n   {t:\"Large\", s:\"* large *\"},\r\n   {t:\"Bold Small\", s:\"normal bold small *\"},\r\n   {t:\"Bold Medium\", s:\"normal bold medium *\"},\r\n   {t:\"Bold Large\", s:\"normal bold large *\"}\r\n   ],\r\n  \"cellformat\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Left\", s:\"left\"},\r\n   {t:\"Right\", s:\"right\"},\r\n   {t:\"Center\", s:\"center\"}\r\n   ],\r\n  \"borderOnOff\": [\r\n   {t:\"On\", s:\"1px solid rgb(0,0,0)\"},\r\n   {t:\"Off\", s:\"\"}\r\n   ],\r\n  \"colWidths\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"20\", s:\"20\"},\r\n   {t:\"40\", s:\"40\"},\r\n   {t:\"60\", s:\"60\"},\r\n   {t:\"80\", s:\"80\"},\r\n   {t:\"100\", s:\"100\"},\r\n   {t:\"120\", s:\"120\"},\r\n   {t:\"140\", s:\"140\"},\r\n   {t:\"160\", s:\"160\"},\r\n   {t:\"180\", s:\"180\"},\r\n   {t:\"200\", s:\"200\"},\r\n   {t:\"220\", s:\"220\"},\r\n   {t:\"240\", s:\"240\"},\r\n   {t:\"260\", s:\"260\"},\r\n   {t:\"280\", s:\"280\"},\r\n   {t:\"300\", s:\"300\"}\r\n   ],\r\n  \"ntvf\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"1234\", s:\"0\"},\r\n   {t:\"1,234\", s:\"#,##0\"},\r\n   {t:\"1,234.5\", s:\"#,##0.0\"},\r\n   {t:\"1,234.56\", s:\"#,##0.00\"},\r\n   {t:\"1,234.567\", s:\"#,##0.000\"},\r\n   {t:\"1,234%\", s:\"#,##0%\"},\r\n   {t:\"1,234.5%\", s:\"#,##0.0%\"},\r\n   {t:\"(1,234)\", s:\"#,##0_);(#,##0)\"},\r\n   {t:\"(1,234.5)\", s:\"#,##0.0_);(#,##0.0)\"},\r\n   {t:\"(1,234.56)\", s:\"#,##0.00_);(#,##0.00)\"},\r\n   {t:\"00\", s:\"00\"},\r\n   {t:\"000\", s:\"000\"},\r\n   {t:\"0000\", s:\"0000\"},\r\n   {t:\"$1,234.56\", s:\"$#,##0.00\"},\r\n   {t:\"2006-01-04\", s:\"yyyy-mm-dd\"},\r\n   {t:\"01:23:45\", s:\"hh:mm:ss\"},\r\n   {t:\"2006-01-04 01:23:45\", s:\"yyyy-mm-dd hh:mm:ss\"},\r\n   {t:\"Hidden\", s:\"hidden\"}\r\n   ],\r\n  \"tvf\": [\r\n   {t:\"Default\", s:\"\"},\r\n   {t:\"Automatic\", s:\"general\"},\r\n   {t:\"Plain Text\", s:\"text-plain\"},\r\n   {t:\"HTML\", s:\"text-html\"},\r\n   {t:\"Wiki\", s:\"text-wiki\"},\r\n   {t:\"Hidden\", s:\"hidden\"}\r\n   ],\r\n  \"ffal\": [ // Formulas, Formats, All\r\n   {t:\"All\", s:\"all\"},\r\n   {t:\"Contents\", s:\"formulas\"},\r\n   {t:\"Formats\", s:\"formats\"}\r\n   ],\r\n  \"all\": [ // All\r\n   {t:\"All\", s:\"all\"}\r\n   ],\r\n  \"rowcol\": [\r\n   {t:\"Row\", s:\"row\"},\r\n   {t:\"Column\", s:\"col\"}\r\n   ],\r\n  \"sortcol\": [\r\n   {t:\"A up\", s:\"A up\"},\r\n   {t:\"B up\", s:\"B up\"},\r\n   {t:\"C up\", s:\"C up\"},\r\n   {t:\"A down\", s:\"A down\"},\r\n   {t:\"B down\", s:\"B down\"},\r\n   {t:\"C down\", s:\"C down\"},\r\n   {t:\"A, B, C up\", s:\"A up B up C up\"}\r\n   ],\r\n  \"none\": [ // nothing\r\n   {t:\" \", s:\" \"}\r\n   ]\r\n  }\r\n }\r\n*********/\r\n\r\n//\r\n// SocialCalc.SpreadsheetControlExecuteCommand(obj, combostr, sstr)\r\n//\r\n// xxx\r\n//\r\n\r\nSocialCalc.SpreadsheetControlExecuteCommand = function(obj, combostr, sstr) {\r\n\r\n   var i, commands;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var eobj = spreadsheet.editor;\r\n\r\n   var str = {};\r\n   str.P = \"%\";\r\n   str.N = \"\\n\"\r\n   if (eobj.range.hasrange) {\r\n      str.R = SocialCalc.crToCoord(eobj.range.left, eobj.range.top)+\r\n             \":\"+SocialCalc.crToCoord(eobj.range.right, eobj.range.bottom);\r\n      str.C = str.R;\r\n      str.W = SocialCalc.rcColname(eobj.range.left) + \":\" + SocialCalc.rcColname(eobj.range.right);\r\n      str.H = eobj.range.top + \":\" + eobj.range.bottom;\r\n      }\r\n   else if (eobj.ecell) {\r\n      str.C = eobj.ecell.coord;\r\n      str.R = eobj.ecell.coord+\":\"+eobj.ecell.coord;\r\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr(eobj.ecell.coord).col);\r\n      str.H = SocialCalc.coordToCr(eobj.ecell.coord).row;\r\n      }\r\n   else {\r\n      str.C = 'A1'\r\n      str.R = 'A1:A1'\r\n      str.W = SocialCalc.rcColname(SocialCalc.coordToCr('A1').col);\r\n      str.H = SocialCalc.coordToCr('A1').row;\r\n      }\r\n   str.S = sstr;\r\n   combostr = combostr.replace(/%C/g, str.C);\r\n   combostr = combostr.replace(/%R/g, str.R);\r\n   combostr = combostr.replace(/%N/g, str.N);\r\n   combostr = combostr.replace(/%S/g, str.S);\r\n   combostr = combostr.replace(/%W/g, str.W);\r\n   combostr = combostr.replace(/%H/g, str.H);\r\n   combostr = combostr.replace(/%P/g, str.P);\r\n\r\n   eobj.EditorScheduleSheetCommands(combostr, true, false);\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateSheetHTML(spreadsheet)\r\n//\r\n// Returns the HTML representation of the whole spreadsheet\r\n//\r\n\r\nSocialCalc.SpreadsheetControlCreateSheetHTML = function(spreadsheet) {\r\n\r\n   var context, div, ele;\r\n\r\n   var result = \"\";\r\n\r\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\r\n   div = document.createElement(\"div\");\r\n   ele = context.RenderSheet(null, {type: \"html\"});\r\n   div.appendChild(ele);\r\n   delete context;\r\n   result = div.innerHTML;\r\n   delete ele;\r\n   delete div;\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateCellHTML(spreadsheet, coord, linkstyle)\r\n//\r\n// Returns the HTML representation of a cell. Blank is \"\", not \"&nbsp;\".\r\n//\r\n\r\nSocialCalc.SpreadsheetControlCreateCellHTML = function(spreadsheet, coord, linkstyle) {\r\n\r\n   var result = \"\";\r\n   var cell = spreadsheet.sheet.cells[coord];\r\n\r\n   if (!cell) return \"\";\r\n\r\n   if (cell.displaystring == undefined) {\r\n      result = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\r\n      }\r\n   else {\r\n      result = cell.displaystring;\r\n      }\r\n\r\n   if (result == \"&nbsp;\") result = \"\";\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateCellHTMLSave(spreadsheet, range, linkstyle)\r\n//\r\n// Returns the HTML representation of a range of cells, or the whole sheet if range is null.\r\n// The form is:\r\n//    version:1.0\r\n//    coord:cell-HTML\r\n//    coord:cell-HTML\r\n//    ...\r\n//\r\n// Empty cells are skipped. The cell-HTML is encoded with \":\"=>\"\\c\", newline=>\"\\n\", and \"\\\"=>\"\\b\".\r\n//\r\n\r\nSocialCalc.SpreadsheetControlCreateCellHTMLSave = function(spreadsheet, range, linkstyle) {\r\n\r\n   var cr1, cr2, row, col, coord, cell, cellHTML;\r\n   var result = [];\r\n   var prange;\r\n\r\n   if (range) {\r\n      prange = SocialCalc.ParseRange(range);\r\n      }\r\n   else {\r\n      prange = {cr1: {row: 1, col:1},\r\n                cr2: {row: spreadsheet.sheet.attribs.lastrow, col: spreadsheet.sheet.attribs.lastcol}};\r\n      }\r\n   cr1 = prange.cr1;\r\n   cr2 = prange.cr2;\r\n\r\n   result.push(\"version:1.0\");\r\n\r\n   for (row=cr1.row; row <= cr2.row; row++) {\r\n      for (col=cr1.col; col <= cr2.col; col++) {\r\n         coord = SocialCalc.crToCoord(col, row);\r\n         cell=spreadsheet.sheet.cells[coord];\r\n         if (!cell) continue;\r\n         if (cell.displaystring == undefined) {\r\n            cellHTML = SocialCalc.FormatValueForDisplay(spreadsheet.sheet, cell.datavalue, coord, (linkstyle || spreadsheet.context.defaultHTMLlinkstyle));\r\n            }\r\n         else {\r\n            cellHTML = cell.displaystring;\r\n            }\r\n         if (cellHTML == \"&nbsp;\") continue;\r\n         result.push(coord+\":\"+SocialCalc.encodeForSave(cellHTML));\r\n         }\r\n      }\r\n\r\n   result.push(\"\"); // one extra to get extra \\n\r\n   return result.join(\"\\n\");\r\n   }\r\n\r\n//\r\n// Formula Bar Button Routines\r\n//\r\n\r\nSocialCalc.SpreadsheetControl.DoFunctionList = function() {\r\n\r\n   var i, cname, str, f, ele;\r\n\r\n   var scf = SocialCalc.Formula;\r\n   var scc = SocialCalc.Constants;\r\n   var fcl = scc.function_classlist;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"function\";\r\n\r\n   ele = document.getElementById(idp+\"dialog\");\r\n   if (ele) return; // already have one\r\n\r\n   scf.FillFunctionInfo();\r\n\r\n   str = '<table><tr><td><span style=\"font-size:x-small;font-weight:bold\">%loc!Category!</span><br>'+\r\n      '<select id=\"'+idp+'class\" size=\"'+fcl.length+'\" style=\"width:120px;\" onchange=\"SocialCalc.SpreadsheetControl.FunctionClassChosen(this.options[this.selectedIndex].value);\">';\r\n   for (i=0; i<fcl.length; i++) {\r\n      str += '<option value=\"'+fcl[i]+'\"'+(i==0?' selected>':'>')+SocialCalc.special_chars(scf.FunctionClasses[fcl[i]].name)+'</option>';\r\n      }\r\n   str += '</select></td><td>&nbsp;&nbsp;</td><td id=\"'+idp+'list\"><span style=\"font-size:x-small;font-weight:bold\">%loc!Functions!</span><br>'+\r\n      '<select id=\"'+idp+'name\" size=\"'+fcl.length+'\" style=\"width:240px;\" '+\r\n      'onchange=\"SocialCalc.SpreadsheetControl.FunctionChosen(this.options[this.selectedIndex].value);\" ondblclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">';\r\n   str += SocialCalc.SpreadsheetControl.GetFunctionNamesStr(\"all\");\r\n   str += '</td></tr><tr><td colspan=\"3\">'+\r\n          '<div id=\"'+idp+'desc\" style=\"width:380px;height:80px;overflow:auto;font-size:x-small;\">'+SocialCalc.SpreadsheetControl.GetFunctionInfoStr(scf.FunctionClasses[fcl[0]].items[0])+'</div>'+\r\n          '<div style=\"width:380px;text-align:right;padding-top:6px;font-size:small;\">'+\r\n          '<input type=\"button\" value=\"%loc!Paste!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoFunctionPaste();\">&nbsp;'+\r\n          '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\"></div>'+\r\n          '</td></tr></table>';\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.id = idp+\"dialog\";\r\n\r\n   main.style.position = \"absolute\";\r\n\r\n   var vp = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\r\n\r\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\r\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   main.style.width = \"400px\";\r\n\r\n   str = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;%loc!Function List!\"+'</td>'+\r\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideFunctions();\">&nbsp;X&nbsp;</td></tr></table>'+\r\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\r\n\r\n   str = SocialCalc.LocalizeSubstrings(str);\r\n\r\n   main.innerHTML = str;\r\n\r\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true,\r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: main},\r\n                  spreadsheet.spreadsheetDiv);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(main);\r\n\r\n   ele = document.getElementById(idp+\"name\");\r\n   ele.focus();\r\n   SocialCalc.CmdGotFocus(ele);\r\n//!!! need to do keyboard handling: if esc, hide; if All, letter scrolls to there\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.GetFunctionNamesStr = function(cname) {\r\n\r\n   var i, f;\r\n   var scf = SocialCalc.Formula;\r\n   var str = \"\";\r\n\r\n   f = scf.FunctionClasses[cname];\r\n   for (i=0; i<f.items.length; i++) {\r\n      str += '<option value=\"'+f.items[i]+'\"'+(i==0?' selected>':'>')+f.items[i]+'</option>';\r\n      }\r\n\r\n   return str;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FillFunctionNames = function(cname, ele) {\r\n\r\n   var i, f;\r\n   var scf = SocialCalc.Formula;\r\n\r\n   ele.length = 0;\r\n   f = scf.FunctionClasses[cname];\r\n   for (i=0; i<f.items.length; i++) {\r\n      ele.options[i] = new Option(f.items[i], f.items[i]);\r\n      if (i==0) {\r\n         ele.options[i].selected = true;\r\n         }\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.GetFunctionInfoStr = function(fname) {\r\n   \r\n   var scf = SocialCalc.Formula;\r\n   var f = scf.FunctionList[fname];\r\n   var scsc = SocialCalc.special_chars;\r\n\r\n   var str = \"<b>\"+fname+\"(\"+scsc(scf.FunctionArgString(fname))+\")</b><br>\";\r\n   str += scsc(f[3]);\r\n\r\n   return str;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FunctionClassChosen = function(cname) {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"function\";\r\n   var scf = SocialCalc.Formula;\r\n\r\n   SocialCalc.SpreadsheetControl.FillFunctionNames(cname, document.getElementById(idp+\"name\"));\r\n\r\n   SocialCalc.SpreadsheetControl.FunctionChosen(scf.FunctionClasses[cname].items[0]);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FunctionChosen = function(fname) {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"function\";\r\n\r\n   document.getElementById(idp+\"desc\").innerHTML = SocialCalc.SpreadsheetControl.GetFunctionInfoStr(fname);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.HideFunctions = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functiondialog\");\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(ele);\r\n\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoFunctionPaste = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"functionname\");\r\n   var mele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\r\n\r\n   var text = ele.value+\"(\";\r\n\r\n   SocialCalc.SpreadsheetControl.HideFunctions();\r\n\r\n   if (mele) { // multi-line editing is in progress\r\n      mele.value += text;\r\n      mele.focus();\r\n      SocialCalc.CmdGotFocus(mele);\r\n      }\r\n   else {\r\n      editor.EditorAddToInput(text, \"=\");\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoMultiline = function() {\r\n\r\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\r\n\r\n   var str, ele, text;\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"multiline\";\r\n\r\n   ele = document.getElementById(idp+\"dialog\");\r\n   if (ele) return; // already have one\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         text = editor.inputBox.GetText();\r\n         break;\r\n      }\r\n\r\n   editor.inputBox.element.disabled = true;\r\n\r\n   text = SocialCalc.special_chars(text);\r\n\r\n   str = '<textarea id=\"'+idp+'textarea\" style=\"width:380px;height:120px;margin:10px 0px 0px 6px;\">'+text+'</textarea>'+\r\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\r\n         SCLocSS('<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilinePaste();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoMultilineClear();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\"></div>'+\r\n         '</div>');\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.id = idp+\"dialog\";\r\n\r\n   main.style.position = \"absolute\";\r\n\r\n   var vp = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\r\n\r\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\r\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   main.style.width = \"400px\";\r\n\r\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\r\n      SCLocSS(\"&nbsp;%loc!Multi-line Input Box!\")+'</td>'+\r\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideMultiline();\">&nbsp;X&nbsp;</td></tr></table>'+\r\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\r\n\r\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, \r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: main},\r\n                  spreadsheet.spreadsheetDiv);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(main);\r\n\r\n   ele = document.getElementById(idp+\"textarea\");\r\n   ele.focus();\r\n   SocialCalc.CmdGotFocus(ele);\r\n//!!! need to do keyboard handling: if esc, hide?\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.HideMultiline = function() {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinedialog\");\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(ele);\r\n\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.inputBox.DisplayCellContents(null);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.element.disabled = false;\r\n         editor.inputBox.Focus();\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoMultilineClear = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\r\n\r\n   ele.value = \"\";\r\n   ele.focus();\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoMultilinePaste = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"multilinetextarea\");\r\n\r\n   var text = ele.value;\r\n\r\n   SocialCalc.SpreadsheetControl.HideMultiline();\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         break;\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.Blur();\r\n         editor.inputBox.ShowInputBox(false);\r\n         editor.state = \"start\";\r\n         break;\r\n      }\r\n\r\n   editor.EditorSaveEdit(text);\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoLink = function() {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   var str, ele, text, cell, setformat, popup;\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var idp = spreadsheet.idPrefix+\"link\";\r\n\r\n   ele = document.getElementById(idp+\"dialog\");\r\n   if (ele) return; // already have one\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         editor.RangeRemove();\r\n         text = SocialCalc.GetCellContents(editor.context.sheetobj, wval.ecoord);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         text = editor.inputBox.GetText();\r\n         break;\r\n      }\r\n\r\n   editor.inputBox.element.disabled = true;\r\n\r\n   if (text.charAt(0)==\"'\") {\r\n      text = text.slice(1);\r\n      }\r\n\r\n   var parts = SocialCalc.ParseCellLinkText(text);\r\n\r\n   text = SocialCalc.special_chars(text);\r\n\r\n   cell = spreadsheet.sheet.cells[editor.ecell.coord];\r\n   if (!cell || !cell.textvalueformat) { // set to link format, but don't override\r\n      setformat = \" checked\";\r\n      }\r\n   else {\r\n      setformat = \"\";\r\n      }\r\n\r\n   popup = parts.newwin ? \" checked\" : \"\";\r\n\r\n   str = '<div style=\"padding:6px 0px 4px 6px;\">'+\r\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"Description\")+'</span><br>'+\r\n         '<input type=\"text\" id=\"'+idp+'desc\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.desc)+'\"><br>'+\r\n         '<span style=\"font-size:smaller;\">'+SCLoc(\"URL\")+'</span><br>'+\r\n         '<input type=\"text\" id=\"'+idp+'url\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.url)+'\"><br>';\r\n   if (SocialCalc.Callbacks.MakePageLink) { // only show if handling pagenames here\r\n      str += '<span style=\"font-size:smaller;\">'+SCLoc(\"Page Name\")+'</span><br>'+\r\n             '<input type=\"text\" id=\"'+idp+'pagename\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.pagename)+'\"><br>'+\r\n             '<span style=\"font-size:smaller;\">'+SCLoc(\"Workspace\")+'</span><br>'+\r\n             '<input type=\"text\" id=\"'+idp+'workspace\" style=\"width:380px;\" value=\"'+SocialCalc.special_chars(parts.workspace)+'\"><br>';\r\n      }\r\n   str += SocialCalc.LocalizeSubstrings('<input type=\"checkbox\" id=\"'+idp+'format\"'+setformat+'>&nbsp;'+\r\n         '<span style=\"font-size:smaller;\">%loc!Set to Link format!</span><br>'+\r\n         '<input type=\"checkbox\" id=\"'+idp+'popup\"'+popup+'>&nbsp;'+\r\n         '<span style=\"font-size:smaller;\">%loc!Show in new browser window!</span>'+\r\n         '</div>'+\r\n         '<div style=\"width:380px;text-align:right;padding:6px 0px 4px 6px;font-size:small;\">'+\r\n         '<input type=\"button\" value=\"%loc!Set Cell Contents!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkPaste();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Clear!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.DoLinkClear();\">&nbsp;'+\r\n         '<input type=\"button\" value=\"%loc!Cancel!\" style=\"font-size:smaller;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\"></div>'+\r\n         '</div>');\r\n\r\n   var main = document.createElement(\"div\");\r\n   main.id = idp+\"dialog\";\r\n\r\n   main.style.position = \"absolute\";\r\n\r\n   var vp = SocialCalc.GetViewportInfo();\r\n   var pos = SocialCalc.GetElementPositionWithScroll(spreadsheet.spreadsheetDiv);\r\n\r\n   main.style.top = ((vp.height/3)-pos.top)+\"px\";\r\n   main.style.left = ((vp.width/3)-pos.left)+\"px\";\r\n   main.style.zIndex = 100;\r\n   main.style.backgroundColor = \"#FFF\";\r\n   main.style.border = \"1px solid black\";\r\n\r\n   main.style.width = \"400px\";\r\n\r\n   main.innerHTML = '<table cellspacing=\"0\" cellpadding=\"0\" style=\"border-bottom:1px solid black;\"><tr>'+\r\n      '<td style=\"font-size:10px;cursor:default;width:100%;background-color:#999;color:#FFF;\">'+\"&nbsp;\"+SCLoc(\"Link Input Box\")+'</td>'+\r\n      '<td style=\"font-size:10px;cursor:default;color:#666;\" onclick=\"SocialCalc.SpreadsheetControl.HideLink();\">&nbsp;X&nbsp;</td></tr></table>'+\r\n      '<div style=\"background-color:#DDD;\">'+str+'</div>';\r\n\r\n   SocialCalc.DragRegister(main.firstChild.firstChild.firstChild.firstChild, true, true, \r\n                 {MouseDown: SocialCalc.DragFunctionStart, \r\n                  MouseMove: SocialCalc.DragFunctionPosition,\r\n                  MouseUp: SocialCalc.DragFunctionPosition,\r\n                  Disabled: null, positionobj: main},\r\n                  spreadsheet.spreadsheetDiv);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(main);\r\n\r\n   ele = document.getElementById(idp+\"url\");\r\n   ele.focus();\r\n   SocialCalc.CmdGotFocus(ele);\r\n//!!! need to do keyboard handling: if esc, hide?\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.HideLink = function() {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkdialog\");\r\n   ele.innerHTML = \"\";\r\n\r\n   SocialCalc.DragUnregister(ele);\r\n\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (ele.parentNode) {\r\n      ele.parentNode.removeChild(ele);\r\n      }\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         editor.inputBox.DisplayCellContents(null);\r\n         break;\r\n\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.element.disabled = false;\r\n         editor.inputBox.Focus();\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoLinkClear = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   document.getElementById(spreadsheet.idPrefix+\"linkdesc\").value = \"\";\r\n   document.getElementById(spreadsheet.idPrefix+\"linkpagename\").value = \"\";\r\n   document.getElementById(spreadsheet.idPrefix+\"linkworkspace\").value = \"\";\r\n\r\n   var ele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\r\n   ele.value = \"\";\r\n   ele.focus();\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SpreadsheetControl.DoLinkPaste = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var wval = editor.workingvalues;\r\n\r\n   var descele = document.getElementById(spreadsheet.idPrefix+\"linkdesc\");\r\n   var urlele = document.getElementById(spreadsheet.idPrefix+\"linkurl\");\r\n   var pagenameele = document.getElementById(spreadsheet.idPrefix+\"linkpagename\");\r\n   var workspaceele = document.getElementById(spreadsheet.idPrefix+\"linkworkspace\");\r\n   var formatele = document.getElementById(spreadsheet.idPrefix+\"linkformat\");\r\n   var popupele = document.getElementById(spreadsheet.idPrefix+\"linkpopup\");\r\n\r\n   var text = \"\";\r\n\r\n   var ltsym, gtsym, obsym, cbsym;\r\n\r\n   if (popupele.checked) {\r\n      ltsym = \"<<\"; gtsym = \">>\"; obsym = \"[[\"; cbsym = \"]]\";\r\n      }\r\n   else {\r\n      ltsym = \"<\"; gtsym = \">\"; obsym = \"[\"; cbsym = \"]\";\r\n      }\r\n\r\n   if (pagenameele && pagenameele.value) {\r\n      if (workspaceele.value) {\r\n         text = descele.value+\"{\"+workspaceele.value+obsym+pagenameele.value+cbsym+\"}\";\r\n         }\r\n      else {\r\n         text = descele.value+obsym+pagenameele.value+cbsym;\r\n         }\r\n      }\r\n   else {\r\n      text = descele.value+ltsym+urlele.value+gtsym;\r\n      }\r\n\r\n   SocialCalc.SpreadsheetControl.HideLink();\r\n\r\n   switch (editor.state) {\r\n      case \"start\":\r\n         wval.partialexpr = \"\";\r\n         wval.ecoord = editor.ecell.coord;\r\n         wval.erow = editor.ecell.row;\r\n         wval.ecol = editor.ecell.col;\r\n         break;\r\n      case \"input\":\r\n      case \"inputboxdirect\":\r\n         editor.inputBox.Blur();\r\n         editor.inputBox.ShowInputBox(false);\r\n         editor.state = \"start\";\r\n         break;\r\n      }\r\n\r\n   if (formatele.checked) {\r\n      SocialCalc.SpreadsheetControlExecuteCommand(null, \"set %C textvalueformat text-link\", \"\");\r\n      }\r\n\r\n   editor.EditorSaveEdit(text);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.DoSum = function() {\r\n\r\n   var cmd, cell, row, col, sel, cr, foundvalue;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var editor = spreadsheet.editor;\r\n   var sheet = editor.context.sheetobj;\r\n\r\n   if (editor.range.hasrange) {\r\n      sel = SocialCalc.crToCoord(editor.range.left, editor.range.top)+\r\n         \":\"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      cmd = \"set \"+SocialCalc.crToCoord(editor.range.right, editor.range.bottom+1)+\r\n         \" formula sum(\"+sel+\")\";\r\n      }\r\n   else {\r\n      row = editor.ecell.row - 1;\r\n      col = editor.ecell.col;\r\n      if (row<=1) {\r\n         cmd = \"set \"+editor.ecell.coord+\" constant e#REF! 0 #REF!\";\r\n         }\r\n      else {\r\n         foundvalue = false;\r\n         while (row>0) {\r\n            cr = SocialCalc.crToCoord(col, row);\r\n            cell = sheet.GetAssuredCell(cr);\r\n            if (!cell.datatype || cell.datatype==\"t\") {\r\n               if (foundvalue) {\r\n                  row++;\r\n                  break;\r\n                  }\r\n               }\r\n            else {\r\n               foundvalue = true;\r\n               }\r\n            row--;\r\n            }\r\n         cmd = \"set \"+editor.ecell.coord+\" formula sum(\"+\r\n            SocialCalc.crToCoord(col,row)+\":\"+SocialCalc.crToCoord(col, editor.ecell.row-1)+\")\";\r\n         }\r\n      }\r\n\r\n   editor.EditorScheduleSheetCommands(cmd, true, false);\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControl.FindInSheet = function() {\r\n    var searchstatus = $(\"#searchstatus\");\r\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n    if (!this.value.length) {\r\n        searchstatus.text(\"\");\r\n        spreadsheet.sheet.search_cells = [];\r\n        spreadsheet.sheet.selected_search_cell = undefined;\r\n        return;\r\n    }\r\n    var cells = spreadsheet.sheet.cells;\r\n    var regex = new RegExp(this.value, 'im');\r\n    var cell, cellvalue;\r\n    var search_cells = [];\r\n    for (var cell_id in cells) {\r\n        cell = cells[cell_id];\r\n        var cr = SocialCalc.coordToCr(cell_id);\r\n        if (spreadsheet.sheet.rowattribs.hide[cr.row] === 'yes' || spreadsheet.sheet.colattribs.hide[SocialCalc.rcColname(cr.col)] === 'yes') {\r\n            continue;\r\n        }\r\n        if (cell.datatype === 'c') {\r\n            cellvalue = cell.displaystring;\r\n        } else {\r\n            cellvalue = String(cell.datavalue);\r\n        }\r\n        if (cellvalue !== undefined && cellvalue.match(regex)) {\r\n           search_cells.push(cell_id);\r\n        } \r\n    }\r\n    spreadsheet.sheet.search_cells = search_cells;\r\n    if (search_cells.length) {\r\n        spreadsheet.sheet.selected_search_cell = 0;\r\n        spreadsheet.editor.MoveECell(search_cells[0]);\r\n        searchstatus.text(\"1 of \" + search_cells.length); \r\n    } else {\r\n        spreadsheet.sheet.selected_search_cell = undefined;\r\n        searchstatus.text(\"No Matches\");\r\n    }\r\n        \r\n}\r\n\r\nSocialCalc.SpreadsheetControl.SearchSheet = function(direction) {\r\n    var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n    var sheet = spreadsheet.sheet;\r\n    var cells = sheet.search_cells;\r\n    if (!cells.length) {\r\n        return;\r\n    }\r\n    var selected_cell = sheet.selected_search_cell;\r\n    if (selected_cell === (direction === 0 ? 0 : cells.length-1)) {\r\n        selected_cell = (direction === 0 ? cells.length-1 : 0);\r\n    } else {\r\n        selected_cell += (direction === 0 ? -1 : 1);\r\n    }\r\n    var new_cell = cells[selected_cell];\r\n    sheet.selected_search_cell = selected_cell; \r\n    spreadsheet.editor.MoveECell(new_cell);\r\n    document.getElementById(\"searchstatus\").textContent = String(selected_cell+1) + \" of \" + cells.length;\r\n}\r\n \r\nSocialCalc.SpreadsheetControl.SearchUp = function() {\r\n    SocialCalc.SpreadsheetControl.SearchSheet(0);    \r\n}\r\n\r\nSocialCalc.SpreadsheetControl.SearchDown = function() {\r\n    SocialCalc.SpreadsheetControl.SearchSheet(1);\r\n}\r\n\r\n//\r\n// TAB Routines\r\n//\r\n\r\n// Sort\r\n\r\nSocialCalc.SpreadsheetControlSortOnclick = function(s, t) {\r\n\r\n   var name, i;\r\n   var namelist = [];\r\n   var nl = document.getElementById(s.idPrefix+\"sortlist\");\r\n   SocialCalc.LoadColumnChoosers(s);\r\n   s.editor.RangeChangeCallback.sort = SocialCalc.UpdateSortRangeProposal;\r\n\r\n   for (name in s.sheet.names) {\r\n      namelist.push(name);\r\n      }\r\n   namelist.sort();\r\n   nl.length = 0;\r\n   nl.options[0] = new Option(SocialCalc.LocalizeString(\"[select range]\"));\r\n   nl.options[1] = new Option(SocialCalc.LocalizeString(\"Sort All\"), \"all\");\r\n   n_options = nl.options.length;\r\n\r\n   for (i=0; i<namelist.length; i++) {\r\n      name = namelist[i];\r\n      nl.options[i+n_options] = new Option(name, name);\r\n      if (name == s.sortrange) {\r\n         nl.options[i+n_options].selected = true;\r\n         }\r\n      }\r\n   if (s.sortrange == \"\") {\r\n      nl.options[0].selected = true;\r\n      }\r\n\r\n   SocialCalc.UpdateSortRangeProposal(s.editor);\r\n   SocialCalc.KeyboardFocus();\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlSortSave = function(editor, setting) {\r\n   // Format is:\r\n   //    sort:sortrange:major:up/down:minor:up/down:last:up/down\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n   var str, sele, rele;\r\n\r\n   str = \"sort:\"+SocialCalc.encodeForSave(spreadsheet.sortrange)+\":\";\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n   rele = document.getElementById(spreadsheet.idPrefix+\"majorsortup\");\r\n   str += sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n   if (sele.selectedIndex>0) {\r\n      rele = document.getElementById(spreadsheet.idPrefix+\"minorsortup\");\r\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\r\n      }\r\n   else {\r\n      str += \"::\";\r\n      }\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n   if (sele.selectedIndex>0) {\r\n      rele = document.getElementById(spreadsheet.idPrefix+\"lastsortup\");\r\n      str += \":\"+sele.selectedIndex + (rele.checked ? \":up\" : \":down\");\r\n      }\r\n    else {\r\n      str += \"::\";\r\n      }\r\n   return str+\"\\n\";\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlSortLoad = function(editor, setting, line, flags) {\r\n   var parts, ele;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetControlObject();\r\n\r\n   parts = line.split(\":\");\r\n   spreadsheet.sortrange = SocialCalc.decodeFromSave(parts[1]);\r\n   ele = document.getElementById(spreadsheet.idPrefix+\"sortbutton\");\r\n   if (spreadsheet.sortrange) {\r\n      ele.value = SocialCalc.LocalizeString(\"Sort \")+spreadsheet.sortrange;\r\n      ele.style.visibility = \"visible\";\r\n      }\r\n   else {\r\n      ele.style.visibility = \"hidden\";\r\n      }\r\n   SocialCalc.LoadColumnChoosers(spreadsheet);\r\n\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"majorsort\");\r\n   sele.selectedIndex = parts[2]-0;\r\n   document.getElementById(spreadsheet.idPrefix+\"majorsort\"+parts[3]).checked = true;\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"minorsort\");\r\n   if (parts[4]) {\r\n      sele.selectedIndex = parts[4]-0;\r\n      document.getElementById(spreadsheet.idPrefix+\"minorsort\"+parts[5]).checked = true;\r\n      }\r\n   else {\r\n      sele.selectedIndex = 0;\r\n      document.getElementById(spreadsheet.idPrefix+\"minorsortup\").checked = true;\r\n      }\r\n   sele = document.getElementById(spreadsheet.idPrefix+\"lastsort\");\r\n   if (parts[6]) {\r\n      sele.selectedIndex = parts[6]-0;\r\n      document.getElementById(spreadsheet.idPrefix+\"lastsort\"+parts[7]).checked = true;\r\n      }\r\n    else {\r\n      sele.selectedIndex = 0;\r\n      document.getElementById(spreadsheet.idPrefix+\"lastsortup\").checked = true;\r\n      }\r\n\r\n   return true;\r\n   }\r\n\r\n// Comment\r\n\r\nSocialCalc.SpreadsheetControlCommentOnclick = function(s, t) {\r\n   s.editor.MoveECellCallback.comment = SocialCalc.SpreadsheetControlCommentMoveECell;\r\n   SocialCalc.SpreadsheetControlCommentDisplay(s, t);\r\n   SocialCalc.KeyboardFocus();\r\n   return;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentDisplay = function(s, t) {\r\n   var c = \"\";\r\n   if (s.editor.ecell && s.editor.ecell.coord && s.sheet.cells[s.editor.ecell.coord]) {\r\n      c = s.sheet.cells[s.editor.ecell.coord].comment || \"\";\r\n      }\r\n   document.getElementById(s.idPrefix+\"commenttext\").value = c;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentMoveECell = function(editor) {\r\n   SocialCalc.SpreadsheetControlCommentDisplay(SocialCalc.GetSpreadsheetControlObject(), \"comment\");\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentSet = function() {\r\n   var s=SocialCalc.GetSpreadsheetControlObject();\r\n   s.ExecuteCommand(\"set %C comment \"+SocialCalc.encodeForSave(document.getElementById(s.idPrefix+\"commenttext\").value));\r\n   var cell=SocialCalc.GetEditorCellElement(s.editor, s.editor.ecell.row, s.editor.ecell.col);\r\n   if (!s.editor.ECellReadonly()) {\r\n      cell.element.title = document.getElementById(s.idPrefix+\"commenttext\").value;\r\n      s.editor.UpdateCellCSS(cell, s.editor.ecell.row, s.editor.ecell.col);\r\n      }\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlCommentOnunclick = function(s, t) {\r\n   delete s.editor.MoveECellCallback.comment;\r\n   }\r\n\r\n// Names\r\n\r\nSocialCalc.SpreadsheetControlNamesOnclick = function(s, t) {\r\n   document.getElementById(s.idPrefix+\"namesname\").value = \"\";\r\n   document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\r\n   document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\r\n   s.editor.RangeChangeCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\r\n   s.editor.MoveECellCallback.names = SocialCalc.SpreadsheetControlNamesRangeChange;\r\n   SocialCalc.SpreadsheetControlNamesRangeChange(s.editor);\r\n   SocialCalc.SpreadsheetControlNamesFillNameList();\r\n   SocialCalc.SpreadsheetControlNamesChangedName();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesFillNameList = function() {\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n   var name, i;\r\n   var namelist = [];\r\n   var s=SocialCalc.GetSpreadsheetControlObject();\r\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\r\n   var currentname = document.getElementById(s.idPrefix+\"namesname\").value.toUpperCase().replace(/[^A-Z0-9_\\.]/g, \"\");\r\n   for (name in s.sheet.names) {\r\n      namelist.push(name);\r\n      }\r\n   namelist.sort();\r\n   nl.length = 0;\r\n   if (namelist.length > 0) {\r\n      nl.options[0] = new Option(SCLoc(\"[New]\"));\r\n      }\r\n   else {\r\n      nl.options[0] = new Option(SCLoc(\"[None]\"));\r\n      }\r\n   for (i=0; i<namelist.length; i++) {\r\n      name = namelist[i];\r\n      nl.options[i+1] = new Option(name, name);\r\n      if (name == currentname) {\r\n         nl.options[i+1].selected = true;\r\n         }\r\n      }\r\n   if (currentname == \"\") {\r\n      nl.options[0].selected = true;\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesChangedName = function() {\r\n   var s=SocialCalc.GetSpreadsheetControlObject();\r\n   var nl = document.getElementById(s.idPrefix+\"nameslist\");\r\n   var name = nl.options[nl.selectedIndex].value;\r\n   if (s.sheet.names[name]) {\r\n      document.getElementById(s.idPrefix+\"namesname\").value = name;\r\n      document.getElementById(s.idPrefix+\"namesdesc\").value = s.sheet.names[name].desc || \"\";\r\n      document.getElementById(s.idPrefix+\"namesvalue\").value = s.sheet.names[name].definition || \"\";\r\n      }\r\n   else {\r\n      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\r\n      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\r\n      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesRangeChange = function(editor) {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var ele = document.getElementById(s.idPrefix+\"namesrangeproposal\");\r\n   if (editor.range.hasrange) {\r\n      ele.value = SocialCalc.crToCoord(editor.range.left, editor.range.top) + \":\" +\r\n                            SocialCalc.crToCoord(editor.range.right, editor.range.bottom);\r\n      }\r\n   else {\r\n      ele.value = editor.ecell.coord;\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesOnunclick = function(s, t) {\r\n   delete s.editor.RangeChangeCallback.names;\r\n   delete s.editor.MoveECellCallback.names;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesSetValue = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   document.getElementById(s.idPrefix+\"namesvalue\").value = document.getElementById(s.idPrefix+\"namesrangeproposal\").value;\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesSave = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   if (name != \"\") {\r\n      s.ExecuteCommand(\"name define \"+name+\" \"+document.getElementById(s.idPrefix+\"namesvalue\").value+\"\\n\"+\r\n         \"name desc \"+name+\" \"+document.getElementById(s.idPrefix+\"namesdesc\").value);\r\n      }\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlNamesDelete = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var name = document.getElementById(s.idPrefix+\"namesname\").value;\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   if (name != \"\") {\r\n      s.ExecuteCommand(\"name delete \"+name);\r\n//      document.getElementById(s.idPrefix+\"namesname\").value = \"\";\r\n//      document.getElementById(s.idPrefix+\"namesvalue\").value = \"\";\r\n//      document.getElementById(s.idPrefix+\"namesdesc\").value = \"\";\r\n//      SocialCalc.SpreadsheetControlNamesFillNameList();\r\n      }\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\n// Clipboard\r\n\r\nSocialCalc.SpreadsheetControlClipboardOnclick = function(s, t) {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\r\n   document.getElementById(s.idPrefix+\"clipboardformat-tab\").checked = true;\r\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, \"tab\");\r\n   return;\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardFormat = function(which) {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\r\n   clipele.value = SocialCalc.ConvertSaveToOtherFormat(SocialCalc.Clipboard.clipboard, which);\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardLoad = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var savetype = \"tab\";\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   if (document.getElementById(s.idPrefix+\"clipboardformat-csv\").checked) {\r\n      savetype = \"csv\";\r\n      }\r\n   else if (document.getElementById(s.idPrefix+\"clipboardformat-scsave\").checked) {\r\n      savetype = \"scsave\";\r\n      }\r\n   // control+v ignores ignore windows clipboard - see ctrlkeyFunction(editor, charname)\r\n   s.editor.pastescclipboard = true;\r\n   s.editor.EditorScheduleSheetCommands(\"loadclipboard \"+\r\n      SocialCalc.encodeForSave(\r\n         SocialCalc.ConvertOtherFormatToSave(document.getElementById(s.idPrefix+\"clipboardtext\").value, savetype)), true, false);\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardClear = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var clipele = document.getElementById(s.idPrefix+\"clipboardtext\");\r\n   clipele.value = \"\";\r\n   s.editor.EditorScheduleSheetCommands(\"clearclipboard\", true, false);\r\n   clipele.focus();\r\n   }\r\n\r\nSocialCalc.SpreadsheetControlClipboardExport = function() {\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   if (s.ExportCallback) {\r\n      s.ExportCallback(s);\r\n      }\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n   }\r\n\r\n// Settings\r\n\r\nSocialCalc.SpreadsheetControlSettingsSwitch = function(target) {\r\n   SocialCalc.SettingControlReset();\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var sheettable = document.getElementById(s.idPrefix+\"sheetsettingstable\");\r\n   var celltable = document.getElementById(s.idPrefix+\"cellsettingstable\");\r\n   var sheettoolbar = document.getElementById(s.idPrefix+\"sheetsettingstoolbar\");\r\n   var celltoolbar = document.getElementById(s.idPrefix+\"cellsettingstoolbar\");\r\n   if (target==\"sheet\") {\r\n      sheettable.style.display = \"block\";\r\n      celltable.style.display = \"none\";\r\n      sheettoolbar.style.display = \"block\";\r\n      celltoolbar.style.display = \"none\";\r\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.sheetspanel);\r\n      }\r\n   else {\r\n      sheettable.style.display = \"none\";\r\n      celltable.style.display = \"block\";\r\n      sheettoolbar.style.display = \"none\";\r\n      celltoolbar.style.display = \"block\";\r\n      SocialCalc.SettingsControlSetCurrentPanel(s.views.settings.values.cellspanel);\r\n      }\r\n   }\r\n\r\nSocialCalc.SettingsControlSave = function(target) {\r\n   var range, cmdstr;\r\n   var s = SocialCalc.GetSpreadsheetControlObject();\r\n   var sc = SocialCalc.SettingsControls;\r\n   var panelobj = sc.CurrentPanel;\r\n   var attribs = SocialCalc.SettingsControlUnloadPanel(panelobj);\r\n\r\n   SocialCalc.SetTab(s.tabs[0].name); // return to first tab\r\n   SocialCalc.KeyboardFocus();\r\n\r\n   if (target==\"sheet\") {\r\n      cmdstr = s.sheet.DecodeSheetAttributes(attribs);\r\n      }\r\n   else if (target==\"cell\") {\r\n      if (s.editor.range.hasrange) {\r\n         range = SocialCalc.crToCoord(s.editor.range.left, s.editor.range.top) + \":\" +\r\n            SocialCalc.crToCoord(s.editor.range.right, s.editor.range.bottom);\r\n         }\r\n      cmdstr = s.sheet.DecodeCellAttributes(s.editor.ecell.coord, attribs, range);\r\n      }\r\n   else { // Cancel\r\n      }\r\n   if (cmdstr) {\r\n      s.editor.EditorScheduleSheetCommands(cmdstr, true, false);\r\n      }\r\n   }\r\n\r\n///////////////////////\r\n//\r\n// SAVE / LOAD ROUTINES\r\n//\r\n///////////////////////\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetControlCreateSpreadsheetSave(spreadsheet, otherparts)\r\n//\r\n// Saves the spreadsheet's sheet data, editor settings, and audit trail (redo stack).\r\n// The serialized data strings are concatenated together in multi-part MIME format.\r\n// The first part lists the types of the subsequent parts (e.g., \"sheet\", \"editor\", and \"audit\")\r\n// in this format:\r\n//   # comments\r\n//   version:1.0\r\n//   part:type1\r\n//   part:type2\r\n//   ...\r\n//\r\n// If otherparts is non-null, it is an object with:\r\n//   partname1: \"part contents - should end with \\n\",\r\n//   partname2: \"part contents - should end with \\n\"\r\n//\r\n\r\n\r\nSocialCalc.SpreadsheetControlCreateSpreadsheetSave = function(spreadsheet, otherparts) {\r\n\r\n   var result;\r\n\r\n   var otherpartsstr = \"\";\r\n   var otherpartsnames = \"\";\r\n   var partname, extranl;\r\n\r\n   if (otherparts) {\r\n      for (partname in otherparts) {\r\n         if (otherparts[partname].charAt(otherparts[partname]-1) != \"\\n\") {\r\n            extranl = \"\\n\";\r\n            }\r\n         else {\r\n            extranl = \"\";\r\n            }\r\n         otherpartsstr += \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n            otherparts[partname] + extranl;\r\n         otherpartsnames += \"part:\"+partname + \"\\n\";\r\n         }\r\n      }\r\n\r\n   result = \"socialcalc:version:1.0\\n\" +\r\n      \"MIME-Version: 1.0\\nContent-Type: multipart/mixed; boundary=\"+\r\n      spreadsheet.multipartBoundary + \"\\n\" +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      \"# SocialCalc Spreadsheet Control Save\\nversion:1.0\\npart:sheet\\npart:edit\\npart:audit\\n\" + otherpartsnames +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      spreadsheet.CreateSheetSave() +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      spreadsheet.editor.SaveEditorSettings() +\r\n      \"--\" + spreadsheet.multipartBoundary + \"\\nContent-type: text/plain; charset=UTF-8\\n\\n\" +\r\n      spreadsheet.sheet.CreateAuditString() +\r\n      otherpartsstr +\r\n      \"--\" + spreadsheet.multipartBoundary + \"--\\n\";\r\n\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n//\r\n// parts = SocialCalc.SpreadsheetControlDecodeSpreadsheetSave(spreadsheet, str)\r\n//\r\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\r\n//\r\n//    {type1: {start: startpos, end: endpos}, type2:...}\r\n//\r\n\r\nSocialCalc.SpreadsheetControlDecodeSpreadsheetSave = function(spreadsheet, str) {\r\n\r\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\r\n   var parts = {};\r\n   var partlist = [];\r\n\r\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\r\n   if (pos1 < 0) return parts;\r\n\r\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\r\n   mpregex.lastIndex = pos1;\r\n\r\n   searchinfo = mpregex.exec(str);\r\n   if (mpregex.lastIndex <= 0) return parts;\r\n   boundary = searchinfo[1];\r\n\r\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\r\n   boundaryregex.lastIndex = mpregex.lastIndex;\r\n\r\n   searchinfo = boundaryregex.exec(str); // find header top boundary\r\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\r\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\r\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\r\n   if (!searchinfo) return parts;\r\n   start = blanklineregex.lastIndex;\r\n   boundaryregex.lastIndex = start;\r\n   searchinfo = boundaryregex.exec(str); // find end of header\r\n   if (!searchinfo) return parts;\r\n   ending = searchinfo.index;\r\n\r\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\r\n   for (i=0;i<lines.length;i++) {\r\n      line=lines[i];\r\n      p = line.split(\":\");\r\n      switch (p[0]) {\r\n         case \"version\":\r\n            break;\r\n         case \"part\":\r\n            partlist.push(p[1]);\r\n            break;\r\n         }\r\n      }\r\n\r\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\r\n      blanklineregex.lastIndex = ending;\r\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\r\n      if (!searchinfo) return parts;\r\n      start = blanklineregex.lastIndex;\r\n      if (pnum==partlist.length-1) { // last one has different boundary\r\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\r\n         }\r\n      boundaryregex.lastIndex = start;\r\n      searchinfo = boundaryregex.exec(str); // find ending boundary\r\n      if (!searchinfo) return parts;\r\n      ending = searchinfo.index;\r\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\r\n      }\r\n\r\n   return parts;\r\n\r\n   }\r\n\r\n\r\n/*\r\n* SettingsControls\r\n*\r\n* Each settings panel has an object in the following form:\r\n*\r\n*    {ctrl-name1: {setting: setting-nameA, type: ctrl-type, id: id-component},\r\n*     ctrl-name2: {setting: setting-nameB, type: ctrl-type, id: id-component, initialdata: optional-initialdata-override},\r\n*     ...}\r\n*\r\n* The ctrl-types are names that correspond to:\r\n*\r\n*    SocialCalc.SettingsControls.Controls = {\r\n*       ctrl-type1: {\r\n*          SetValue: function(panel-obj, ctrl-name, {def: true/false, val: value}) {...;},\r\n*          ColorValues: if true, Onchanged converts between hex and RGB\r\n*          GetValue: function(panel-obj, ctrl-name) {...return {def: true/false, val: value};},\r\n*          Initialize: function(panel-obj, ctrl-name) {...;}, // used to fill dropdowns, etc.\r\n*          InitialData: control-dependent, // used by Initialize (if no panel ctrlname.initialdata)\r\n*          OnReset: function(ctrl-name) {...;}, // called to put down popups, etc.\r\n*          ChangedCallback: function(ctrl-name) {...;} // if not null, called by control when user changes value\r\n*       }\r\n*\r\n*/\r\n\r\nSocialCalc.SettingsControls = {\r\n   Controls: {},\r\n   CurrentPanel: null // panel object to search on events\r\n   };\r\n\r\n//\r\n// SocialCalc.SettingsControlSetCurrentPanel(panel-object)\r\n//\r\n\r\nSocialCalc.SettingsControlSetCurrentPanel = function(panelobj) {\r\n\r\n   SocialCalc.SettingsControls.CurrentPanel = panelobj;\r\n\r\n   SocialCalc.SettingsControls.PopupChangeCallback({panelobj: panelobj}, \"\", null);\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControlInitializePanel(panel-object)\r\n//\r\n\r\nSocialCalc.SettingsControlInitializePanel = function(panelobj) {\r\n\r\n   var ctrlname;\r\n   var sc = SocialCalc.SettingsControls;\r\n\r\n   for (ctrlname in panelobj) {\r\n      if (ctrlname==\"name\") continue;\r\n      ctrl = sc.Controls[panelobj[ctrlname].type];\r\n      if (ctrl && ctrl.Initialize) ctrl.Initialize(panelobj, ctrlname);\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControlLoadPanel(panel-object, attribs)\r\n//\r\n\r\nSocialCalc.SettingsControlLoadPanel = function(panelobj, attribs) {\r\n\r\n   var ctrlname;\r\n   var sc = SocialCalc.SettingsControls;\r\n\r\n   for (ctrlname in panelobj) {\r\n      if (ctrlname==\"name\") continue;\r\n      ctrl = sc.Controls[panelobj[ctrlname].type];\r\n      if (ctrl && ctrl.SetValue) ctrl.SetValue(panelobj, ctrlname, attribs[panelobj[ctrlname].setting]);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// attribs = SocialCalc.SettingsControlUnloadPanel(panel-object)\r\n//\r\n\r\nSocialCalc.SettingsControlUnloadPanel = function(panelobj) {\r\n\r\n   var ctrlname;\r\n   var sc = SocialCalc.SettingsControls;\r\n   var attribs = {};\r\n\r\n   for (ctrlname in panelobj) {\r\n      if (ctrlname==\"name\") continue;\r\n      ctrl = sc.Controls[panelobj[ctrlname].type];\r\n      if (ctrl && ctrl.GetValue) attribs[panelobj[ctrlname].setting] = ctrl.GetValue(panelobj, ctrlname);\r\n      }\r\n\r\n   return attribs;\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupChangeCallback\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupChangeCallback = function(attribs, id, value) {\r\n\r\n   var sc = SocialCalc.Constants;\r\n\r\n   var ele = document.getElementById(\"sample-text\");\r\n\r\n   if (!ele || !attribs || !attribs.panelobj) return;\r\n\r\n   var idPrefix = SocialCalc.CurrentSpreadsheetControlObject.idPrefix;\r\n\r\n   var c = attribs.panelobj.name == \"cell\" ? \"c\" : \"\";\r\n\r\n   var v, a, parts, str1, str2, i;\r\n\r\n   parts = sc.defaultCellLayout.match(/^padding.(\\S+) (\\S+) (\\S+) (\\S+).vertical.align.(\\S+);$/) || [];\r\n\r\n   var cv = {color: [\"textcolor\"], backgroundColor: [\"bgcolor\", \"#FFF\"],\r\n             fontSize: [\"fontsize\", sc.defaultCellFontSize], fontFamily: [\"fontfamily\"],\r\n             paddingTop: [\"padtop\", parts[1]], paddingRight: [\"padright\", parts[2]],\r\n             paddingBottom: [\"padbottom\", parts[3]], paddingLeft: [\"padleft\", parts[4]],\r\n             verticalAlign: [\"alignvert\", parts[5]]};\r\n\r\n   for (a in cv) {\r\n      v = SocialCalc.Popup.GetValue(idPrefix+c+cv[a][0]) || cv[a][1] || \"\";\r\n      ele.style[a] = v;\r\n      }\r\n\r\n   if (c==\"c\") {\r\n      cv = {borderTop: \"cbt\", borderRight: \"cbr\", borderBottom: \"cbb\", borderLeft: \"cbl\"};\r\n      for (a in cv) {\r\n         v = SocialCalc.SettingsControls.BorderSideGetValue(attribs.panelobj, cv[a]);\r\n         ele.style[a] = v ? (v.val || \"\") : \"\";\r\n         }\r\n      v = SocialCalc.Popup.GetValue(idPrefix+\"calignhoriz\");\r\n      ele.style.textAlign = v || \"left\";\r\n      ele.childNodes[1].style.textAlign = v || \"right\";\r\n      }\r\n   else {\r\n      ele.style.border = \"\";\r\n      v = SocialCalc.Popup.GetValue(idPrefix+\"textalignhoriz\");\r\n      ele.style.textAlign = v || \"left\";\r\n      v = SocialCalc.Popup.GetValue(idPrefix+\"numberalignhoriz\");\r\n      ele.childNodes[1].style.textAlign = v || \"right\";\r\n      }\r\n\r\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"fontlook\");\r\n   parts = v ? (v.match(/^(\\S+) (\\S+)$/) || []) : [];\r\n   ele.style.fontStyle = parts[1] || \"\";\r\n   ele.style.fontWeight = parts[2] || \"\";\r\n\r\n   v = SocialCalc.Popup.GetValue(idPrefix+c+\"formatnumber\") || \"General\";\r\n   str1 = SocialCalc.FormatNumber.formatNumberWithFormat(9.8765, v, \"\");\r\n   str2 = SocialCalc.FormatNumber.formatNumberWithFormat(-1234.5, v, \"\");\r\n   if (str2 != \"??-???-??&nbsp;??:??:??\") { // not bad date from negative number\r\n      str1 += \"<br>\"+str2;\r\n      }\r\n      \r\n   ele.childNodes[1].innerHTML = str1;\r\n\r\n   }\r\n\r\n//\r\n// PopupList Control\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListSetValue = function(panelobj, ctrlname, value) {\r\n\r\n   if (!value) {alert(ctrlname+\" no value\"); return;}\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   if (!value.def) {\r\n      sp.SetValue(panelobj[ctrlname].id, value.val);\r\n      }\r\n   else {\r\n      sp.SetValue(panelobj[ctrlname].id, \"\");\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupListGetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListGetValue = function(panelobj, ctrlname) {\r\n\r\n   var ctl = panelobj[ctrlname];\r\n   if (!ctl) return null;\r\n\r\n   var value = SocialCalc.Popup.GetValue(ctl.id);\r\n   if (value) {\r\n      return {def: false, val: value};\r\n      }\r\n   else {\r\n      return {def: true, val: 0};\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupListInitialize\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListInitialize = function(panelobj, ctrlname) {\r\n\r\n   var i, val, pos, otext;\r\n   var sc = SocialCalc.SettingsControls;\r\n   var initialdata = panelobj[ctrlname].initialdata || sc.Controls[panelobj[ctrlname].type].InitialData || \"\";\r\n   initialdata = SocialCalc.LocalizeSubstrings(initialdata);\r\n   var optionvals = initialdata.split(/\\|/);\r\n\r\n   var options = [];\r\n\r\n   for (i=0; i<(optionvals.length||0); i++) {\r\n      val = optionvals[i];\r\n      pos = val.indexOf(\":\");\r\n      otext = val.substring(0, pos);\r\n      if (otext.indexOf(\"\\\\\")!=-1) { // escape any colons\r\n         otext = otext.replace(/\\\\c/g,\":\");\r\n         otext = otext.replace(/\\\\b/g,\"\\\\\");\r\n\r\n         }\r\n      otext = SocialCalc.special_chars(otext);\r\n      if (otext == \"[custom]\") {\r\n         options[i] = {o: SocialCalc.Constants.s_PopupListCustom, v: val.substring(pos+1), a:{custom: true}};\r\n         }\r\n      else if (otext == \"[cancel]\") {\r\n         options[i] = {o: SocialCalc.Constants.s_PopupListCancel, v: \"\", a:{cancel: true}};\r\n         }\r\n      else if (otext == \"[break]\") {\r\n         options[i] = {o: \"-----\", v: \"\", a:{skip: true}};\r\n         }\r\n      else if (otext == \"[newcol]\") {\r\n         options[i] = {o: \"\", v: \"\", a:{newcol: true}};\r\n         }\r\n      else {\r\n         options[i] = {o: otext, v: val.substring(pos+1)};\r\n         }\r\n      }\r\n\r\n   SocialCalc.Popup.Create(\"List\", panelobj[ctrlname].id, {});\r\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id, \r\n      {options: options, \r\n       attribs:{changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControls.PopupListReset\r\n//\r\n\r\nSocialCalc.SettingsControls.PopupListReset = function(ctrlname) {\r\n\r\n   SocialCalc.Popup.Reset(\"List\");\r\n\r\n   }\r\n\r\nSocialCalc.SettingsControls.Controls.PopupList = {\r\n   SetValue: SocialCalc.SettingsControls.PopupListSetValue,\r\n   GetValue: SocialCalc.SettingsControls.PopupListGetValue,\r\n   Initialize: SocialCalc.SettingsControls.PopupListInitialize,\r\n   OnReset: SocialCalc.SettingsControls.PopupListReset,\r\n   ChangedCallback: null\r\n   }\r\n\r\n//\r\n// ColorChooser Control\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserSetValue = function(panelobj, ctrlname, value) {\r\n\r\n   if (!value) {alert(ctrlname+\" no value\"); return;}\r\n\r\n   var sp = SocialCalc.Popup;\r\n\r\n   if (!value.def) {\r\n      sp.SetValue(panelobj[ctrlname].id, value.val);\r\n      }\r\n   else {\r\n      sp.SetValue(panelobj[ctrlname].id, \"\");\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.ColorChooserGetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserGetValue = function(panelobj, ctrlname) {\r\n\r\n   var value = SocialCalc.Popup.GetValue(panelobj[ctrlname].id);\r\n   if (value) {\r\n      return {def: false, val: value};\r\n      }\r\n   else {\r\n      return {def: true, val: 0};\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.ColorChooserInitialize\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserInitialize = function(panelobj, ctrlname) {\r\n\r\n   var i, val, pos, otext;\r\n   var sc = SocialCalc.SettingsControls;\r\n\r\n   SocialCalc.Popup.Create(\"ColorChooser\", panelobj[ctrlname].id, {});\r\n   SocialCalc.Popup.Initialize(panelobj[ctrlname].id,\r\n      {attribs:{title: \"&nbsp;\", moveable: true, width: \"106px\",\r\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControls.ColorChooserReset\r\n//\r\n\r\nSocialCalc.SettingsControls.ColorChooserReset = function(ctrlname) {\r\n\r\n   SocialCalc.Popup.Reset(\"ColorChooser\");\r\n\r\n   }\r\n\r\nSocialCalc.SettingsControls.Controls.ColorChooser = {\r\n   SetValue: SocialCalc.SettingsControls.ColorChooserSetValue,\r\n   GetValue: SocialCalc.SettingsControls.ColorChooserGetValue,\r\n   Initialize: SocialCalc.SettingsControls.ColorChooserInitialize,\r\n   OnReset: SocialCalc.SettingsControls.ColorChooserReset,\r\n   ChangedCallback: null\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControls.BorderSideSetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.BorderSideSetValue = function(panelobj, ctrlname, value) {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var ele, found, idname, parts;\r\n   var idstart = panelobj[ctrlname].id;\r\n\r\n   if (!value) {alert(ctrlname+\" no value\"); return;}\r\n\r\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\r\n   if (!ele) return;\r\n\r\n   if (value.val) { // border does not use default: it looks only to the value currently\r\n      ele.checked = true;\r\n      ele.value = value.val;\r\n      parts = value.val.match(/(\\S+)\\s+(\\S+)\\s+(\\S.+)/);\r\n      idname = idstart+\"-color\";\r\n      SocialCalc.Popup.SetValue(idname, parts[3]);\r\n      SocialCalc.Popup.SetDisabled(idname, false);\r\n      }\r\n   else {\r\n      ele.checked = false;\r\n      ele.value = value.val;\r\n      idname = idstart+\"-color\";\r\n      SocialCalc.Popup.SetValue(idname, \"\");\r\n      SocialCalc.Popup.SetDisabled(idname, true);\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.BorderSideGetValue\r\n//\r\n\r\nSocialCalc.SettingsControls.BorderSideGetValue = function(panelobj, ctrlname) {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var ele, value;\r\n   var idstart = panelobj[ctrlname].id;\r\n\r\n   ele = document.getElementById(idstart+\"-onoff-bcb\"); // border checkbox\r\n   if (!ele) return;\r\n\r\n\r\n   if (ele.checked) { // on\r\n      value = SocialCalc.Popup.GetValue(idstart+\"-color\");\r\n      value = \"1px solid \" + (value || \"rgb(0,0,0)\");\r\n      return {def: false, val: value};\r\n      }\r\n   else { // off\r\n      return {def: false, val: \"\"};\r\n      }\r\n\r\n   }\r\n\r\n//\r\n// SocialCalc.SettingsControls.BorderSideInitialize\r\n//\r\n\r\nSocialCalc.SettingsControls.BorderSideInitialize = function(panelobj, ctrlname) {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var idstart = panelobj[ctrlname].id;\r\n\r\n   SocialCalc.Popup.Create(\"ColorChooser\", idstart+\"-color\", {});\r\n   SocialCalc.Popup.Initialize(idstart+\"-color\",\r\n      {attribs:{title: \"&nbsp;\", width: \"106px\", moveable: true,\r\n                changedcallback: SocialCalc.SettingsControls.PopupChangeCallback, panelobj: panelobj}});\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SettingsControlOnchangeBorder = function(ele)\r\n//\r\n\r\nSocialCalc.SettingsControlOnchangeBorder = function(ele) {\r\n\r\n   var idname, value, found, ele2;\r\n   var sc = SocialCalc.SettingsControls;\r\n   var panelobj = sc.CurrentPanel;\r\n\r\n   var nameparts = ele.id.match(/(^.*\\-)(\\w+)\\-(\\w+)\\-(\\w+)$/);\r\n   if (!nameparts) return;\r\n   var prefix = nameparts[1];\r\n   var ctrlname = nameparts[2];\r\n   var ctrlsubid = nameparts[3]\r\n   var ctrlidsuffix = nameparts[4];\r\n   var ctrltype = panelobj[ctrlname].type;\r\n\r\n   switch (ctrlidsuffix) {\r\n      case \"bcb\": // border checkbox\r\n         if (ele.checked) {\r\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: ele.value || \"1px solid rgb(0,0,0)\"});\r\n            }\r\n         else {\r\n            sc.Controls[ctrltype].SetValue(sc.CurrentPanel, ctrlname, {def: false, val: \"\"});\r\n            }\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\nSocialCalc.SettingsControls.Controls.BorderSide = {\r\n   SetValue: SocialCalc.SettingsControls.BorderSideSetValue,\r\n   GetValue: SocialCalc.SettingsControls.BorderSideGetValue,\r\n   OnClick: SocialCalc.SettingsControls.ColorComboOnClick,\r\n   Initialize: SocialCalc.SettingsControls.BorderSideInitialize,\r\n   InitialData: {thickness: \"1 pixel:1px\", style: \"Solid:solid\"},\r\n   ChangedCallback: null\r\n   }\r\n\r\n\r\nSocialCalc.SettingControlReset = function() {\r\n\r\n   var sc = SocialCalc.SettingsControls;\r\n   var ctrlname;\r\n\r\n   for (ctrlname in sc.Controls) {\r\n      if (sc.Controls[ctrlname].OnReset) sc.Controls[ctrlname].OnReset(ctrlname);\r\n      }\r\n   }\r\n\r\n\r\n/**********************\r\n*\r\n* CtrlSEditor implementation for editing SocialCalc.OtherSaveParts\r\n*\r\n*/\r\n\r\nSocialCalc.OtherSaveParts = {}; // holds other parts to save - must be set when loaded if you want to keep\r\n\r\nSocialCalc.CtrlSEditor = function(whichpart) {\r\n\r\n   var strtoedit, partname;\r\n   if (whichpart.length > 0) {\r\n      strtoedit = SocialCalc.special_chars(SocialCalc.OtherSaveParts[whichpart] || \"\");\r\n      }\r\n   else {\r\n      strtoedit = \"Listing of Parts\\n\";\r\n      for (partname in SocialCalc.OtherSaveParts) {\r\n         strtoedit += SocialCalc.special_chars(\"\\nPart: \"+partname+\"\\n=====\\n\"+SocialCalc.OtherSaveParts[partname]+\"\\n\");\r\n         }\r\n      }\r\n   var editbox = document.createElement(\"div\");\r\n   editbox.style.cssText = \"position:absolute;z-index:500;width:300px;height:300px;left:100px;top:200px;border:1px solid black;background-color:#EEE;text-align:center;\";\r\n   editbox.id = \"socialcalc-editbox\";\r\n   editbox.innerHTML = whichpart+'<br><br><textarea id=\"socialcalc-editbox-textarea\" style=\"width:250px;height:200px;\">'+\r\n      strtoedit + '</textarea><br><br><input type=button ' +\r\n      'onclick=\"SocialCalc.CtrlSEditorDone (\\'socialcalc-editbox\\', \\''+whichpart+'\\');\" value=\"OK\">';\r\n   document.body.appendChild(editbox);\r\n\r\n   var ebta = document.getElementById(\"socialcalc-editbox-textarea\");\r\n   ebta.focus();\r\n   SocialCalc.CmdGotFocus(ebta);\r\n\r\n   }\r\n\r\nSocialCalc.CtrlSEditorDone = function(idprefix, whichpart) {\r\n\r\n   var edittextarea = document.getElementById(idprefix+\"-textarea\");\r\n   var text = edittextarea.value;\r\n   if (whichpart.length > 0) {\r\n      if (text.length > 0) {\r\n         SocialCalc.OtherSaveParts[whichpart] = text;\r\n         }\r\n      else {\r\n         delete SocialCalc.OtherSaveParts[whichpart];\r\n         }\r\n      }\r\n\r\n   var editbox = document.getElementById(idprefix);\r\n   SocialCalc.KeyboardFocus();\r\n   editbox.parentNode.removeChild(editbox);\r\n\r\n   }\r\n\r\n","//\r\n// SocialCalcViewer\r\n//\r\n/*\r\n// The code module of the SocialCalc package that lets you embed a spreadsheet viewer\r\n// with an optional simple toolbar into a web page.\r\n//\r\n// (c) Copyright 2008, 2009, 2010 Socialtext, Inc.\r\n// All Rights Reserved.\r\n//\r\n*/\r\n\r\n/*\r\n\r\nLEGAL NOTICES REQUIRED BY THE COMMON PUBLIC ATTRIBUTION LICENSE:\r\n\r\nEXHIBIT A. Common Public Attribution License Version 1.0.\r\n\r\nThe contents of this file are subject to the Common Public Attribution License Version 1.0 (the \r\n\"License\"); you may not use this file except in compliance with the License. You may obtain a copy \r\nof the License at http://socialcalc.org. The License is based on the Mozilla Public License Version 1.1 but \r\nSections 14 and 15 have been added to cover use of software over a computer network and provide for \r\nlimited attribution for the Original Developer. In addition, Exhibit A has been modified to be \r\nconsistent with Exhibit B.\r\n\r\nSoftware distributed under the License is distributed on an \"AS IS\" basis, WITHOUT WARRANTY OF ANY \r\nKIND, either express or implied. See the License for the specific language governing rights and \r\nlimitations under the License.\r\n\r\nThe Original Code is SocialCalc JavaScript SpreadsheetViewer.\r\n\r\nThe Original Developer is the Initial Developer.\r\n\r\nThe Initial Developer of the Original Code is Socialtext, Inc. All portions of the code written by \r\nSocialtext, Inc., are Copyright (c) Socialtext, Inc. All Rights Reserved.\r\n\r\nContributor: Dan Bricklin.\r\n\r\n\r\nEXHIBIT B. Attribution Information\r\n\r\nWhen the SpreadsheetViewer is producing and/or controlling the display the Graphic Image must be\r\ndisplayed on the screen visible to the user in a manner comparable to that in the \r\nOriginal Code. The Attribution Phrase must be displayed as a \"tooltip\" or \"hover-text\" for\r\nthat image. The image must be linked to the Attribution URL so as to access that page\r\nwhen clicked. If the user interface includes a prominent \"about\" display which includes\r\nfactual prominent attribution in a form similar to that in the \"about\" display included\r\nwith the Original Code, including Socialtext copyright notices and URLs, then the image\r\nneed not be linked to the Attribution URL but the \"tool-tip\" is still required.\r\n\r\nAttribution Copyright Notice:\r\n\r\n Copyright (C) 2010 Socialtext, Inc.\r\n All Rights Reserved.\r\n\r\nAttribution Phrase (not exceeding 10 words): SocialCalc\r\n\r\nAttribution URL: http://www.socialcalc.org/\r\n\r\nGraphic Image: The contents of the sc-logo.gif file in the Original Code or\r\na suitable replacement from http://www.socialcalc.org/licenses specified as\r\nbeing for SocialCalc.\r\n\r\nDisplay of Attribution Information is required in Larger Works which are defined \r\nin the CPAL as a work which combines Covered Code or portions thereof with code \r\nnot governed by the terms of the CPAL.\r\n\r\n*/\r\n\r\n//\r\n// Some of the other files in the SocialCalc package are licensed under\r\n// different licenses. Please note the licenses of the modules you use.\r\n//\r\n// Code History:\r\n//\r\n// Initially coded by Dan Bricklin of Software Garden, Inc., for Socialtext, Inc.\r\n// Unless otherwise specified, referring to \"SocialCalc\" in comments refers to this\r\n// JavaScript version of the code, not the SocialCalc Perl code.\r\n//\r\n\r\n/*\r\n\r\nSee the comments in the main SocialCalc code module file of the SocialCalc package.\r\n\r\n*/\r\n\r\n   var SocialCalc;\r\n   if (!SocialCalc) {\r\n      alert(\"Main SocialCalc code module needed\");\r\n      SocialCalc = {};\r\n      }\r\n   if (!SocialCalc.TableEditor) {\r\n      alert(\"SocialCalc TableEditor code module needed\");\r\n      }\r\n\r\n// *************************************\r\n//\r\n// SpreadsheetViewer class:\r\n//\r\n// *************************************\r\n\r\n// Global constants:\r\n\r\n   SocialCalc.CurrentSpreadsheetViewerObject = null; // right now there can only be one active at a time\r\n\r\n\r\n// Constructor:\r\n\r\nSocialCalc.SpreadsheetViewer = function(idPrefix) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n\r\n   // Properties:\r\n\r\n   this.parentNode = null;\r\n   this.spreadsheetDiv = null;\r\n   this.requestedHeight = 0;\r\n   this.requestedWidth = 0;\r\n   this.requestedSpaceBelow = 0;\r\n   this.height = 0;\r\n   this.width = 0;\r\n   this.viewheight = 0; // calculated amount for views below toolbar, etc.\r\n\r\n   // Dynamic properties:\r\n\r\n   this.sheet = null;\r\n   this.context = null;\r\n   this.editor = null;\r\n\r\n   this.spreadsheetDiv = null;\r\n   this.editorDiv = null;\r\n\r\n   this.sortrange = \"\"; // remembered range for sort tab\r\n\r\n   // Constants:\r\n\r\n   this.idPrefix = idPrefix || \"SocialCalc-\"; // prefix added to element ids used here, should end in \"-\"\r\n   this.imagePrefix = scc.defaultImagePrefix; // prefix added to img src\r\n\r\n   this.statuslineheight = scc.SVStatuslineheight; // in pixels\r\n   this.statuslineCSS = scc.SVStatuslineCSS;\r\n\r\n   // Callbacks:\r\n\r\n   // Initialization Code:\r\n\r\n   this.sheet = new SocialCalc.Sheet();\r\n   this.context = new SocialCalc.RenderContext(this.sheet);\r\n   // eddy SpreadsheetViewer {\r\n   if(SocialCalc._app == true || SocialCalc._view == true) scc.defaultImagePrefix = this.imagePrefix = \"../\"+ this.imagePrefix;\r\n   if(SocialCalc._app == true) {\r\n     this.context.showGrid= false; \r\n     this.context.showRCHeaders= false;\r\n     this.context.highlightTypes.range.style = \"\"; // no cell highlighting in app mode\r\n     \r\n     // Loading Message - add to cell A1 - shows when app is loading a large sheet or from a slow server\r\n     this.context.sheetobj.cells[\"A1\"] = new SocialCalc.Cell(\"A1\");\r\n     this.context.sheetobj.cells[\"A1\"].displaystring = \"Loading ... \"; // will display until recalc issues a render request - auto reset by recalc on load\r\n     \r\n   } else {\r\n     this.context.showGrid= true; \r\n     this.context.showRCHeaders= true;     \r\n   }\r\n   // } SpreadsheetViewer\r\n   this.editor = new SocialCalc.TableEditor(this.context);\r\n   this.editor.noEdit = true;\r\n   this.editor.StatusCallback.statusline =\r\n      {func: SocialCalc.SpreadsheetViewerStatuslineCallback,\r\n       params: {}};\r\n   this.hasStatusLine = true; // default\r\n//   this.statuslineHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td width=\"100%\" style=\"overflow:hidden;\">{status}</td><td><a href=\"\">Will&nbsp;be&nbsp;link</a></td></tr></table>';\r\n   this.statuslineHTML = '<table cellspacing=\"0\" cellpadding=\"0\"><tr><td width=\"100%\" style=\"overflow:hidden;\">{status}</td><td>&nbsp;</td></tr></table>';\r\n   this.statuslineFull = true;\r\n   this.noRecalc = true; // don't do a recalc when loaded, so no need for external sheet routines\r\n\r\n   // Repeating macro info\r\n\r\n   this.repeatingMacroTimer = null;\r\n   this.repeatingMacroInterval = 60; // default to 60 seconds\r\n   this.repeatingMacroCommands = \"\"; // what to execute\r\n\r\n\r\n   SocialCalc.CurrentSpreadsheetViewerObject = this; // remember this for rendezvousing on events\r\n\r\n   return;\r\n\r\n   }\r\n\r\n// Methods:\r\n\r\nSocialCalc.SpreadsheetViewer.prototype.InitializeSpreadsheetViewer =\r\n   function(node, height, width, spacebelow) {return SocialCalc.InitializeSpreadsheetViewer(this, node, height, width, spacebelow);};\r\nSocialCalc.SpreadsheetViewer.prototype.LoadSave = function(str) {return SocialCalc.SpreadsheetViewerLoadSave(this, str);};\r\nSocialCalc.SpreadsheetViewer.prototype.DoOnResize = function() {return SocialCalc.DoOnResize(this);};\r\nSocialCalc.SpreadsheetViewer.prototype.SizeSSDiv = function() {return SocialCalc.SizeSSDiv(this);};\r\nSocialCalc.SpreadsheetViewer.prototype.DecodeSpreadsheetSave = \r\n   function(str) {return SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(this, str);};\r\n\r\n// Sheet Methods to make things a little easier:\r\n\r\nSocialCalc.SpreadsheetViewer.prototype.ParseSheetSave = function(str) {return this.sheet.ParseSheetSave(str);};\r\n\r\n\r\n// Functions:\r\n\r\n//\r\n// InitializeSpreadsheetViewer(spreadsheet, node, height, width, spacebelow)\r\n//\r\n// Creates the control elements and makes them the child of node (string or element).\r\n// If present, height and width specify size.\r\n// If either is 0 or null (missing), the maximum that fits on the screen\r\n// (taking spacebelow into account) is used.\r\n//\r\n// You should do a redisplay or recalc (which redisplays) after running this.\r\n//\r\n\r\nSocialCalc.InitializeSpreadsheetViewer = function(spreadsheet, node, height, width, spacebelow) {\r\n\r\n   var scc = SocialCalc.Constants;\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n   var SCLocSS = SocialCalc.LocalizeSubstrings;\r\n\r\n   var html, child, i, vname, v, style, button, bele;\r\n   var tabs = spreadsheet.tabs;\r\n   var views = spreadsheet.views;\r\n\r\n   spreadsheet.requestedHeight = height;\r\n   spreadsheet.requestedWidth = width;\r\n   spreadsheet.requestedSpaceBelow = spacebelow;\r\n\r\n   if (typeof node == \"string\") node = document.getElementById(node);\r\n\r\n   if (node == null) {\r\n      alert(\"SocialCalc.SpreadsheetControl not given parent node.\");\r\n      }\r\n\r\n   spreadsheet.parentNode = node;\r\n\r\n   // create node to hold spreadsheet view\r\n\r\n   spreadsheet.spreadsheetDiv = document.createElement(\"div\");\r\n\r\n   spreadsheet.SizeSSDiv(); // calculate and fill in the size values\r\n\r\n   for (child=node.firstChild; child!=null; child=node.firstChild) {\r\n      node.removeChild(child);\r\n      }\r\n\r\n   node.appendChild(spreadsheet.spreadsheetDiv);\r\n\r\n   // create sheet div\r\n\r\n   spreadsheet.nonviewheight = spreadsheet.hasStatusLine ? spreadsheet.statuslineheight : 0;\r\n   spreadsheet.viewheight = spreadsheet.height-spreadsheet.nonviewheight;\r\n   spreadsheet.editorDiv=spreadsheet.editor.CreateTableEditor(spreadsheet.width, spreadsheet.viewheight);\r\n\r\n   spreadsheet.spreadsheetDiv.appendChild(spreadsheet.editorDiv);\r\n\r\n   // create statusline\r\n\r\n   if (spreadsheet.hasStatusLine) {\r\n      spreadsheet.statuslineDiv = document.createElement(\"div\");\r\n      spreadsheet.statuslineDiv.style.cssText = spreadsheet.statuslineCSS;\r\n      spreadsheet.statuslineDiv.style.height = spreadsheet.statuslineheight -\r\n         (spreadsheet.statuslineDiv.style.paddingTop.slice(0,-2)-0) -\r\n         (spreadsheet.statuslineDiv.style.paddingBottom.slice(0,-2)-0) + \"px\";\r\n      spreadsheet.statuslineDiv.id = spreadsheet.idPrefix+\"statusline\";\r\n      spreadsheet.spreadsheetDiv.appendChild(spreadsheet.statuslineDiv);\r\n      spreadsheet.editor.StatusCallback.statusline =\r\n         {func: SocialCalc.SpreadsheetViewerStatuslineCallback,\r\n          params: {spreadsheetobj:spreadsheet}};\r\n      }\r\n\r\n   // eddy InitializeSpreadsheetViewer {\r\n   if(SocialCalc._app == true) {\r\n     spreadsheet.formDataViewer = new SocialCalc.SpreadsheetViewer(\"te_FormData-\");\r\n     // remove callback to stop drawing of table.\r\n     spreadsheet.formDataViewer.sheet.statuscallback = null;\r\n     // setup app viewer object\r\n     SocialCalc.CurrentSpreadsheetViewerObject = spreadsheet;\r\n   }\r\n   \r\n   // done - refresh screen needed\r\n\r\n   return;\r\n\r\n   }\r\n\r\nSocialCalc.SpreadsheetViewerLoadSave = function(spreadsheet, savestr) {\r\n\r\n   var rmstr, pos, t, t2;\r\n\r\n   var parts = spreadsheet.DecodeSpreadsheetSave(savestr);\r\n   if (parts) {\r\n      if (parts.sheet) {\r\n         spreadsheet.sheet.ResetSheet();\r\n         spreadsheet.sheet.ParseSheetSave(savestr.substring(parts.sheet.start, parts.sheet.end));\r\n         }\r\n      if (parts.edit) {\r\n         spreadsheet.editor.LoadEditorSettings(savestr.substring(parts.edit.start, parts.edit.end));\r\n         }\r\n      if (parts.startupmacro) { // executed now\r\n         spreadsheet.editor.EditorScheduleSheetCommands(savestr.substring(parts.startupmacro.start, parts.startupmacro.end), false, true);\r\n         }\r\n      if (parts.repeatingmacro) { // first line tells how many seconds before first execution. Last cmd must be \"cmdextension repeatmacro delay\" to continue repeating.\r\n         rmstr = savestr.substring(parts.repeatingmacro.start, parts.repeatingmacro.end);\r\n         rmstr = rmstr.replace(\"\\r\", \"\"); // make sure no CR, only LF\r\n         pos = rmstr.indexOf(\"\\n\");\r\n         if (pos > 0) {\r\n            t = rmstr.substring(0, pos)-0; // get number\r\n            t2 = t;\r\n//            if (!(t > 0)) t = 60; // handles NAN, too\r\n            spreadsheet.repeatingMacroInterval = t;\r\n            spreadsheet.repeatingMacroCommands = rmstr.substring(pos+1);\r\n            if (t2 > 0) { // zero means don't start yet\r\n               spreadsheet.repeatingMacroTimer = window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro, spreadsheet.repeatingMacroInterval * 1000);\r\n               }\t\r\n            }\r\n         }\r\n      }\r\n   if (spreadsheet.editor.context.sheetobj.attribs.recalc==\"off\" || spreadsheet.noRecalc) {\r\n      spreadsheet.editor.ScheduleRender();\r\n      }\r\n   else {\r\n      spreadsheet.editor.EditorScheduleSheetCommands(\"recalc\");\r\n      }\r\n   }\r\n\r\n//\r\n// SocialCalc.SpreadsheetViewerDoRepeatingMacro\r\n//\r\n// Called by a timer. Executes repeatingMacroCommands once.\r\n// Use the \"startcmdextension repeatmacro delay\" command last to schedule this again.\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerDoRepeatingMacro = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   spreadsheet.repeatingMacroTimer = null;\r\n\r\n   SocialCalc.SheetCommandInfo.CmdExtensionCallbacks.repeatmacro = {func:SocialCalc.SpreadsheetViewerRepeatMacroCommand, data:null};\r\n\r\n   editor.EditorScheduleSheetCommands(spreadsheet.repeatingMacroCommands);\r\n\r\n}\r\n\r\nSocialCalc.SpreadsheetViewerRepeatMacroCommand = function(name, data, sheet, cmd, saveundo) {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n\r\n   var rest = cmd.RestOfString();\r\n   var t = rest-0; // get number\r\n   if (!(t > 0)) t = spreadsheet.repeatingMacroInterval; // handles NAN, too, using last value\r\n   spreadsheet.repeatingMacroInterval = t;\r\n\r\n   spreadsheet.repeatingMacroTimer = window.setTimeout(SocialCalc.SpreadsheetViewerDoRepeatingMacro, spreadsheet.repeatingMacroInterval * 1000);\r\n\r\n}\r\n\r\nSocialCalc.SpreadsheetViewerStopRepeatingMacro = function() {\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n\r\n   if (spreadsheet.repeatingMacroTimer) {\r\n      window.clearTimeout(spreadsheet.repeatingMacroTimer);\r\n      spreadsheet.repeatingMacroTimer = null;\r\n      }\r\n}\r\n\r\n//\r\n// SocialCalc.SpreadsheetViewerDoButtonCmd(e, buttoninfo, bobj)\r\n//\r\n// xxx\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerDoButtonCmd = function(e, buttoninfo, bobj) {\r\n\r\n   var obj = bobj.element;\r\n   var which = bobj.functionobj.command;\r\n\r\n   var spreadsheet = SocialCalc.GetSpreadsheetViewerObject();\r\n   var editor = spreadsheet.editor;\r\n\r\n   switch (which) {\r\n      case \"recalc\":\r\n         editor.EditorScheduleSheetCommands(\"recalc\");\r\n         break;\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   if (obj && obj.blur) obj.blur();\r\n   SocialCalc.KeyboardFocus();   \r\n\r\n   }\r\n\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeString(str)\r\n//\r\n// SocialCalc function to make localization easier.\r\n// If str is \"Text to localize\", it returns\r\n// SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., \"A & B\"\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n//\r\n\r\nSocialCalc.LocalizeString = function(str) {\r\n   var cstr = SocialCalc.LocalizeStringList[str]; // found already this session?\r\n   if (!cstr) { // no - look up\r\n      cstr = SocialCalc.Constants[\"s_loc_\"+str.toLowerCase().replace(/\\s/g, \"_\").replace(/\\W/g, \"X\")] || str;\r\n      SocialCalc.LocalizeStringList[str] = cstr;\r\n      }\r\n   return cstr;\r\n   }\r\n\r\nSocialCalc.LocalizeStringList = {}; // a list of strings to localize accumulated by the routine\r\n\r\n//\r\n// outstr = SocialCalc.LocalizeSubstrings(str)\r\n//\r\n// SocialCalc function to make localization easier using %loc and %scc.\r\n//\r\n// Replaces sections of str with:\r\n//    %loc!Text to localize!\r\n// with SocialCalc.Constants.s_loc_text_to_localize if\r\n// it exists, or else with just \"Text to localize\".\r\n// Note that spaces are replaced with \"_\" and other special\r\n// chars with \"X\" in the name of the constant (e.g., %loc!A & B!\r\n// would look for SocialCalc.Constants.s_loc_a_X_b.\r\n// Uses SocialCalc.LocalizeString for this.\r\n//\r\n// Replaces sections of str with:\r\n//    %ssc!constant-name!\r\n// with SocialCalc.Constants.constant-name.\r\n// If the constant doesn't exist, throws and alert.\r\n//\r\n\r\nSocialCalc.LocalizeSubstrings = function(str) {\r\n\r\n   var SCLoc = SocialCalc.LocalizeString;\r\n\r\n   return str.replace(/%(loc|ssc)!(.*?)!/g, function(a, t, c) {\r\n      if (t==\"ssc\") {\r\n         return SocialCalc.Constants[c] || alert(\"Missing constant: \"+c);\r\n         }\r\n      else {\r\n         return SCLoc(c);\r\n         }\r\n      });\r\n\r\n   }\r\n\r\n//\r\n// obj = GetSpreadsheetViewerObject()\r\n//\r\n// Returns the current spreadsheet view object\r\n//\r\n\r\nSocialCalc.GetSpreadsheetViewerObject = function() {\r\n\r\n   var csvo = SocialCalc.CurrentSpreadsheetViewerObject;\r\n   if (csvo) return csvo;\r\n\r\n   throw (\"No current SpreadsheetViewer object.\");\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.DoOnResize(spreadsheet)\r\n//\r\n// Processes an onResize event, setting the different views.\r\n//\r\n\r\nSocialCalc.DoOnResize = function(spreadsheet) {\r\n\r\n   var v;\r\n   var views = spreadsheet.views;\r\n\r\n   var needresize = spreadsheet.SizeSSDiv();\r\n   if (!needresize) return;\r\n\r\n   for (vname in views) {\r\n      v = views[vname].element;\r\n      v.style.width = spreadsheet.width + \"px\";\r\n      v.style.height = (spreadsheet.height-spreadsheet.nonviewheight) + \"px\";\r\n      }\r\n\r\n   if(SocialCalc._app) return; // app has no scroll bars and keep normal HTML style page scroll - for mobile\r\n   spreadsheet.editor.ResizeTableEditor(spreadsheet.width, spreadsheet.height-spreadsheet.nonviewheight);\r\n\r\n   }\r\n\r\n\r\n//\r\n// resized = SocialCalc.SizeSSDiv(spreadsheet)\r\n//\r\n// Figures out a reasonable size for the spreadsheet, given any requested values and viewport.\r\n// Sets ssdiv to that.\r\n// Return true if different than existing values.\r\n//\r\n\r\nSocialCalc.SizeSSDiv = function(spreadsheet) {\r\n\r\n   var sizes, pos, resized, nodestyle, newval;\r\n   var fudgefactorX = 10; // for IE\r\n   var fudgefactorY = 10;\r\n\r\n   resized = false;\r\n\r\n   sizes = SocialCalc.GetViewportInfo();\r\n   pos = SocialCalc.GetElementPosition(spreadsheet.parentNode);\r\n   pos.bottom = 0;\r\n   pos.right = 0;\r\n\r\n   nodestyle = spreadsheet.parentNode.style;\r\n\r\n   if (nodestyle.marginTop) {\r\n      pos.top += nodestyle.marginTop.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginBottom) {\r\n      pos.bottom += nodestyle.marginBottom.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginLeft) {\r\n      pos.left += nodestyle.marginLeft.slice(0,-2)-0;\r\n      }\r\n   if (nodestyle.marginRight) {\r\n      pos.right += nodestyle.marginRight.slice(0,-2)-0;\r\n      }\r\n\r\n   newval = spreadsheet.requestedHeight ||\r\n            sizes.height - (pos.top + pos.bottom + fudgefactorY) -\r\n               (spreadsheet.requestedSpaceBelow || 0);\r\n   if (spreadsheet.height != newval) {\r\n      spreadsheet.height = newval;\r\n      spreadsheet.spreadsheetDiv.style.height = newval + \"px\";\r\n      resized = true;\r\n      }\r\n   newval = spreadsheet.requestedWidth ||\r\n            sizes.width - (pos.left + pos.right + fudgefactorX) || 700;\r\n   if (spreadsheet.width != newval) {\r\n      spreadsheet.width = newval;\r\n      spreadsheet.spreadsheetDiv.style.width = newval + \"px\";\r\n      resized = true;\r\n      }\r\n\r\n   spreadsheet.spreadsheetDiv.style.position = \"relative\";\r\n\r\n   return resized;\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.SpreadsheetViewerStatuslineCallback\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerStatuslineCallback = function(editor, status, arg, params) {\r\n\r\n   var spreadsheet = params.spreadsheetobj;\r\n   var slstr = \"\";\r\n\r\n   if (spreadsheet && spreadsheet.statuslineDiv) {\r\n      if (spreadsheet.statuslineFull) {\r\n         slstr = editor.GetStatuslineString(status, arg, params);\r\n         }\r\n      else {\r\n         slstr = editor.ecell.coord;\r\n         }\r\n      slstr = spreadsheet.statuslineHTML.replace(/\\{status\\}/, slstr);\r\n      spreadsheet.statuslineDiv.innerHTML = slstr;\r\n      }\r\n\r\n   switch (status) {\r\n      case \"cmdendnorender\":\r\n      case \"calcfinished\":\r\n      case \"doneposcalc\":\r\n         break; // not updating Recalc button since no toolbar\r\n\r\n      default:\r\n         break;\r\n      }\r\n\r\n   }\r\n\r\n\r\n//\r\n// SocialCalc.CmdGotFocus(obj)\r\n//\r\n// Sets SocialCalc.Keyboard.passThru: obj should be element with focus or \"true\"\r\n//\r\n\r\nSocialCalc.CmdGotFocus = function(obj) {\r\n\r\n   SocialCalc.Keyboard.passThru = obj;\r\n\r\n   }\r\n\r\n\r\n//\r\n// result = SocialCalc.SpreadsheetViewerCreateSheetHTML(spreadsheet)\r\n//\r\n// Returns the HTML representation of the whole spreadsheet\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerCreateSheetHTML = function(spreadsheet) {\r\n\r\n   var context, div, ele;\r\n\r\n   var result = \"\";\r\n\r\n   context = new SocialCalc.RenderContext(spreadsheet.sheet);\r\n   div = document.createElement(\"div\");\r\n   ele = context.RenderSheet(null, {type: \"html\"});\r\n   div.appendChild(ele);\r\n   delete context;\r\n   result = div.innerHTML;\r\n   delete ele;\r\n   delete div;\r\n   return result;\r\n\r\n   }\r\n\r\n\r\n///////////////////////\r\n//\r\n// LOAD ROUTINE\r\n//\r\n///////////////////////\r\n\r\n//\r\n// parts = SocialCalc.SpreadsheetViewerDecodeSpreadsheetSave(spreadsheet, str)\r\n//\r\n// Separates the parts from a spreadsheet save string, returning an object with the sub-strings.\r\n//\r\n//    {type1: {start: startpos, end: endpos}, type2:...}\r\n//\r\n\r\nSocialCalc.SpreadsheetViewerDecodeSpreadsheetSave = function(spreadsheet, str) {\r\n\r\n   var pos1, mpregex, searchinfo, boundary, boundaryregex, blanklineregex, start, ending, lines, i, lines, p, pnun;\r\n   var parts = {};\r\n   var partlist = [];\r\n\r\nvar hasreturnonly = /[^\\n]\\r[^\\n]/;\r\nif (hasreturnonly.test(str)) {\r\nstr = str.replace(/([^\\n])\\r([^\\n])/g, \"$1\\r\\n$2\");\r\n}\r\n   pos1 = str.search(/^MIME-Version:\\s1\\.0/mi);\r\n   if (pos1 < 0) return parts;\r\n\r\n   mpregex = /^Content-Type:\\s*multipart\\/mixed;\\s*boundary=(\\S+)/mig;\r\n   mpregex.lastIndex = pos1;\r\n\r\n   searchinfo = mpregex.exec(str);\r\n   if (mpregex.lastIndex <= 0) return parts;\r\n   boundary = searchinfo[1];\r\n\r\n   boundaryregex = new RegExp(\"^--\"+boundary+\"(?:\\r\\n|\\n)\", \"mg\");\r\n   boundaryregex.lastIndex = mpregex.lastIndex;\r\n\r\n   searchinfo = boundaryregex.exec(str); // find header top boundary\r\n   blanklineregex = /(?:\\r\\n|\\n)(?:\\r\\n|\\n)/gm;\r\n   blanklineregex.lastIndex = boundaryregex.lastIndex;\r\n   searchinfo = blanklineregex.exec(str); // skip to after blank line\r\n   if (!searchinfo) return parts;\r\n   start = blanklineregex.lastIndex;\r\n   boundaryregex.lastIndex = start;\r\n   searchinfo = boundaryregex.exec(str); // find end of header\r\n   if (!searchinfo) return parts;\r\n   ending = searchinfo.index;\r\n\r\n   lines = str.substring(start, ending).split(/\\r\\n|\\n/); // get header as lines\r\n   for (i=0;i<lines.length;i++) {\r\n      line=lines[i];\r\n      p = line.split(\":\");\r\n      switch (p[0]) {\r\n         case \"version\":\r\n            break;\r\n         case \"part\":\r\n            partlist.push(p[1]);\r\n            break;\r\n         }\r\n      }\r\n\r\n   for (pnum=0; pnum<partlist.length; pnum++) { // get each part\r\n      blanklineregex.lastIndex = ending;\r\n      searchinfo = blanklineregex.exec(str); // find blank line ending mime-part header\r\n      if (!searchinfo) return parts;\r\n      start = blanklineregex.lastIndex;\r\n      if (pnum==partlist.length-1) { // last one has different boundary\r\n         boundaryregex = new RegExp(\"^--\"+boundary+\"--$\", \"mg\");\r\n         }\r\n      boundaryregex.lastIndex = start;\r\n      searchinfo = boundaryregex.exec(str); // find ending boundary\r\n      if (!searchinfo) return parts;\r\n      ending = searchinfo.index;\r\n      parts[partlist[pnum]] = {start: start, end: ending}; // return position within full string\r\n      }\r\n\r\n   return parts;\r\n\r\n   }\r\n\r\n\r\n// END OF FILE\r\n\r\n","(function() {\r\n\r\nClass = function(classDefinition, classWrapper) {\r\n    if (!classDefinition) throw(\"Class requires a class definition string as its first argument\");\r\n    if (!classWrapper) throw(\"Class requires a class wrapper function as its second argument\");\r\n\r\n    if (! classDefinition.match(/^([\\w\\.]+)(?:\\(\\s*([\\w\\.]+)\\s*\\))?(?:\\s+(.*?)\\s*)?$/))\r\n        throw(\"Can't parse Class Definition: '\" + classDefinition + \"'\");\r\n    var className = RegExp.$1;\r\n    var baseClassName = RegExp.$2 || '';\r\n    var options = [];\r\n    if (RegExp.$3) {\r\n        options = RegExp.$3.split(/\\s+/);\r\n    }\r\n    var incValues = [];\r\n    var strict = true;\r\n    for (var i = 0, l = options.length; i < l; i++) {\r\n        var option = options[i];\r\n        if (option == '-nostrict') {\r\n            strict = false;\r\n        }\r\n        if (option.match(/^-inc=(.+)$/)) {\r\n            incValues = RegExp.$1.split(',');\r\n        }\r\n    }\r\n\r\n    var parts = className.split('.');\r\n    var klass = Class.global;\r\n    for (var i = 0; i < parts.length; i++) {\r\n        if (! klass[parts[i]]) {\r\n            klass[parts[i]] = function() {\r\n                try { this.init() } catch(e) {}\r\n            };\r\n        }\r\n        klass = klass[parts[i]];\r\n    }\r\n    klass.className = className;\r\n\r\n    klass.isa = function(baseName) {\r\n        klass.baseClassName = baseName;\r\n        if (baseName) {\r\n            klass.prototype = eval('new ' + baseName + '()');\r\n            klass.prototype.superFunc = function(name) {\r\n                return eval(baseName).prototype[name];\r\n            }\r\n        }\r\n    };\r\n    klass.isa(baseClassName);\r\n\r\n    klass.global = Class.global;\r\n\r\n    klass.addGlobal = function() {\r\n        this.newGlobals++;\r\n        return Class.global;\r\n    }\r\n\r\n    klass.extend = function(pairs) {\r\n        if (typeof pairs != 'object') {\r\n            throw(\"extend requires an object of name:value pairs\");\r\n        }\r\n        for (var name in pairs) {\r\n            klass.prototype[name] = pairs[name];\r\n        }\r\n    }\r\n\r\n    for (var ii = 0, ll = incValues.length; ii < ll; ii++) {\r\n        var value = incValues[ii];\r\n        if (value == 'proto') {\r\n            incValues[ii] = klass.prototype;\r\n        }\r\n        else if (value == 'this') {\r\n            incValues[ii] = klass;\r\n        }\r\n        else {\r\n            incValues[ii] = Class.global[value];\r\n        }\r\n    }\r\n\r\n    if (strict) {\r\n        Class.eval_strict(classWrapper, klass, incValues);\r\n    }\r\n    else {\r\n        classWrapper.apply(klass, incValues);\r\n    }\r\n\r\n    return klass;\r\n};\r\n\r\n})();\r\n\r\nClass.global = this;\r\n\r\nClass.eval_strict = function(classWrapper, klass, incValues) {\r\n    var globals = 0;\r\n    var last_key;\r\n\r\n    for (var k in Class.global) {\r\n        globals++;\r\n        last_key = k;\r\n    }\r\n\r\n    klass.newGlobals = 0;\r\n\r\n    classWrapper.apply(klass, incValues);\r\n\r\n    var globals_after = 0;\r\n    for (var k in Class.global) {\r\n        globals_after++;\r\n    }\r\n\r\n    if (globals + klass.newGlobals != globals_after) {\r\n        throw(\"Class '\" + klass.className + \"' defines \" + (globals_after - globals) + \" new global JavaScript variables without using this.addGlobal()\");\r\n    }\r\n\r\n    delete klass.newGlobals;\r\n};\r\n\r\n","Class('Document.Emitter', function() {\r\n\r\nvar proto = this.prototype;\r\nproto.className = 'Document.Emitter';\r\n\r\nproto.instantiate = function() {\r\n    return eval('new ' + this.className + '()');\r\n}\r\n\r\nproto.init = function() {\r\n    this.output = '';\r\n}\r\n\r\nproto.content = function() {\r\n    return this.output;\r\n}\r\n\r\nproto.insert = function(receiver) {\r\n    this.output += receiver.output;\r\n}\r\n\r\n});\r\n","Class('Document.Emitter.HTML(Document.Emitter)', function() {\r\n\r\nvar proto = this.prototype;\r\nproto.className = 'Document.Emitter.HTML';\r\n\r\nproto.begin_node = function(node) {\r\n    var tag = node.type;\r\n    switch (tag) {\r\n        case 'asis': case 'line': return;\r\n        case 'br': case 'hr': {\r\n            this.output += '<'+tag+' />';\r\n            return;\r\n        }\r\n        case 'html': {\r\n            this.output += '<span class=\"wafl\">Raw HTML section. Edit in Wiki Text mode.</span>';\r\n            return;\r\n        }\r\n        case 'waflparagraph': case 'waflphrase': case 'im': {\r\n            if (node._wafl.match(/^image:\\s*(\\S+)(?:\\s+size=(\\w+))?/)) {\r\n                var onload = \"if (typeof(ss) != 'undefined' && ss.editor) { var recalc = function () { try { ss.editor.DoPositionCalculations() } catch (e) { setTimeout(recalc, 500) } }; recalc() } if (!window.image_dimension_cache) window.image_dimension_cache = {};window.image_dimension_cache['/data/wafl/\"+node._label.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"\\\\'\").replace(/\\\\/g, \"\\\\\\\\\")+\"'] = [ this.offsetWidth, this.offsetHeight ]; this.style.width = this.offsetWidth + 'px'; this.style.height = this.offsetHeight + 'px'\";\r\n\r\n                var imageName = RegExp.$1;\r\n                var width = RegExp.$2;\r\n                switch (width) {\r\n                    case 'small':  { width = '100'; break; }\r\n                    case 'medium': { width = '300'; break; }\r\n                    case 'large':  { width = '600'; break; }\r\n                }\r\n                if (width) {\r\n                    width = ' width=\"'+width+'\"';\r\n                }\r\n                this.output += '<img src=\"'+imageName.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")+'\" onload=\"'+onload+'\"'+width+' />';\r\n                return;\r\n            }\r\n            this.output += '<span class=\"wafl\">'+node._label.replace(/&/g,\"&amp;\").replace(/\"/g,\"&quot;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/'/g, \"\\\\'\").replace(/\\\\/g, \"\\\\\\\\\")+'</span>';\r\n\r\n            return;\r\n        }\r\n        case 'a': case 'wikilink': {\r\n            this.output += '<a href=\"'+encodeURI(node._href)+'\">';\r\n            return;\r\n        }\r\n        case 'file': {\r\n            this.output += '<a title=\"(network resource)\" href=\"'+encodeURI(node._href)+'\">';\r\n            return;\r\n        }\r\n        case 'ul': case 'ol': case 'table': case 'tr': {\r\n            this.output += '<'+tag+\">\\n\";\r\n            return;\r\n        }\r\n        default: {\r\n            this.output += '<'+tag+'>';\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\nproto.end_node = function(node) {\r\n    var tag = node.type;\r\n    switch (tag) {\r\n        case 'asis': case 'br': case 'hr': case 'html': case 'waflparagraph': case 'waflphrase': case 'im': return;\r\n        case 'line': {\r\n            this.output += '<br />';\r\n            return;\r\n        }\r\n        case 'file': case 'wikilink': {\r\n            this.output += '</a>';\r\n            return;\r\n        }\r\n        default: {\r\n            if (tag.search(/^(?:p|ul|ol|li|h\\d|table|tr|td)$/) == 0) {\r\n                this.output += '</'+tag+\">\\n\";\r\n            }\r\n            else {\r\n                this.output += '</'+tag+'>';\r\n            }\r\n            return;\r\n        }\r\n    }\r\n    return;\r\n}\r\n\r\nproto.text_node = function(text) {\r\n    this.output += text\r\n        .replace(/&/g, '&amp;')\r\n        .replace(/>/g, '&gt;')\r\n        .replace(/</g, '&lt;')\r\n        .replace(/\"/g, '&quot;')\r\n        .replace(/'/g, '&apos;');\r\n}\r\n\r\n});\r\n","Class('Document.Parser', function() {\r\n\r\nvar proto = this.prototype;\r\n\r\nproto.className = 'Document.Parser';\r\n\r\nproto.init = function() {}\r\n\r\nproto.parse = function(input, receiver) {\r\n    this.input = (input.search(/\\n$/) == -1) ? input+\"\\n\" : input;\r\n    if (receiver) this.receiver = receiver;\r\n    this.receiver.init();\r\n    this.grammar = this.create_grammar();\r\n    this.parse_blocks('top');\r\n    return this.receiver.content();\r\n}\r\n\r\nproto.create_grammar = function() {\r\n    throw \"Please define create_grammar in a derived class of Document.Parser.\";\r\n};\r\n\r\n//------------------------------------------------------------------------------\r\n// Parse input into a series of blocks. With each iteration the parser must\r\n// match a block at position 0 of the text, and remove that block from the\r\n// input reparse it further. This continues until there is no input left.\r\n//------------------------------------------------------------------------------\r\nproto.parse_blocks = function(container_type) {\r\n    var types = this.grammar[container_type].blocks; // Document.contains[container_type];\r\n    if (!types) return;\r\n    while (this.input.length) {\r\n        var length = this.input.length;\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            var matched = this.find_match('matched_block', type);\r\n            if (matched) {\r\n                this.input = this.input.substr(matched.end);\r\n                this.handle_match(type, matched);\r\n                break;\r\n            }\r\n        }\r\n        if (this.input.length >= length)\r\n            throw this.classname + ': Reduction error for:\\n' + this.input +\r\n            '\\n' + JSON.stringify(this);\r\n    }\r\n    return;\r\n}\r\n\r\nproto.handle_match = function(type, match) {\r\n    var grammar = this.grammar[type];\r\n    var parse = grammar.blocks ? 'parse_blocks' : 'parse_phrases';\r\n    // console.log(\"Subparsing \" + parse + '(' + type + '): ');\r\n    // console.log(match);\r\n    this.subparse(parse, match, type, grammar.filter);\r\n}\r\n\r\nproto.find_match = function(matched_func, type) {\r\n    var re = this.grammar[type].match;\r\n    if (!re) throw 'no regexp for type: ' + type;\r\n    var capture = this.input.match(re);\r\n    if (capture) {\r\n        // console.log(\"Found match \" + type + \" - \" + matched_func);\r\n        var match = this[matched_func].call(this, capture, this.grammar[type].lookbehind);\r\n        match.type = this.grammar[type].type || type;\r\n        // console.log(match);\r\n        return match;\r\n    }\r\n    return;\r\n};\r\n\r\n//------------------------------------------------------------------------------\r\n// This code parses a chunk into interleaved pieces of plain text and\r\n// phrases. It repeatedly tries to match every possible phrase and\r\n// then takes the match closest to the start. Everything before a\r\n// match is written as text. Matched phrases are subparsed according\r\n// to their rules. This continues until the input is all eaten.\r\n//------------------------------------------------------------------------------\r\nproto.parse_phrases = function(container_type) {\r\n    var types = this.grammar[container_type].phrases;\r\n    if (!types) { this.receiver.text_node(this.input || ''); return }\r\n    // console.log(\"INPUT: \" + this.input);\r\n    while (this.input.length) {\r\n        var match = null;\r\n        for (var i = 0; i < types.length; i++) {\r\n            var type = types[i];\r\n            var matched = this.find_match('matched_phrase', type);\r\n            if (! matched) continue;\r\n\r\n            if (!match || (matched.begin < match.begin)) {\r\n                match = matched;\r\n                if (match.begin == 0) break;\r\n            }\r\n        }\r\n        if (!match) {\r\n            // console.log(\"NO MATCH: \" + this.input);\r\n            this.receiver.text_node(this.input || '');\r\n            break;\r\n        }\r\n        if (match.begin != 0) {\r\n            // console.log(\"MATCH OFFSET:\" + this.input + \" (\" + match.type + \")\" + match.begin);\r\n            this.receiver.text_node(this.input.substr(0, match.begin) || '');\r\n            }\r\n        this.input = this.input.substr(match.end);\r\n        this.handle_match(match.type, match);\r\n    }\r\n    return;\r\n}\r\n\r\nproto.subparse = function(func, match, type, filter) {\r\n    /* The call could cause side effects to the match object. */\r\n    match.type = this.grammar[type].type;\r\n    if (match.type == null) match.type = type;\r\n\r\n    var filtered_text = filter ? filter(match) : null;\r\n\r\n    if (match.type) this.receiver.begin_node(match);\r\n\r\n    var parser = eval('new ' + this.className + '()');\r\n\r\n    parser.input = (filtered_text == null) ? match.text : filtered_text;\r\n    parser.grammar = this.grammar;\r\n    parser.receiver = this.receiver.instantiate();\r\n    // console.log(\"SEEDED: (\" + type + \")\" + parser.input);\r\n    parser[func].call(parser, type);\r\n    this.receiver.insert(parser.receiver);\r\n\r\n    if (match.type) this.receiver.end_node(match);\r\n}\r\n\r\n//------------------------------------------------------------------------------\r\n// Helper functions\r\n//\r\n// These are the odds and ends called by the code above.\r\n//------------------------------------------------------------------------------\r\n\r\n/* Blocks has no lookbehinds, so:\r\n * All match begins at 0. The first capture is text; the next ones are various parts.\r\n */\r\nproto.matched_block = function(capture) {\r\n    return {\r\n        begin: capture.index,\r\n        text: capture[1],\r\n        end: capture[0].length,\r\n        1: capture[2],\r\n        2: capture[3],\r\n        3: capture[4]\r\n    };\r\n}\r\n\r\n/* The first capture in a Phrases is the lookbehind. So:\r\n */\r\nproto.matched_phrase = function(capture, lookbehind) {\r\n    if (lookbehind) {\r\n        var text = capture[2];\r\n        var begin = this.input.indexOf(capture[1]);\r\n        return {\r\n            text: text,\r\n            begin: begin,\r\n            end: (begin + capture[1].length),\r\n            1: RegExp.$2,\r\n            2: RegExp.$3,\r\n            3: RegExp.$4\r\n        };\r\n    }\r\n\r\n    return {\r\n        begin: capture.index,\r\n        text: capture[1],\r\n        end: capture.index + capture[0].length,\r\n        1: capture[2],\r\n        2: capture[3],\r\n        3: capture[4]\r\n    };\r\n}\r\n\r\n});\r\n","Class('Document.Parser.Wikitext(Document.Parser)', function() {\r\n\r\nvar proto = this.prototype;\r\nproto.className = 'Document.Parser.Wikitext';\r\n\r\nproto.init = function() {}\r\n\r\nproto.create_grammar = function() {\r\n    var all_blocks = ['pre', 'html', 'hr', 'hx', 'waflparagraph', 'ul', 'ol', 'blockquote', 'p', 'empty', 'else'];\r\n\r\n    // Phrase TODO: im\r\n    var all_phrases = ['waflphrase', 'asis', 'wikilink', 'wikilink2', 'a', 'im', 'mail', 'file', 'tt', 'b', 'i', 'del', 'a'];\r\n\r\n    var re_huggy = function(brace1, brace2) {\r\n        brace2 = '\\\\' + (brace2 || brace1);\r\n        brace1 = '\\\\' + brace1;\r\n        return {\r\n            match: new RegExp('(?:^|[^'+brace1+'\\\\w])('+brace1+'(?=\\\\S)(?!'+brace2+')(.*?)'+brace2+'(?=[^'+brace2+'\\\\w]|$))'),\r\n            phrases: (brace1 == '\\\\`') ? null : all_phrases,\r\n            lookbehind: true\r\n        };\r\n    };\r\n\r\n    var im_types = {\r\n        yahoo: 'yahoo',\r\n        ymsgr: 'yahoo',\r\n        callto: 'callto',\r\n        callme: 'callto',\r\n        skype: 'callto',\r\n        aim: 'aim'\r\n    };\r\n\r\n    var im_label = {\r\n        aim: \"AIM: %1\",\r\n        yahoo: \"Yahoo: %1\",\r\n        callto: \"Skype: %1\"\r\n    };\r\n\r\n    var im_re = '(\\\\b(';\r\n    for (var key in im_types) {\r\n        im_re += key + '|';\r\n    }\r\n    im_re = im_re.replace(/\\|$/, ')\\\\:([^\\\\s\\\\>\\\\)]+))');\r\n\r\n    var re_list = function(bullet, filter_out) {\r\n        var exclusion = new RegExp('(^|\\n)' + filter_out + '\\ *', 'g');\r\n        return {\r\n            match: new RegExp(\r\n                \"^(\" + bullet + \"+\\ .*\\n\" +\r\n                \"(?:[\\*\\-\\+\\#]+\\ .*\\n)*\" +\r\n                \")(?:\\s*\\n)?\"\r\n            ),\r\n            blocks: ['ul', 'ol', 'subl', 'li'],\r\n            filter: function(node) {\r\n                return node.text.replace(exclusion, '$1');\r\n            }\r\n        };\r\n    };\r\n\r\n    return {\r\n        _all_blocks: all_blocks,\r\n        _all_phrases: all_phrases,\r\n        top: { blocks: all_blocks },\r\n        ol: re_list('#', '[*#]'),\r\n        ul: re_list('[-+*]', '[-+*#]'),\r\n        blockquote: {\r\n            match: /^((?:>[^\\n]*\\n)+)(?:\\s*\\n)?/,\r\n            blocks: ['blockquote', 'line'],\r\n            filter: function(node) { return node.text.replace(/(^|\\n)>\\ ?/g, '$1') }\r\n        },\r\n        line: {\r\n            match: /([^\\n]*)\\n/,\r\n            phrases: all_phrases\r\n        },\r\n        subl: {\r\n            type: 'li',\r\n            match: /^(([^\\n]*)\\n[*#]+\\ [^\\n]*\\n(?:[*#]+\\ [^\\n]*\\n)*)(?:\\s*\\n)?/,\r\n            blocks: ['ul', 'ol', 'li2']\r\n        },\r\n        li: {\r\n            match: /([^\\n]*)\\n/,\r\n            phrases: all_phrases\r\n        },\r\n        li2: {\r\n            type: '', // Do not emit begin/end node; just reparse\r\n            match: /([^\\n]*)\\n/,\r\n            phrases: all_phrases\r\n        },\r\n        html: {\r\n            match: /^(\\.html\\ *\\n(?:[^\\n]*\\n)*?\\.html)\\ *\\n(?:\\s*\\n)?/,\r\n            filter: function(node) {\r\n                node._html = node.text;\r\n                return '';\r\n            }\r\n        },\r\n        pre: { match: /^\\.pre\\ *\\n((?:[^\\n]*\\n)*?)\\.pre\\ *\\n(?:\\s*\\n)?/ },\r\n        hr: { match: /^--+(?:\\s*\\n)?/ },\r\n        hx: {\r\n            match: /^((\\^+) *([^\\n]*?)(\\s+=+)?\\s*?\\n+)/,\r\n            phrases: all_phrases,\r\n            filter: function(node) {\r\n                node.type = 'h' + node['1'].length;\r\n                return node[2];\r\n            }\r\n        },\r\n        p: {\r\n            match: /^((?:(?!(?:(?:\\^+|\\#+|\\*+|\\-+) |\\>|\\.\\w+\\s*\\n|\\{[^\\}]+\\}\\s*\\n))[^\\n]*\\S[^\\n]*\\n)+(?:(?=^|\\n)\\s*\\n)*)/,\r\n            phrases: all_phrases,\r\n            filter: function(node) { return node.text.replace(/\\n$/, '') }\r\n        },\r\n        empty: {\r\n            match: /^(\\s*\\n)/,\r\n            filter: function(node) { node.type = '' }\r\n        },\r\n        'else': {\r\n            match: /^(([^\\n]*)\\n)/,\r\n            phrases: [],\r\n            filter: function(node) {\r\n                node.type = 'p';\r\n            }\r\n        },\r\n        waflparagraph: {\r\n            match: /^\\{(.*)\\}[\\ \\t]*\\n(?:\\s*\\n)?/,\r\n            filter: function(node) {\r\n                node._wafl = node._label = node.text;\r\n                // node._function = node._wafl.replace(/[: ].*/, '');;\r\n                // node._options = node._wafl.replace(/^[^: ]*[: ]?/, '');\r\n                return '';\r\n            }\r\n        },\r\n        waflphrase: {\r\n            match: /(?:^|[\\s\\-])((?:\"([^\\n]+?)\")?\\{([\\w-]+(?=[\\:\\ \\}])(?:\\s*:)?\\s*[^\\n]*?\\s*)\\}(?=[\\W_]|$))/,\r\n            filter: function(node) {\r\n                node._wafl = node[2];\r\n                node._label = node[1] || node._wafl;\r\n                // node._function = node._wafl.replace(/[: ].*/, '');;\r\n                // node._options = node._wafl.replace(/^[^: ]*[: ]?/, '');\r\n                return '';\r\n            },\r\n            lookbehind: true\r\n        },\r\n        asis: {\r\n            match: /(\\{\\{([^\\n]*?)\\}\\}(\\}*))/,\r\n            filter: function(node) {\r\n                node.type = '';\r\n                return(node[1] + node[2]);\r\n            }\r\n        },\r\n        wikilink: {\r\n            match: /(?:^|[_\\W])(\\[()(?=[^\\s\\[\\]])(.*?)\\](?=[_\\W]|$))/,\r\n            filter: function(node) {\r\n                node._href = '?' + node[2];\r\n                return(node.text || node[2]);\r\n            },\r\n            lookbehind: true\r\n        },\r\n        wikilink2: {\r\n            type: 'wikilink',\r\n            match: /(?:\"([^\"]*)\"\\s*)(\\[(?=[^\\s\\[\\]])(.*?)\\](?=[_\\W]|$))/,\r\n            filter: function(node) {\r\n                node._href = '?' + node[2];\r\n                return(node[1] || node[2]);\r\n            }\r\n        },\r\n        a: {\r\n            match: /((?:\"([^\"]*)\"\\s*)?<?((?:http|https|ftp|irc|file):(?:\\/\\/)?[\\;\\/\\?\\:\\@\\&\\=\\+\\$\\,\\[\\]\\#A-Za-z0-9\\-\\_\\.\\!\\~\\*\\'\\(\\)]+[A-Za-z0-9\\/#])>?)/,\r\n            filter: function(node) {\r\n                node._href = node[2];\r\n                return(node[1] || node[2]);\r\n            }\r\n        },\r\n        file: {\r\n            match: /((?:\"([^\"]*)\")?<(\\\\\\\\[^\\s\\>\\)]+)>)/,\r\n            filter: function(node) {\r\n                var href = node[2].replace(/^\\\\\\\\/, '');\r\n                node._href = \"file://\" + href.replace(/\\\\/g, '/');\r\n                return(node['1'] || href);\r\n            }\r\n        },\r\n        im: {\r\n            match: (new RegExp(im_re)),\r\n            filter: function(node) {\r\n                node._wafl = node[1] + ': ' + node[2];\r\n                node._label = (im_label[im_types[node[1]]] || '%1').replace(/%1/g, node[2]);\r\n                return '';\r\n            }\r\n        },\r\n        mail: {\r\n            match: /([\\w+%\\-\\.]+@(?:[\\w\\-]+\\.)+[\\w\\-]+)/,\r\n            filter: function(node) {\r\n                node.type = 'a';\r\n                node._href = \"mailto:\" + node.text.replace(/%/g, '%25');\r\n            }\r\n        },\r\n        tt: re_huggy('`'), // Special-cased in re_huggy above to disallow subphrases\r\n        b: re_huggy('*'),\r\n        i: re_huggy('_'),\r\n        del: re_huggy('-')\r\n    };\r\n};\r\n\r\n});\r\n","/*! jQuery v1.11.0 | (c) 2005, 2014 jQuery Foundation, Inc. | jquery.org/license */\r\n!function(a,b){\"object\"==typeof module&&\"object\"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error(\"jQuery requires a window with a document\");return b(a)}:b(a)}(\"undefined\"!=typeof window?window:this,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k=\"\".trim,l={},m=\"1.11.0\",n=function(a,b){return new n.fn.init(a,b)},o=/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,p=/^-ms-/,q=/-([\\da-z])/gi,r=function(a,b){return b.toUpperCase()};n.fn=n.prototype={jquery:m,constructor:n,selector:\"\",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for(\"boolean\"==typeof g&&(j=g,g=arguments[h]||{},h++),\"object\"==typeof g||n.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],c=e[d],g!==c&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(b?(b=!1,f=a&&n.isArray(a)?a:[]):f=a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:\"jQuery\"+(m+Math.random()).replace(/\\D/g,\"\"),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return\"function\"===n.type(a)},isArray:Array.isArray||function(a){return\"array\"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||\"object\"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,\"constructor\")&&!j.call(a.constructor.prototype,\"isPrototypeOf\"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+\"\":\"object\"==typeof a||\"function\"==typeof a?h[i.call(a)]||\"object\":typeof a},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,\"ms-\").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var d,e=0,f=a.length,g=s(a);if(c){if(g){for(;f>e;e++)if(d=b.apply(a[e],c),d===!1)break}else for(e in a)if(d=b.apply(a[e],c),d===!1)break}else if(g){for(;f>e;e++)if(d=b.call(a[e],e,a[e]),d===!1)break}else for(e in a)if(d=b.call(a[e],e,a[e]),d===!1)break;return a},trim:k&&!k.call(\"\\ufeff\\xa0\")?function(a){return null==a?\"\":k.call(a)}:function(a){return null==a?\"\":(a+\"\").replace(o,\"\")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,\"string\"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){var c=+b.length,d=0,e=a.length;while(c>d)a[e++]=b[d++];if(c!==c)while(void 0!==b[d])a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,h=s(a),i=[];if(h)for(;g>f;f++)d=b(a[f],f,c),null!=d&&i.push(d);else for(f in a)d=b(a[f],f,c),null!=d&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return\"string\"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),e=function(){return a.apply(b||this,c.concat(d.call(arguments)))},e.guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"),function(a,b){h[\"[object \"+b+\"]\"]=b.toLowerCase()});function s(a){var b=a.length,c=n.type(a);return\"function\"===c||n.isWindow(a)?!1:1===a.nodeType&&b?!0:\"array\"===c||0===b||\"number\"==typeof b&&b>0&&b-1 in a}var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s=\"sizzle\"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A=\"undefined\",B=1<<31,C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},J=\"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",K=\"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",L=\"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",M=L.replace(\"w\",\"w#\"),N=\"\\\\[\"+K+\"*(\"+L+\")\"+K+\"*(?:([*^$|!~]?=)\"+K+\"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\"+M+\")|)|)\"+K+\"*\\\\]\",O=\":(\"+L+\")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\"+N.replace(3,8)+\")*)|.*)\\\\)|)\",P=new RegExp(\"^\"+K+\"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\"+K+\"+$\",\"g\"),Q=new RegExp(\"^\"+K+\"*,\"+K+\"*\"),R=new RegExp(\"^\"+K+\"*([>+~]|\"+K+\")\"+K+\"*\"),S=new RegExp(\"=\"+K+\"*([^\\\\]'\\\"]*?)\"+K+\"*\\\\]\",\"g\"),T=new RegExp(O),U=new RegExp(\"^\"+M+\"$\"),V={ID:new RegExp(\"^#(\"+L+\")\"),CLASS:new RegExp(\"^\\\\.(\"+L+\")\"),TAG:new RegExp(\"^(\"+L.replace(\"w\",\"w*\")+\")\"),ATTR:new RegExp(\"^\"+N),PSEUDO:new RegExp(\"^\"+O),CHILD:new RegExp(\"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\"+K+\"*(even|odd|(([+-]|)(\\\\d*)n|)\"+K+\"*(?:([+-]|)\"+K+\"*(\\\\d+)|))\"+K+\"*\\\\)|)\",\"i\"),bool:new RegExp(\"^(?:\"+J+\")$\",\"i\"),needsContext:new RegExp(\"^\"+K+\"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\"+K+\"*((?:-\\\\d)?\\\\d*)\"+K+\"*\\\\)|)(?=[^-]|$)\",\"i\")},W=/^(?:input|select|textarea|button)$/i,X=/^h\\d$/i,Y=/^[^{]+\\{\\s*\\[native \\w/,Z=/^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,$=/[+~]/,_=/'|\\\\/g,ab=new RegExp(\"\\\\\\\\([\\\\da-f]{1,6}\"+K+\"?|(\"+K+\")|.)\",\"ig\"),bb=function(a,b,c){var d=\"0x\"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType}catch(cb){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){var c=a.length,d=0;while(a[c++]=b[d++]);a.length=c-1}}}function db(a,b,d,e){var f,g,h,i,j,m,p,q,u,v;if((b?b.ownerDocument||b:t)!==l&&k(b),b=b||l,d=d||[],!a||\"string\"!=typeof a)return d;if(1!==(i=b.nodeType)&&9!==i)return[];if(n&&!e){if(f=Z.exec(a))if(h=f[1]){if(9===i){if(g=b.getElementById(h),!g||!g.parentNode)return d;if(g.id===h)return d.push(g),d}else if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h)return d.push(g),d}else{if(f[2])return G.apply(d,b.getElementsByTagName(a)),d;if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(h)),d}if(c.qsa&&(!o||!o.test(a))){if(q=p=s,u=b,v=9===i&&a,1===i&&\"object\"!==b.nodeName.toLowerCase()){m=ob(a),(p=b.getAttribute(\"id\"))?q=p.replace(_,\"\\\\$&\"):b.setAttribute(\"id\",q),q=\"[id='\"+q+\"'] \",j=m.length;while(j--)m[j]=q+pb(m[j]);u=$.test(a)&&mb(b.parentNode)||b,v=m.join(\",\")}if(v)try{return G.apply(d,u.querySelectorAll(v)),d}catch(w){}finally{p||b.removeAttribute(\"id\")}}}return xb(a.replace(P,\"$1\"),b,d,e)}function eb(){var a=[];function b(c,e){return a.push(c+\" \")>d.cacheLength&&delete b[a.shift()],b[c+\" \"]=e}return b}function fb(a){return a[s]=!0,a}function gb(a){var b=l.createElement(\"div\");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function hb(a,b){var c=a.split(\"|\"),e=a.length;while(e--)d.attrHandle[c[e]]=b}function ib(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||B)-(~a.sourceIndex||B);if(d)return d;if(c)while(c=c.nextSibling)if(c===b)return-1;return a?1:-1}function jb(a){return function(b){var c=b.nodeName.toLowerCase();return\"input\"===c&&b.type===a}}function kb(a){return function(b){var c=b.nodeName.toLowerCase();return(\"input\"===c||\"button\"===c)&&b.type===a}}function lb(a){return fb(function(b){return b=+b,fb(function(c,d){var e,f=a([],c.length,b),g=f.length;while(g--)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function mb(a){return a&&typeof a.getElementsByTagName!==A&&a}c=db.support={},f=db.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?\"HTML\"!==b.nodeName:!1},k=db.setDocument=function(a){var b,e=a?a.ownerDocument||a:t,g=e.defaultView;return e!==l&&9===e.nodeType&&e.documentElement?(l=e,m=e.documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener(\"unload\",function(){k()},!1):g.attachEvent&&g.attachEvent(\"onunload\",function(){k()})),c.attributes=gb(function(a){return a.className=\"i\",!a.getAttribute(\"className\")}),c.getElementsByTagName=gb(function(a){return a.appendChild(e.createComment(\"\")),!a.getElementsByTagName(\"*\").length}),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){return a.innerHTML=\"<div class='a'></div><div class='a i'></div>\",a.firstChild.className=\"i\",2===a.getElementsByClassName(\"i\").length}),c.getById=gb(function(a){return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length}),c.getById?(d.find.ID=function(a,b){if(typeof b.getElementById!==A&&n){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){return a.getAttribute(\"id\")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){var c=typeof a.getAttributeNode!==A&&a.getAttributeNode(\"id\");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==A?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if(\"*\"===a){while(c=f[e++])1===c.nodeType&&d.push(c);return d}return f},d.find.CLASS=c.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==A&&n?b.getElementsByClassName(a):void 0},p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){a.innerHTML=\"<select t=''><option selected=''></option></select>\",a.querySelectorAll(\"[t^='']\").length&&o.push(\"[*^$]=\"+K+\"*(?:''|\\\"\\\")\"),a.querySelectorAll(\"[selected]\").length||o.push(\"\\\\[\"+K+\"*(?:value|\"+J+\")\"),a.querySelectorAll(\":checked\").length||o.push(\":checked\")}),gb(function(a){var b=e.createElement(\"input\");b.setAttribute(\"type\",\"hidden\"),a.appendChild(b).setAttribute(\"name\",\"D\"),a.querySelectorAll(\"[name=d]\").length&&o.push(\"name\"+K+\"*[*^$|!~]?=\"),a.querySelectorAll(\":enabled\").length||o.push(\":enabled\",\":disabled\"),a.querySelectorAll(\"*,:x\"),o.push(\",.*:\")})),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){c.disconnectedMatch=q.call(a,\"div\"),q.call(a,\"[s!='']:x\"),p.push(\"!=\",O)}),o=o.length&&new RegExp(o.join(\"|\")),p=p.length&&new RegExp(p.join(\"|\")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)while(b=b.parentNode)if(b===a)return!0;return!1},z=b?function(a,b){if(a===b)return j=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)}:function(a,b){if(a===b)return j=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0;if(f===g)return ib(a,b);c=a;while(c=c.parentNode)h.unshift(c);c=b;while(c=c.parentNode)k.unshift(c);while(h[d]===k[d])d++;return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0},e):l},db.matches=function(a,b){return db(a,null,null,b)},db.matchesSelector=function(a,b){if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,\"='$1']\"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b)))try{var d=q.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return db(b,l,null,[a]).length>0},db.contains=function(a,b){return(a.ownerDocument||a)!==l&&k(a),r(a,b)},db.attr=function(a,b){(a.ownerDocument||a)!==l&&k(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},db.error=function(a){throw new Error(\"Syntax error, unrecognized expression: \"+a)},db.uniqueSort=function(a){var b,d=[],e=0,f=0;if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){while(b=a[f++])b===a[f]&&(e=d.push(f));while(e--)a.splice(d[e],1)}return i=null,a},e=db.getText=function(a){var b,c=\"\",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if(\"string\"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else while(b=a[d++])c+=e(b);return c},d=db.selectors={cacheLength:50,createPseudo:fb,match:V,attrHandle:{},find:{},relative:{\">\":{dir:\"parentNode\",first:!0},\" \":{dir:\"parentNode\"},\"+\":{dir:\"previousSibling\",first:!0},\"~\":{dir:\"previousSibling\"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||\"\").replace(ab,bb),\"~=\"===a[2]&&(a[3]=\" \"+a[3]+\" \"),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),\"nth\"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*(\"even\"===a[3]||\"odd\"===a[3])),a[5]=+(a[7]+a[8]||\"odd\"===a[3])):a[3]&&db.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(\")\",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ab,bb).toLowerCase();return\"*\"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=w[a+\" \"];return b||(b=new RegExp(\"(^|\"+K+\")\"+a+\"(\"+K+\"|$)\"))&&w(a,function(a){return b.test(\"string\"==typeof a.className&&a.className||typeof a.getAttribute!==A&&a.getAttribute(\"class\")||\"\")})},ATTR:function(a,b,c){return function(d){var e=db.attr(d,a);return null==e?\"!=\"===b:b?(e+=\"\",\"=\"===b?e===c:\"!=\"===b?e!==c:\"^=\"===b?c&&0===e.indexOf(c):\"*=\"===b?c&&e.indexOf(c)>-1:\"$=\"===b?c&&e.slice(-c.length)===c:\"~=\"===b?(\" \"+e+\" \").indexOf(c)>-1:\"|=\"===b?e===c||e.slice(0,c.length+1)===c+\"-\":!1):!0}},CHILD:function(a,b,c,d,e){var f=\"nth\"!==a.slice(0,3),g=\"last\"!==a.slice(-4),h=\"of-type\"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?\"nextSibling\":\"previousSibling\",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;if(q){if(f){while(p){l=b;while(l=l[p])if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p=\"only\"===a&&!o&&\"nextSibling\"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&t){k=q[s]||(q[s]={}),j=k[a]||[],n=j[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if(1===l.nodeType&&++m&&l===b){k[a]=[u,n,m];break}}else if(t&&(j=(b[s]||(b[s]={}))[a])&&j[0]===u)m=j[1];else while(l=++n&&l&&l[p]||(m=n=0)||o.pop())if((h?l.nodeName.toLowerCase()===r:1===l.nodeType)&&++m&&(t&&((l[s]||(l[s]={}))[a]=[u,m]),l===b))break;return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error(\"unsupported pseudo: \"+a);return e[s]?e(b):e.length>1?(c=[a,a,\"\",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){var d,f=e(a,b),g=f.length;while(g--)d=I.call(a,f[g]),a[d]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:fb(function(a){var b=[],c=[],d=g(a.replace(P,\"$1\"));return d[s]?fb(function(a,b,c,e){var f,g=d(a,null,e,[]),h=a.length;while(h--)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fb(function(a){return function(b){return db(a,b).length>0}}),contains:fb(function(a){return function(b){return(b.textContent||b.innerText||e(b)).indexOf(a)>-1}}),lang:fb(function(a){return U.test(a||\"\")||db.error(\"unsupported lang: \"+a),a=a.replace(ab,bb).toLowerCase(),function(b){var c;do if(c=n?b.lang:b.getAttribute(\"xml:lang\")||b.getAttribute(\"lang\"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+\"-\");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===m},focus:function(a){return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&!!a.checked||\"option\"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return\"input\"===b&&\"button\"===a.type||\"button\"===b},text:function(a){var b;return\"input\"===a.nodeName.toLowerCase()&&\"text\"===a.type&&(null==(b=a.getAttribute(\"type\"))||\"text\"===b.toLowerCase())},first:lb(function(){return[0]}),last:lb(function(a,b){return[b-1]}),eq:lb(function(a,b,c){return[0>c?c+b:c]}),even:lb(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:lb(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:lb(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:lb(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},d.pseudos.nth=d.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=jb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=kb(b);function nb(){}nb.prototype=d.filters=d.pseudos,d.setFilters=new nb;function ob(a,b){var c,e,f,g,h,i,j,k=x[a+\" \"];if(k)return b?0:k.slice(0);h=a,i=[],j=d.preFilter;while(h){(!c||(e=Q.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P,\" \")}),h=h.slice(c.length));for(g in d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?db.error(a):x(a,i).slice(0)}function pb(a){for(var b=0,c=a.length,d=\"\";c>b;b++)d+=a[b].value;return d}function qb(a,b,c){var d=b.dir,e=c&&\"parentNode\"===d,f=v++;return b.first?function(b,c,f){while(b=b[d])if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[u,f];if(g){while(b=b[d])if((1===b.nodeType||e)&&a(b,c,g))return!0}else while(b=b[d])if(1===b.nodeType||e){if(i=b[s]||(b[s]={}),(h=i[d])&&h[0]===u&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function rb(a){return a.length>1?function(b,c,d){var e=a.length;while(e--)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function tb(a,b,c,d,e,f){return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||wb(b||\"*\",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d){j=sb(r,n),d(j,[],h,i),k=j.length;while(k--)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l))}if(f){if(e||a){if(e){j=[],k=r.length;while(k--)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}k=r.length;while(k--)(l=r[k])&&(j=e?I.call(f,l):m[k])>-1&&(f[j]=!(g[j]=l))}}else r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ub(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[\" \"],j=g?1:0,k=qb(function(a){return a===b},i,!0),l=qb(function(a){return I.call(b,a)>-1},i,!0),m=[function(a,c,d){return!g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];f>j;j++)if(c=d.relative[a[j].type])m=[qb(rb(m),c)];else{if(c=d.filter[a[j].type].apply(null,a[j].matches),c[s]){for(e=++j;f>e;e++)if(d.relative[a[e].type])break;return tb(j>1&&rb(m),j>1&&pb(a.slice(0,j-1).concat({value:\" \"===a[j-2].type?\"*\":\"\"})).replace(P,\"$1\"),c,e>j&&ub(a.slice(j,e)),f>e&&ub(a=a.slice(e)),f>e&&pb(a))}m.push(c)}return rb(m)}function vb(a,b){var c=b.length>0,e=a.length>0,f=function(f,g,i,j,k){var m,n,o,p=0,q=\"0\",r=f&&[],s=[],t=h,v=f||e&&d.find.TAG(\"*\",k),w=u+=null==t?1:Math.random()||.1,x=v.length;for(k&&(h=g!==l&&g);q!==x&&null!=(m=v[q]);q++){if(e&&m){n=0;while(o=a[n++])if(o(m,g,i)){j.push(m);break}k&&(u=w)}c&&((m=!o&&m)&&p--,f&&r.push(m))}if(p+=q,c&&q!==p){n=0;while(o=b[n++])o(r,s,g,i);if(f){if(p>0)while(q--)r[q]||s[q]||(s[q]=E.call(j));s=sb(s)}G.apply(j,s),k&&!f&&s.length>0&&p+b.length>1&&db.uniqueSort(j)}return k&&(u=w,h=t),r};return c?fb(f):f}g=db.compile=function(a,b){var c,d=[],e=[],f=y[a+\" \"];if(!f){b||(b=ob(a)),c=b.length;while(c--)f=ub(b[c]),f[s]?d.push(f):e.push(f);f=y(a,vb(e,d))}return f};function wb(a,b,c){for(var d=0,e=b.length;e>d;d++)db(a,b[d],c);return c}function xb(a,b,e,f){var h,i,j,k,l,m=ob(a);if(!f&&1===m.length){if(i=m[0]=m[0].slice(0),i.length>2&&\"ID\"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){if(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0],!b)return e;a=a.slice(i.shift().value.length)}h=V.needsContext.test(a)?0:i.length;while(h--){if(j=i[h],d.relative[k=j.type])break;if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){if(i.splice(h,1),a=f.length&&pb(i),!a)return G.apply(e,f),e;break}}}return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e}return c.sortStable=s.split(\"\").sort(z).join(\"\")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){return 1&a.compareDocumentPosition(l.createElement(\"div\"))}),gb(function(a){return a.innerHTML=\"<a href='#'></a>\",\"#\"===a.firstChild.getAttribute(\"href\")})||hb(\"type|href|height|width\",function(a,b,c){return c?void 0:a.getAttribute(b,\"type\"===b.toLowerCase()?1:2)}),c.attributes&&gb(function(a){return a.innerHTML=\"<input/>\",a.firstChild.setAttribute(\"value\",\"\"),\"\"===a.firstChild.getAttribute(\"value\")})||hb(\"value\",function(a,b,c){return c||\"input\"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),gb(function(a){return null==a.getAttribute(\"disabled\")})||hb(J,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),db}(a);n.find=t,n.expr=t.selectors,n.expr[\":\"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,w=/^.[^:#\\[\\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if(\"string\"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return n.inArray(a,b)>=0!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=\":not(\"+a+\")\"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if(\"string\"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;e>b;b++)if(n.contains(d[b],this))return!0}));for(b=0;e>b;b++)n.find(a,d[b],c);return c=this.pushStack(e>1?n.unique(c):c),c.selector=this.selector?this.selector+\" \"+a:a,c},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,\"string\"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=a.document,A=/^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,B=n.fn.init=function(a,b){var c,d;if(!a)return this;if(\"string\"==typeof a){if(c=\"<\"===a.charAt(0)&&\">\"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:A.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if(d=z.getElementById(c[2]),d&&d.parentNode){if(d.id!==c[2])return y.find(a);this.length=1,this[0]=d}return this.context=z,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?\"undefined\"!=typeof y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this))};B.prototype=n.fn,y=n(z);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};n.extend({dir:function(a,b,c){var d=[],e=a[b];while(e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c)))1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=0;d>b;b++)if(n.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||\"string\"!=typeof a?n(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?n.unique(f):f)},index:function(a){return a?\"string\"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}});function E(a,b){do a=a[b];while(a&&1!==a.nodeType);return a}n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,\"parentNode\")},parentsUntil:function(a,b,c){return n.dir(a,\"parentNode\",c)},next:function(a){return E(a,\"nextSibling\")},prev:function(a){return E(a,\"previousSibling\")},nextAll:function(a){return n.dir(a,\"nextSibling\")},prevAll:function(a){return n.dir(a,\"previousSibling\")},nextUntil:function(a,b,c){return n.dir(a,\"nextSibling\",c)},prevUntil:function(a,b,c){return n.dir(a,\"previousSibling\",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,\"iframe\")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return\"Until\"!==a.slice(-5)&&(d=c),d&&\"string\"==typeof d&&(e=n.filter(d,e)),this.length>1&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)}});var F=/\\S+/g,G={};function H(a){var b=G[a]={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}n.Callbacks=function(a){a=\"string\"==typeof a?G[a]||H(a):n.extend({},a);var b,c,d,e,f,g,h=[],i=!a.once&&[],j=function(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&e>f;f++)if(h[f].apply(l[0],l[1])===!1&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())},k={add:function(){if(h){var d=h.length;!function f(b){n.each(b,function(b,c){var d=n.type(c);\"function\"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&\"string\"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&n.each(arguments,function(a,c){var d;while((d=n.inArray(c,h,d))>-1)h.splice(d,1),b&&(e>=d&&e--,f>=d&&f--)}),this},has:function(a){return a?n.inArray(a,h)>-1:!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=c||[],c=[a,c.slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},n.extend({Deferred:function(a){var b=[[\"resolve\",\"done\",n.Callbacks(\"once memory\"),\"resolved\"],[\"reject\",\"fail\",n.Callbacks(\"once memory\"),\"rejected\"],[\"notify\",\"progress\",n.Callbacks(\"memory\")]],c=\"pending\",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+\"With\"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+\"With\"](this===e?d:this,arguments),this},e[f[0]+\"With\"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=arguments.length>1?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}},i,j,k;if(e>1)for(i=new Array(e),j=new Array(e),k=new Array(e);e>b;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}});var I;n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(a===!0?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready);n.isReady=!0,a!==!0&&--n.readyWait>0||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger(\"ready\").off(\"ready\"))}}});function J(){z.addEventListener?(z.removeEventListener(\"DOMContentLoaded\",K,!1),a.removeEventListener(\"load\",K,!1)):(z.detachEvent(\"onreadystatechange\",K),a.detachEvent(\"onload\",K))}function K(){(z.addEventListener||\"load\"===event.type||\"complete\"===z.readyState)&&(J(),n.ready())}n.ready.promise=function(b){if(!I)if(I=n.Deferred(),\"complete\"===z.readyState)setTimeout(n.ready);else if(z.addEventListener)z.addEventListener(\"DOMContentLoaded\",K,!1),a.addEventListener(\"load\",K,!1);else{z.attachEvent(\"onreadystatechange\",K),a.attachEvent(\"onload\",K);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!n.isReady){try{c.doScroll(\"left\")}catch(a){return setTimeout(e,50)}J(),n.ready()}}()}return I.promise(b)};var L=\"undefined\",M;for(M in n(l))break;l.ownLast=\"0\"!==M,l.inlineBlockNeedsLayout=!1,n(function(){var a,b,c=z.getElementsByTagName(\"body\")[0];c&&(a=z.createElement(\"div\"),a.style.cssText=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px\",b=z.createElement(\"div\"),c.appendChild(a).appendChild(b),typeof b.style.zoom!==L&&(b.style.cssText=\"border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1\",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=z.createElement(\"div\");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete a.test}catch(b){l.deleteExpando=!1}}a=null}(),n.acceptData=function(a){var b=n.noData[(a.nodeName+\" \").toLowerCase()],c=+a.nodeType||1;return 1!==c&&9!==c?!1:!b||b!==!0&&a.getAttribute(\"classid\")===b};var N=/^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,O=/([A-Z])/g;function P(a,b,c){if(void 0===c&&1===a.nodeType){var d=\"data-\"+b.replace(O,\"-$1\").toLowerCase();if(c=a.getAttribute(d),\"string\"==typeof c){try{c=\"true\"===c?!0:\"false\"===c?!1:\"null\"===c?null:+c+\"\"===c?+c:N.test(c)?n.parseJSON(c):c}catch(e){}n.data(a,b,c)}else c=void 0}return c}function Q(a){var b;for(b in a)if((\"data\"!==b||!n.isEmptyObject(a[b]))&&\"toJSON\"!==b)return!1;return!0}function R(a,b,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||\"string\"!=typeof b)return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}:{toJSON:n.noop}),(\"object\"==typeof b||\"function\"==typeof b)&&(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),\"string\"==typeof b?(f=g[b],null==f&&(f=g[n.camelCase(b)])):f=g,f\r\n}}function S(a,b,c){if(n.acceptData(a)){var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){n.isArray(b)?b=b.concat(n.map(b,n.camelCase)):b in d?b=[b]:(b=n.camelCase(b),b=b in d?[b]:b.split(\" \")),e=b.length;while(e--)delete d[b[e]];if(c?!Q(d):!n.isEmptyObject(d))return}(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}n.extend({cache:{},noData:{\"applet \":!0,\"embed \":!0,\"object \":\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"},hasData:function(a){return a=a.nodeType?n.cache[a[n.expando]]:a[n.expando],!!a&&!Q(a)},data:function(a,b,c){return R(a,b,c)},removeData:function(a,b){return S(a,b)},_data:function(a,b,c){return R(a,b,c,!0)},_removeData:function(a,b){return S(a,b,!0)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,\"parsedAttrs\"))){c=g.length;while(c--)d=g[c].name,0===d.indexOf(\"data-\")&&(d=n.camelCase(d.slice(5)),P(f,d,e[d]));n._data(f,\"parsedAttrs\",!0)}return e}return\"object\"==typeof a?this.each(function(){n.data(this,a)}):arguments.length>1?this.each(function(){n.data(this,a,b)}):f?P(f,a,n.data(f,a)):void 0},removeData:function(a){return this.each(function(){n.removeData(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||\"fx\")+\"queue\",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||\"fx\";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b),g=function(){n.dequeue(a,b)};\"inprogress\"===e&&(e=c.shift(),d--),e&&(\"fx\"===b&&c.unshift(\"inprogress\"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+\"queueHooks\";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks(\"once memory\").add(function(){n._removeData(a,b+\"queue\"),n._removeData(a,c)})})}}),n.fn.extend({queue:function(a,b){var c=2;return\"string\"!=typeof a&&(b=a,a=\"fx\",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),\"fx\"===a&&\"inprogress\"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||\"fx\",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};\"string\"!=typeof a&&(b=a,a=void 0),a=a||\"fx\";while(g--)c=n._data(f[g],a+\"queueHooks\"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var T=/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source,U=[\"Top\",\"Right\",\"Bottom\",\"Left\"],V=function(a,b){return a=b||a,\"none\"===n.css(a,\"display\")||!n.contains(a.ownerDocument,a)},W=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if(\"object\"===n.type(c)){e=!0;for(h in c)n.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(n(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},X=/^(?:checkbox|radio)$/i;!function(){var a=z.createDocumentFragment(),b=z.createElement(\"div\"),c=z.createElement(\"input\");if(b.setAttribute(\"className\",\"t\"),b.innerHTML=\"  <link/><table></table><a href='/a'>a</a>\",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName(\"tbody\").length,l.htmlSerialize=!!b.getElementsByTagName(\"link\").length,l.html5Clone=\"<:nav></:nav>\"!==z.createElement(\"nav\").cloneNode(!0).outerHTML,c.type=\"checkbox\",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML=\"<textarea>x</textarea>\",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML=\"<input type='radio' checked='checked' name='t'/>\",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent(\"onclick\",function(){l.noCloneEvent=!1}),b.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete b.test}catch(d){l.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=z.createElement(\"div\");for(b in{submit:!0,change:!0,focusin:!0})c=\"on\"+b,(l[b+\"Bubbles\"]=c in a)||(d.setAttribute(c,\"t\"),l[b+\"Bubbles\"]=d.attributes[c].expando===!1);d=null}();var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\\.(.+)|)$/;function bb(){return!0}function cb(){return!1}function db(){try{return z.activeElement}catch(a){}}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);if(r){c.handler&&(i=c,c=i.handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||(k=r.handle=function(a){return typeof n===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)},k.elem=a),b=(b||\"\").match(F)||[\"\"],h=b.length;while(h--)f=ab.exec(b[h])||[],o=q=f[1],p=(f[2]||\"\").split(\".\").sort(),o&&(j=n.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{},l=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(\".\")},i),(m=g[o])||(m=g[o]=[],m.delegateCount=0,j.setup&&j.setup.call(a,d,p,k)!==!1||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent(\"on\"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);if(r&&(k=r.events)){b=(b||\"\").match(F)||[\"\"],j=b.length;while(j--)if(h=ab.exec(b[j])||[],o=q=h[1],p=(h[2]||\"\").split(\".\").sort(),o){l=n.event.special[o]||{},o=(d?l.delegateType:l.bindType)||o,m=k[o]||[],h=h[2]&&new RegExp(\"(^|\\\\.)\"+p.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"),i=f=m.length;while(f--)g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&(\"**\"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&l.teardown.call(a,p,r.handle)!==!1||n.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,\"events\"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,\"type\")?b.type:b,q=j.call(b,\"namespace\")?b.namespace.split(\".\"):[];if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(p.indexOf(\".\")>=0&&(q=p.split(\".\"),p=q.shift(),q.sort()),g=p.indexOf(\":\")<0&&\"on\"+p,b=b[n.expando]?b:new n.Event(p,\"object\"==typeof b&&b),b.isTrigger=e?2:3,b.namespace=q.join(\".\"),b.namespace_re=b.namespace?new RegExp(\"(^|\\\\.)\"+q.join(\"\\\\.(?:.*\\\\.|)\")+\"(\\\\.|$)\"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{},e||!k.trigger||k.trigger.apply(d,c)!==!1)){if(!e&&!k.noBubble&&!n.isWindow(d)){for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)}m=0;while((h=o[m++])&&!b.isPropagationStopped())b.type=m>1?i:k.bindType||p,f=(n._data(h,\"events\")||{})[b.type]&&n._data(h,\"handle\"),f&&f.apply(h,c),f=g&&h[g],f&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),b.result===!1&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||k._default.apply(o.pop(),c)===!1)&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){l=d[g],l&&(d[g]=null),n.event.triggered=p;try{d[p]()}catch(r){}n.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,\"events\")||{})[a.type]||[],k=n.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){h=n.event.handlers.call(this,a,j),b=0;while((f=h[b++])&&!a.isPropagationStopped()){a.currentTarget=f.elem,g=0;while((e=f.handlers[g++])&&!a.isImmediatePropagationStopped())(!a.namespace_re||a.namespace_re.test(e.namespace))&&(a.handleObj=e,a.data=e.data,c=((n.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i),void 0!==c&&(a.result=c)===!1&&(a.preventDefault(),a.stopPropagation()))}return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||\"click\"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(i.disabled!==!0||\"click\"!==a.type)){for(e=[],f=0;h>f;f++)d=b[f],c=d.selector+\" \",void 0===e[c]&&(e[c]=d.needsContext?n(c,this).index(i)>=0:n.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;while(b--)c=d[b],a[c]=f[c];return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:\"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),fixHooks:{},keyHooks:{props:\"char charCode key keyCode\".split(\" \"),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:\"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(d=a.target.ownerDocument||z,e=d.documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==db()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:\"focusin\"},blur:{trigger:function(){return this===db()&&this.blur?(this.blur(),!1):void 0},delegateType:\"focusout\"},click:{trigger:function(){return n.nodeName(this,\"input\")&&\"checkbox\"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,\"a\")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d=\"on\"+b;a.detachEvent&&(typeof a[d]===L&&(a[d]=null),a.detachEvent(d,c))},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()}},n.each({mouseenter:\"mouseover\",mouseleave:\"mouseout\"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!n.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),l.submitBubbles||(n.event.special.submit={setup:function(){return n.nodeName(this,\"form\")?!1:void n.event.add(this,\"click._submit keypress._submit\",function(a){var b=a.target,c=n.nodeName(b,\"input\")||n.nodeName(b,\"button\")?b.form:void 0;c&&!n._data(c,\"submitBubbles\")&&(n.event.add(c,\"submit._submit\",function(a){a._submit_bubble=!0}),n._data(c,\"submitBubbles\",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate(\"submit\",this.parentNode,a,!0))},teardown:function(){return n.nodeName(this,\"form\")?!1:void n.event.remove(this,\"._submit\")}}),l.changeBubbles||(n.event.special.change={setup:function(){return Y.test(this.nodeName)?((\"checkbox\"===this.type||\"radio\"===this.type)&&(n.event.add(this,\"propertychange._change\",function(a){\"checked\"===a.originalEvent.propertyName&&(this._just_changed=!0)}),n.event.add(this,\"click._change\",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate(\"change\",this,a,!0)})),!1):void n.event.add(this,\"beforeactivate._change\",function(a){var b=a.target;Y.test(b.nodeName)&&!n._data(b,\"changeBubbles\")&&(n.event.add(b,\"change._change\",function(a){!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate(\"change\",this.parentNode,a,!0)}),n._data(b,\"changeBubbles\",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||\"radio\"!==b.type&&\"checkbox\"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,\"._change\"),!Y.test(this.nodeName)}}),l.focusinBubbles||n.each({focus:\"focusin\",blur:\"focusout\"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=n._data(d,b);e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=n._data(d,b)-1;e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if(\"object\"==typeof a){\"string\"!=typeof b&&(c=c||b,b=void 0);for(f in a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&(\"string\"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=cb;else if(!d)return this;return 1===e&&(g=d,d=function(a){return n().off(a),g.apply(this,arguments)},d.guid=g.guid||(g.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+\".\"+d.namespace:d.origType,d.selector,d.handler),this;if(\"object\"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return(b===!1||\"function\"==typeof b)&&(c=b,b=void 0),c===!1&&(c=cb),this.each(function(){n.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});function eb(a){var b=fb.split(\"|\"),c=a.createDocumentFragment();if(c.createElement)while(b.length)c.createElement(b.pop());return c}var fb=\"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",gb=/ jQuery\\d+=\"(?:null|\\d+)\"/g,hb=new RegExp(\"<(?:\"+fb+\")[\\\\s/>]\",\"i\"),ib=/^\\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,kb=/<([\\w:]+)/,lb=/<tbody/i,mb=/<|&#?\\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\\s*(?:[^=]|=\\s*.checked.)/i,pb=/^$|\\/(?:java|ecma)script/i,qb=/^true\\/(.*)/,rb=/^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,sb={option:[1,\"<select multiple='multiple'>\",\"</select>\"],legend:[1,\"<fieldset>\",\"</fieldset>\"],area:[1,\"<map>\",\"</map>\"],param:[1,\"<object>\",\"</object>\"],thead:[1,\"<table>\",\"</table>\"],tr:[2,\"<table><tbody>\",\"</tbody></table>\"],col:[2,\"<table><tbody></tbody><colgroup>\",\"</colgroup></table>\"],td:[3,\"<table><tbody><tr>\",\"</tr></tbody></table>\"],_default:l.htmlSerialize?[0,\"\",\"\"]:[1,\"X<div>\",\"</div>\"]},tb=eb(z),ub=tb.appendChild(z.createElement(\"div\"));sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td;function vb(a,b){var c,d,e=0,f=typeof a.getElementsByTagName!==L?a.getElementsByTagName(b||\"*\"):typeof a.querySelectorAll!==L?a.querySelectorAll(b||\"*\"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b));return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f}function wb(a){X.test(a.type)&&(a.defaultChecked=a.checked)}function xb(a,b){return n.nodeName(a,\"table\")&&n.nodeName(11!==b.nodeType?b:b.firstChild,\"tr\")?a.getElementsByTagName(\"tbody\")[0]||a.appendChild(a.ownerDocument.createElement(\"tbody\")):a}function yb(a){return a.type=(null!==n.find.attr(a,\"type\"))+\"/\"+a.type,a}function zb(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute(\"type\"),a}function Ab(a,b){for(var c,d=0;null!=(c=a[d]);d++)n._data(c,\"globalEval\",!b||n._data(b[d],\"globalEval\"))}function Bb(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)n.event.add(b,c,h[c][d])}g.data&&(g.data=n.extend({},g.data))}}function Cb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){e=n._data(b);for(d in e.events)n.removeEvent(b,d,e.handle);b.removeAttribute(n.expando)}\"script\"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):\"object\"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):\"input\"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):\"option\"===c?b.defaultSelected=b.selected=a.defaultSelected:(\"input\"===c||\"textarea\"===c)&&(b.defaultValue=a.defaultValue)}}n.extend({clone:function(a,b,c){var d,e,f,g,h,i=n.contains(a.ownerDocument,a);if(l.html5Clone||n.isXMLDoc(a)||!hb.test(\"<\"+a.nodeName+\">\")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(d=vb(f),h=vb(a),g=0;null!=(e=h[g]);++g)d[g]&&Cb(e,d[g]);if(b)if(c)for(h=h||vb(a),d=d||vb(f),g=0;null!=(e=h[g]);g++)Bb(e,d[g]);else Bb(a,f);return d=vb(f,\"script\"),d.length>0&&Ab(d,!i&&vb(a,\"script\")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;m>q;q++)if(f=a[q],f||0===f)if(\"object\"===n.type(f))n.merge(p,f.nodeType?[f]:f);else if(mb.test(f)){h=h||o.appendChild(b.createElement(\"div\")),i=(kb.exec(f)||[\"\",\"\"])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,\"<$1></$2>\")+k[2],e=k[0];while(e--)h=h.lastChild;if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody){f=\"table\"!==i||lb.test(f)?\"<table>\"!==k[1]||lb.test(f)?0:h:h.firstChild,e=f&&f.childNodes.length;while(e--)n.nodeName(j=f.childNodes[e],\"tbody\")&&!j.childNodes.length&&f.removeChild(j)}n.merge(p,h.childNodes),h.textContent=\"\";while(h.firstChild)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,\"input\"),wb),q=0;while(f=p[q++])if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),\"script\"),g&&Ab(h),c)){e=0;while(f=h[e++])pb.test(f.type||\"\")&&c.push(f)}return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;null!=(d=a[h]);h++)if((b||n.acceptData(d))&&(f=d[i],g=f&&j[f])){if(g.events)for(e in g.events)m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle);j[f]&&(delete j[f],k?delete d[i]:typeof d.removeAttribute!==L?d.removeAttribute(i):d[i]=null,c.push(f))}}}),n.fn.extend({text:function(a){return W(this,function(a){return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,\"script\")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){1===a.nodeType&&n.cleanData(vb(a,!1));while(a.firstChild)a.removeChild(a.firstChild);a.options&&n.nodeName(a,\"select\")&&(a.options.length=0)}return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return W(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(gb,\"\"):void 0;if(!(\"string\"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||[\"\",\"\"])[1].toLowerCase()])){a=a.replace(jb,\"<$1></$2>\");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);if(q||k>1&&\"string\"==typeof p&&!l.checkClone&&ob.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(k&&(i=n.buildFragment(a,this[0].ownerDocument,!1,this),c=i.firstChild,1===i.childNodes.length&&(i=c),c)){for(g=n.map(vb(i,\"script\"),yb),f=g.length;k>j;j++)d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,\"script\"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;f>j;j++)d=g[j],pb.test(d.type||\"\")&&!n._data(d,\"globalEval\")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||\"\").replace(rb,\"\")));i=c=null}return this}}),n.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(a,b){n.fn[a]=function(a){for(var c,d=0,e=[],g=n(a),h=g.length-1;h>=d;d++)c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Db,Eb={};function Fb(b,c){var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],\"display\");return d.detach(),e}function Gb(a){var b=z,c=Eb[a];return c||(c=Fb(a,b),\"none\"!==c&&c||(Db=(Db||n(\"<iframe frameborder='0' width='0' height='0'/>\")).appendTo(b.documentElement),b=(Db[0].contentWindow||Db[0].contentDocument).document,b.write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c}!function(){var a,b,c=z.createElement(\"div\"),d=\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0\";c.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=c.getElementsByTagName(\"a\")[0],a.style.cssText=\"float:left;opacity:.5\",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip=\"content-box\",c.cloneNode(!0).style.backgroundClip=\"\",l.clearCloneStyle=\"content-box\"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){var a,c,e,f;if(null==b){if(a=z.getElementsByTagName(\"body\")[0],!a)return;f=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px\",c=z.createElement(\"div\"),e=z.createElement(\"div\"),a.appendChild(c).appendChild(e),b=!1,typeof e.style.zoom!==L&&(e.style.cssText=d+\";width:1px;padding:1px;zoom:1\",e.innerHTML=\"<div></div>\",e.firstChild.style.width=\"5px\",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var Hb=/^margin/,Ib=new RegExp(\"^(\"+T+\")(?!px)[a-z%]+$\",\"i\"),Jb,Kb,Lb=/^(top|right|bottom|left)$/;a.getComputedStyle?(Jb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c.getPropertyValue(b)||c[b]:void 0,c&&(\"\"!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+\"\"}):z.documentElement.currentStyle&&(Jb=function(a){return a.currentStyle},Kb=function(a,b,c){var d,e,f,g,h=a.style;return c=c||Jb(a),g=c?c[b]:void 0,null==g&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,e=a.runtimeStyle,f=e&&e.left,f&&(e.left=a.currentStyle.left),h.left=\"fontSize\"===b?\"1em\":g,g=h.pixelLeft+\"px\",h.left=d,f&&(e.left=f)),void 0===g?g:g+\"\"||\"auto\"});function Mb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}!function(){var b,c,d,e,f,g,h=z.createElement(\"div\"),i=\"border:0;width:0;height:0;position:absolute;top:0;left:-9999px\",j=\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0\";h.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",b=h.getElementsByTagName(\"a\")[0],b.style.cssText=\"float:left;opacity:.5\",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip=\"content-box\",h.cloneNode(!0).style.backgroundClip=\"\",l.clearCloneStyle=\"content-box\"===h.style.backgroundClip,b=h=null,n.extend(l,{reliableHiddenOffsets:function(){if(null!=c)return c;var a,b,d,e=z.createElement(\"div\"),f=z.getElementsByTagName(\"body\")[0];if(f)return e.setAttribute(\"className\",\"t\"),e.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=z.createElement(\"div\"),a.style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML=\"<table><tr><td></td><td>t</td></tr></table>\",b=e.getElementsByTagName(\"td\"),b[0].style.cssText=\"padding:0;margin:0;border:0;display:none\",d=0===b[0].offsetHeight,b[0].style.display=\"\",b[1].style.display=\"none\",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c},boxSizing:function(){return null==d&&k(),d},boxSizingReliable:function(){return null==e&&k(),e},pixelPosition:function(){return null==f&&k(),f},reliableMarginRight:function(){var b,c,d,e;if(null==g&&a.getComputedStyle){if(b=z.getElementsByTagName(\"body\")[0],!b)return;c=z.createElement(\"div\"),d=z.createElement(\"div\"),c.style.cssText=i,b.appendChild(c).appendChild(d),e=d.appendChild(z.createElement(\"div\")),e.style.cssText=d.style.cssText=j,e.style.marginRight=e.style.width=\"0\",d.style.width=\"1px\",g=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return g}});function k(){var b,c,h=z.getElementsByTagName(\"body\")[0];h&&(b=z.createElement(\"div\"),c=z.createElement(\"div\"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText=\"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%\",n.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){d=4===c.offsetWidth}),e=!0,f=!1,g=!0,a.getComputedStyle&&(f=\"1%\"!==(a.getComputedStyle(c,null)||{}).top,e=\"4px\"===(a.getComputedStyle(c,null)||{width:\"4px\"}).width),h.removeChild(b),c=h=null)}}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Nb=/alpha\\([^)]*\\)/i,Ob=/opacity\\s*=\\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp(\"^(\"+T+\")(.*)$\",\"i\"),Rb=new RegExp(\"^([+-])=(\"+T+\")\",\"i\"),Sb={position:\"absolute\",visibility:\"hidden\",display:\"block\"},Tb={letterSpacing:0,fontWeight:400},Ub=[\"Webkit\",\"O\",\"Moz\",\"ms\"];function Vb(a,b){if(b in a)return b;var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;while(e--)if(b=Ub[e]+c,b in a)return b;return d}function Wb(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=n._data(d,\"olddisplay\"),c=d.style.display,b?(f[g]||\"none\"!==c||(d.style.display=\"\"),\"\"===d.style.display&&V(d)&&(f[g]=n._data(d,\"olddisplay\",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&\"none\"!==c||!e)&&n._data(d,\"olddisplay\",e?c:n.css(d,\"display\"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&\"none\"!==d.style.display&&\"\"!==d.style.display||(d.style.display=b?f[g]||\"\":\"none\"));return a}function Xb(a,b,c){var d=Qb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||\"px\"):b}function Yb(a,b,c,d,e){for(var f=c===(d?\"border\":\"content\")?4:\"width\"===b?1:0,g=0;4>f;f+=2)\"margin\"===c&&(g+=n.css(a,c+U[f],!0,e)),d?(\"content\"===c&&(g-=n.css(a,\"padding\"+U[f],!0,e)),\"margin\"!==c&&(g-=n.css(a,\"border\"+U[f]+\"Width\",!0,e))):(g+=n.css(a,\"padding\"+U[f],!0,e),\"padding\"!==c&&(g+=n.css(a,\"border\"+U[f]+\"Width\",!0,e)));return g}function Zb(a,b,c){var d=!0,e=\"width\"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&\"border-box\"===n.css(a,\"boxSizing\",!1,f);if(0>=e||null==e){if(e=Kb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Ib.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Yb(a,b,c||(g?\"border\":\"content\"),d,f)+\"px\"}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Kb(a,\"opacity\");return\"\"===c?\"1\":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{\"float\":l.cssFloat?\"cssFloat\":\"styleFloat\"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&\"get\"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if(f=typeof c,\"string\"===f&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f=\"number\"),null!=c&&c===c&&(\"number\"!==f||n.cssNumber[h]||(c+=\"px\"),l.clearCloneStyle||\"\"!==c||0!==b.indexOf(\"background\")||(i[b]=\"inherit\"),!(g&&\"set\"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]=\"\",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),g=n.cssHooks[b]||n.cssHooks[h],g&&\"get\"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),\"normal\"===f&&b in Tb&&(f=Tb[b]),\"\"===c||c?(e=parseFloat(f),c===!0||n.isNumeric(e)?e||0:f):f}}),n.each([\"height\",\"width\"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Pb.test(n.css(a,\"display\"))?n.swap(a,Sb,function(){return Zb(a,b,d)}):Zb(a,b,d):void 0},set:function(a,c,d){var e=d&&Jb(a);return Xb(a,c,d?Yb(a,b,d,l.boxSizing()&&\"border-box\"===n.css(a,\"boxSizing\",!1,e),e):0)}}}),l.opacity||(n.cssHooks.opacity={get:function(a,b){return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||\"\")?.01*parseFloat(RegExp.$1)+\"\":b?\"1\":\"\"},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?\"alpha(opacity=\"+100*b+\")\":\"\",f=d&&d.filter||c.filter||\"\";c.zoom=1,(b>=1||\"\"===b)&&\"\"===n.trim(f.replace(Nb,\"\"))&&c.removeAttribute&&(c.removeAttribute(\"filter\"),\"\"===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+\" \"+e)}}),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){return b?n.swap(a,{display:\"inline-block\"},Kb,[a,\"marginRight\"]):void 0}),n.each({margin:\"\",padding:\"\",border:\"Width\"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f=\"string\"==typeof c?c.split(\" \"):[c];4>d;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Hb.test(a)||(n.cssHooks[a+b].set=Xb)}),n.fn.extend({css:function(a,b){return W(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Jb(a),e=b.length;e>g;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)\r\n},a,b,arguments.length>1)},show:function(){return Wb(this,!0)},hide:function(){return Wb(this)},toggle:function(a){return\"boolean\"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}});function $b(a,b,c,d,e){return new $b.prototype.init(a,b,c,d,e)}n.Tween=$b,$b.prototype={constructor:$b,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||\"swing\",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?\"\":\"px\")},cur:function(){var a=$b.propHooks[this.prop];return a&&a.get?a.get(this):$b.propHooks._default.get(this)},run:function(a){var b,c=$b.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this}},$b.prototype.init.prototype=$b.prototype,$b.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,\"\"),b&&\"auto\"!==b?b:0):a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},$b.propHooks.scrollTop=$b.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=$b.prototype.init,n.fx.step={};var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp(\"^(?:([+-])=|)(\"+T+\")([a-z%]*)$\",\"i\"),dc=/queueHooks$/,ec=[jc],fc={\"*\":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?\"\":\"px\"),g=(n.cssNumber[a]||\"px\"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||\".5\",g/=h,n.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function gc(){return setTimeout(function(){_b=void 0}),_b=n.now()}function hc(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=U[e],d[\"margin\"+c]=d[\"padding\"+c]=a;return b&&(d.opacity=d.width=a),d}function ic(a,b,c){for(var d,e=(fc[b]||[]).concat(fc[\"*\"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function jc(a,b,c){var d,e,f,g,h,i,j,k,m=this,o={},p=a.style,q=a.nodeType&&V(a),r=n._data(a,\"fxshow\");c.queue||(h=n._queueHooks(a,\"fx\"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,m.always(function(){m.always(function(){h.unqueued--,n.queue(a,\"fx\").length||h.empty.fire()})})),1===a.nodeType&&(\"height\"in b||\"width\"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,\"display\"),k=Gb(a.nodeName),\"none\"===j&&(j=k),\"inline\"===j&&\"none\"===n.css(a,\"float\")&&(l.inlineBlockNeedsLayout&&\"inline\"!==k?p.zoom=1:p.display=\"inline-block\")),c.overflow&&(p.overflow=\"hidden\",l.shrinkWrapBlocks()||m.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],bc.exec(e)){if(delete b[d],f=f||\"toggle\"===e,e===(q?\"hide\":\"show\")){if(\"show\"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||n.style(a,d)}if(!n.isEmptyObject(o)){r?\"hidden\"in r&&(q=r.hidden):r=n._data(a,\"fxshow\",{}),f&&(r.hidden=!q),q?n(a).show():m.done(function(){n(a).hide()}),m.done(function(){var b;n._removeData(a,\"fxshow\");for(b in o)n.style(a,b,o[b])});for(d in o)g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start=\"width\"===d||\"height\"===d?1:0))}}function kc(a,b){var c,d,e,f,g;for(c in a)if(d=n.camelCase(c),e=b[d],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=n.cssHooks[d],g&&\"expand\"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function lc(a,b,c){var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(kc(k,j.opts.specialEasing);g>f;f++)if(d=ec[f].call(j,a,k,j.opts))return d;return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(lc,{tweener:function(a,b){n.isFunction(a)?(b=a,a=[\"*\"]):a=a.split(\" \");for(var c,d=0,e=a.length;e>d;d++)c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)},prefilter:function(a,b){b?ec.unshift(a):ec.push(a)}}),n.speed=function(a,b,c){var d=a&&\"object\"==typeof a?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:\"number\"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue=\"fx\"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css(\"opacity\",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=lc(this,n.extend({},a),f);(e||n._data(this,\"finish\"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return\"string\"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||\"fx\",[]),this.each(function(){var b=!0,e=null!=a&&a+\"queueHooks\",f=n.timers,g=n._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&dc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));(b||!c)&&n.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||\"fx\"),this.each(function(){var b,c=n._data(this),d=c[a+\"queue\"],e=c[a+\"queueHooks\"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each([\"toggle\",\"show\",\"hide\"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||\"boolean\"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)}}),n.each({slideDown:hc(\"show\"),slideUp:hc(\"hide\"),slideToggle:hc(\"toggle\"),fadeIn:{opacity:\"show\"},fadeOut:{opacity:\"hide\"},fadeToggle:{opacity:\"toggle\"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=n.timers,c=0;for(_b=n.now();c<b.length;c++)a=b[c],a()||b[c]!==a||b.splice(c--,1);b.length||n.fx.stop(),_b=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){ac||(ac=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(ac),ac=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx?n.fx.speeds[a]||a:a,b=b||\"fx\",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=z.createElement(\"div\");e.setAttribute(\"className\",\"t\"),e.innerHTML=\"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\",a=e.getElementsByTagName(\"a\")[0],c=z.createElement(\"select\"),d=c.appendChild(z.createElement(\"option\")),b=e.getElementsByTagName(\"input\")[0],a.style.cssText=\"top:1px\",l.getSetAttribute=\"t\"!==e.className,l.style=/top/.test(a.getAttribute(\"style\")),l.hrefNormalized=\"/a\"===a.getAttribute(\"href\"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement(\"form\").enctype,c.disabled=!0,l.optDisabled=!d.disabled,b=z.createElement(\"input\"),b.setAttribute(\"value\",\"\"),l.input=\"\"===b.getAttribute(\"value\"),b.value=\"t\",b.setAttribute(\"type\",\"radio\"),l.radioValue=\"t\"===b.value,a=b=c=d=e=null}();var mc=/\\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,n(this).val()):a,null==e?e=\"\":\"number\"==typeof e?e+=\"\":n.isArray(e)&&(e=n.map(e,function(a){return null==a?\"\":a+\"\"})),b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()],b&&\"set\"in b&&void 0!==b.set(this,e,\"value\")||(this.value=e))});if(e)return b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()],b&&\"get\"in b&&void 0!==(c=b.get(e,\"value\"))?c:(c=e.value,\"string\"==typeof c?c.replace(mc,\"\"):null==c?\"\":c)}}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,\"value\");return null!=b?b:n.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f=\"select-one\"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute(\"disabled\"))||c.parentNode.disabled&&n.nodeName(c.parentNode,\"optgroup\"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){var c,d,e=a.options,f=n.makeArray(b),g=e.length;while(g--)if(d=e[g],n.inArray(n.valHooks.option.get(d),f)>=0)try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),n.each([\"radio\",\"checkbox\"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=n.inArray(n(a).val(),b)>=0:void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute(\"value\")?\"on\":a.value})});var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;n.fn.extend({attr:function(a,b){return W(this,n.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&\"get\"in d&&null!==(e=d.get(a,b))?e:(e=n.find.attr(a,b),null==e?void 0:e):null!==c?d&&\"set\"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+\"\"),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)while(c=f[e++])d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase(\"default-\"+c)]=a[d]=!1:n.attr(a,c,\"\"),a.removeAttribute(rc?c:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&\"radio\"===b&&n.nodeName(a,\"input\")){var c=a.value;return a.setAttribute(\"type\",b),c&&(a.value=c),b}}}}}),oc={set:function(a,b,c){return b===!1?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase(\"default-\"+c)]=a[c]=!0,c}},n.each(n.expr.match.bool.source.match(/\\w+/g),function(a,b){var c=pc[b]||n.find.attr;pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){var e,f;return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e}:function(a,b,c){return c?void 0:a[n.camelCase(\"default-\"+b)]?b.toLowerCase():null}}),sc&&rc||(n.attrHooks.value={set:function(a,b,c){return n.nodeName(a,\"input\")?void(a.defaultValue=b):nc&&nc.set(a,b,c)}}),rc||(nc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+=\"\",\"value\"===c||b===a.getAttribute(c)?b:void 0}},pc.id=pc.name=pc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&\"\"!==d.value?d.value:null},n.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:nc.set},n.attrHooks.contenteditable={set:function(a,b,c){nc.set(a,\"\"===b?!1:b,c)}},n.each([\"width\",\"height\"],function(a,b){n.attrHooks[b]={set:function(a,c){return\"\"===c?(a.setAttribute(b,\"auto\"),c):void 0}}})),l.style||(n.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+\"\"}});var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return W(this,n.prop,a,b,arguments.length>1)},removeProp:function(a){return a=n.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),n.extend({propFix:{\"for\":\"htmlFor\",\"class\":\"className\"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!n.isXMLDoc(a),f&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&\"set\"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&\"get\"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,\"tabindex\");return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1}}}}),l.hrefNormalized||n.each([\"href\",\"src\"],function(a,b){n.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),n.each([\"tabIndex\",\"readOnly\",\"maxLength\",\"cellSpacing\",\"cellPadding\",\"rowSpan\",\"colSpan\",\"useMap\",\"frameBorder\",\"contentEditable\"],function(){n.propFix[this.toLowerCase()]=this}),l.enctype||(n.propFix.enctype=\"encoding\");var vc=/[\\t\\r\\n\\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=\"string\"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||\"\").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(\" \"+c.className+\" \").replace(vc,\" \"):\" \")){f=0;while(e=b[f++])d.indexOf(\" \"+e+\" \")<0&&(d+=e+\" \");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||\"string\"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||\"\").match(F)||[];i>h;h++)if(c=this[h],d=1===c.nodeType&&(c.className?(\" \"+c.className+\" \").replace(vc,\" \"):\"\")){f=0;while(e=b[f++])while(d.indexOf(\" \"+e+\" \")>=0)d=d.replace(\" \"+e+\" \",\" \");g=a?n.trim(d):\"\",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return\"boolean\"==typeof b&&\"string\"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if(\"string\"===c){var b,d=0,e=n(this),f=a.match(F)||[];while(b=f[d++])e.hasClass(b)?e.removeClass(b):e.addClass(b)}else(c===L||\"boolean\"===c)&&(this.className&&n._data(this,\"__className__\",this.className),this.className=this.className||a===!1?\"\":n._data(this,\"__className__\")||\"\")})},hasClass:function(a){for(var b=\" \"+a+\" \",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(\" \"+this[c].className+\" \").replace(vc,\" \").indexOf(b)>=0)return!0;return!1}}),n.each(\"blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu\".split(\" \"),function(a,b){n.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,\"**\"):this.off(b,a||\"**\",c)}});var wc=n.now(),xc=/\\?/,yc=/(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g;n.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+\"\");var c,d=null,e=n.trim(b+\"\");return e&&!n.trim(e.replace(yc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,\"\")}))?Function(\"return \"+e)():n.error(\"Invalid JSON: \"+b)},n.parseXML=function(b){var c,d;if(!b||\"string\"!=typeof b)return null;try{a.DOMParser?(d=new DOMParser,c=d.parseFromString(b,\"text/xml\")):(c=new ActiveXObject(\"Microsoft.XMLDOM\"),c.async=\"false\",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName(\"parsererror\").length||n.error(\"Invalid XML: \"+b),c};var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/gm,Ec=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Fc=/^(?:GET|HEAD)$/,Gc=/^\\/\\//,Hc=/^([\\w.+-]+:)(?:\\/\\/(?:[^\\/?#]*@|)([^\\/?#:]*)(?::(\\d+)|)|)/,Ic={},Jc={},Kc=\"*/\".concat(\"*\");try{Ac=location.href}catch(Lc){Ac=z.createElement(\"a\"),Ac.href=\"\",Ac=Ac.href}zc=Hc.exec(Ac.toLowerCase())||[];function Mc(a){return function(b,c){\"string\"!=typeof b&&(c=b,b=\"*\");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))while(d=f[e++])\"+\"===d.charAt(0)?(d=d.slice(1)||\"*\",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nc(a,b,c,d){var e={},f=a===Jc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return\"string\"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e[\"*\"]&&g(\"*\")}function Oc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&n.extend(!0,a,c),a}function Pc(a,b,c){var d,e,f,g,h=a.contents,i=a.dataTypes;while(\"*\"===i[0])i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader(\"Content-Type\"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+\" \"+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function Qc(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];f=k.shift();while(f)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if(\"*\"===f)f=i;else if(\"*\"!==i&&i!==f){if(g=j[i+\" \"+f]||j[\"* \"+f],!g)for(e in j)if(h=e.split(\" \"),h[1]===f&&(g=j[i+\" \"+h[0]]||j[\"* \"+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a[\"throws\"])b=g(b);else try{b=g(b)}catch(l){return{state:\"parsererror\",error:g?l:\"No conversion from \"+i+\" to \"+f}}}return{state:\"success\",data:b}}n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ac,type:\"GET\",isLocal:Ec.test(zc[1]),global:!0,processData:!0,async:!0,contentType:\"application/x-www-form-urlencoded; charset=UTF-8\",accepts:{\"*\":Kc,text:\"text/plain\",html:\"text/html\",xml:\"application/xml, text/xml\",json:\"application/json, text/javascript\"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:\"responseXML\",text:\"responseText\",json:\"responseJSON\"},converters:{\"* text\":String,\"text html\":!0,\"text json\":n.parseJSON,\"text xml\":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)},ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){\"object\"==typeof a&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks(\"once memory\"),q=k.statusCode||{},r={},s={},t=0,u=\"canceled\",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j){j={};while(b=Dc.exec(f))j[b[1].toLowerCase()]=b[2]}b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+\"\").replace(Bc,\"\").replace(Gc,zc[1]+\"//\"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||\"*\").toLowerCase().match(F)||[\"\"],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||(\"http:\"===c[1]?\"80\":\"443\"))===(zc[3]||(\"http:\"===zc[1]?\"80\":\"443\")))),k.data&&k.processData&&\"string\"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t)return v;h=k.global,h&&0===n.active++&&n.event.trigger(\"ajaxStart\"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?\"&\":\"?\")+k.data,delete k.data),k.cache===!1&&(k.url=Cc.test(e)?e.replace(Cc,\"$1_=\"+wc++):e+(xc.test(e)?\"&\":\"?\")+\"_=\"+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader(\"If-Modified-Since\",n.lastModified[e]),n.etag[e]&&v.setRequestHeader(\"If-None-Match\",n.etag[e])),(k.data&&k.hasContent&&k.contentType!==!1||b.contentType)&&v.setRequestHeader(\"Content-Type\",k.contentType),v.setRequestHeader(\"Accept\",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+(\"*\"!==k.dataTypes[0]?\", \"+Kc+\"; q=0.01\":\"\"):k.accepts[\"*\"]);for(d in k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(k.beforeSend.call(l,v,k)===!1||2===t))return v.abort();u=\"abort\";for(d in{success:1,error:1,complete:1})v[d](k[d]);if(i=Nc(Jc,k,b,v)){v.readyState=1,h&&m.trigger(\"ajaxSend\",[v,k]),k.async&&k.timeout>0&&(g=setTimeout(function(){v.abort(\"timeout\")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(2>t))throw w;x(-1,w)}}else x(-1,\"No Transport\");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||\"\",v.readyState=a>0?4:0,j=a>=200&&300>a||304===a,c&&(u=Pc(k,v,c)),u=Qc(k,u,v,j),j?(k.ifModified&&(w=v.getResponseHeader(\"Last-Modified\"),w&&(n.lastModified[e]=w),w=v.getResponseHeader(\"etag\"),w&&(n.etag[e]=w)),204===a||\"HEAD\"===k.type?x=\"nocontent\":304===a?x=\"notmodified\":(x=u.state,r=u.data,s=u.error,j=!s)):(s=x,(a||!x)&&(x=\"error\",0>a&&(a=0))),v.status=a,v.statusText=(b||x)+\"\",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?\"ajaxSuccess\":\"ajaxError\",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger(\"ajaxComplete\",[v,k]),--n.active||n.event.trigger(\"ajaxStop\")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,\"json\")},getScript:function(a,b){return n.get(a,void 0,b,\"script\")}}),n.each([\"get\",\"post\"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each([\"ajaxStart\",\"ajaxStop\",\"ajaxComplete\",\"ajaxError\",\"ajaxSuccess\",\"ajaxSend\"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:\"GET\",dataType:\"script\",async:!1,global:!1,\"throws\":!0})},n.fn.extend({wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){var a=this;while(a.firstChild&&1===a.firstChild.nodeType)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,\"body\")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&\"none\"===(a.style&&a.style.display||n.css(a,\"display\"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Rc=/%20/g,Sc=/\\[\\]$/,Tc=/\\r?\\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;function Wc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Sc.test(a)?d(a,e):Wc(a+\"[\"+(\"object\"==typeof e?b:\"\")+\"]\",e,c,d)});else if(c||\"object\"!==n.type(b))d(a,b);else for(e in b)Wc(a+\"[\"+e+\"]\",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?\"\":b,d[d.length]=encodeURIComponent(a)+\"=\"+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Wc(c,a[c],b,e);return d.join(\"&\").replace(Rc,\"+\")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,\"elements\");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(\":disabled\")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Tc,\"\\r\\n\")}}):{name:b.name,value:c.replace(Tc,\"\\r\\n\")}}).get()}}),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||_c()}:$c;var Xc=0,Yc={},Zc=n.ajaxSettings.xhr();a.ActiveXObject&&n(a).on(\"unload\",function(){for(var a in Yc)Yc[a](void 0,!0)}),l.cors=!!Zc&&\"withCredentials\"in Zc,Zc=l.ajax=!!Zc,Zc&&n.ajaxTransport(function(a){if(!a.crossDomain||l.cors){var b;return{send:function(c,d){var e,f=a.xhr(),g=++Xc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c[\"X-Requested-With\"]||(c[\"X-Requested-With\"]=\"XMLHttpRequest\");for(e in c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+\"\");f.send(a.hasContent&&a.data||null),b=function(c,e){var h,i,j;if(b&&(e||4===f.readyState))if(delete Yc[g],b=void 0,f.onreadystatechange=n.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,\"string\"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=\"\"}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(b):f.onreadystatechange=Yc[g]=b:b()},abort:function(){b&&b(void 0,!0)}}}});function $c(){try{return new a.XMLHttpRequest}catch(b){}}function _c(){try{return new a.ActiveXObject(\"Microsoft.XMLHTTP\")}catch(b){}}n.ajaxSetup({accepts:{script:\"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"},contents:{script:/(?:java|ecma)script/},converters:{\"text script\":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter(\"script\",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type=\"GET\",a.global=!1)}),n.ajaxTransport(\"script\",function(a){if(a.crossDomain){var b,c=z.head||n(\"head\")[0]||z.documentElement;return{send:function(d,e){b=z.createElement(\"script\"),b.async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){(c||!b.readyState||/loaded|complete/.test(b.readyState))&&(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,\"success\"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ad=[],bd=/(=)\\?(?=&|$)|\\?\\?/;n.ajaxSetup({jsonp:\"callback\",jsonpCallback:function(){var a=ad.pop()||n.expando+\"_\"+wc++;return this[a]=!0,a}}),n.ajaxPrefilter(\"json jsonp\",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(bd.test(b.url)?\"url\":\"string\"==typeof b.data&&!(b.contentType||\"\").indexOf(\"application/x-www-form-urlencoded\")&&bd.test(b.data)&&\"data\");return h||\"jsonp\"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,\"$1\"+e):b.jsonp!==!1&&(b.url+=(xc.test(b.url)?\"&\":\"?\")+b.jsonp+\"=\"+e),b.converters[\"script json\"]=function(){return g||n.error(e+\" was not called\"),g[0]},b.dataTypes[0]=\"json\",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),\"script\"):void 0}),n.parseHTML=function(a,b,c){if(!a||\"string\"!=typeof a)return null;\"boolean\"==typeof b&&(c=b,b=!1),b=b||z;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var cd=n.fn.load;n.fn.load=function(a,b,c){if(\"string\"!=typeof a&&cd)return cd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(\" \");return h>=0&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&\"object\"==typeof b&&(f=\"POST\"),g.length>0&&n.ajax({url:a,type:f,dataType:\"html\",data:b}).done(function(a){e=arguments,g.html(d?n(\"<div>\").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var dd=a.document.documentElement;function ed(a){return n.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=n.css(a,\"position\"),l=n(a),m={};\"static\"===k&&(a.style.position=\"relative\"),h=l.offset(),f=n.css(a,\"top\"),i=n.css(a,\"left\"),j=(\"absolute\"===k||\"fixed\"===k)&&n.inArray(\"auto\",[f,i])>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),\"using\"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;if(f)return b=f.documentElement,n.contains(b,e)?(typeof e.getBoundingClientRect!==L&&(d=e.getBoundingClientRect()),c=ed(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return\"fixed\"===n.css(d,\"position\")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],\"html\")||(c=a.offset()),c.top+=n.css(a[0],\"borderTopWidth\",!0),c.left+=n.css(a[0],\"borderLeftWidth\",!0)),{top:b.top-c.top-n.css(d,\"marginTop\",!0),left:b.left-c.left-n.css(d,\"marginLeft\",!0)}}},offsetParent:function(){return this.map(function(){var a=this.offsetParent||dd;while(a&&!n.nodeName(a,\"html\")&&\"static\"===n.css(a,\"position\"))a=a.offsetParent;return a||dd})}}),n.each({scrollLeft:\"pageXOffset\",scrollTop:\"pageYOffset\"},function(a,b){var c=/Y/.test(b);n.fn[a]=function(d){return W(this,function(a,d,e){var f=ed(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),n.each([\"top\",\"left\"],function(a,b){n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+\"px\":c):void 0})}),n.each({Height:\"height\",Width:\"width\"},function(a,b){n.each({padding:\"inner\"+a,content:b,\"\":\"outer\"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||\"boolean\"!=typeof d),g=c||(d===!0||e===!0?\"margin\":\"border\");return W(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement[\"client\"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body[\"scroll\"+a],e[\"scroll\"+a],b.body[\"offset\"+a],e[\"offset\"+a],e[\"client\"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,\"function\"==typeof define&&define.amd&&define(\"jquery\",[],function(){return n});var fd=a.jQuery,gd=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n},typeof b===L&&(a.jQuery=a.$=n),n});\r\n","/*! vex.js, vex.dialog.js 2.0.1 */\r\n(function(){var a;a=function(a){var b,c;return b=!1,a(function(){var d;return d=(document.body||document.documentElement).style,b=void 0!==d.animation||void 0!==d.WebkitAnimation||void 0!==d.MozAnimation||void 0!==d.MsAnimation||void 0!==d.OAnimation,a(window).bind(\"keyup.vex\",function(a){return 27===a.keyCode?c.closeByEscape():void 0})}),c={globalID:1,animationEndEvent:\"animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend\",baseClassNames:{vex:\"vex\",content:\"vex-content\",overlay:\"vex-overlay\",close:\"vex-close\",closing:\"vex-closing\",open:\"vex-open\"},defaultOptions:{content:\"\",showCloseButton:!0,escapeButtonCloses:!0,overlayClosesOnClick:!0,appendLocation:\"body\",className:\"\",css:{},overlayClassName:\"\",overlayCSS:{},contentClassName:\"\",contentCSS:{},closeClassName:\"\",closeCSS:{}},open:function(b){return b=a.extend({},c.defaultOptions,b),b.id=c.globalID,c.globalID+=1,b.$vex=a(\"<div>\").addClass(c.baseClassNames.vex).addClass(b.className).css(b.css).data({vex:b}),b.$vexOverlay=a(\"<div>\").addClass(c.baseClassNames.overlay).addClass(b.overlayClassName).css(b.overlayCSS).data({vex:b}),b.overlayClosesOnClick&&b.$vexOverlay.bind(\"click.vex\",function(b){return b.target===this?c.close(a(this).data().vex.id):void 0}),b.$vex.append(b.$vexOverlay),b.$vexContent=a(\"<div>\").addClass(c.baseClassNames.content).addClass(b.contentClassName).css(b.contentCSS).append(b.content).data({vex:b}),b.$vex.append(b.$vexContent),b.showCloseButton&&(b.$closeButton=a(\"<div>\").addClass(c.baseClassNames.close).addClass(b.closeClassName).css(b.closeCSS).data({vex:b}).bind(\"click.vex\",function(){return c.close(a(this).data().vex.id)}),b.$vexContent.append(b.$closeButton)),a(b.appendLocation).append(b.$vex),c.setupBodyClassName(b.$vex),b.afterOpen&&b.afterOpen(b.$vexContent,b),setTimeout(function(){return b.$vexContent.trigger(\"vexOpen\",b)},0),b.$vexContent},getAllVexes:function(){return a(\".\"+c.baseClassNames.vex+':not(\".'+c.baseClassNames.closing+'\") .'+c.baseClassNames.content)},getVexByID:function(b){return c.getAllVexes().filter(function(){return a(this).data().vex.id===b})},close:function(a){var b;if(!a){if(b=c.getAllVexes().last(),!b.length)return!1;a=b.data().vex.id}return c.closeByID(a)},closeAll:function(){var b;return b=c.getAllVexes().map(function(){return a(this).data().vex.id}).toArray(),(null!=b?b.length:void 0)?(a.each(b.reverse(),function(a,b){return c.closeByID(b)}),!0):!1},closeByID:function(d){var e,f,g,h,i;return f=c.getVexByID(d),f.length?(e=f.data().vex.$vex,i=a.extend({},f.data().vex),g=function(){return i.beforeClose?i.beforeClose(f,i):void 0},h=function(){return f.trigger(\"vexClose\",i),e.remove(),i.afterClose?i.afterClose(f,i):void 0},b?(g(),e.unbind(c.animationEndEvent).bind(c.animationEndEvent,function(){return h()}).addClass(c.baseClassNames.closing)):(g(),h()),!0):void 0},closeByEscape:function(){var b,d,e;return e=c.getAllVexes().map(function(){return a(this).data().vex.id}).toArray(),(null!=e?e.length:void 0)?(d=Math.max.apply(Math,e),b=c.getVexByID(d),b.data().vex.escapeButtonCloses!==!0?!1:c.closeByID(d)):!1},setupBodyClassName:function(b){return b.bind(\"vexOpen.vex\",function(){return a(\"body\").addClass(c.baseClassNames.open)}).bind(\"vexClose.vex\",function(){return c.getAllVexes().length?void 0:a(\"body\").removeClass(c.baseClassNames.open)})},hideLoading:function(){return a(\".vex-loading-spinner\").remove()},showLoading:function(){return c.hideLoading(),a(\"body\").append('<div class=\"vex-loading-spinner '+c.defaultOptions.className+'\"></div>')}}},\"function\"==typeof define&&define.amd?define([\"jquery\"],a):\"object\"==typeof exports?module.exports=a(require(\"jquery\")):window.vex=a(jQuery)}).call(this),function(){var a;a=function(a,b){var c,d;return null==b?a.error(\"Vex is required to use vex.dialog\"):(c=function(b){var c;return c={},a.each(b.serializeArray(),function(){return c[this.name]?(c[this.name].push||(c[this.name]=[c[this.name]]),c[this.name].push(this.value||\"\")):c[this.name]=this.value||\"\"}),c},d={},d.buttons={YES:{text:\"OK\",type:\"submit\",className:\"vex-dialog-button-primary\"},NO:{text:\"Cancel\",type:\"button\",className:\"vex-dialog-button-secondary\",click:function(a){return a.data().vex.value=!1,b.close(a.data().vex.id)}}},d.defaultOptions={callback:function(){},afterOpen:function(){},message:\"Message\",input:'<input name=\"vex\" type=\"hidden\" value=\"_vex-empty-value\" />',value:!1,buttons:[d.buttons.YES,d.buttons.NO],showCloseButton:!1,onSubmit:function(e){var f,g;return f=a(this),g=f.parent(),e.preventDefault(),e.stopPropagation(),g.data().vex.value=d.getFormValueOnSubmit(c(f)),b.close(g.data().vex.id)},focusFirstInput:!0},d.defaultAlertOptions={message:\"Alert\",buttons:[d.buttons.YES]},d.defaultConfirmOptions={message:\"Confirm\"},d.open=function(c){var e;return c=a.extend({},b.defaultOptions,d.defaultOptions,c),c.content=d.buildDialogForm(c),c.beforeClose=function(a){return c.callback(a.data().vex.value)},e=b.open(c),c.focusFirstInput&&e.find('input[type=\"submit\"], textarea, input[type=\"date\"], input[type=\"datetime\"], input[type=\"datetime-local\"], input[type=\"email\"], input[type=\"month\"], input[type=\"number\"], input[type=\"password\"], input[type=\"search\"], input[type=\"tel\"], input[type=\"text\"], input[type=\"time\"], input[type=\"url\"], input[type=\"week\"]').first().focus(),e},d.alert=function(b){return\"string\"==typeof b&&(b={message:b}),b=a.extend({},d.defaultAlertOptions,b),d.open(b)},d.confirm=function(b){return\"string\"==typeof b?a.error(\"dialog.confirm(options) requires options.callback.\"):(b=a.extend({},d.defaultConfirmOptions,b),d.open(b))},d.prompt=function(b){var c;return\"string\"==typeof b?a.error(\"dialog.prompt(options) requires options.callback.\"):(c={message:'<label for=\"vex\">'+(b.label||\"Prompt:\")+\"</label>\",input:'<input name=\"vex\" type=\"text\" class=\"vex-dialog-prompt-input\" placeholder=\"'+(b.placeholder||\"\")+'\"  value=\"'+(b.value||\"\")+'\" />'},b=a.extend({},c,b),d.open(b))},d.buildDialogForm=function(b){var c,e,f;return c=a('<form class=\"vex-dialog-form\" />'),f=a('<div class=\"vex-dialog-message\" />'),e=a('<div class=\"vex-dialog-input\" />'),c.append(f.append(b.message)).append(e.append(b.input)).append(d.buttonsToDOM(b.buttons)).bind(\"submit.vex\",b.onSubmit),c},d.getFormValueOnSubmit=function(a){return a.vex||\"\"===a.vex?\"_vex-empty-value\"===a.vex?!0:a.vex:a},d.buttonsToDOM=function(c){var d;return d=a('<div class=\"vex-dialog-buttons\" />'),a.each(c,function(e,f){return d.append(a('<input type=\"'+f.type+'\" />').val(f.text).addClass(f.className+\" vex-dialog-button \"+(0===e?\"vex-first \":\"\")+(e===c.length-1?\"vex-last \":\"\")).bind(\"click.vex\",function(c){return f.click?f.click(a(this).parents(\".\"+b.baseClassNames.content),c):void 0}))}),d},d)},\"function\"==typeof define&&define.amd?define([\"jquery\",\"vex\"],a):\"object\"==typeof exports?module.exports=a(require(\"jquery\"),require(\"vex\")):window.vex.dialog=a(window.jQuery,window.vex)}.call(this);"]}